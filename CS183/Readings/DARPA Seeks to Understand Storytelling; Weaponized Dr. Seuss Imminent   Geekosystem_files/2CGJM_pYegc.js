/*1338773412,176833974*/

if (window.CavalryLogger) { CavalryLogger.start_js(["726uy"]); }

__d("legacy:primer",["Primer"],function(a,b,c,d){b('Primer');},3);
if(!window.CommentAdminPanelController){window.CommentAdminPanelController=function(a){copy_properties(this,{channel:a.channel,controllerID:a.controllerID,commentIDs:a.commentIDs,domIDs:a.domIDs,blacklistedActors:a.blacklistedActors,actorToCommentInfoMap:a.actorToCommentIDMap,commentInfoMap:a.commentInfoMap,inAggregatedView:a.inAggregatedView,inModerationQueue:a.inModerationQueue,inContextualDialog:a.inContextualDialog,loggedIn:a.loggedIn,userOwnsPages:a.userOwnsPages,recentlyBlacklistedActors:a.blacklistedActors});this.controlledRegion=$(this.controllerID);this.attachClickHandlers();if(this.inModerationQueue)this.registerModeratorQueueHandlers(true);if(this.inContextualDialog)this.attachContextualDialogHandlers();if(!this.inAggregatedView)UnverifiedXD.init({autoResize:true,channelUrl:a.channel,hideOverflow:true,resizeWidth:false});};copy_properties(CommentAdminPanelController,{allControllers:{},mainController:null,contextualControllers:{},initController:function(a){var b=new CommentAdminPanelController(a),c=a.controllerID;CommentAdminPanelController.allControllers[c]=b;if(b.inContextualDialog){CommentAdminPanelController.contextualControllers[c]=b;}else CommentAdminPanelController.mainController=b;},syncController:function(a,b){var c=CommentAdminPanelController.allControllers[a];c.attachClickHandlers();if(!c.isControllingModerationQueue())return;c.deselectComments(b);c.registerModeratorQueueHandlers(false);c.synchronizeModeratorQueueUI();},resetController:function(a){var b=CommentAdminPanelController.allControllers[a];b.resetController();},updateController:function(a,b,c,d,e,f){var g=CommentAdminPanelController.allControllers[a];g.updateController(b,c,d,e,f);if(!CommentAdminPanelController.mainController.loggedIn)MultiLoginPopup.reattachLoginInterceptors();if(!g.isControllingModerationQueue())return;g.registerModeratorQueueHandlers(false);g.synchronizeModeratorQueueUI();},registerMoreCommentsLinkHandler:function(a,b){var c=CommentAdminPanelController.allControllers[a];c.registerMoreCommentsLinkHandler(b);},notifyCommentCreated:function(a){if(!CommentAdminPanelController.mainController.channel)return;UnverifiedXD.send({type:'commentCreated',href:a.href,parentCommentID:a.parentCommentID,commentID:a.commentID});},notifyCommentRemoved:function(a){if(!CommentAdminPanelController.mainController.channel)return;UnverifiedXD.send({type:'commentRemoved',href:a.href,commentID:a.commentID});},markAsShowingAllReplies:function(a){var b=a+' a.fbUpDownVoteOption',c=DOM.scry(document.documentElement,b),d=a+' li.fbUpDownVoteOption a.itemAnchor',e=DOM.scry(document.documentElement,d),f=c.concat(e);for(var g=0;g<f.length;g++){var h=f[g],i=new URI(h.getAttribute('ajaxify'));i.addQueryData({show_all_replies:1});h.setAttribute('ajaxify',i.toString());}},setLoggedIn:function(a){CommentAdminPanelController.mainController.loggedIn=a;}});copy_properties(CommentAdminPanelController.prototype,{isControllingModerationQueue:function(){var a=this==CommentAdminPanelController.mainController&&this.inModerationQueue;return a;},resetController:function(){this.commentIDs=[];this.domIDs=[];},updateController:function(a,b,c,d,e){a.forEach(function(g){this.commentIDs.push(g);},this);b.forEach(function(g){this.domIDs.push(g);},this);copy_properties(this.blacklistedActors,c);for(var f in d){if(!this.actorToCommentInfoMap[f])this.actorToCommentInfoMap[f]=[];d[f].forEach(function(g){this.actorToCommentInfoMap[f].push(g);},this);}copy_properties(this.commentInfoMap,e);this.attachClickHandlers();},attachClickHandlers:function(){for(var a=0;a<this.domIDs.length;a++){var b='li[id="'+this.domIDs[a]+'"]',c=DOM.scry(this.controlledRegion,b);if(c.length===0)continue;var d=c[0],e=DOM.scry(d,'a.uiCloseButton');Event.listen(d,'mouseleave',this.closeStickyMenuFlyouts.bind(this,e));var f=DOM.scry(d,'.fbModerateDropdownContainer');if(f.length>0){var g=f[0],h=DOM.find(g,'.fbModerateDropdownLink');Event.listen(h,'mouseover',function(q,event){CSS.addClass(q,'fbUnderlineText');}.curry(h));Event.listen(h,'mouseout',function(q,event){CSS.removeClass(q,'fbUnderlineText');}.curry(h));var i=DOM.find(g,'.fbModerationDropdownList');Event.listen(h,'click',this.exposeDropDownMenu.bind(this,h,i));Event.listen(i.parentNode,'mouseleave',this.concealDropDownMenu.bind(this,h,i));this.attachDropDownHandlers(d,this.commentIDs[a],i);}var j=this.commentInfoMap[this.commentIDs[a]].actor,k=!!this.recentlyBlacklistedActors[j];if(k){var l=DOM.scry(d,'.fbUndoBlacklistLink');if(l.length>0){var m=l[0];Event.listen(m,'click',this.toggleBlackListAndSync.bind(this,this.commentIDs[a]));}}}var n=DOM.scry(this.controlledRegion,'.fbReplyButton'),o=DOM.scry(this.controlledRegion,'.fbReplyAfterLoginButton');for(var p=0;p<n.length;p++)if(this.loggedIn){CSS.show(n[p]);CSS.hide(o[p]);}else{CSS.hide(n[p]);CSS.show(o[p]);}},closeStickyMenuFlyouts:function(a,event){Toggler.hide();for(var b=0;b<a.length;b++)a[b].blur();},attachDropDownHandlers:function(a,b,c){var d=DOM.scry(c,'.fbBanUser');if(d.length>0){var e=d[0],f=DOM.find(e,'^.fbFeedbackPost');if(startsWith(f.id,b))Event.listen(e,'click',this.toggleBlackListAndSync.bind(this,b));}},exposeDropDownMenu:function(a,b,event){if(CSS.shown(b))return this.concealDropDownMenu(a,b,event);Event.stop(event);CSS.show(b);b.focus();a.blur();return false;},concealDropDownMenu:function(a,b,event){Event.stop(event);CSS.removeClass(a,'fbUnderlineText');CSS.hide(b);a.blur();return false;},registerMoreCommentsLinkHandler:function(a){var b=a.pager_id;if(!ge(b))return;var c=$(b);Event.listen(c,'click',this.fetchMoreComments.bind(this,a,c));},deselectComments:function(a){for(var b=0;b<a.length;b++)delete this.selectedCommentsMap[a[b]];},registerModeratorQueueHandlers:function(a){if(a)this.selectedCommentsMap={};this.selectableComments=this.findSelectableComments();this.selectableCheckboxes=[];this.selectAllCheckBoxes=DOM.scry(this.controlledRegion,'.fbSelectAllCheckbox');this.approveButtons=DOM.scry(this.controlledRegion,'.fbApproveButton');this.removeButtons=DOM.scry(this.controlledRegion,'.fbRemoveButton');for(var b=0;b<this.selectableComments.length;b++){var c=this.selectableComments[b].id,d=!!this.selectedCommentsMap[c];this.setCommentSelection(this.selectableComments[b],d);var e=DOM.find(this.selectableComments[b],'.fbCommentCheckbox'),f=DOM.find(this.selectableComments[b],'.UIImageBlock_Content');Event.listen(e,'click',this.toggleCommentSelection.bind(this));Event.listen(this.selectableComments[b],'click',this.toggleCommentSelection.bind(this));e.checked=d;this.selectableCheckboxes.push(e);}for(var g=0;g<this.selectAllCheckBoxes.length;g++){this.selectAllCheckBoxes[g].checked=false;this.selectAllCheckBoxes[g].disabled=this.selectableComments.length===0;Event.listen(this.selectAllCheckBoxes[g],'click',this.toggleSelectAllCheckbox.bind(this,this.selectAllCheckBoxes[g]));}for(var h=0;h<this.approveButtons.length;h++)Event.listen(this.approveButtons[h],'click',this.setBulkPrivacy.bind(this,false));for(var i=0;i<this.removeButtons.length;i++)Event.listen(this.removeButtons[i],'click',this.setBulkPrivacy.bind(this,true));},findSelectableComments:function(){var a=DOM.scry(this.controlledRegion,'.fbTopLevelComment'),b=[];for(var c=0;c<a.length;c++)if((DOM.scry(a[c],'.fbCommentCheckbox').length===1)&&(DOM.scry(a[c],'.fbCommentOverlay').length===0))b.push(a[c]);return b;},toggleCommentSelection:function(event){var a={a:true},b=event.getTarget(),c=b.tagName.toLowerCase(),d=b.parentNode.tagName.toLowerCase();if(a[c]||a[d])return;var e=CSS.hasClass(b,'fbFeedbackPost')?b:DOM.find(b,'^.fbFeedbackPost'),f=this.commentIsSelected(e),g=!f;this.setCommentSelection(e,g);this.synchronizeModeratorQueueUI();if(CSS.hasClass(b,'fbCommentCheckbox'))Event.stop(event);},commentIsSelected:function(a){return CSS.hasClass(a,'fbCommentSelected');},setCommentSelection:function(a,b){if(b){this.selectComment(a);}else this.deselectComment(a);},selectComment:function(a){CSS.addClass(a,'fbCommentSelected');this.selectedCommentsMap[a.id]=true;DOM.find(a,'.fbCommentCheckbox').checked=true;},deselectComment:function(a){CSS.removeClass(a,'fbCommentSelected');delete this.selectedCommentsMap[a.id];DOM.find(a,'.fbCommentCheckbox').checked=false;},toggleSelectAllCheckbox:function(a,event){Event.stop(event);var b=a.checked;for(var c=0;c<this.selectableComments.length;c++){this.setCommentSelection(this.selectableComments[c],a.checked);this.selectableCheckboxes[c].checked=b;}this.synchronizeBulkModerationCheckboxes(b);this.synchronizeBulkModerationButtons(b);},synchronizeModeratorQueueUI:function(){var a=0;for(var b=0;b<this.selectableCheckboxes.length;b++)if(this.selectableCheckboxes[b].checked)a++;var c=this.selectableCheckboxes.length>0&&a==this.selectableCheckboxes.length;this.synchronizeBulkModerationCheckboxes(c);this.synchronizeBulkModerationButtons(a>0);},synchronizeBulkModerationCheckboxes:function(a){for(var b=0;b<this.selectAllCheckBoxes.length;b++)this.selectAllCheckBoxes[b].checked=a;},synchronizeBulkModerationButtons:function(a){for(var b=0;b<this.approveButtons.length;b++)Button.setEnabled(this.approveButtons[b],a);for(var c=0;c<this.removeButtons.length;c++)Button.setEnabled(this.removeButtons[c],a);},setBulkPrivacy:function(a,event){Event.stop(event);this.synchronizeBulkModerationButtons(false);selectedCommentIDs=[];for(var b in this.selectedCommentsMap)selectedCommentIDs.push(b);var c={is_private:a,in_moderation_queue:true,comment_ids:selectedCommentIDs,uniqids:selectedCommentIDs,controller_id:this.controllerID,owns_pages:this.userOwnsPages,in_aggregated_view:this.inAggregatedView,in_contextual_dialog:this.inContextualDialog};new AsyncRequest().setURI('/ajax/connect/comments/set_bulk_private.php').setData(c).send();return false;},toggleBlackListAndSync:function(a,event){Event.stop(event);var b=this.commentInfoMap[a].actor,c={blacklist:!this.blacklistedActors[b],in_moderation_queue:this.inModerationQueue,comment_id:a,other_comment_ids:this.getOtherCommentsByActor(b,a),uniqid:a,controller_id:this.controllerID,owns_pages:this.userOwnsPages,in_aggregated_view:this.inAggregatedView,in_contextual_dialog:this.inContextualDialog};new AsyncRequest().setURI('/ajax/connect/comments/set_blacklist.php').setData(c).setHandler(function(d){this.blacklistedActors[b]=!this.blacklistedActors[b];if(this.blacklistedActors[b]){this.recentlyBlacklistedActors[b]=true;}else delete this.recentlyBlacklistedActors[b];}.bind(this)).send();return false;},getOtherCommentsByActor:function(a,b){return this.actorToCommentInfoMap[a].filter(function(c){return c!=b;});},fetchMoreComments:function(a,b,event){Event.kill(event);CSS.addClass(b,'async_saving');var c={is_reply_thread:false,in_moderation_queue:false,view_as_moderator:false};copy_properties(c,a);c.recently_blacklisted=this.getRecentlyBlacklistedActors();c.offset=this.getVisibleCommentCount(c);if(!c.aggregate_view)delete c.aggregate_view;if(!c.comment_id)delete c.comment_id;if(!c.is_reply_thread)c.comment_ids=this.commentIDs;new AsyncRequest().setURI('/ajax/connect/feedback.php').setReadOnly(true).setData(c).send();},getVisibleCommentCount:function(a){var b=this.getCommentsSelector(a),c=DOM.scry($(a.controller_id),b),d=0;for(var e=0;e<c.length;e++)if(!CSS.hasClass(c[e],'fbCommentIgnored'))d++;return d;},getCommentsSelector:function(a){var b=a.is_reply_thread?'li.fbCommentReply':'li.fbTopLevelComment';if(a.controller_id!=a.uniqid)b='div[id="'+a.uniqid+'"] '+b;return b;},getRecentlyBlacklistedActors:function(){var a=[];for(var b in this.recentlyBlacklistedActors)a.push(b);return a;},attachContextualDialogHandlers:function(){this.documentClickListener=Event.listen(document.documentElement,'click',this.closeContextualDialog.bind(this));},closeContextualDialog:function(event){var a=event.getTarget(),b=Parent.byClass(a,'fbCommentContext');if(!b)this.destroyContextualDialog();},destroyContextualDialog:function(){this.documentClickListener.remove();delete this.documentClickListener;var a=this.controllerID;Feedback.closeContextualDialog(a);}});}
ConnectLogin={init:function(a){this.appID=a.appID;this.addToProfile=a.addToProfile;this.oneClick=a.oneClick;this.channelUrl=a.channelUrl;XD.init(a);},login:function(a,b,c){if(this.oneClick&&!b){this._oneClick(a);}else this._openPopup(a,b,c);},logout:function(){XD.send({type:'logout'});},_oneClick:function(a){new AsyncRequest().setURI('/ajax/api/tos.php').setData({app_id:this.appID,grant_perm:1}).setHandler(function(b){ConnectLogin._refreshLoginStatus();a&&a();}).send();},_openPopup:function(a,b,c){c=c||{};var d=WindowComm.makeHandler(function(h){ConnectLogin._closePopup();if(ConnectLogin.appID)ConnectLogin._refreshLoginStatus();a&&a();}),e=WindowComm.makeHandler(function(h){ConnectLogin._closePopup();}),f=new URI('/login.php');f.setQueryData({api_key:this.appID,next:d,channel_url:e,cancel_url:e,req_perms:b,v:'1.0',fbconnect:1,add_to_profile:this.addToProfile,display:'popup'});f.addQueryData(c);var g=this._getSize(c);this._popup=PopupResizer.open(f.toString(),g.height,g.width);},_closePopup:function(){if(this._popup){this._popup.close();this._popup=null;}},_refreshLoginStatus:function(){if(this.channelUrl){XD.send({type:'refreshLoginStatus'});}else window.location.reload();},_getSize:function(a){if(a.social_plugin=='registration'){return {width:640,height:370};}else return {width:610,height:280};}};
add_properties('Feedback',{registerComment:function(a,b){Feedback.comments[a]=b;return Feedback;},getRegisteredComment:function(a){return Feedback.comments[a];},deleteClickHandler:function(a,b,c,d,e){var f=new Dialog().setTitle("Delete Post").setBody("Are you sure you want to delete this post?").setButtons([Dialog.newButton('delete',"Delete"),Dialog.CANCEL]).setHandler(function(event){new AsyncRequest().setURI('/ajax/connect/feedback.php').setData({command:'delete',url:a,uniqid:d,owns_pages:e,controller_id:c,comment_id:b}).send();}.bind(this)).show();},resizeCommentas:function(a){var b=DOM.scry(a,'div.post')[0];if(b){var c=Vector2.getElementDimensions(b).x;if(c){var d=DOM.find(b,'.commentas'),e=Vector2.getElementDimensions(d).x;if((c-e)<190&&(c-190)>60){CSS.setStyle(d,'width',c-190+'px');var f=DOM.scry(d,'span.commentas_inner')[0];if(f){var g=Vector2.getElementDimensions(f).x;CSS.setStyle(d,'width',g+'px');}}}}},exposeContextualDialogReply:function(a){var b=$(a),c=b.parentNode.parentNode;CSS.show(DOM.find(c,"form"));DOM.find(c,"textarea").focus();return false;},concealContextualDialogReply:function(a){var b=$(a),c=b.parentNode.parentNode,d=DOM.find(c,"form"),e=DOM.find(c,"textarea"),f=e.value.length;if(!Input.getValue(e))CSS.hide(d);return false;},closeContextualDialog:function(a){var b=ContextualDialogX.getInstance($(a));b.hide();return false;},_clickLocked:false,attachOptInClickListener:function(a){Event.listen(a,'click',function(b){Event.kill(b);if(!this._clickLocked){this._clickLocked=true;setTimeout(function(){this._clickLocked=false;}.bind(this),1000);PlatformOptInPopup.open('feedback','opt.in');}});},attachReplyListener:function(a){var b=DOM.find(a,'textarea');a.suppressBlur=false;Event.listen(a,'click',function(c){var d=c.getTarget(),e=Parent.byClass(d,'commentas')!==null,f=Parent.byClass(d,'uiButton')!==null,g=Parent.byClass(d,'uiSelector')!==null;a.suppressBlur=e||f||g;});Event.listen(b,'blur',function(c,d){if(a.interval)return;a.interval=setInterval((function(e,f){if(e.suppressBlur||Input.getValue(f)||f==document.activeElement)return;CSS.hide(e);e.suppressBlur=false;clearInterval(e.interval);delete e.interval;}).curry(a,c),100);}.curry(b));},attachReplyClickListener:function(a,b,c){var d=DOM.find(a,'textarea');Event.listen(b,'click',function(e){CSS.show(a);d.focus();if(!c.isViewer&&c.isReply){var f=MentionsInput.getInstance(d);if(f){var g=f.getMentions();if(!g[c.uid]&&Input.getValue(d)===''){f.addMention(c);Input.setValue(d,Input.getValue(d)+' ');}}else Input.setValue(d,c.text+' ');}e.preventDefault();});},resetInput:function(a){var b=MentionsInput.getInstance(a);if(b){b.reset({flattened:'',mention_data:{}});}else Input.setValue(a,'');}});if(!window.Feedback.comments)window.Feedback.comments={};
var PlatformOptInPopup=function(){};copy_properties(PlatformOptInPopup,{DIALOG_URL:'/connect/uiserver.php',DIALOG_WIDTH:420,DIALOG_HEIGHT:450,APP_ID:127760087237610,open:function(a,b,c){if(!a)a='generic';if(!b)b='opt.in';var d=new URI(PlatformOptInPopup.DIALOG_URL);d.addQueryData({social_plugin:a,method:b,display:'popup',secure:URI.getRequestURI().isSecure(),app_id:PlatformOptInPopup.APP_ID});if(c)d.addQueryData(c);return PopupResizer.open(d.toString(),PlatformOptInPopup.DIALOG_WIDTH,PlatformOptInPopup.DIALOG_HEIGHT);}});
function ConnectSocialWidget(a,b){ConnectSocialWidget.setInstance(b,this);ConnectSocialWidget.delayUntilDisplayed(function(){this.initializeObject.call(this,a,b);}.bind(this));}copy_properties(ConnectSocialWidget,{OPT_IN_FACEBOOK_APP_ID:'127760087237610',TYPE_ACTIVITY:'A',TYPE_RECOMMENDATIONS:'R',TYPE_LIKEBOX:'L',instances:{},setInstance:function(a,b){ConnectSocialWidget.instances[a]=b;},getInstance:function(a){return ConnectSocialWidget.instances[a];},popups:{},login:function(a,b){ConnectSocialWidget.popups[b]={popup:PlatformOptInPopup.open('login','opt.in')};},aDelayedFunctions:[],delayUntilDisplayed:function(a){ConnectSocialWidget.aDelayedFunctions.push(a);if(ConnectSocialWidget.aDelayedFunctions.length===1){if(!ConnectSocialWidget.ndTestDim){var b=document.createElement('div'),c={position:'absolute',width:'1px',height:'1px',overflow:'hidden',top:'0px'};for(var d in c)if(typeof c[d]==='string')CSS.setStyle(b,d,c[d]);document.body.appendChild(b);ConnectSocialWidget.ndTestDim=b;}ConnectSocialWidget.testForDisplay();}},testForDisplay:function(){var a=Vector2.getElementDimensions(ConnectSocialWidget.ndTestDim).y;if(a!==0){ConnectSocialWidget.aDelayedFunctions.forEach(function(b){b();});ConnectSocialWidget.aDelayedFunctions=[];}else ConnectSocialWidget.testForDisplay.defer(100);},listenForLogin:function(){if(!ConnectSocialWidget.listenerAttached){Arbiter.subscribe('platform/socialplugins/login',function(a){if(a.user!==Env.user)document.location.reload();});ConnectSocialWidget.listenerAttached=true;}}});copy_properties(ConnectSocialWidget.prototype,{initializeObject:function(a,b){var c=DOM.scry(document.body,a.sOverflowContainerSelector)[0],d=DOM.scry(c,'.fbConnectWidgetFooter')[0],e=d?Vector2.getElementDimensions(d).y:0,f=a.sOverflowItemsSelector,g=DOM.scry(document.body,a.sStreamContainerSelector)[0];this.fRemoveOverflowElements=this.removeOverflowElements.bind(this,c,g,f,-e);copy_properties(this,{bInitialized:true,sWidgetId:b,iFooterHeight:e,ndTop:c,ndFooter:d,ndContentContainer:g,oQueryParams:new URI(window.location.href).getQueryData(),bComboMode:a.bComboMode,sOverflowItemsSelector:f});this.oQueryParams.user=Env.user;this.fRemoveOverflowElements();CSS.setStyle(g,'visibility','visible');animation(g).from('opacity',0).to('opacity',1).duration(200).go();ConnectSocialWidget.listenForLogin();},getElementTop:function(a){var b=DOM.scry(a,'^'+this.sOverflowItemsSelector);return b[0];},getItemPosition:function(a){var b=DOM.scry(this.ndContentContainer,this.sOverflowItemsSelector),c=b.length,d=b.indexOf(a)+1;return d+'/'+c;},removeOverflowElements:function(a,b,c,d,e){var f,g=c?DOM.scry(b,c):$A(b.childNodes);if(!e){var d=d||0,h=Vector2.getElementDimensions(a).y+d,i=Vector2.getElementPosition(a).y;e=h+i;}while(g.length>0&&(f=$(g.pop()))&&(Vector2.getElementDimensions(f).y+Vector2.getElementPosition(f).y)>e)DOM.remove(f);},login:function(){ConnectSocialWidget.login(this.appID,this.sWidgetId);},toggleLogin:function(){DOM.scry(this.ndTop,'.fbToggleLogin').forEach(function(a){CSS.toggle(a);});this.fRemoveOverflowElements();}});function ActivityWidget(a,b){this.parent.construct(this,a,b);}Class.extend(ActivityWidget,'ConnectSocialWidget');ActivityWidget.REQUEST_INTERVAL=15*1000;ActivityWidget.ACTIVITY_HEIGHT=45;ActivityWidget.MAX_INTERVAL=30;ActivityWidget.MAX_ITEMS=24;copy_properties(ActivityWidget.prototype,{initializeObject:function(a,b){this.parent.initializeObject.call(this,a,b);this.oQueryParams.nb_activities=Math.min(ActivityWidget.MAX_ITEMS,Math.round((this.oQueryParams.height||300)/ActivityWidget.ACTIVITY_HEIGHT));this.oQueryParams.newest=a.iNewestStoryTime||0;},removeOverflowElements:function(){if(this.bComboMode&&!this.bFirstRound){this.bFirstRound=true;var a=Vector2.getElementPosition(this.ndTop).y,b=Vector2.getElementDimensions(document.body).y-(a+this.iFooterHeight),c=Math.round(b/2),d=$A(arguments);d[d.length]=c;ConnectSocialWidget.prototype.removeOverflowElements.apply(this,d);}else ConnectSocialWidget.prototype.removeOverflowElements.apply(this,arguments);},hasFriendsActivity:function(){return DOM.scry(this.ndContentContainer,'div.fbFriendsActivity')[0].childNodes.length>0;},hasContent:function(){return DOM.scry(this.ndTop,this.sOverflowItemsSelector).length>0;},getEmptyMessage:function(){return DOM.find(this.ndContentContainer,'div.fbEmptyWidget');},showEmptyMessage:function(){var a=this.getEmptyMessage();if(a)CSS.show(a);}});function RecommendationsWidget(a,b){this.parent.construct(this,a,b);}Class.extend(RecommendationsWidget,'ConnectSocialWidget');copy_properties(RecommendationsWidget.prototype,{initializeObject:function(a,b){this.parent.initializeObject.call(this,a,b);this.sActivityParent=a.sActivityParent;this.cropImages(DOM.scry(this.ndContentContainer,".fbImageContainer img"),RecommendationsWidget.IMAGE_HEIGHT,true);this.cropImages(DOM.scry(this.ndContentContainer,"img.fbGalleryImage"),RecommendationsWidget.GALLERY_IMAGE_HEIGHT,false);},cropImages:function(a,b,c){if(a.length>0){var d=function(event){RecommendationsWidget.image_resize({image:event.getTarget(),dimension:b,centerimage:c});};a.forEach(function(e){if(e.complete){RecommendationsWidget.image_resize({image:e,dimension:b,centerimage:c});}else Event.listen(e,'load',d);});}},hasContent:function(){return this.ndContentContainer.childNodes.length>0;},getParent:function(){if(this.sActivityParent)return ConnectSocialWidget.getInstance(this.sActivityParent);},showRecommendationsSeparator:function(){var a=this.getParent();if(a&&a.hasContent()){var b=DOM.scry(this.ndTop,'div.fbRecommendationsSeparator')[0];CSS.show(b);CSS.setStyle(b,'visibility','visible');}return this;},removeOverflowElements:function(){ConnectSocialWidget.prototype.removeOverflowElements.apply(this,arguments);if(this.sActivityParent&&!this.hasContent()){var a=DOM.scry(this.ndTop,'div.fbRecommendationsSeparator')[0];CSS.hide(a);}}});RecommendationsWidget.IMAGE_HEIGHT=35;RecommendationsWidget.GALLERY_IMAGE_HEIGHT=105;function LikeBoxWidget(a,b){this.parent.construct(this,a,b);}Class.extend(LikeBoxWidget,'ConnectSocialWidget');copy_properties(LikeBoxWidget.prototype,{});RecommendationsWidget.image_resize=function(a){var b=a.image,c=Vector2.getElementDimensions(b),d=c.y,e=c.x,f=a.dimension,g=f+'px',h=a.centerimage;if(d<=5||e<=5)return;var i=d/e;if(i<.5||i>2)return;if(d===e){CSS.setStyle(b,'width',g);}else if(d<e){var j=f/d,k=-Math.round((e-d)*j/2);CSS.setStyle(b,'height',g);h&&CSS.setStyle(b,'marginLeft',k+'px');}else{var j=f/e,l=-Math.round((d-e)*j/2);CSS.setStyle(b,'width',g);h&&CSS.setStyle(b,'marginTop',l+'px');}CSS.setStyle(b,'visibility','visible');CSS.setStyle(b.parentNode,'background','transparent');var m=Parent.byClass(b,'fbRecommendation');if(m)CSS.removeClass(m,'invisible_elem');};
__d("PopupWindow",["DOMDimensions","DOMQuery","UserAgent","copyProperties"],function(a,b,c,d,e,f){var g=b('DOMDimensions'),h=b('DOMQuery'),i=b('UserAgent'),j=b('copyProperties'),k={_opts:{allowShrink:true,strategy:'vector',timeout:100,widthElement:null},init:function(l){j(k._opts,l);setInterval(k._resizeCheck,k._opts.timeout);},_resizeCheck:function(){var l=g.getViewportDimensions(),m=k._getDocumentSize(),n=m.height-l.height,o=m.width-l.width;if(o<0&&!k._opts.widthElement)o=0;o=o>1?o:0;if(!k._opts.allowShrink&&n<0)n=0;if(n||o)try{window.console&&window.console.firebug;window.resizeBy(o,n);if(o)window.moveBy(o/-2,0);}catch(p){}},_getDocumentSize:function(){var l=g.getDocumentDimensions();if(k._opts.strategy==='offsetHeight')l.height=document.body.offsetHeight;if(k._opts.widthElement){var m=h.scry(document.body,k._opts.widthElement)[0];if(m)l.width=g.getElementDimensions(m).width;}if(window.Dialog&&Dialog.max_bottom&&Dialog.max_bottom>l.height)l.height=Dialog.max_bottom;return l;},open:function(l,m,n){var o=typeof window.screenX!='undefined'?window.screenX:window.screenLeft,p=typeof window.screenY!='undefined'?window.screenY:window.screenTop,q=typeof window.outerWidth!='undefined'?window.outerWidth:document.body.clientWidth,r=typeof window.outerHeight!='undefined'?window.outerHeight:(document.body.clientHeight-22),s=parseInt(o+((q-n)/2),10),t=parseInt(p+((r-m)/2.5),10),u=('width='+n+',height='+m+',left='+s+',top='+t);return window.open(l,'_blank',u);}};e.exports=k;});
__d("legacy:popup-resizer",["PopupWindow"],function(a,b,c,d){a.PopupResizer=b('PopupWindow');},3);
WidgetArbiter={_findSiblings:function(){if(WidgetArbiter._siblings)return;WidgetArbiter._siblings=[];for(var a=parent.frames.length-1;a>=0;a--)try{if(parent.frames[a]&&parent.frames[a].Arbiter&&parent.frames[a].Arbiter.inform)WidgetArbiter._siblings.push(parent.frames[a].Arbiter);}catch(b){}},inform:function(){WidgetArbiter._findSiblings();var a=$A(arguments);WidgetArbiter._siblings.forEach(function(b){b.inform.apply(b,a);});}};
WindowComm={_callbacks:{},makeHandler:function(a,b){b=b||'opener';var c='f'+(Math.random()*(1<<30)).toString(16).replace('.','');WindowComm._callbacks[c]=a;return new URI('/connect/window_comm.php').setQueryData({_id:c,_relation:b}).getQualifiedURI().toString();},_recv:function(a){var b=new URI(a).getQueryData();WindowComm._callbacks[b._id](b);}};
__d("DOMEvent",["copyProperties"],function(a,b,c,d,e,f){var g=b('copyProperties');function h(i){this.event=i||window.event;this.target=this.event.target||this.event.srcElement;}g(h.prototype,{preventDefault:function(){var i=this.event;i.preventDefault?i.preventDefault():i.returnValue=false;return this;},stopPropagation:function(){var i=this.event;i.stopPropagation?i.stopPropagation():i.cancelBubble=true;return this;},kill:function(){this.stopPropagation().preventDefault();return this;}});e.exports=h;});
__d("DOMEventListener",[],function(a,b,c,d,e,f){var g,h;if(window.addEventListener){g=function(j,k,l){j.addEventListener(k,l,false);};h=function(j,k,l){j.removeEventListener(k,l,false);};}else if(window.attachEvent){g=function(j,k,l){j.attachEvent('on'+k,l);};h=function(j,k,l){j.detachEvent('on'+k,l);};}var i={add:function(j,k,l){g(j,k,l);return {remove:function(){h(j,k,l);j=null;}};},remove:h};e.exports=i;});
__d("UnverifiedXD",["XD","XDUnverifiedChannel"],function(a,b,c,d,e,f){var g=b('XD').UnverifiedXD,h=c('XDUnverifiedChannel').channel;g.init({channelUrl:h});e.exports=g;});
__d("PluginResize",["Log","UnverifiedXD","bind","copyProperties","curry"],function(a,b,c,d,e,f){var g=b('Log'),h=b('UnverifiedXD'),i=b('bind'),j=b('copyProperties'),k=b('curry');function l(o){o=o||document.body;return o.offsetWidth+o.offsetLeft;}function m(o){o=o||document.body;return o.offsetHeight+o.offsetTop;}function n(o,p,event){this.calcWidth=o||l;this.calcHeight=p||m;this.width=undefined;this.height=undefined;this.event=event||'resize';}j(n.prototype,{resize:function(){var o=this.calcWidth(),p=this.calcHeight();if(o!==this.width||p!==this.height){g.debug('Resizing Plugin: (%s, %s)',o,p);this.width=o;this.height=p;h.send({type:this.event,width:o,height:p});}return this;},auto:function(o){setInterval(i(this,this.resize),o||250);return this;}});n.auto=function(o,p,event){return new n(k(l,o),k(m,o),event).resize().auto(p);};e.exports=n;});
__d("PluginLoginButton",["DOMEventListener","DOMQuery","PluginResize","UserAgent","curry"],function(a,b,c,d,e,f){var g=b('DOMEventListener'),h=b('DOMQuery'),i=b('PluginResize'),j=b('UserAgent'),k=b('curry'),l={redirect:function(m){window.parent.location.replace(m);},submit:function(m){m.submit();},registration:function(m,n){g.add(m,'click',k(l.redirect,n));},connect:function(m,n){g.add(m,'click',k(l.submit,n));},resize:function(m){var n=j.firefox()||j.ie()>=9?1:0;new i(function(){return m.offsetWidth+n;}).resize().auto();}};e.exports=l;});
__d("PluginOptin",["DOMEvent","DOMEventListener","PopupWindow","URI","bind","copyProperties"],function(a,b,c,d,e,f){var g=b('DOMEvent'),h=b('DOMEventListener'),i=b('PopupWindow'),j=b('URI'),k=b('bind'),l=b('copyProperties');function m(n){l(this,{return_params:j.getRequestURI().getQueryData(),login_params:{},optin_params:{},plugin:n});this.addReturnParams({ret:'optin'});delete this.return_params.hash;}l(m.prototype,{addReturnParams:function(n){l(this.return_params,n);return this;},addLoginParams:function(n){l(this.login_params,n);return this;},addOptinParams:function(n){l(this.optin_params,n);return this;},start:function(){var n=new j('/dialog/optin').addQueryData(this.optin_params).addQueryData({display:'popup',app_id:127760087237610,secure:j.getRequestURI().isSecure(),social_plugin:this.plugin,return_params:JSON.stringify(this.return_params),login_params:JSON.stringify(this.login_params)});this.popup=i.open(n.toString(),420,450);return this;}});m.starter=function(n,o,p,q){var r=new m(n);r.addReturnParams(o||{});r.addLoginParams(p||{});r.addOptinParams(q||{});return k(r,r.start);};m.listen=function(n,o,p,q,r){h.add(n,'click',function(s){new g(s).kill();m.starter(o,p,q,r)();});};e.exports=m;});
__d("PluginPerms",["DOMEvent","DOMEventListener","PopupWindow","URI","bind","copyProperties"],function(a,b,c,d,e,f){var g=b('DOMEvent'),h=b('DOMEventListener'),i=b('PopupWindow'),j=b('URI'),k=b('bind'),l=b('copyProperties');function m(n,o){l(this,{return_params:j.getRequestURI().getQueryData(),login_params:{},perms_params:{},perms:[],plugin:n,app:o});this.addReturnParams({ret:'perms'});delete this.return_params.hash;}l(m.prototype,{addReturnParams:function(n){l(this.return_params,n);},addLoginParams:function(n){l(this.login_params,n);},addPermsParams:function(n){l(this.perms_params,n);},addPerms:function(n){this.perms.push.apply(this.perms,n);},start:function(){var n=j('/dialog/plugin.perms').addQueryData(this.perms_params).addQueryData({display:'popup',app_id:this.app,perms:this.perms.join(','),secure:j.getRequestURI().isSecure(),social_plugin:this.plugin,return_params:JSON.stringify(this.return_params),login_params:JSON.stringify(this.login_params)});this.popup=i.open(n.toString(),210,450);}});m.starter=function(n,o,p,q,r,s){var t=new m(n,o);t.addReturnParams(q||{});t.addLoginParams(r||{});t.addPermsParams(s||{});t.addPerms(p||[]);return k(t,t.start);};m.listen=function(n,o,p,q,r,s,t){h.add(n,'click',function(u){new g(u).kill();m.starter(o,p,q,r,s,t)();});};e.exports=m;});
__d("PluginSend",["Arbiter","CSS","DOMDimensions","DOMPosition","DOMQuery","PluginOptin","UnverifiedXD","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DOMDimensions'),j=b('DOMPosition'),k=b('DOMQuery'),l=b('PluginOptin'),m=b('UnverifiedXD'),n=b('copyProperties'),o='platform/socialplugins/dialog',p='platform/socialplugins/send/sent',q='platform/socialplugins/send/cancel',r=false,s=false,t={type:'presentEdgeCommentDialog',controllerID:'',widget_type:'send',nodeURL:'',width:400,height:300,query:{}},u={close:'dismissEdgeCommentDialog',show:'showEdgeCommentDialog',hide:'hideEdgeCommentDialog'},v={element:null,href:'',canpersonalize:false},w,x,y='';function z(){new l("send").addReturnParams({act:"send"}).start();}function aa(da){if(!v.canpersonalize)return z();if(typeof da!=='string')if(!r){da='open';}else if(s){da='hide';}else da='show';switch(da){case 'open':g.inform(o,{controllerID:y,event:da});r=s=true;var ea=i.getElementDimensions(x),fa=j.getElementPosition(x);t.anchorGeometry={x:ea.width,y:ea.height};t.anchorPosition={x:fa.x,y:fa.y};var ga=ba();t.query.anchorTargetX=ga.x;t.query.anchorTargetY=ga.y;m.send(t);break;case 'close':g.inform(o,{controllerID:y,event:da});r=s=false;break;case 'show':s=true;break;default:s=false;break;}h[s?'show':'hide'](w);h[s?'hide':'show'](x);if(da!=='open')m.send({type:u[da]});}function ba(){var da=k.find(x,'.pluginButtonIcon'),ea=j.getElementPosition(da),fa=i.getElementDimensions(da);return {y:ea.y+fa.width/2,x:ea.x+fa.height/2};}var ca={init:function(da){n(v,da);y=t.controllerID=v.element.id;t.nodeURL=v.href;w=k.find(v.element,'.pluginSendActive');x=k.find(v.element,'.pluginSendInactive');v.element.onclick=aa;g.subscribe(q,function(ea,fa){if(fa.controllerID===y)aa('hide');},g.SUBSCRIBE_NEW);g.subscribe(p,function(ea,fa){if(fa.controllerID===y)aa('close');},g.SUBSCRIBE_NEW);if(da.autosubmit)aa('open');}};a.Arbiter=g;e.exports=ca;});
__d("PluginXDReady",["Arbiter","DOMEventListener","UnverifiedXD"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('DOMEventListener'),i=b('UnverifiedXD'),j={handleMessage:function(k){if(!k.method)return;var l={e:g.BEHAVIOR_EVENT,p:g.BEHAVIOR_PERSISTENT,s:g.BEHAVIOR_STATE}[k.behavior]||g.BEHAVIOR_PERSISTENT;try{g.inform('Connect.Unsafe.'+k.method,JSON.parse(k.params),l);}catch(m){}}};if(window.postMessage)h.add(window,'message',function(k){var event=JSON.parse(k.data);j.handleMessage({method:event.method,params:JSON.stringify(event.params||{}),behavior:event.behavior});});a.XdArbiter=j;i.send({xd_action:'plugin_ready',name:window.name});e.exports=null;});
FBCommentServer={serverStarted:true,init:function(a){CSS.setClass($(a.commentsID).parentNode,'mu-connect-disable-logout');this._notifyAddComment=a.notify;ConnectLogin.init(a);XD.init({channelUrl:a.channelUrl,hideOverflow:true,autoResize:true});},showConnect:function(){ConnectLogin.login();},setupConnect:function(a,b){if(Env.user&&Env.user!="0"){a.defer();}else b.defer();},addComment:function(a){if(this._notifyAddComment)XD.send({type:'addComment',comments:a});}};