(function(){var userAgent=navigator.userAgent.toLowerCase(),domain=document.domain,test=false,bcpDomain='',autoFire=false,loaded=false,async_props={async:false,asyncBehaviors:{},asyncOpportunityIds:[],asyncOpportunities:[]},behaviors={},urls={},sep="/",version="4",delim="|",bcpd_callback=null,pv="pv=y",dobcp=false,placementOpps={p:[],pt:[]};var client=312; ;var browser={version:(userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(userAgent),opera:/opera/.test(userAgent),msie:/msie/.test(userAgent)&&!/opera/.test(userAgent),mozilla:/mozilla/.test(userAgent)&&!/(compatible|webkit)/.test(userAgent)};var addEvent=(function(){if(document.addEventListener){return function(obj,sEvent,func){obj.addEventListener(sEvent,func,false);return true}}else{if(document.attachEvent){return function(obj,sEvent,func){obj.attachEvent("on"+sEvent,func);return true}}else{return function(obj,sEvent,func){return false}}}})();if(!client)return false;var ns,running=document.getElementById('LOTCC_'+client);if(running){var qs=parseQuery(running.src.replace(/^[^\?]+\??/,''));ns=qs['ns']||('LOTCC_'+client);autoFire=!!(qs['autobcp']||false);delete qs['ns'];delete qs['autobcp'];for(var type in qs){if(isArray(qs[type])){for(var i=0,beh;beh=qs[type][i++];){add(type,beh)}}}}else{ns=('LOTCC_'+client);}if(!(ns in window))window[ns]={};for(prop in async_props){if(prop in window[ns]){async_props[prop]=window[ns][prop]}else if(('LOTCC'in window)&&(typeof LOTCC==='object')&&(prop in LOTCC)){async_props[prop]=LOTCC[prop]}}window[ns].enableDiv=function(){};window[ns].enableNamedDiv=function(){};window[ns].fillDiv=function(){};window[ns].add=add;window[ns].addBehavior=addBehavior;window[ns].addInterest=addInterest;window[ns].addAction=addAction;window[ns].addMedia=addMedia;window[ns].bcp=bcp;window[ns].bcpd=bcpd;window[ns].bcpw=bcpw;window[ns].bcpdpv=bcpdpv;window[ns].pvdone=false;LOTCC=window[ns];addEvent(window,"load",doneload);addEvent(window,"load",loadAsync);if(autoFire){bcp()}function flash(msg){if(div=document.getElementById('LOTCC.status'))div.innerHTML=msg}function isArray(v){return v&&typeof v==='object'&&typeof v.length==='number'&&!(v.propertyIsEnumerable('length'))}function add(name,id){if(behaviors[name]==null){behaviors[name]=new Array()}var entry=behaviors[name];var encodedId=encodeURIComponent(id);entry[entry.length]=encodedId.replace(/%2F/g,"/")}function addBehavior(id){add("b",id)}function addAction(id){add("act",id)}function addInterest(id){add("int",id)}function addMedia(id){add("med",id)}function addMemberId(id){}function addContentId(id){}function addOpportunityId(id){placementOpps.p.push(id)}function addOpportunity(tag){placementOpps.pt.push(tag)}function appendInternal(url,vals,vr){if((typeof(vals)!="undefined")&&(vals.length>0)){var vn=delim+vr+"=";for(var i=0;i<vals.length;i++){url+=vn+vals[i]}}return url}function append(url,val,vr){if((typeof(val)!="undefined")&&(val.length>0)){var vals;if(isArray(val)){vals=val}else{vals=val.split(",")}var vn=delim+vr+"=";for(var i=0;i<vals.length;i++){url+=vn+vals[i]}}return url}function appendAll(url){for(var type in behaviors){url=appendInternal(url,behaviors[type],type)}for(var pl_type in placementOpps){url=appendInternal(url,placementOpps[pl_type],pl_type)}if(placementOpps.p.length>0||placementOpps.pt.length>0){url=appendInternal(url,'y','dp')}if(async_props.async){url=appendInternal(url,'y','async')}return url}function baseURL(is_pv){is_pv=!window[ns].pvdone;var min=100000000;var max=999999999;var randomnumber=Math.floor(min+(max-min)*Math.random());var prefix=((document.location.protocol=='https:')?'https:':'http:')+'//';var url=prefix+getDomain()+"/"+version+sep+"c="+client+delim+"rand="+randomnumber;if(is_pv){url+=delim+pv}if(typeof(group)!="undefined"){url+=delim+"brg="+group}return url}function getDomain(){return(test)?'bcp.test.lotame.com':'bcp.crwdcntrl.net'}function bcp(){if(client=="15"||/fotolog/i.test(domain)){var foundUS=false;var ints=behaviors["int"]||[];for(var i=0;i<ints.length;i++){if(decodeURIComponent(ints[i]).toLowerCase()=="country:us"||decodeURIComponent(ints[i]).toLowerCase()=="country:ca"){foundUS=true}}if(!foundUS){return}}bcpinternal()}function bcpinternal(){(loaded)?firebcp():dobcp=true}function bcpdpv(){var pvbak=window[ns].pvdone;window[ns].pvdone=true;bcpd();window[ns].pvdone=pvbak}function bcpd(cb){var url=appendAll(baseURL(false));pixel(url,cb)}function bcpw(){var len=arguments.length;if(len>0){for(var i=0;i<len;i+=2){if(i+1<len){add(arguments[i],arguments[i+1])}}}bcpd()}function pixel(url,cb){var pi=new Image();pi.onload=img_done;pi.onerror=img_done;pi.onabort=img_done;bcpd_callback=cb;reset(url);pi.src=url}function img_done(url){if(bcpd_callback)bcpd_callback()}function reset(url){behaviors={};if(typeof(lotbcp)!="undefined")lotbcp="";if(typeof(lotact)!="undefined")lotact="";if(typeof(lotint)!="undefined")lotint="";if(typeof(lotmed)!="undefined")lotmed="";if(url&&url.indexOf(pv)>0){window[ns].pvdone=true}}function firebcp(){ addPlacementRule({element: "#xrailHome300x250_frame", placement_id: 3624}); addPlacementRule({element: "#header728x90_frame", placement_id: 3625}); addPlacementRule({element: "#xrailTop300x250_frame", placement_id: 3626}); addPlacementRule({element: "#xrailBottom300x250_frame", placement_id: 3627}); addPlacementRule({element: "#bottom728x90_frame", placement_id: 3628}); addTrigger({act: ["Click on Facebook Link"], location: "([a-zA-Z0-9_+%-]+)", element: "{{a[href*=facebook]}}", event: "click", opr: 7648}); addTrigger({act: ["Rate Video"], location: "www\.wired\.com/video/", element: "{{#rating_one}}", event: "click", opr: 10490}); addTrigger({act: ["Share Video"], location: "www\.wired\.com/video/([a-zA-Z0-9_+%-]+)", element: "{{div.bc_share a}}", event: "click", opr: 10491}); addTrigger({act: ["Comment on Video"], location: "www\.wired\.com/video/", element: "{{#postComment}}", event: "click", opr: 10492}); addTrigger({act: ["Edit Wiki"], location: "howto\.wired\.com/wiki/([a-zA-Z0-9_+%-]+)action\=edit", element: "{{#editform}}", event: "submit", opr: 10494}); addTrigger({act: ["Create Wiki Subject"], location: "howto\.wired\.com/wiki/Create\_An\_Article", element: "{{form.createboxForm}}", event: "submit", opr: 10495}); addTrigger({act: ["Like Article on Facebook"], location: "www\.wired\.com/([a-zA-Z0-9_+%-]+)", element: "{{a.connect_widget_like_button}}", event: "click", opr: 10496}); addTrigger({act: ["Subscribe to Magazine"], location: "www\.wired\.com/([a-zA-Z0-9_+%-]+)", element: "{{#global_navBar a}}", event: "click", opr: 10499}); addTrigger({act: ["Share Article on Twitter"], location: "www\.wired\.com/([a-zA-Z0-9_+%-]+)", element: "{{span.tb button}}", event: "click", opr: 10608}); addTrigger({act: ["Submit Comment"], location: "www\.wired\.com/([a-zA-Z0-9_+%-]+)", element: "{{#comment_form}}", event: "submit", opr: 10609}); addTrigger({act: ["Share Content on Twitter"], location: "www\.wired\.com", element: "{{div.tweetmeme_button}}", event: "click", opr: 11133}); addTrigger({act: ["Share Content on Digg"], location: "www\.wired\.com", element: "{{#sb_art_diggit_}}", event: "click", opr: 11134}); addTrigger({act: ["Share Content on Yahoo Buzz"], location: "www\.wired\.com", element: "{{#sb_art_yahoo}}", event: "click", opr: 11135}); addTrigger({act: ["Share Content on StumbleUpon"], location: "www\.wired\.com", element: "{{#sb_art_stumble}}", event: "click", opr: 11136}); addTrigger({act: ["Share Content on ShareThis"], location: "www\.wired\.com", element: "{{#sb_art_sharethis}}", event: "click", opr: 11137}); addTrigger({act: ["Like Content on Facebook"], location: "www\.wired\.com", element: "{{#sb_facebook_like iframe}}", event: "click", opr: 11138}); addTrigger({act: ["Share Content on Twitter"], location: "www\.wired\.com", element: "{{#tweetmeme}}", event: "click", opr: 11139}); addTrigger({act: ["Rate Content"], location: "www\.wired\.com", element: "{{#dsq-like-thread-button}}", event: "click", opr: 11140}); addTrigger({act: ["Submit Comment"], location: "www\.wired\.com", element: "{{#dsq-post-button}}", event: "click", opr: 11141}); addTrigger({act: ["Rate Comment"], location: "www\.wired\.com", element: "{{span[id^=\"dsq-like-\"]}}", event: "click", opr: 11142}); addTrigger({act: ["Reply to Comment"], location: "www\.wired\.com", element: "{{span[id^=\"dsq-comment-footer-reply-\"]}}", event: "click", opr: 11143}); addTrigger({act: ["Share HowTo Article"], location: "howto\.wired\.com/", element: "{{div.social}}", event: "click", opr: 11154}); addTrigger({act: ["Share Content General"], location: "www\.wired\.com/", element: "{{div.social}}", event: "click", opr: 11155}); addTrigger({act: ["Share Content on Digg"], location: "www\.wired\.com/", element: "{{#sb_digg}}", event: "click", opr: 11156}); addTrigger({act: ["Share Content on Yahoo Buzz"], location: "www\.wired\.com/", element: "{{#sb_yahoo span a}}", event: "click", opr: 11157}); addTrigger({act: ["Share Content on StumbleUpon"], location: "www\.wired\.com/", element: "{{#sb_stumble}}", event: "click", opr: 11158}); addTrigger({act: ["Share Content on Delicious"], location: "www\.wired\.com/", element: "{{#sb_delicious}}", event: "click", opr: 11159}); addTrigger({act: ["Share Content on Reddit"], location: "www\.wired\.com/", element: "{{#sb_reddit}}", event: "click", opr: 11160}); addTrigger({act: ["Download Ipad Magazine App"], location: "www\.wired\.com/magazine/ipad", element: "{{div.entry map}}", event: "click", opr: 11161}); addTrigger({act: ["Generic312"], location: "www\.wired\.com", element: "{{div.advertisement}}", event: "click", opr: 11451}); addTrigger({act: ["Click on Youtube Link"], location: "([a-zA-Z0-9_+%-]+)", element: "{{a[href*=youtube]}}", event: "click", opr: 12263}); addTrigger({act: ["Create New Wiki Article"], location: "howto\.wired\.com/wiki/Create\_An\_Article", element: "{{input.createboxButton}}", event: "click", opr: 12638}); addTrigger({act: ["Sign Up For Newsletter : Wired"], location: "wired\.com/services/newsletters/demographics", element: "{{form #submit}}", event: "click", opr: 20010}); addTrigger({int: ["Video: {{div.bc_titleText}}.textContent : {{div.titleInfo h1}}.textContent"], location: "www\.wired\.com/video/([a-zA-Z0-9_+%-]+)", element: "{{div.titleInfo}}", opr: 10500}); addTrigger({int: ["Blog : $1"], location: "www\.wired\.com/([a-zA-Z]+)/", element: "{{div.blogIndex}}", opr: 10542}); addTrigger({int: ["How To : {{#articlehed}}.textContent"], location: "howto\.wired\.com/wiki/([a-zA-Z0-9_+%-]+)", element: "{{#articlehed}}", opr: 10544}); addTrigger({int: ["Section : $1"], location: "www\.wired\.com/([a-zA-Z-_]+)/([a-zA-Z-_]+)", element: "{{a.subSectionNameHeader}}", opr: 11150}); addTrigger({int: ["Section : $1 : $2"], location: "www\.wired\.com/([a-zA-Z-_]+)/([a-zA-Z-_]+)", element: "{{a.subSectionNameHeader}}", opr: 11151}); addTrigger({int: ["Wiki Page : {{#articlehed}}.textContent"], location: "howto\.wired\.com/wiki/Category", element: "{{#articlehed}}", opr: 12639}); addTrigger({srch: ["{{#q}}.value"], location: "www\.wired\.com", element: "{{#gs_search_form}}", event: "submit", opr: 10984}); addTrigger({srch: ["{{fieldset.search input.box}}.value"], location: "www\.wired\.com/", element: "{{#cse-search-box}}", event: "submit", opr: 11144}); addTrigger({srch: ["{{input.input_text}}.value"], location: "www\.wired\.com", element: "{{#nav_search}}", event: "submit", opr: 11152}); addTrigger({srch: ["{{#s}}.value"], location: "www\.wired\.com", element: "{{#search-2 form}}", event: "submit", opr: 11174}); addTrigger({med: ["Blog Entry: $1 : {{div.entryDescription li.entryCategories a:nth-of-type(1)}}.textContent : {{div.entryDescription li.entryCategories a:nth-of-type(2)}}.textContent"], location: "www\.wired\.com/([a-zA-Z]+)/([0-9]+)/([0-9]+)/([a-zA-Z0-9_+%-]+)/", element: "{{#blog_header}}", opr: 10543}); addTrigger({med: ["Section : $1"], location: "www\.wired\.com/([a-zA-Z-_]+)", element: "{{a.sectionNameHeader}}", opr: 11149}); addTrigger({med: ["Mag Article : {{#page #content div.post h1}}.textContent"], location: "www\.wired\.com/magazine/([0-9]+)/([0-9]+)/([a-zA-Z0-9_+%-]+)", element: "{{#page #content div.post h1}}", opr: 11407}); addTrigger({med: ["Mag Article : {{#page #content div.post span.permalink h1}}.textContent"], location: "www\.wired\.com/magazine/([0-9]+)/([0-9]+)/([a-zA-Z0-9_+%-]+)", element: "{{#page #content div.post span.permalink}}", opr: 11408}); addTrigger({med: ["How To Article Tag : {{#catlinks p.catlinks span:nth-of-type(1) a}}.textContent"], location: "howto\.wired\.com/wiki/([a-zA-Z0-9_-]+)", element: "{{#catlinks p.catlinks span:nth-of-type(1) a}}", opr: 12640}); addTrigger({med: ["How To Article Tag : {{#catlinks p.catlinks span:nth-of-type(2) a}}.textContent"], location: "howto\.wired\.com/wiki/([a-zA-Z0-9_-]+)", element: "{{#catlinks p.catlinks span:nth-of-type(2) a}}", opr: 12641}); addTrigger({med: ["How To Article Tag : {{#catlinks p.catlinks span:nth-of-type(3) a}}.textContent"], location: "howto\.wired\.com/wiki/([a-zA-Z0-9_-]+)", element: "{{#catlinks p.catlinks span:nth-of-type(3) a}}", opr: 12642}); addTrigger({med: ["How To Article Tag : {{#catlinks p.catlinks span:nth-of-type(4) a}}.textContent"], location: "howto\.wired\.com/wiki/([a-zA-Z0-9_-]+)", element: "{{#catlinks p.catlinks span:nth-of-type(4) a}}", opr: 12643}); addTrigger({med: ["How To Article Tag : {{#catlinks p.catlinks span:nth-of-type(5) a}}.textContent"], location: "howto\.wired\.com/wiki/([a-zA-Z0-9_-]+)", element: "{{#catlinks p.catlinks span:nth-of-type(5) a}}", opr: 12644});bindTriggers();;var url=appendAll(baseURL(true));if(typeof(lotbcp)!="undefined")url=append(url,lotbcp,"b");if(typeof(lotact)!="undefined")url=append(url,lotact,"act");if(typeof(lotint)!="undefined")url=append(url,lotint,"int");if(typeof(lotmed)!="undefined")url=append(url,lotmed,"med");try{var tempIFrame=document.createElement('iframe');tempIFrame.setAttribute('id','LOTCCFrame'+new Date());url=append(url,"ifr","rt");tempIFrame.setAttribute('src',url.replace(/'/g,"%27"));tempIFrame.style.border='0px';tempIFrame.style.width='0px';tempIFrame.style.height='0px';tempIFrame.style.display='block';document.body.appendChild(tempIFrame)}catch(exception){var pixel=new Image(1,1);pixel.src=url.replace(/'/g,"%27")}reset(url)}function doneload(){if(dobcp){firebcp();dobcp=false}loaded=true}function loadAsync(){if(async_props.async){try{with(async_props){for(type in asyncBehaviors){for(var i=0,b;b=asyncBehaviors[type][i++];){add(type,b)}}for(var i=0,id;id=asyncOpportunityIds[i++];){addOpportunityId(asyncOpportunityIds[id])}for(var i=0,tag;tag=asyncOpportunities[i++];){addOpportunity(asyncOpportunities[tag])}}bcp()}catch(e){console.log(e)}}}function parseQuery(query){var params={};if(!query)return params;var pairs=query.split(/[;&]/);for(var i=0;i<pairs.length;i++){var key_val=pairs[i].split('=');if(!key_val||key_val.length!=2)continue;var key=unescape(key_val[0]);var val=unescape(key_val[1]);val=val.replace(/\+/g,' ');(params[key]&&params[key].push)?params[key].push(val):params[key]=[val]}return params}var te=[],mnpct=50,mxidle=20,mxstart=0,lstact=new Date(),isFocused=true,expinited=false,maxPolls=5,icnt=0,numPolls=0,stepIncrement=0,pollInterval=0,pollIncrement=3,forcePing=3,sw="_SW["+(new Date()).getTime()+"]",swSize=0,lastStr="",ichks=0;window[ns].addExpTracker=addExpTracker;addEvent(window,"message",listenForInViewTrackers);addEvent(window,"load",checkForAds);setTimeout(adChk,1000);function expinit(){if(expinited==true){return}flash("initializing");var f=function(){activity();isFocused=true};var b=function(){activity();isFocused=false};addEvent((browser.mozilla||browser.opera)?document:window,"focus",f);addEvent((browser.mozilla||browser.opera)?document:window,"blur",b);addEvent(window,"scroll",activity);addEvent(window,"resize",activity);addEvent(window,"load",activity);addEvent(window,"mousemove",activity);addEvent(document,"mousemove",activity);addEvent(document,"keyup",activity);addEvent(document,"click",activity);addEvent(window,"unload",record);setInterval(track,1000);expinited=true;flash("Initialized")}function activity(){lstact=new Date()}function record(){var ad_exp=[],camp_exp=[],swArray=[],swElements=[];for(var i=0;i<te.length;i++){var eInf=te[i];if(eInf==undefined)continue;if(eInf['last_seen']==null&&eInf['impSent'])continue;var last_seen=(eInf['last_seen']!=null)?Math.floor(eInf['last_seen'].getTime()/1000):null;var d=Math.round(getTime(eInf['element'].elm)/1000);var start_time=eInf['max_start'];if(d<start_time){if((start_time<forcePing)||(icnt!=forcePing)||eInf['impSent']){continue}}var aInf=ad_exp['a'+eInf["adId"]];var cInf=camp_exp['c'+eInf["campaignId"]];if(aInf==undefined){aInf=new Array();aInf['id']=eInf["adId"];ad_exp['a'+eInf["adId"]]=aInf;ad_exp.push(aInf)}if(cInf==undefined){cInf=new Array();cInf['id']=eInf["campaignId"];camp_exp['c'+eInf["campaignId"]]=cInf;camp_exp.push(cInf)}var adj_adDuration=((d-eInf['max_start'])<=0)?0:(d-eInf['max_start']);aInf["duration"]=(aInf["duration"]==undefined)?adj_adDuration:aInf["duration"]+adj_adDuration;cInf["duration"]=(cInf["duration"]==undefined)?adj_adDuration:cInf["duration"]+adj_adDuration;aInf["last_seen"]=last_seen;if(cInf["last_seen"]==undefined||last_seen>cInf["last_seen"])cInf["last_seen"]=last_seen;swArray.push(eInf["txId"]+"."+eInf["adId"]+"."+eInf["zoneId"]+"."+aInf["duration"]);swElements.push(eInf)}if(swArray.length>0&&icnt>0){var cks=new Array();cks.push(sw+"="+swArray.join("_"));for(var i=0;i<ad_exp.length;i++){var aInf=ad_exp[i];if(aInf['last_seen']==null)continue;var ab_name='_OAAEBLOCK['+aInf['id']+']';var ac_name='_OAAECAP['+aInf['id']+']';cks.push(ac_name+"="+aInf["duration"]);cks.push(ab_name+"="+aInf["last_seen"])}for(var i=0;i<camp_exp.length;i++){var cInf=camp_exp[i];var cb_name='_OACEBLOCK['+cInf['id']+']';var cc_name='_OACECAP['+cInf['id']+']';cks.push(cc_name+"="+cInf["duration"]);cks.push(cb_name+"="+cInf["last_seen"])}if(swArray.length!=swSize){pollInterval=0;stepIncrement=0;numPolls=0;maxPolls=5}swSize=swArray.length;if(stepIncrement==pollInterval){var str=cks.join("&");if(str!=null&&str.length>0&&str!=lastStr){var min=100000000;var max=999999999;var rand=Math.floor(min+(max-min)*Math.random());var tracker=new Image(1,1);var prefix=document.location.protocol+'//';var poll=prefix+getDomain()+"/exp?"+str+"&rand="+rand;tracker.src=poll;flash("Poll "+poll);lastStr=str;for(var i=0;i<swElements.length;i++){swElements[i]["impSent"]=true}stepIncrement=0;numPolls++}else{flash("no changes to poll")}if(numPolls==maxPolls){numPolls=0;maxPolls=Math.ceil(maxPolls/2);pollInterval+=pollIncrement}}else{stepIncrement++}}icnt++}function track(){var msg="";for(var i=0;i<te.length;i++){var eInf=te[i];var e=eInf['element'];if(e==undefined)continue;e=e.elm;var pct=getPctVisible(e);var activityInterval=Math.round((new Date().getTime()-lstact.getTime())/1000);var exposure_time=Math.round(getTime(e)/1000);if(pct>=eInf['min_visible']&&activityInterval<eInf['max_idle']&&isFocused){msg+=startTimer(e)}else{msg+=stopTimer(e)}msg+=": "+pct+" visible, "+activityInterval+" seconds idle. exposure timer @ "+exposure_time+" seconds for tx "+eInf['txId']+"<br \>"}flash(msg);record()}function stopTimer(e){if(e==undefined)return;var eInf=getElementInfo(e);var msg='';if(eInf['start']!=undefined){eInf['totaltime']=getTime(e);delete eInf['start'];msg='Stop Timer'}else{msg='Timer Stopped'}return msg}function startTimer(e){if(e==undefined)return;var eInf=getElementInfo(e);var msg='';eInf['last_seen']=new Date();if(eInf['start']==undefined){eInf['start']=new Date();msg='Start Timer'}else{msg='Timer Running'}return msg}function getTime(e){if(e==undefined)return;var eInf=getElementInfo(e);var duration=0;if(eInf['start']!=undefined){duration=new Date().getTime()-eInf['start'].getTime();duration=eInf['totaltime']+duration}else{duration=eInf['totaltime']}return duration}function getElementInfo(e){var len=te.length;for(var i=0;i<len;i++){if(te[i]['element'].elm==e)return te[i]}return null}function addExpTracker(txId,elementId,zoneId,adId,campaignId,expInfo){var e=document.getElementById(elementId);if(e==undefined||adId==undefined){flash(elementId+" not found");return}addExpTrackerElm(txId,e,zoneId,adId,campaignId,expInfo)}function addExpTrackerElm(txId,e,zoneId,adId,campaignId,expInfo){if(e==undefined||adId==undefined)return;expinit();if(!(e.offsetHeight>0||e.offsetWidth>0))return;for(var i=0;i<te.length;i++){if(te[i]['element'].elm==e)return}flash("adding tracker for tx "+txId);var eInf=[];eInf['element']={elm:e};eInf['adId']=adId;eInf['zoneId']=zoneId;eInf['txId']=txId;eInf['campaignId']=campaignId;eInf['min_visible']=expInfo.pct_visible||mnpct;eInf['max_idle']=expInfo.max_idle||mxidle;eInf['max_start']=expInfo.max_start||mxstart;eInf['rand']=Math.floor(100000000+(999999999-100000000)*Math.random());eInf['last_seen']=null;eInf['impSent']=false;eInf['totaltime']=0;te.push(eInf)}function getPctVisible(e){if(e==null)return 0;var elementX1=elementY1=0;var workingElement=e;if(workingElement.offsetParent){do{elementX1+=workingElement.offsetLeft;elementY1+=workingElement.offsetTop}while(workingElement=workingElement.offsetParent)}var elementX2=elementX1+e.offsetWidth;var elementY2=elementY1+e.offsetHeight;if(elementX2==elementX1)elementX2=elementX1+1;if(elementY2==elementY1)elementY2=elementY1+1;flash(elementX1+","+elementX2+","+elementY1+","+elementY2);var viewX1=window.pageXOffset?window.pageXOffset:document.body.scrollLeft;var viewY1=window.pageYOffset?window.pageYOffset:document.body.scrollTop;var viewX2=viewX1+(window.innerWidth?window.innerWidth:document.body.clientWidth);var viewY2=viewY1+(window.innerHeight?window.innerHeight:document.body.clientHeight);var overlap;var x_overlap;var y_overlap;if(elementX1>viewX2){overlap=0}else if(elementX2<viewX1){overlap=0}else if(elementY1>viewY2){overlap=0}else if(elementY2<viewY1){overlap=0}else{x_overlap=Math.min(viewX2,elementX2)-Math.max(viewX1,elementX1);y_overlap=Math.min(viewY2,elementY2)-Math.max(viewY1,elementY1)}var areaOriginal=(elementX2-elementX1)*(elementY2-elementY1);overlap=x_overlap*y_overlap;var overlapPct=overlap/areaOriginal*100.0;return overlapPct>=0?overlapPct:0}function checkForAds(){var fs=document.getElementsByTagName("IFRAME");var len=fs.length;for(var i=0;i<len;i++){var f=fs[i].contentWindow;try{var h=f.location.href;}catch(e){for(var j=0;j<fs[i].contentWindow.frames.length;j++){try{var loc=fs[i].contentWindow.frames[j].location.toString();var index=loc.indexOf("#LOTEXP.");if(index>0){var ps=loc.substring(index+8).split("_");if(ps.length>=6)addExpTrackerElm(ps[0],fs[i],ps[1],ps[2],ps[3],{max_idle:ps[4],pct_visible:ps[5]})}}catch(e){}}}}}function adChk(){if(!loaded){checkForAds();if(ichks<10)setTimeout(adChk,1000);ichks++}}function listenForInViewTrackers(e){var ps=e.data.split("_");if(ps.length>7&&ps[0]=="LOTCCREG"){var f=document.getElementsByName(ps[1]);if(f.length>0){addExpTrackerElm(ps[2],f[0],ps[3],ps[4],ps[5],{max_idle:ps[6],pct_visible:ps[7]})}else{f=document.getElementById(ps[1]);if(f){addExpTrackerElm(ps[2],f,ps[3],ps[4],ps[5],{max_idle:ps[6],pct_visible:ps[7]})}}}};var reg_selector=/\{\{([^}}]*)\}\}(\.([a-zA-Z0-9\._-]+))?/g,opt_rules=[],hpx_rules=[],pl_rules=[],addTrigger=addOptimusRule,query=function(){};function addOptimusRule(rule){if(!isValidOptRule(rule))return false;addRule(rule,opt_rules);return true}function addHapaxRule(rule){if(!isValidHpxRule(rule))return false;addRule(rule,hpx_rules);return true}function addPlacementRule(rule){if(!isValidPlRule(rule))return false;addRule(rule,pl_rules);return true}function addRule(rule,basket){basket.push(rule)}function bindTriggers(){var doc_map=generateDocumentMap(window,new Object());for(var href in doc_map){processOptimusRules(opt_rules,href,doc_map[href]);processHapaxRules(hpx_rules,href,doc_map[href]);processPlacementRules(pl_rules,doc_map[href])}for(var i=0,arr;arr=addEventRule.elements[i++];){var el=arr[0];var handlers=arr[1];for(var ev in handlers){addEvent(el,ev,(function(h){return function(evt){for(var j=0,callback;callback=h[j++];){callback(evt)}var b_count=0;for(var type in behaviors){b_count++}if(b_count>0)bcpw()}})(handlers[ev]))}}}function generateDocumentMap(w,doc_map){doc_map[w.location.href]=w.document;var has_access=false;if(window.parent!=w){try{if(w.parent.location.href){has_access=true;return generateDocumentMap(w.parent,doc_map)}}catch(e){}if(!has_access){if(w.document.referrer!=='')doc_map[w.document.referrer]=null}}return doc_map}function processOptimusRules(opt_rules,href,doc){for(var i=0,opt;opt=opt_rules[i++];){var location_matches=getLocationMatches(opt.location,href);if(location_matches===false||doc===null)continue;if("element"in opt){var elements=getElements(opt.element,doc);if(elements.length>0){if(isSelector(opt.element)&&/(\.([a-zA-Z0-9\._-]+))$/.test(opt.element)){var matches=/(\.([a-zA-Z0-9\._-]+))$/.exec(opt.element);if(typeof matches[2]!=="undefined"){var properties=matches[2].split('.');var found=true;for(var e_inc=0,el;el=elements[e_inc++];){for(var p_inc=0,prop;prop=properties[p_inc++];){if(typeof el[prop]==="undefined"){found=false;break}else{el=el[prop]}}if(!found)break}if(!found)continue}}if("event"in opt){for(var j=0;j<elements.length;j++){addEventRule(elements[j],opt.event,(function(rule,matches){return function(){populateBehaviors(rule,matches,doc)}})(opt,location_matches))}}else{populateBehaviors(opt,location_matches,doc)}}else{if("event"in opt&&opt.event=='click'){addEventRule(doc,'click',(function(rule,matches){return function(ev){els=getElements(rule.element,doc);for(var i=0,el;el=els[i++];){if(el===ev.target)populateBehaviors(rule,matches,doc)}}}(opt,location_matches)))}}}else{populateBehaviors(opt,location_matches,doc)}}}function processHapaxRules(hpx_rules,href,doc){for(var i=0,hpx;hpx=hpx_rules[i++];){var loc_matches=getLocationMatches(hpx.location,href);if(loc_matches==false||doc===null)continue;var elements=getElements(hpx.element,doc);if(elements.length>0){for(var j=0,e;e=elements[j++];){addEventRule(e,hpx.event,hpxCallback(hpx))}}else if(hpx.event==='click'){addEventRule(doc,'click',(function(rule,matches){return function(ev){els=getElements(rule.element,doc);for(var i=0,el;el=els[i++];){if(el===ev.target)hpxCallback(rule)()}}}(hpx,loc_matches)))}}function hpxCallback(h){return function(){var ugc_behaviors=[];for(var i=0,behavior;behavior=h.ug[i++];){var matched_element=getElements(behavior,doc);ugc_behaviors.push(matched_element[0].value)}var ugc_behavior_string=ugc_behaviors.join(' ');if(ugc_behavior_string!==''){add("ugc",("opr"in h)?formatOptimusBehavior(h.opr,ugc_behavior_string):ugc_behavior_string)}}}}function processPlacementRules(pl_rules,doc){var pl_sent=[];pl_rules.sort(function(a,b){var regex=/^#/;if(regex.test(a.element)&&!regex.test(b.element))return-1;if(!regex.test(a.element)&&regex.test(b.element))return 1;return 0});for(var i=0,pl;pl=pl_rules[i++];){var els=query(pl.element,doc);var found=false;if(els.length>0){for(var j=0;j<pl_sent.length;j++){if(compareArray(els,pl_sent[j]))found=true}if(found)continue;for(var k=0;k<els.length;k++){if(pl.placement_id){addOpportunityId(pl.placement_id)}else if(pl.placement){addOpportunity(pl.placement)}}pl_sent.push(els)}}}function compareArray(arr1,arr2){if(arr1.length!=arr2.length)return false;for(var i=0;i<arr1.length;i++){if(arr1[i]!==arr2[i])return false}return true}function formatOptimusBehavior(opr,b){return("#OpR#"+opr+"#"+b)}function getLocationMatches(loc,href){var matches;try{var re=new RegExp(loc);matches=re.exec(href)}catch(e){add("opterr","location-match");matches=null}return(matches!==null)?matches:false}function getElements(el,doc){var domelements;if(!isSelector(el)){el='{{#'+el+'}}'}var expr_els=getElementsBySelector(el,doc);domelements=(expr_els.length>0)?expr_els[0][1]:[];return domelements}function getElementsBySelector(expression,doc){var matches=[],results,expr,selector,property,els;if(!isSelector(expression))return[];try{while((results=reg_selector.exec(expression))!==null){expr=results[0];selector=results[1];property=results[3]||'value';els=query(selector,doc);if(els.length>0)matches.push([expr,els,property])}}catch(e){add("opterr","get-elements-by-selector");matches=[]}return matches}function isSelector(expression){var result;try{result=reg_selector.test(expression);reg_selector.lastIndex=0}catch(e){add("opterr","selector-match");result=false}return result}function populateBehaviors(behaviors,loc_matches,doc){for(var bt in behaviors){if(!isArray(behaviors[bt]))continue;for(var i=0,b;b=behaviors[bt][i++];){b=replaceSelectors(b,doc);b=replacePlaceholders(b,loc_matches);if(b!==''){add(bt,("opr"in behaviors)?formatOptimusBehavior(behaviors.opr,b):b);}}}}function replaceSelectors(b,doc){if(!isSelector(b))return b;var matches=getElementsBySelector(b,doc);if(matches.length>0){for(var i=0,m;m=matches[i++];){var el_vals=[],selector=m[0],els=m[1],property=m[2];for(var j=0,el;el=els[j++];){properties=property.split('.');var p=0;while(el[properties[p]]!==undefined){el=el[properties[p]];p++}el_vals.push((p==properties.length)?filterContent(el.toString()):'')}b=b.replace(selector,el_vals.join(','))}if(isSelector(b))b=b.replace(reg_selector,'')}else{b=b.replace(reg_selector,'')}return b}function filterContent(c){return c.replace(/\<\/?[^>]+\/?\>/gi,'').replace(/\n|\t|\r/gi,' ').replace(/\s{2,}/g,' ').replace(/\[quote\][\s\S]*\[\/quote\]/gi,'');}function replacePlaceholders(b,loc_matches){if(loc_matches.length<2)return b;for(var i=0;i<loc_matches.length;i++){var sub_regex=new RegExp("\\$"+i.toString()+"\\b");b=b.replace(sub_regex,loc_matches[i])}return b}function isValidOptRule(rule){var valid=true;if(!("location"in rule)||((rule.location==='')||(rule.location===null)))valid=false;if(("element"in rule)&&(rule.element===''||rule.element===null))valid=false;if(("event"in rule)&&(!("element"in rule)||(rule.event===''||rule.event===null)))valid=false;return valid}function isValidHpxRule(rule){var valid=true;if(!("location"in rule)||((rule.location==='')||(rule.location===null)))valid=false;if(!("element"in rule)||(rule.element===''||rule.element===null))valid=false;if(!("event"in rule)||(rule.event===''||rule.event===null))valid=false;if(!("ug"in rule)||(rule.ug===''||rule.ug===null))valid=false;return valid}function isValidPlRule(rule){var valid=true;if(!("placement"in rule)&&!("placement_id"in rule))valid=false;if(!("element"in rule)||(rule.element===''||rule.element===null))valid=false;if(("placement"in rule)&&(rule.placement===''||rule.placement===null))valid=false;if(("placement_id"in rule)&&(rule.placement_id===''||rule.placement_id===null))valid=false;return valid}function searchArray(arr,str){if(!isArray(arr))return false;if(!Array.prototype.indexOf){for(var i=0;i<arr.length;i++){if(arr[i]==str)return true}}else{if(arr.indexOf(str)>=0)return true}return false}var addEventRule=function(elm,event,callback){var func=arguments.callee;for(var i=0,arr_elm;arr_elm=func.elements[i++];){if(!isArray(arr_elm))continue;var cached_element=arr_elm[0];var handler_obj=arr_elm[1];if(elm===cached_element){if(!(event in handler_obj))handler_obj[event]=[];handler_obj[event].push(callback);return}}var new_elm=[elm,{}];new_elm[1][event]=[callback];func.elements.push(new_elm)};addEventRule.elements=[];(function(){var doc=document;var isIE=/(?!.*?opera.*?)msie(?!.*?opera.*?)/i.test(navigator.userAgent);var isWebKit=/webkit/i.test(navigator.userAgent);var cache={};var cacheOn=!isIE&&!isWebKit;var persistCache={};var _uid=0;var reg={trim:/^\s+|\s+$/g,quickTest:/^[^:\[>+~ ,]+$/,typeSelector:/(^[^\[:]+?)(?:\[|\:|$)/,tag:/^(\w+|\*)/,id:/^(\w*|\*)#/,classRE:/^(\w*|\*)\./,attributeName:/(\w+)(?:[!+~*\^$|=])|\w+/,attributeValue:/(?:[!+~*\^$|=]=*)(.+)(?:\])/,pseudoName:/(\:[^\(]+)/,pseudoArgs:/(?:\()(.+)(?:\))/,nthParts:/([+-]?\d)*(n)([+-]\d+)*/i,combinatorTest:/[+>~ ](?![^\(]+\)|[^\[]+\])/,combinator:/\s*[>~]\s*(?![=])|\s*\+\s*(?![0-9)])|\s+/g,recursive:/:(not|has)\((\w+|\*)?([#.](\w|\d)+)*(\:(\w|-)+(\([^\)]+\))?|\[[^\}]+\])*(\s*,\s*(\w+|\*)?([#.](\w|\d)+)*(\:(\w|-)+(\([^\)]+\))?|\[[^\}]+\])*)*\)/gi};var arrayIt=function(a){if(!!(window.attachEvent&&!window.opera)){return function(a){if(a instanceof Array)return a;for(var i=0,result=[],m;m=a[i++];)result[result.length]=m;return result}}else{return function(a){return Array.prototype.slice.call(a)}}}();function filter(a,tag){var r=[],uids={};if(tag)tag=new RegExp("^"+tag+"$","i");for(var i=0,ae;ae=a[i++];){ae.uid=ae.uid||_uid++;if(!uids[ae.uid]&&(!tag||ae.nodeName.search(tag)!==-1)){r[r.length]=uids[ae.uid]=ae}}return r}function getAttribute(e,a){if(!e)return null;if(a==="class"||a==="className")return e.className;if(a==="for")return e.htmlFor;return e.getAttribute(a)||e[a]}function getByClass(selector,selectorRE,root,includeRoot,cacheKey,tag,flat){var result=[];if(!!flat){return selectorRE.test(root.className)?[root]:[]}if(root.getElementsByClassName){result=arrayIt(root.getElementsByClassName(selector));if(!!includeRoot){if(selectorRE.test(root.className))result[result.length]=root}if(tag!="*")result=filter(result,tag);cache[cacheKey]=result.slice(0);return result}else if(doc.getElementsByClassName){result=arrayIt(doc.getElementsByClassName(selector));if(tag!="*")result=filter(result,tag);cache[cacheKey]=result.slice(0);return result}var es=(tag=="*"&&root.all)?root.all:root.getElementsByTagName(tag);if(!!includeRoot)es[es.length]=root;for(var index=0,e;e=es[index++];){if(selectorRE.test(e.className)){result[result.length]=e}}return result}function getById(selector,root,includeRoot,cacheKey,tag,flat){var rs,result=[];if(!!flat){return getAttribute(root,"id")===selector?[root]:[]}if(root.getElementById){rs=root.getElementById(selector)}else{rs=doc.getElementById(selector)}if(rs&&getAttribute(rs,"id")===selector){result[result.length]=rs;cache[cacheKey]=result.slice(0);return result}var es=root.getElementsByTagName(tag);if(!!includeRoot)es[es.length]=root;for(var index=0,e;e=es[index++];){if(getAttribute(e,"id")===selector){result[result.length]=e;break}}return result}function getContextFromSequenceSelector(selector,roots,includeRoot,flat){var context,tag,contextType="",result=[],tResult=[],root,rootCount,rootsLength;reg.id.lastIndex=reg.typeSelector.lastIndex=reg.classRE.lastIndex=0;if(!reg.tag.test(selector))selector="*"+selector;context=reg.typeSelector.exec(selector)[1];roots=roots instanceof Array?roots.slice(0):[roots];rootsLength=roots.length;rootCount=rootsLength-1;if(reg.id.test(context)){contextType="id";tag=(tag=context.match(/^\w+/))?tag[0]:"*";context=context.replace(reg.id,"")}else if(reg.classRE.test(context)){contextType="class";tag=(tag=context.match(reg.tag))?tag[0]:"*";context=context.replace(reg.tag,"");contextRE=persistCache[context+"RegExp"]||(persistCache[context+"RegExp"]=new RegExp("(?:^|\\s)"+context.replace(/\./g,"\\s*")+"(?:\\s|$)"));context=context.replace(/\./g," ")}while(rootCount>-1){root=roots[rootCount--];root.uid=root.uid||_uid++;var cacheKey=selector+root.uid;if(cacheOn&&cache[cacheKey]){result=result.concat(cache[cacheKey]);continue}if(contextType==="id"){tResult=getById(context,root,includeRoot,cacheKey,tag,flat)}else if(contextType==="class"){tResult=getByClass(context,contextRE,root,includeRoot,cacheKey,tag,flat)}else{tResult=arrayIt(root.getElementsByTagName(context));if(!!includeRoot&&(root.nodeName.toUpperCase()===context.toUpperCase()||context==="*"))tResult[tResult.length]=root}result=rootsLength>1?result.concat(tResult):tResult;cache[cacheKey]=result.slice(0)}return result}peppy={query:function(selectorGroups,root,includeRoot,recursed,flat){var elements=[];if(!recursed){selectorGroups=selectorGroups.replace(reg.trim,"").replace(/(\[)\s+/g,"$1").replace(/\s+(\])/g,"$1").replace(/(\[[^\] ]+)\s+/g,"$1").replace(/\s+([^ \[]+\])/g,"$1").replace(/(\()\s+/g,"$1").replace(/(\+)([^0-9])/g,"$1 $2").replace(/['"]/g,"").replace(/\(\s*even\s*\)/gi,"(2n)").replace(/\(\s*odd\s*\)/gi,"(2n+1)");}if(typeof root==="string"){root=(root=getContextFromSequenceSelector(root,doc)).length>0?root:undefined}root=root||doc;root.uid=root.uid||_uid++;var cacheKey=selectorGroups+root.uid;if(cacheOn&&cache[cacheKey])return cache[cacheKey];reg.quickTest.lastIndex=0;if(reg.quickTest.test(selectorGroups)){elements=getContextFromSequenceSelector(selectorGroups,root,includeRoot,flat);return(cache[cacheKey]=elements.slice(0))}var groupsWorker,groups,selector,parts=[],part;groupsWorker=selectorGroups.split(/\s*,\s*/g);groups=groupsWorker.length>1?[""]:groupsWorker;for(var gwi=0,tc=0,gi=0,g;groupsWorker.length>1&&(g=groupsWorker[gwi++])!==undefined;){tc+=(((l=g.match(/\(/g))?l.length:0)-((r=g.match(/\)/g))?r.length:0));groups[gi]=groups[gi]||"";groups[gi]+=(groups[gi]===""?g:","+g);if(tc===0)gi++}var gCount=0;while((selector=groups[gCount++])!==undefined){reg.quickTest.lastIndex=0;if(reg.quickTest.test(selector)){result=getContextFromSequenceSelector(selector,root,includeRoot,flat);elements=groups.length>1?elements.concat(result):result;continue}reg.combinatorTest.lastIndex=0;if(reg.combinatorTest.test(selector)){var parts,pLength,pCount=0,combinators,cLength,cCount=0,result;parts=selector.split(reg.combinator);pLength=parts.length;combinators=selector.match(reg.combinator)||[""];cLength=combinators.length;while(pCount<pLength){var c,part1,part2;c=combinators[cCount++].replace(reg.trim,"");part1=result||peppy.query(parts[pCount++],root,includeRoot,true,flat);part2=peppy.query(parts[pCount++],c==""||c==">"?part1:root,c==""||c==">",true,flat);result=peppy.queryCombinator(part1,part2,c)}elements=groups.length>1?elements.concat(result):result;result=undefined}else{result=peppy.querySelector(selector,root,includeRoot,flat);elements=groups.length>1?elements.concat(result):result}}if(groups.length>1)elements=filter(elements);return(cache[cacheKey]=elements.slice(0))},queryCombinator:function(l,r,c){var result=[],uids={},proc={},succ={},fail={},combinatorCheck=peppy.simpleSelector.combinator[c];for(var li=0,le;le=l[li++];){le.uid=le.uid||_uid++;uids[le.uid]=le}for(var ri=0,re;re=r[ri++];){re.uid=re.uid||_uid++;if(!proc[re.uid]&&combinatorCheck(re,uids,fail,succ)){result[result.length]=re}proc[re.uid]=re}return result},querySelector:function(selector,root,includeRoot,flat){var context,passed=[],count,totalCount,e,first=true,localCache={};context=getContextFromSequenceSelector(selector,root,includeRoot,flat);count=context.length;totalCount=count-1;var tests,recursive;if(/:(not|has)/i.test(selector)){recursive=selector.match(reg.recursive);selector=selector.replace(reg.recursive,"")}if(!(tests=selector.match(/:(\w|-)+(\([^\(]+\))*|\[[^\[]+\]/g)))tests=[];if(recursive)tests=tests.concat(recursive);var aTest;while((aTest=tests.pop())!==undefined){var pc=persistCache[aTest],testFuncScope,testFunc,testFuncKey,testFuncArgs=[],isTypeTest=false,isCountTest=false;passed=[];if(pc){testFuncKey=pc[0];testFuncScope=pc[1];testFuncArgs=pc.slice(2);testFunc=testFuncScope[testFuncKey]}else if(!/^:/.test(aTest)){var n=aTest.match(reg.attributeName);var v=aTest.match(reg.attributeValue);testFuncArgs[1]=n[1]||n[0];testFuncArgs[2]=v?v[1]:"";testFuncKey=""+aTest.match(/[~!+*\^$|=]/);testFuncScope=peppy.simpleSelector.attribute;testFunc=testFuncScope[testFuncKey];persistCache[aTest]=[testFuncKey,testFuncScope].concat(testFuncArgs)}else{var pa=aTest.match(reg.pseudoArgs);testFuncArgs[1]=pa?pa[1]:"";testFuncKey=aTest.match(reg.pseudoName)[1];testFuncScope=peppy.simpleSelector.pseudos;if(/nth-(?!.+only)/i.test(aTest)){var a,b,nArg=testFuncArgs[1],nArgPC=persistCache[nArg];if(nArgPC){a=nArgPC[0];b=nArgPC[1]}else{var nParts=nArg.match(reg.nthParts);if(nParts){a=parseInt(nParts[1],10)||0;b=parseInt(nParts[3],10)||0;if(/^\+n|^n/i.test(nArg)){a=1}else if(/^-n/i.test(nArg)){a=-1}testFuncArgs[2]=a;testFuncArgs[3]=b;persistCache[nArg]=[a,b]}}}else if(/^:contains/.test(aTest)){var cArg=testFuncArgs[1];var cArgPC=persistCache[cArg];if(cArgPC){testFuncArgs[1]=cArgPC}else{testFuncArgs[1]=persistCache[cArg]=new RegExp(cArg)}}testFunc=testFuncScope[testFuncKey];persistCache[aTest]=[testFuncKey,testFuncScope].concat(testFuncArgs)}isTypeTest=/:(\w|-)+type/i.test(aTest);isCountTest=/^:(nth[^-]|eq|gt|lt|first|last)/i.test(aTest);if(isCountTest)testFuncArgs[3]=totalCount;var cLength=context.length,cCount=cLength-1;while(cCount>-1){e=context[cCount--];if(first){e.peppyCount=cCount+1}var pass=true;testFuncArgs[0]=e;if(isCountTest)testFuncArgs[2]=e.peppyCount;if(!testFunc.apply(testFuncScope,testFuncArgs)){pass=false}if(pass){passed.push(e)}}context=passed;first=false}return passed},simpleSelector:{attribute:{"null":function(e,a,v){return!!getAttribute(e,a)},"=":function(e,a,v){return getAttribute(e,a)==v},"~":function(e,a,v){return getAttribute(e,a).match(new RegExp('\\b'+v+'\\b'))},"^":function(e,a,v){return getAttribute(e,a).indexOf(v)===0},"$":function(e,a,v){var attr=getAttribute(e,a);return attr.lastIndexOf(v)===attr.length-v.length},"*":function(e,a,v){return getAttribute(e,a).indexOf(v)!=-1},"|":function(e,a,v){return getAttribute(e,a).match('^'+v+'-?(('+v+'-)*('+v+'$))*')},"!":function(e,a,v){return getAttribute(e,a)!==v}},pseudos:{":root":function(e){return e===doc.getElementsByTagName("html")[0]?true:false},":nth-child":function(e,n,a,b,t){if(!e.nodeIndex){var node=e.parentNode.firstChild,count=0,last;for(;node;node=node.nextSibling){if(node.nodeType==1){last=node;node.nodeIndex=++count}}last.IsLastNode=true;if(count==1)last.IsOnlyChild=true}var position=e.nodeIndex;if(n=="first")return position==1;if(n=="last")return!!e.IsLastNode;if(n=="only")return!!e.IsOnlyChild;return(!a&&!b&&position==n)||((a==0?position==b:a>0?position>=b&&(position-b)%a==0:position<=b&&(position+b)%a==0))},":nth-last-child":function(e,n){return this[":nth-child"](e,n,a,b)},":nth-of-type":function(e,n,t){return this[":nth-child"](e,n,a,b,t)},":nth-last-of-type":function(e,n,t){return this[":nth-child"](e,n,a,b,t)},":first-child":function(e){return this[":nth-child"](e,"first")},":last-child":function(e){return this[":nth-child"](e,"last")},":first-of-type":function(e,n,t){return this[":nth-child"](e,"first",null,null,t)},":last-of-type":function(e,n,t){return this[":nth-child"](e,"last",null,null,t)},":only-child":function(e){return this[":nth-child"](e,"only")},":only-of-type":function(e,n,t){return this[":nth-child"](e,"only",null,null,t)},":empty":function(e){for(var node=e.firstChild,count=0;node!==null;node=node.nextSibling){if(node.nodeType===1||node.nodeType===3)return false}return true},":not":function(e,s){return peppy.query(s,e,true,true,true).length===0},":has":function(e,s){return peppy.query(s,e,true,true,true).length>0},":selected":function(e){return e.selected},":hidden":function(e){return e.type==="hidden"||e.style.display==="none"},":visible":function(e){return e.type!=="hidden"&&e.style.display!=="none"},":input":function(e){return e.nodeName.search(/input|select|textarea|button/i)!==-1},":radio":function(e){return e.type==="radio"},":checkbox":function(e){return e.type==="checkbox"},":text":function(e){return e.type==="text"},":header":function(e){return e.nodeName.search(/h\d/i)!==-1},":enabled":function(e){return!e.disabled&&e.type!=="hidden"},":disabled":function(e){return e.disabled},":checked":function(e){return e.checked},":contains":function(e,s){return s.test((e.textContent||e.innerText||""))},":parent":function(e){return!!e.firstChild},":odd":function(e){return this[":nth-child"](e,"2n+2",2,2)},":even":function(e){return this[":nth-child"](e,"2n+1",2,1)},":nth":function(e,s,i){return s==i},":eq":function(e,s,i){return s==i},":gt":function(e,s,i){return i>s},":lt":function(e,s,i){return i<s},":first":function(e,s,i){return i==0},":last":function(e,s,i,end){return i==end}},combinator:{"":function(r,u,f,s){var rUID=r.uid;while((r=r.parentNode)!==null&&!f[r.uid]){if(!!u[r.uid]||!!s[r.uid]){return(s[rUID]=true)}}return(f[rUID]=false)},">":function(r,u,f,s){return r.parentNode&&u[r.parentNode.uid]},"+":function(r,u,f,s){while((r=r.previousSibling)!==null&&!f[r.uid]){if(r.nodeType===1)return r.uid in u}return false},"~":function(r,u,f,s){var rUID=r.uid;while((r=r.previousSibling)!==null&&!f[r.uid]){if(!!u[r.uid]||!!s[r.uid]){return(s[rUID]=true)}}return(f[rUID]=false)}}}};if(doc.querySelectorAll){(function(){var oldpeppy=peppy.query;peppy.query=function(sel,context){context=context||doc;if(context===doc){try{return context.querySelectorAll(sel)}catch(e){}}return oldpeppy.apply(oldpeppy,arrayIt(arguments))}})()}else{var aEvent=doc.addEventListener||doc.attachEvent;function clearCache(){cache={}}aEvent("DOMAttrModified",clearCache,false);aEvent("DOMNodeInserted",clearCache,false);aEvent("DOMNodeRemoved",clearCache,false)}query=function(){try{return peppy.query.apply(peppy,arguments)}catch(e){if(typeof console!='undefined'){console.log("Error processing selector: "+arguments[0])}return[]}}})();;var GTKPR_AUTO_FIRE})();
