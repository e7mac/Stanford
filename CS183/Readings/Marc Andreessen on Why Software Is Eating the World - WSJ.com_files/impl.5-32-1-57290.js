(function(b,a){TRC.aspect={before:function(c,h,g,f){var d=c[h];c[h]=function(){if(f){c[h]=d}g.apply(this,arguments);return d.apply(this,arguments)}},after:function(c,h,g,f){var d=c[h];c[h]=function(){if(f){c[h]=d}var i=d.apply(this,arguments);g.apply(this,arguments);return i}}}})(window,document);(function(c,b){var a=TRC.AutoPlaylistController=function(h,k,j,f,i,g,d){this.animationDelay=1000/40;this.videoData=i;this.rbox=h;this.publisher=k;this.lightbox=j;this.videoDoneHandler=null;this.autoPlayContainer=f;this.gt=this.rbox.trc.gt;this.listId=g;this.container=b.createElement("div");this.countdownBox=null;this.counterBox=null;this.countdownTimer=null;this.playlistRecommendation=null;this.playlistItemBox=b.createElement("div");this.autoplayTime=(typeof d=="undefined")?5:d;this.active=(this.autoplayTime!=-1);this.isRender=false;this.createPlayer();return this};a.prototype.videoDone=function(d){if(this.countdownBox.style.display!="none"){return}if(!this.checkContainerVisibility()){return}if(this.container.style.display!="block"&&!this.lightbox){if(this.playlistItemBox.firstChild==null){this.getPlaylistItem("n")}this.showNextUp()}(function(g){if(g<=0){this.log("playlist",{ri:this.reqId,sd:this.sesData,ui:this.userData,pi:this.videoData.id,pt:"video",li:this.listId});this.activateNextUp("n");return}var f=""+g--;while(f.length<2){f="0"+f}this.counterBox.innerHTML=Gettext.strargs(this.gt.gettext("in %1 Seconds"),[f]);this.countdownTimer=c.setTimeout(arguments.callee.trcBind(this,g),1000)}).trcBind(this,this.autoplayTime)();if(this.autoplayTime>0){this.showCountdown()}};a.prototype.getScreenPosition=function(){return Math.max(b.documentElement.scrollTop,b.body.scrollTop)};a.prototype.autoPlayerLinkTargetSupport=function(f){function d(h){var g;if(TRC.Browser.ie){g=b.createEventObject();g.button=1}else{g=b.createEvent("MouseEvent");g.initMouseEvent("click",true,true,c,0,0,0,0,0,false,false,false,false,0,null)}return g}if(typeof f!="undefined"){this.playlistRecommendation.link.onclick(f,"playlist")}else{this.playlistRecommendation.link.onclick(d(this.playlistRecommendation),"playlist")}};a.prototype.activateNextUp=function(f,d){if(this.countdownTimer){c.clearTimeout(this.countdownTimer);this.countdownTimer=null}TRC.pageManager.storePublisherValue(this.publisher,"auto-play-intent",new Date().getTime()+":"+this.playlistRecommendation.id+":"+f);this.videoData=this.playlistRecommendation;if(this.lightbox){this.createPlayer();this.getPlaylistItem(f)}else{this.autoPlayerLinkTargetSupport(d)}if(this.countdownBox.style.display!="none"){this.hideCountdown()}this.hideNextUp();this.playlistItemBox.removeChild(this.playlistItemBox.firstChild)};a.prototype.showNextUp=function(){this.container.style.display="block";this.container.style.opacity=1;this.log("visible",{ri:this.reqId,sd:this.sesData,ui:this.userData,pi:this.videoData.id,pt:"video",li:this.listId});if(TRC.Browser.ie){this.container.style.marginLeft=((this.container.parentNode.offsetWidth-this.container.clientWidth)/2)+"px"}};a.prototype.hideNextUp=function(){this.container.style.display="none";this.container.style.opacity=0};a.prototype.animValueSet=function(g,h,f,d){switch(d){case"size":g[h]=f+"px";break;case"opacity":g.filter="alpha(opacity="+(f+100)+")";g[h]=f;break;default:g[h]=f}},a.prototype.animCall=function(i,g,h,d,l,j){if(typeof j=="undefined"){j="size"}var m=parseInt(g/this.animationDelay);var k=parseFloat(h[d]);var f=(i-k)/m*5;this.animValueSet(h,d,k+f,j);if(g-this.animationDelay>0){c.setTimeout(arguments.callee.trcBind(this,i,g-this.animationDelay,h,d),this.animationDelay)}else{this.animValueSet(h,d,i,j);if(typeof l=="function"){l()}}};a.prototype.showCountdown=function(){var g=this.countdownBox.parentNode;var d=Math.max(g.clientWidth,g.offsetWidth);this.countdownBox.style.display="inline";var f=Math.max(g.clientWidth,g.offsetWidth);g.style.width=d+"px";this.animCall(f,750,g.style,"width")};a.prototype.hideCountdown=function(){this.countdownBox.style.display="none";this.countdownBox.parentNode.style.width="auto"};a.prototype.checkContainerVisibility=function(){if(this.autoPlayContainer.playerbox.offsetTop>=this.getScreenPosition()){return true}return false};a.prototype.createPlayer=function(){if(!this.lightbox){return}if(typeof this.autoPlayContainer.playerbox!="undefined"){while(this.autoPlayContainer.playerbox.childNodes.length>0){this.autoPlayContainer.playerbox.removeChild(this.autoPlayContainer.playerbox.firstChild)}}this.autoPlayContainer.createEmbedIframe(this.rbox,this.autoPlayContainer.playerbox,this.videoData);if(typeof this.autoPlayContainer.setTitle=="function"){this.autoPlayContainer.setTitle(this.videoData.title)}};a.prototype.close=function(){if(this.videoDoneHandler){this.videoDoneHandler.remove()}if(typeof this.videoData.lightboxClosed=="function"){this.videoData.lightboxClosed()}};a.prototype.render=function(d){if(!this.active){return}this.isRender=true;this.getPlaylistItem("s");this.videoDoneHandler=TRC.listen("videoDone",this.videoDone.trcBind(this));d.appendChild(this.container);this.container.className="trc_autoplaylist-box";this.container.style.display="none";this.container.appendChild(this.genHeader());this.container.appendChild(this.playlistItemBox);var f=b.createElement("div");f.style.clear="both";this.container.appendChild(f);this.container.onmouseover=(function(){this.log("explore",{ri:this.reqId,sd:this.sesData,ui:this.userData,pi:this.videoData.id,pt:"video",li:this.listId})}).trcBind(this);if(this.playlistRecommendation!=null){this.showNextUp()}};a.prototype.genPlaylistURL=function(g,h){var f={};f.autoplaylist={placement:"autoplaylist",origin:this.listId.replace(/^rbox-/,""),"list-size":1,"item-id":this.videoData.id};if(g){f.autoplaylist["intent"]=g}var d=this.rbox.trc.formatTRCRequest(f,"video");d.cb=this.rbox.trc.genCallback(h);return"http://"+this.rbox.domain+"/"+this.publisher+"/trc/3/json?tim="+encodeURIComponent(__trcClientTimestamp())+"&"+encodeURIComponent(__trcJSONify(d))+TRC.pageManager.additionalDispatchParams()};a.prototype.getPlaylistItem=function(f){if(!this.lightbox){c.setTimeout(this.getPlaylistItemFromRBox.trcBind(this),0);return}var d=this.genPlaylistURL(f,(function(g){if(!g||!g.trc||!g.trc.vl||!g.trc.vl.length||!g.trc.vl[0].v){this.hideNextUp();return}this.reqId=g.trc.vl[0]["req"];this.sesData=g.trc.sd;this.userData=g.trc.ui;TRC.pageManager.storePublisherValue(this.publisher,"session-data",this.sesData);TRC.pageManager.storeValue("user-id",this.userData);var h=g.trc.vl[0].v;this.playlistRecommendation=h.length?h[0]:h;this.playlistItemBox.appendChild(this.drawVideoBox(this.playlistRecommendation));if(this.countdownBox){this.showNextUp()}}).trcBind(this));this.rbox.trc.loadExternal(d,"js",function(){if(!this.playlistRecommendation){this.hideNextUp()}})};a.prototype.getPlaylistItemFromRBox=function(g){if(this.playlistItemBox.firstChild!=null){this.playlistItemBox.removeChild(this.playlistItemBox.firstChild)}var d=0;for(var f=0;f<this.rbox.recommendationList.length-1;f++){if(this.rbox.recommendationList[f].type=="video"&&this.rbox.recommendationList[f]!=this.playlistRecommendation){d=f;break}}this.playlistRecommendation=this.rbox.recommendationList[d];this.playlistItemBox.appendChild(this.drawVideoBox(this.playlistRecommendation))};a.prototype.genBlock=function(f,d,g){var h=b.createElement(d?d:"div");for(p in f){if(typeof f[p]=="string"){h[p]=f[p]}else{if(typeof f[p]=="object"){for(p1 in f[p]){h[p][p1]=f[p][p1]}}}}if(typeof g=="string"){h.appendChild(b.createTextNode(g))}return h};a.prototype.drawVideoBox=function(g){var f=this.genBlock({className:"videobox nextup"});var d=this.genBlock({className:"thumbblock",style:{cssFloat:"left",styleFloat:"left",display:"block"}},"span");f.appendChild(d);d.appendChild(this.genBlock({className:"thumbnail",style:{height:"29px",width:"39px",display:"block",backgroundImage:"url('"+g.thumbnail+"')"}},"span"));d.appendChild(this.genBlock({className:"thumbnail-overlay",style:{height:"29px",width:"39px",display:"block",marginTop:"-29px"}},"span"));var h=this.genBlock({style:{display:"block"},className:"video-label-box"},"span");f.appendChild(h);h.appendChild(this.genBlock({className:"video-label video-title"},"span",g.title));f.onclick=(function(i){this.log("click",{ri:this.reqId,sd:this.sesData,ui:this.userData,pi:this.videoData.id,pt:"video",li:this.listId});this.activateNextUp("s",i)}).trcBind(this);return f};a.prototype.genHeader=function(){var d=b.createElement("span");d.className="trc-next-up-header";d.appendChild(b.createTextNode(this.gt.gettext("Next Up:")+" "));this.countdownBox=b.createElement("span");d.appendChild(this.countdownBox);this.countdownBox.className="trc-next-up-countdown";this.counterBox=b.createElement("span");this.countdownBox.appendChild(this.counterBox);this.countdownBox.style.display="none";return d};a.prototype.log=function(f,i,l){var k=f+":"+i.li+i.ii+i.ri;if(!this.ev){this.ev={}}if(this.ev[k]){this.ev[k]++;return}this.ev[k]=1;try{var d="http://"+this.rbox.domain+"/"+this.rbox.trc["normalize-log-param"]("publisher",this.publisher)+"/log/3/"+encodeURIComponent(f)+"?";for(name in i){var g=name.charAt(0)=="_"?name.substr(1):name;if(typeof i[name]!="undefined"&&i[name]!=null){this.rbox.trc["normalize-log-param"](g,i[name]);d+=encodeURIComponent(g)+"="+encodeURIComponent(i[name])+"&"}}d+="id="+parseInt(Math.random()*10000);var j=new Image();j.src=d+"&url="+encodeURIComponent("http://cdn.taboolasyndication.com/pixel.gif")}catch(h){__trcError("Error in sending auto playlist event",h)}}})(window,document);(function(c,b){var a=function(){this.dom=b.getElementById?1:false;if(this.dom){if(b.importNode?true:false){this.dom=2}if(b.normalizeDocument?true:false){this.dom=3}}var f=this.opera=c.opera?9:false;if(this.opera){if(navigator.geolocation?true:false){this.opera=10}if(c.opera.version?true:false){this.opera=parseFloat(c.opera.version())}}this.ie=(function(){if(typeof b.all!="object"||f){return false}if(b.compatMode!="CSS1Compat"){return 6}if(!c.XMLHttpRequest){return 6}if(!Object.defineProperty){return 7}if(typeof DOMImplementation!="object"||typeof DOMImplementation.prototype.createDocument!="function"){return 8}if(!c.msMatchMedia){return 9}return 10})();this.webkit=(c.openDatabase?true:false)&&!this.opera;this.chrome=this.webkit&&c.chrome?true:false;this.safari=this.webkit&&!this.chrome;if(this.safari){if(b.compareDocumentPosition?true:false){this.safari=4}if(navigator.registerContentHandler?true:false){this.safari=5}if(c.matchMedia?true:false){this.safari=6}}this.firefox=typeof Components!="undefined";if(this.firefox){try{if(typeof b.createElement("canvas").getContext=="function"){this.firefox=1.5}}catch(h){}if(typeof c.globalStorage=="object"){this.firefox=2}if(b.elementFromPoint?true:false){this.firefox=3}if(b.querySelector?true:false){this.firefox=3.5}if(b.getElementsByTagName("head")[0].mozMatchesSelector?true:false){this.firefox=3.6}if(c.Uint8Array?true:false){this.firefox=4}if(Function.prototype.isGenerator?true:false){this.firefox=5}if(c.matchMedia?true:false){this.firefox=6}if(c.FileReader&&c.FileReader.prototype.readAsArrayBuffer?true:false){this.firefox=7}if(b.head&&b.head.insertAdjacentHTML?true:false){this.firefox=8}}var d=["firefox","chrome","safari","webkit","khtml","ie","opera"];for(var g=0;g<d.length;g++){(function(j,i){j[i+"Upto"]=function(k){return this[i]&&(typeof this[i]!="number"||this[i]<=k)};j[i+"Atleast"]=function(k){return this[i]&&(typeof this[i]!="number"||this[i]>=k)}})(this,d[g])}return this};TRC.Browser=new a()})(window,document);(function(g,f){var a=[],b=null,c=null;function d(j){try{if(TRC.dom.isReady){return}TRC.dom.isReady=true;if(!j){if(TRC.Browser.firefox||TRC.Browser.opera||TRC.Browser.webkit){f.removeEventListener("DOMContentLoaded",arguments.callee,false)}else{if(TRC.Browser.ie){if(c){f.detachEvent("onreadystatechange",c)}}else{if(TRC.Browser.safari){if(b){clearInterval(b)}}}}}TRC.dom.onReady=function(i){i()};for(var h=0;h<a.length;h++){a[h]()}}catch(k){__trcError("Error in DOMReady processing",k)}}TRC.dom={isReady:false,onReady:function(i,h){if(h){g.setTimeout(i,10);return}a.push(i)},init:function(){if(f.readyState&&/loaded|complete/.test(f.readyState)){d(true);return}if(TRC.Browser.firefox||TRC.Browser.opera||TRC.Browser.webkit){f.addEventListener("DOMContentLoaded",d,false)}else{if(TRC.Browser.ie){var h=f.createElement("div");(function(){try{h.doScroll("left")}catch(j){h.to=g.setTimeout(arguments.callee,10);return}d()})();f.attachEvent("onreadystatechange",c=function(){if(/loaded|complete/.test(f.readyState)){g.clearTimeout(h.to);d()}})}}if(TRC.Browser.safari){b=setInterval(function(){if(/loaded|complete/.test(f.readyState)){d()}},10)}var i=g.onload;g.onload=function(){d();if(i){try{i()}catch(j){}}}},on:(function(){if(g.addEventListener){return function(i,j,h){i.addEventListener(j,h,false)}}if(g.attachEvent){return function(i,j,h){i.attachEvent("on"+j,h)}}el["on"+sType]=fn}()),isAncestor:function(h,j,i){j=i?j:j.parentNode;while(j!==h&&j.nodeType!=9){j=j.parentNode}return h===j},injectStyle:function(k){if(TRC.Browser.ieUpto(8)){var h=f.createElement("style");h.setAttribute("type","text/css");f.head.appendChild(h);h.styleSheet.cssText=k;return}var j=f.createElement("div");j.innerHTML="<div><style>"+k+"</style></div>";var i=j.childNodes[0];f.body.appendChild(i)},injectStyleOverflowFix:function(o){if(!TRC.Browser.ie){return}var j=document.getElementById("trc_rbox_css_loaded");if(j==null){j=document.createElement("div");j.id="trc_rbox_css_loaded";f.body.appendChild(j)}if(document.trcGetCurrentStyle(j,"overflow")!="hidden"){var h=o.split("}");var n=null;try{for(var k=0;k<document.styleSheets.length;k++){var m=document.styleSheets[k];if((h.length+m.rules.length)<=4096){n=m;break}}if(n!=null){n.cssText+=o}}catch(l){__trcError("Error in injectStyleOverflowFix processing",l)}}}}})(window,document);(function(i,h){var b,a,f={},d=0;function g(j){if(typeof f[j]=="undefined"){f[j]=[]}}function c(j,k){g(j);f[j].forEach(function(l,m){if(k==l.id){f[j].splice(m,1);return}})}TRC.listen=function(k,j){if(typeof k=="object"&&k.length){k.forEach(function(m){TRC.listen(m,j)});return null}g(k);var l={id:d++,handler:j,eventName:k,remove:function(){c(this.eventName,this.id)}};f[k].push(l);return l};TRC.dispatch=function(j,l){g(j);var k=b(j,l);f[j].forEach((function(m){a((function(){m.handler.call(this,k)}).trcBind(this))}).trcBind(this))};if(h.addEventListener&&h.dispatchEvent){h.addEventListener("trcFakeEvents",function(j){j.cx()},false);b=function(j,l){var k=h.createEvent("Event");k.initEvent(j,false,false);if(typeof l=="object"){__trcCopyProps(l,k)}else{k.data=l}return k};a=function(k){var j=b("trcFakeEvents");j.cx=k;h.dispatchEvent(j)};return}h.documentElement.attachEvent("onpropertychange",function(j){if(j.propertyName=="trcFakeEvents"){j.cx()}});b=function(j,l){var k;if(l&&l.generator&&l.generator==="ceo"){l.type=j;return l}k=h.createEventObject();k.generator="ceo";k.type=j;if(typeof l=="object"){__trcCopyProps(l,k)}else{k.data=l}return k};a=function(k){var j=b("trcFakeEvents");j.cx=k;j.propertyName="trcFakeEvents";h.documentElement.fireEvent("onpropertychange",j)}})(window,document);function __trcCopyProps(b,a){for(prop in b){a[prop]=b[prop]}return a}function __trcFromError(a){if(TRC.Browser.ie){return a.message+"["+a.number+": "+a.name+"]"}if(a.message){return a.message+(a.fileName?a.fileName+":"+a.lineNumber:"")}return a}function __trcClientTimestamp(){var d=new Date();var a=d.getHours();var c=d.getMinutes();var b=d.getSeconds()+d.getMilliseconds()/1000;return(a<10?"0":"")+a+":"+(c<10?"0":"")+c+":"+(b<10?"0":"")+b.toFixed(3)}function __trcLog(g,f){if(window.trc_debug_level<g){return}var a=Array.prototype.slice.call(arguments,2);if(a.length>0){f+="("+a.join(",")+")"}if(typeof window.console=="object"){console.log(f)}var b=(function(){switch(g){case 0:return"error";case 1:return"warn";case 2:return"info";case 3:return"debug";default:return}})();var d=window.TRCImpl?window.TRCImpl["normalize-log-param"]:function(i,h){return h};if(document.cookie.search("taboola-debug")>0||g<=window.trc_debug_level){var c=d("publisher",TRC.publisherId);(window.trc_last_log=new Image()).src="http://"+(window.TRCImpl?window.TRCImpl.domain:"urc.taboolasyndication.com")+"/"+c+"/log/2/debug?tim="+escape(__trcClientTimestamp())+"&type="+escape(b)+"&msg="+escape(f)+((window.trc_debug_level>1)?("&llvl="+window.trc_debug_level):"")+"&id="+Math.floor(Math.random()*10000)+"&url="+escape("http://cdn.taboolasyndication.com/pixel.gif")}}function __trcError(b,a){__trcLog(0,b+(a?": "+__trcFromError(a):""));if(a&&a.stack&&(typeof window.console!="undefined")&&console.trace){console.trace()}}function __trcDebug(){var a=Array.prototype.slice.call(arguments);a.unshift(3);__trcLog.apply(null,a)}function __trcInfo(){var a=Array.prototype.slice.call(arguments);a.unshift(2);__trcLog.apply(null,a)}function __trcWarn(){var a=Array.prototype.slice.call(arguments);a.unshift(1);__trcLog.apply(null,a)}function __trcDOMWalker(b,a){a(b);b=b.firstChild;while(b){arguments.callee(b,a);b=b.nextSibling}}function __trcPurgeEventHandlers(a){try{__trcDOMWalker(a,function(c){for(var d in c){if(typeof c[d]==="function"){c[d]=null}}})}catch(b){}}function __trcJSONify(c){function d(f){return'"'+f.replace(/[\s\S]/g,function(g){switch(g){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}return g})+'"'}function a(f){var g=[];for(var h=0;h<f.length;h++){g[h]=__trcJSONify(f[h])}return g}function b(h){var f=[];for(var g in h){if(h.hasOwnProperty(g)){f.push(d(g)+":"+__trcJSONify(h[g]))}}return f}if(c instanceof Array){return"["+a(c).join(",")+"]"}if(c instanceof Object){return"{"+b(c).join(",")+"}"}if(c===null){return"null"}if(typeof c=="string"){return d(c)}if(typeof c=="undefined"){return"undefined"}return c.toString()}function __trcUnJSONify(text){try{return eval("("+String(text)+")")}catch(e){throw new Error("JSON parse error - invalid input!")}}function __trcGetMargins(c){var a=parseInt(document.trcGetCurrentStyle(c,"margin-bottom"));var b=parseInt(document.trcGetCurrentStyle(c,"margin-top"));return(isNaN(b)?0:b)+(isNaN(a)?0:a)}if(typeof window.location.getParameter=="undefined"){window.location.getParameter=function(a){var d=this.search.substr(1).split(/&/);for(var b=0;b<d.length;b++){var c=d[b].split(new RegExp("="),2);if(unescape(c[0])==a){return unescape(c[1])}}return null}}if(typeof Array.prototype.push=="undefined"){Array.prototype.push=function(){for(var a=0;a<arguments.length;a++){this[this.length]=arguments[a]}}}if(typeof Array.prototype.indexOf=="undefined"){Array.prototype.indexOf=function(b,c){if(typeof c!="number"){c=0}for(var a=c;a<this.length;a++){if(this[a]==b){return a}}return -1}}if(typeof Array.prototype.forEach=="undefined"){Array.prototype.forEach=function(b){var a=this.length;if(typeof b!="function"){throw new TypeError()}var d=arguments[1];for(var c=0;c<a;c++){if(!(c in this)){continue}b.call(d,this[c],c,this)}}}function __trcAttachResize(b,a){if(TRC.Browser.ie){b.attachEvent("onresize",a)}else{if(typeof b.resizeInt!="object"){b.resizeInt={}}b.resizeInt[a]=window.setInterval(function(c){if(typeof c.sourceWidth=="undefined"||typeof c.sourceHeight=="undefined"){c.sourceWidth=c.clientWidth;c.sourceHeight=c.clientHeight;return}if(c.sourceWidth!=c.clientWidth||c.sourceHeight!=c.clientHeight){delete c.sourceWidth;delete c.clientWidth;a.apply(c);return}},250,b)}}function __trcDetachResize(c,a){if(TRC.Browser.ie){c.detachEvent("onresize",a)}else{if(typeof c.resizeInt!="object"){c.resizeInt={}}try{if(c.resizeInt[a]){window.clearInterval(c.resizeInt[a])}delete c.resizeInt[a]}catch(b){}}}if(typeof document.getElementsByClassName=="undefined"){document.getElementsByClassName=function(g){var b=[];elms=document.getElementsByTagName("*");var f=g.split(/ +/);elmloop:for(var d=0;d<elms.length;d++){var c=elms[d].className.split(/ +/);for(var a=0;a<f.length;a++){if(c.indexOf(f[a])<0){continue elmloop}}b.push(elms[d])}return b}}if(typeof document.trcGetCurrentStyle=="undefined"){document.trcGetCurrentStyle=function(b,a,c){if(typeof b=="string"){b=document.getElementById(b)}if(TRC.Browser.ie){a=a.replace(/-(\w)/,function(f,d){return d.toUpperCase()});return b.currentStyle[a]}if(window.getComputedStyle){return document.defaultView.getComputedStyle(b,c).getPropertyValue(a)}return null}}if(typeof document.trcGetParentByClassName=="undefined"){document.trcGetParentByClassName=function(b,a){if(!b){return null}if(b.className.split(/\s+/).indexOf(a)>=0){return b}return document.trcGetParentByClassName(b.parentNode,a)}}function __trcGetElementsByClass(f,b,g){var a=[],j=new RegExp("(^|\\s)"+f+"(\\s|$)"),h,c,d;g=g||document;b=b||"*";h=g.getElementsByTagName(b);c=h.length;for(d=0;d<c;d++){if(!!j.test(h[d].className)){a.push(h[d])}}return a}if(typeof Function.prototype.trcBind=="undefined"){Function.prototype.trcBind=function(b){var c=this;var a=Array.prototype.slice.call(arguments,1);return function(){var d=a.concat(Array.prototype.slice.call(arguments,0));return c.apply(b,d)}}}if(typeof document.head=="undefined"){document.head=document.getElementsByTagName("head")[0]}(function(win,doc){var GoogleAds=TRC.GoogleAds=function(rbox,slot,channel,clientId){this.rbox=rbox;this.channel=channel;this.slot=slot;this.clientId=clientId||"ca-pub-8313336773978288";this.gamInWrapper=true;return this};GoogleAds.prototype.draw=function(cont_size,gam_size,reserve_header,vertical){try{if(!gam_size||gam_size.length!=2||!cont_size||cont_size.length!=2){__trcError("Invalid GAM size and Container size!");return}var wrap=this.rbox.getMainBox();var gam=doc.createElement("div");gam.className="gam_wrapper";with(gam.style){if(vertical){clear="right"}else{cssFloat="right";styleFloat="right"}if(TRC.Browser.ieUpto(6)){for(var elm=this.rbox.getMainBox().firstChild;elm!=null;elm=elm.nextSibling){if(elm.className.search("outer")>=0){elm.styleFloat="left"}}}width=cont_size[0]+"px";height=(reserve_header+cont_size[1])+"px"}if(reserve_header){gam.appendChild(doc.createElement("div"));gam.firstChild.style.height=reserve_header+"px";gam.firstChild.className="gam_header"}var container=doc.createElement("div");container.className="gam_container";with(container.style){height=cont_size[1]+"px"}gam.appendChild(container);if(vertical){if(this.gamInWrapper){wrap.insertBefore(gam,wrap.childNodes[wrap.childNodes.length-1])}else{wrap.parentNode.insertBefore(gam,wrap.nextSibling)}}else{if(this.gamInWrapper){wrap.insertBefore(gam,wrap.firstChild)}else{wrap.parentNode.insertBefore(gam,wrap)}}this.genAdBox(container,cont_size,gam_size)}catch(e){__trcError("Error in GoogleAds.draw",e);return}};GoogleAds.prototype.genAdBox=function(container,cont_size,gam_size){try{if(!!this.rbox.trc.getProperty(this.rbox.mode_name,"gam-allow-trc-ads")&&this.checkTRCAdSize(cont_size[0],cont_size[1])&&this.getTRCAdBox(container)){__trcInfo("GoogleAds.genAdBox: displaying a trc ad in the box");return}this.getGoogleAdBox(container,gam_size)}catch(e){__trcError("Error in GoogleAds.genAdBox",e)}};GoogleAds.prototype.checkTRCAdSize=function(w,h){for(var i=0;i<this.rbox.boxes.length;i++){var box=this.rbox.boxes[i];if(box.parentNode==null){continue}if(box.clientWidth>0&&box.clientHeight>0){return box.clientWidth<=w&&box.clientHeight<=h}}return false};GoogleAds.prototype.sendEvent=function(){this.rbox.sendEvent("display",{ii:"-1",it:"text-ad"})};GoogleAds.prototype.getTRCAdBox=function(container){for(var i=0;i<this.rbox.boxes.length;i++){if(!this.rbox.boxes[i].video_data.isAd){continue}var box=this.rbox.boxes.splice(i,1)[0];if(box.parentNode){box.parentNode.removeChild(box);if(this.rbox.trc.getProperty(this.rbox.mode_name,"navigation-type")=="paging"){this.rbox.drawPager()}}container.appendChild(box);return true}return false};GoogleAds.prototype.getGoogleAdBox=function(container,gam_size){__trcInfo("Enter GoogleAds.getGoogleAdBox");try{var igam=doc.createElement("iframe");with(igam.style){width=gam_size[0]+"px";height=gam_size[1]+"px";border=0}igam.scrolling="no";var ieDomainWorkaround=TRC.Browser.ie&&(doc.domain!=win.location.hostname);if(ieDomainWorkaround){__trcInfo("Within GoogleAds.getGoogleAdBox: use IE domain workaround");igam.src='javascript:"<script>window.onload=function(){document.write(\\"<script>document.domain=\''+doc.domain+'\';<\\"+\\"/script>\\");document.close();};<\/script>"'}container.appendChild(igam);var displayad=function(){__trcInfo("Called GoogleAds.getGoogleAdBox.displayad");var idoc=igam.contentDocument?igam.contentDocument:igam.contentWindow.document;idoc.write("<html><head><style>BODY,IFRAME{border:0;margin:0;padding:0;}</style></head><body><script>"+(doc.domain!=win.location.hostname?('document.domain="'+doc.domain+'";'):"")+'google_ad_client="'+this.clientId+'";google_ad_slot="'+this.slot+'";'+(this.channel?("google_ad_channel="+this.channel+";"):"")+"google_ad_width="+gam_size[0]+";google_ad_height="+gam_size[1]+';google_enable_async=false;<\/script><script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript"><\/script></body></html>');win.setTimeout(function(){__trcInfo("Called GoogleAds.getGoogleAdBox.idoc.close");try{idoc.close()}catch(e){__trcError("Exit GoogleAds.getGoogleAdBox: error in idoc.close",e)}},TRC.Browser.ie?3000:0)};if(ieDomainWorkaround){win.setTimeout(displayad.trcBind(this),1000)}else{displayad.call(this)}this.sendEvent()}catch(e){__trcError("Exit GoogleAds.getGoogleAdBox: got an error",e);return}__trcInfo("Exit GoogleAds.getGoogleAdBox: success")}})(window,document);(function(b,a){TRC.implClasses=TRC.implClasses||{};var c=TRC.implClasses.GoogleAd=function(d,f,g){this.options=f;this.trc=g;this.element=null;this.internalc=null;this.id=Math.floor(Math.random()*100000);return this};c.prototype.render=function(f){while(f.firstChild!=null){f.removeChild(f.firstChild)}this.element=a.createElement("div");this.element.id="gad_wrapper_"+this.id;this.element.className="trc_rbox "+this.options.mode_name;this.element.style.overflow="hidden";this.element.style.display="block";f.appendChild(this.element);var d=this.trc.getProperty(this.options.mode_name,"component-id");var g=a.createElement("div");g.id=d;g.className="trc_rbox_div trc_rbox_border_elm";g.style.overflowX="hidden";g.style.overflowY="hidden";this.element.appendChild(g);this.internalc=g;this.trc.log1("available",{pi:this.trc.getItemId(),pt:this.trc.getItemType(),li:d},true,this.element.id)};c.prototype.getListId=function(){return""};c.prototype.getContainer=function(){return this.element.parentNode};c.prototype.getMainBox=function(){return this.internalc};c.prototype.load=function(d){b.setTimeout(this.drawAd.trcBind(this),0)};c.prototype.drawAd=function(){this.trc.getFunction(this.options.mode_name,"list-suffix",this.internalc,this)};c.prototype.sendEvent=function(d,g){var f={pi:this.trc.getItemId(),pt:this.trc.getItemType(),li:this.options.mode_name};if(!!this.options.response&&!!this.options.response.trc){f.ri=this.options.response.trc.req;f.sd=TRC.pageManager.getPublisherValue(TRC.publisherId,"session-data");f.ui=TRC.pageManager.getValue("user-id")}__trcCopyProps(g,f);this.trc.logTrcEvent(d,f)}})(window,document);(function(win,doc){var LightBoxManager=TRC.LightBoxManager=function(displayTitle,originEvent,listId,direction,fps){this.animationLength=300;this.fps=typeof fps=="number"?fps:(TRC.Browser.firefoxUpto(3.5)?20:45);this.listId=listId;this.direction=typeof direction!="undefined"?direction:"ltr";this.origCoords=[0,0];this.cover=null;this.lightbox_container=null;this.whitebox=null;this.whitebox_header=null;this.playerbox=null;this.playerContainer=null;this.animationLoop=null;this.animationEvents=[];this.whiteboxSizeHandler=null;this.position_fixed_works=false;this.player_width=0;this.player_height=0;this.scalingLock=false;this.additionalElements={};this.displayTitle=displayTitle;this.elementsHaveBeenAdded=false;if(originEvent&&typeof originEvent.clientX=="number"){this.origCoords=[originEvent.clientX,originEvent.clientY]}else{this.origCoords=[this.getScreenWidth()/2,100]}if(TRC.Browser.ie){var zoom=this.GetZoomFactor();this.origCoords=[Math.round((this.origCoords[0]-doc.documentElement.clientLeft)/zoom),Math.round((this.origCoords[1]-doc.documentElement.clientTop)/zoom),]}this.createLightbox();this.lightbox_container.style.cursor="wait";return this};LightBoxManager.prototype.GetZoomFactor=function(){if(!doc.body.getBoundingClientRect){return 1}var rect=doc.body.getBoundingClientRect();var physicalW=rect.right-rect.left;var logicalW=doc.body.offsetWidth;return Math.round((physicalW/logicalW)*100)/100};LightBoxManager.prototype.addElements=function(elms){if(typeof elms!="object"){elms={bottom:elms}}for(p in elms){if(!this.additionalElements[p]){this.additionalElements[p]=[]}this.additionalElements[p].push(elms[p])}};LightBoxManager.prototype.createEmbedIframe=function(box,container,recomendation){var global_prefix="";if(box.syndicator){global_prefix=box.syndicator+"-"}var publisherJSsrc=TRC.baseDomain+"publisher."+box.trc.version+".js";var rec={};__trcCopyProps(recomendation,rec);rec.prefix=global_prefix;delete rec.link;try{var igam=doc.createElement("iframe");igam.frameBorder=igam.border="0";igam.scrolling="no";igam.id="_trcLightIframeObj";var ieDomainWorkaround=TRC.Browser.ie&&(doc.domain!=win.location.hostname);if(ieDomainWorkaround){igam.src='javascript:"<script>window.onload=function(){document.write(\\"<script>document.domain=\''+doc.domain+'\';<\\"+\\"/script>\\");document.close();};<\/script>"'}container.appendChild(igam);var idoc=igam.contentDocument?igam.contentDocument:igam.contentWindow.document;idoc.write('<html><head><style>BODY,IFRAME{border:0;margin:0;padding:0;}</style><script type="text/javascript" src="'+publisherJSsrc+'" charset="UTF-8"><\/script></head><body><script>'+(doc.domain!=win.location.hostname?('document.domain="'+doc.domain+'";'):"")+"var recomendation = "+__trcJSONify(rec)+';var embed_loaded = false;<\/script><div id="embed-code-container"></div><script>var loadPlayer = function(){if(window.trc_properties && trc_properties.global["syndication-embed-code"]){var parent_iframe = window.parent.document.getElementById("_trcLightIframeObj");var cont = document.getElementById("embed-code-container");if(!window.embed_loaded){var affiliate = (typeof trc_properties.global["syndicator-affiliate-id"] != "undefined")?trc_properties.global["syndicator-affiliate-id"]:null;embed_code = trc_properties.global[recomendation["prefix"] + "syndication-embed-code"];if(typeof embed_code == "function"){embed_code(cont,recomendation,affiliate);window.embed_loaded = true;}}var obj = cont.getElementsByTagName("object")[0];if(parent_iframe!=null && obj!=null){window.clearInterval(window.checkInt);parent_iframe.parentNode.style.width = parent_iframe.style.width =  Math.max(obj.offsetWidth, obj.width)+"px";parent_iframe.parentNode.style.height = parent_iframe.style.height = Math.max(obj.offsetHeight,obj.height)+"px";}}};window.checkInt = window.setInterval(loadPlayer,100);	<\/script></body></html>');win.setTimeout(function(){try{idoc.close()}catch(e){}},TRC.Browser.ie?3000:0)}catch(e){return}};LightBoxManager.prototype.renderElements=function(){this.elementsHaveBeenAdded=true;function addSubElement(position,e){var div=doc.createElement("div");switch(position){case"left":div.style.cssFloat=div.style.styleFloat="left";break;case"right":div.style.cssFloat=div.style.styleFloat="left";break}if(position=="bottom"){this.playerbox.parentNode.appendChild(div)}else{this.playerbox.parentNode.insertBefore(div,this.playerBox)}try{if(typeof e=="function"){e(div)}else{if(typeof e.render=="function"){e.render(div)}}}catch(e){__trcError("Error in lightbox sub-element rendering",e)}}if("top" in this.additionalElements){this.additionalElements.top.forEach(addSubElement.trcBind(this,"top"))}if("left" in this.additionalElements){this.additionalElements.left.forEach(addSubElement.trcBind(this,"left"))}if("right" in this.additionalElements){this.additionalElements.right.forEach(addSubElement.trcBind(this,"right"))}if("bottom" in this.additionalElements){this.additionalElements.bottom.forEach(addSubElement.trcBind(this,"bottom"))}};LightBoxManager.prototype.createLightbox=function(){var width=this.getScreenWidth();this.createCoverIframe();this.lightbox_container=doc.createElement("div");this.lightbox_container.style.width=width+"px";this.lightbox_container.style.position="absolute";this.lightbox_container.style.left="0px";this.lightbox_container.style.top="0px";this.lightbox_container.className="trc_lightbox_base trc_lightbox "+this.listId;this.lightbox_container.onclick=this.close.trcBind(this);var inner_div=doc.createElement("div");inner_div.style.display="block";inner_div.className="trc_lightbox_overlay";inner_div.style.width=width+"px";inner_div.style.left="0px";inner_div.style.top="0px";this.lightbox_container.appendChild(inner_div);inner_div=doc.createElement("div");inner_div.style.display="block";inner_div.className="trc_lightbox_transparent";inner_div.style.width=width+"px";inner_div.style.left="0px";inner_div.style.top="0px";this.lightbox_container.appendChild(inner_div);doc.body.appendChild(this.lightbox_container);this.whitebox=doc.createElement("div");this.whitebox.className="trc_whitebox";this.whitebox.style.visibility="hidden";this.whitebox.onclick=(function(e){if(!e){e=win.event}if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}});inner_div.appendChild(this.whitebox);this.playerbox=doc.createElement("div");this.playerbox.style.width="0px";this.playerContainer=doc.createElement("div");this.playerContainer.appendChild(this.playerbox);with(this.playerContainer.style){width="0px";height="0px";overflow="hidden"}this.whitebox.appendChild(this.playerContainer);with(inner_div.style){marginTop="30px";position="fixed"}this.position_fixed_works=(inner_div.offsetTop===30);if(!this.position_fixed_works){inner_div.style.position="absolute"}this.lightbox_container.style.height=this.lightbox_container.firstChild.style.height=this.getScreenHeight()+"px"};LightBoxManager.prototype.createCoverIframe=function(){this.cover=doc.createElement("iframe");with(this.cover.style){width=this.getScreenWidth()+"px";height=this.getScreenHeight()+"px";border=0}this.cover.scrolling="no";this.cover.className="trc_cover_iframe";doc.body.appendChild(this.cover)};LightBoxManager.prototype.createHeader=function(title_text,branding_url){var div=doc.createElement("div");div.id="trc_lightbox_header";div.style.display="none";if(typeof branding_url!="undefined"&&branding_url!=""){var branding_div=doc.createElement("div");branding_div.id="branding_div_lightbox";var branding_img=doc.createElement("img");branding_img.id="branding_img_lightbox";branding_img.src=branding_url;branding_div.style.styleFloat=branding_div.style.cssFloat=(this.direction=="ltr")?"right":"left";branding_img.style.display="none";branding_div.appendChild(branding_img);div.appendChild(branding_div)}var title_div=doc.createElement("div");if(this.displayTitle){title_div.innerHTML=title_text}else{title_div.innerHTML="";title_div.style.height="22px"}div.appendChild(title_div);div.titlebox=title_div;this.whitebox_header=div;this.whitebox.insertBefore(div,this.whitebox.firstChild)};LightBoxManager.prototype.setTitle=function(title_text){if(this.displayTitle){this.whitebox_header.titlebox.innerHTML=title_text}else{this.whitebox_header.titlebox.innerHTML=" "}};LightBoxManager.prototype.createLightboxCloseButton=function(){var closeButton=doc.createElement("div");closeButton.className="trc_whiteboxCloseButton";closeButton.innerHTML="x";closeButton.onclick=this.close.trcBind(this);this.whitebox.insertBefore(closeButton,this.whitebox.firstChild)};LightBoxManager.prototype.startAnimate=function(pips,onComplete){var doneHandler=function(){for(var i=0;i<pips.length;i++){if(!pips[i].done){return}}onComplete()};pips.forEach(function(it){it.elm=it[0];it.prop=it[1];it.cur=it[2];it.end=it[3];it.unit=it[4];it.dur=it[5];it.done=false;it.steps=Math.ceil(this.fps*it.dur/1000);it.stepSize=(it.end-it.cur)/it.steps;it.step=0;this.animationEvents.push((it.frameHandler=function(){this.cur+=this.stepSize;if(this.stepSize*(this.cur-this.end)>0){this.cur=this.end}switch(this.prop){case"opacity":this.elm[this.prop]=this.cur;this.elm.filter="alpha(opacity="+(this.cur*100)+")";break;default:this.elm[this.prop]=this.cur+this.unit}if(++this.step>this.steps){this.done=true;doneHandler();return true}return false}).trcBind(it))},this)};LightBoxManager.prototype.animationMainLoop=function(){this.animationEvents.forEach(function(it,i,ar){if(it==null){return}if(it()){ar[i]=null}})};LightBoxManager.prototype.getScreenWidth=function(){return doc.body.scrollWidth};LightBoxManager.prototype.getScreenHeight=function(){return Math.max(doc.body.scrollHeight,doc.documentElement.scrollHeight)};LightBoxManager.prototype.getLeftMargin=function(){return(this.getScreenWidth()-this.playerContainer.scrollWidth)/2};LightBoxManager.prototype.getScreenPosition=function(){return Math.max(doc.documentElement.scrollTop,doc.body.scrollTop)};LightBoxManager.prototype.fixSyndicatorLogo=function(){if(this.scalingLock){return}if(this.whitebox_header.style.display=="none"){return}var branding_img=this.whitebox_header.getElementsByTagName("img");if(branding_img.length>0){with(branding_img[0].style){height=this.whitebox_header.titlebox.scrollHeight+"px";width="auto";display="block"}}this.whitebox_header.style.width=this.player_width+"px"};LightBoxManager.prototype.animateOpening=function(){this.scalingLock=true;this.playerContainer.style.visibility="hidden";with(this.whitebox.style){width="10px";height="10px";marginLeft=(this.origCoords[0]-5)+"px";marginTop=(this.origCoords[1]-5)+"px";visibility="visible"}var playerW=this.playerContainer.scrollWidth;var playerH=this.playerContainer.scrollHeight;this.startAnimate([[this.whitebox.style,"width",10,playerW,"px",this.animationLength],[this.whitebox.style,"height",10,playerH,"px",this.animationLength],[this.whitebox.style,"marginLeft",this.origCoords[0]-5,this.getLeftMargin(),"px",this.animationLength],[this.whitebox.style,"marginTop",this.origCoords[1]-5,30,"px",this.animationLength]],(function(){this.createLightboxCloseButton();this.whitebox_header.style.display="block";this.scalingLock=false;this.player_width=playerW-0.2;this.player_height=playerH-0.2;this.playerContainer.style.visibility="visible";var top=document.body.scrollTop;if(TRC.Browser.webkit&&!TRC.Browser.chrome){document.body.scrollTop+=20}win.setTimeout(function(){document.body.scrollTop=top},1000)}).trcBind(this))};LightBoxManager.prototype.resizeWhitebox=function(){if(this.scalingLock){return}if(this.player_width==0){this.animateOpening();return}if(this.player_width<this.playerContainer.scrollWidth||this.player_height<this.playerContainer.scrollHeight){this.scalingLock=true;this.startAnimate([[this.playerContainer.style,"width",this.player_width,this.playerContainer.scrollWidth,"px",300],[this.playerContainer.style,"height",this.player_height,this.playerContainer.scrollHeight,"px",300],[this.whitebox.style,"width",this.player_width,this.playerContainer.scrollWidth,"px",300],[this.whitebox.style,"height",this.player_height+this.whitebox_header.clientHeight,this.playerContainer.scrollHeight+this.whitebox_header.clientHeight,"px",300]],(function(){this.scalingLock=false;if(!this.elementsHaveBeenAdded){this.renderElements()}}).trcBind(this));this.player_width=Math.max(this.player_width,this.playerContainer.scrollWidth);this.player_height=Math.max(this.player_height,this.playerContainer.scrollHeight)}};LightBoxManager.prototype.open=function(){TRC.pageManager.pushState();this.lightbox_container.style.cursor="auto";this.animationLoop=win.setInterval(this.animationMainLoop.trcBind(this),Math.floor(1000/this.fps));this.whiteboxSizeHandler=(function(){if(!(this.playerContainer.scrollHeight>0&&this.playerContainer.scrollWidth>0&&this.playerbox.style.width!="0px")){return false}this.lightbox_container.style.height=this.lightbox_container.firstChild.style.height=this.getScreenHeight()+"px";if(!this.position_fixed_works){this.whitebox.parentNode.style.top=(this.getScreenPosition()+30)+"px"}this.fixSyndicatorLogo();this.resizeWhitebox();return false}).trcBind(this);this.animationEvents.push(this.whiteboxSizeHandler);if(!this.position_fixed_works){doc.documentElement[TRC.Browser.ie?"attachEvent":"addEventListener"](TRC.Browser.ie?"onscroll":"scroll",this.whiteboxSizeHandler,false)}};LightBoxManager.prototype.close=function(){for(var p in this.additionalElements){this.additionalElements[p].forEach(function(e){if(typeof e=="object"&&typeof e.close=="function"){e.close()}})}win.setTimeout(this.realClose.trcBind(this),500)};LightBoxManager.prototype.realClose=function(){var currentMargin=this.getLeftMargin();var flashObjects=this.playerContainer.getElementsByTagName("object");for(var i=0;flashObjects&&i<flashObjects.length;i++){var tag=flashObjects[i];var closingContainer=doc.body.appendChild(doc.createElement("div"));closingContainer.style.display="none";tag.style.display="none";tag.parentNode.removeChild(tag);closingContainer.appendChild(tag);win.setTimeout(function(){tag.movie="//dummy";tag.parentNode.removeChild(tag);closingContainer.parentNode.removeChild(closingContainer)},250)}this.whitebox.removeChild(this.playerContainer);this.whitebox.removeChild(this.whitebox_header);if(!this.position_fixed_works&&this.whiteboxSizeHandler!=null){doc.documentElement[TRC.Browser.ie?"attachEvent":"addEventListener"](TRC.Browser.ie?"onscroll":"scroll",this.whiteboxSizeHandler,false)}this.startAnimate([[this.whitebox.style,"width",this.whitebox.clientWidth,0,"px",this.animationLength],[this.whitebox.style,"height",this.whitebox.clientHeight,0,"px",this.animationLength],[this.whitebox.style,"marginLeft",currentMargin,this.getScreenWidth()/2,"px",this.animationLength],[this.whitebox.style,"marginTop",30,this.whitebox.clientHeight/2,"px",this.animationLength],[this.whitebox.style,"opacity",1,0,"",this.animationLength]],(function(){doc.body.removeChild(this.lightbox_container);doc.body.removeChild(this.cover);win.clearInterval(this.animationLoop);this.animationLoop=null;TRC.pageManager.popState()}).trcBind(this));if(typeof win.trc_lightboxClose=="function"){win.trc_lightboxClose()}}})(window,document);(function(g,f){var d={source:"|v|h|c|t|s|p|video|home|category|text|search|photo|",target:"|v|p|t|m|video|photo|text|mix|"},a="v",c=function(i,h){i=i.toLowerCase();if(d[h].indexOf("|"+i+"|")!==-1){return i.substr(0,1)}__trcError('illegal parameter "'+i+'" was passed to trc_ListOriginBuilder method: "set'+h.substr(0,1).toUpperCase()+h.substr(1)+'" \nUsing "video" instead');return"v"};var b=TRC.ListOriginBuilder=function(h,i){this.setSource(h||a);this.setTarget(i||"v")};b.prototype.setSource=function(h){a=c(h,"source")};b.prototype.getSource=function(){return a};b.prototype.setTarget=function(h){this.target=c(h,"target")};b.prototype.getTarget=function(){return this.target};b.prototype.toString=function(){return(a+"2"+this.target).replace(/v2v/,"blended")}})(window,document);(function(c,b){var a={};TRC.net={loadScript:function(j,d,f,i){var h=b.getElementsByTagName("script")[0],g=null;if(d=="js"){g=b.createElement("script");g.type="text/javascript";g.src=j;g.charset="UTF-8";if(!!i){g.setAttribute("defer","defer")}}else{if(d=="css"){g=b.createElement("link");g.rel="stylesheet";g.type="text/css";g.href=j}else{throw new Error("External reference loaded must be of type 'js' or 'css'!")}}if(typeof f=="function"){if(TRC.Browser.ieUpto(8)){g.onreadystatechange=function(){if((g.readyState=="loaded")||(g.readyState=="complete")){f.apply(g)}}}else{g.addEventListener("load",f,false);g.addEventListener("error",f,false)}}h.parentNode.insertBefore(g,h);return g},checkLoadJsCssFile:function(g,d,f){var i=g.replace(new RegExp("^.*/([^/]+)$"),"$1");try{if(typeof a[i]=="undefined"){a[i]=TRC.net.loadScript(g,d,f);if(d=="css"){a.css=1}}else{if(typeof f=="function"){c.setTimeout(function(){f.apply(a[i])},0)}}return a[i]}catch(h){__trcError("Error trying to load "+g,h)}}}})(window,document);(function(g,E){g.TRC=g.TRC||{};var B;if(typeof Array.prototype.forEach=="undefined"){Array.prototype.forEach=function(G){var F=this.length;if(typeof G!="function"){throw new TypeError()}var I=arguments[1];for(var H=0;H<F;H++){if(!(H in this)){continue}G.call(I,this[H],H,this)}}}var t=0;var C="";var d=8;function n(F){return l(h(z(F),F.length*d))}function k(F){return r(h(z(F),F.length*d))}function f(F){return x(h(z(F),F.length*d))}function c(F,G){return l(i(F,G))}function j(F,G){return r(i(F,G))}function q(F,G){return x(i(F,G))}function a(){return n("abc")=="a9993e364706816aba3e25717850c26c9cd0d89d"}function h(S,M){S[M>>5]|=128<<(24-M%32);S[((M+64>>9)<<4)+15]=M;var T=Array(80);var R=1732584193;var Q=-271733879;var P=-1732584194;var O=271733878;var N=-1009589776;for(var J=0;J<S.length;J+=16){var L=R;var K=Q;var I=P;var H=O;var F=N;for(var G=0;G<80;G++){if(G<16){T[G]=S[J+G]}else{T[G]=s(T[G-3]^T[G-8]^T[G-14]^T[G-16],1)}var U=v(v(s(R,5),y(G,Q,P,O)),v(v(N,T[G]),o(G)));N=O;O=P;P=s(Q,30);Q=R;R=U}R=v(R,L);Q=v(Q,K);P=v(P,I);O=v(O,H);N=v(N,F)}return Array(R,Q,P,O,N)}function y(G,F,I,H){if(G<20){return(F&I)|((~F)&H)}if(G<40){return F^I^H}if(G<60){return(F&I)|(F&H)|(I&H)}return F^I^H}function o(F){return(F<20)?1518500249:(F<40)?1859775393:(F<60)?-1894007588:-899497514}function i(H,K){var J=z(H);if(J.length>16){J=h(J,H.length*d)}var F=Array(16),I=Array(16);for(var G=0;G<16;G++){F[G]=J[G]^909522486;I[G]=J[G]^1549556828}var L=h(F.concat(z(K)),512+K.length*d);return h(I.concat(L),512+160)}function v(F,I){var H=(F&65535)+(I&65535);var G=(F>>16)+(I>>16)+(H>>16);return(G<<16)|(H&65535)}function s(F,G){return(F<<G)|(F>>>(32-G))}function z(I){var H=Array();var F=(1<<d)-1;for(var G=0;G<I.length*d;G+=d){H[G>>5]|=(I.charCodeAt(G/d)&F)<<(32-d-G%32)}return H}function x(H){var I="";var F=(1<<d)-1;for(var G=0;G<H.length*32;G+=d){I+=String.fromCharCode((H[G>>5]>>>(32-d-G%32))&F)}return I}function l(H){var G=t?"0123456789ABCDEF":"0123456789abcdef";var I="";for(var F=0;F<H.length*4;F++){I+=G.charAt((H[F>>2]>>((3-F%4)*8+4))&15)+G.charAt((H[F>>2]>>((3-F%4)*8))&15)}return I}function r(I){var H="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var K="";for(var G=0;G<I.length*4;G+=3){var J=(((I[G>>2]>>8*(3-G%4))&255)<<16)|(((I[G+1>>2]>>8*(3-(G+1)%4))&255)<<8)|((I[G+2>>2]>>8*(3-(G+2)%4))&255);for(var F=0;F<4;F++){if(G*8+F*6>I.length*32){K+=C}else{K+=H.charAt((J>>6*(3-F))&63)}}}return K}function m(F){if(g.DOMParser){var G=new DOMParser();return G.parseFromString(F,"text/xml")}xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async=false;xmlDoc.validateOnParse=false;if(!xmlDoc.loadXML(F)){throw"XMLParsing failed"}return xmlDoc}function u(){var I="trc_cookie_storage";var M=new Object();var G=document.cookie.split(/;\s+/);for(var J=0;J<G.length;J++){var L=TRC.text.lsplit(G[J],"=",2);var N=unescape(L[0]),F=unescape(L[1]);if(N==I){var O=F.split("|");for(var H=0;H<O.length;H++){var L=O[H].split("=");M[unescape(L[0])]=unescape(L[1])}break}}function K(){var Q=new Array();for(var R in M){if(M.hasOwnProperty(R)&&M[R]!=null){Q[Q.length]=escape(R)+"="+escape(M[R])}}var P=new Date(new Date().getTime()+(365*86400000));document.cookie=I+"="+escape(Q.join("|"))+";path=/;expires="+P.toUTCString()}this.getValue=function(P){return M.hasOwnProperty(P)?M[P]:null};this.setValue=function(P,Q){M[P]=Q;K()};return this}function b(){var F={};this.getValue=function(G){return F[G]?F[G]:null};this.setValue=function(G,H){F[G]=H};return this}function w(){this.getValue=function(F){return g.localStorage.getItem(F)};this.setValue=function(F,G){try{g.localStorage.setItem(F,G)}catch(H){}};return this}var D=function(){this.publisher_id=null;this.item_id=null;this.page_id=null;this.state={};this.stateStack=[];this.getLocalStorageImplementation=function(){if(this.state.privateStorageImpl!=null){return this.state.privateStorageImpl}var F=g.TRCImpl?g.TRCImpl.global:{};var H=F["local-storage-usage"]?F["local-storage-usage"]:"prefer-w3c-storage";switch(H){case"prefer-w3c-storage":try{if(g.localStorage instanceof Storage){return this.state.privateStorageImpl=new w()}}catch(G){}case"prefer-cookies":try{document.cookie="trc;0";if(document.cookie.indexOf("trc;0")===-1){return this.state.privateStorageImpl=new u()}}catch(G){}default:return this.state.privateStorageImpl=new b()}};this.trcParseParams=function(I){if(!I||owner.item_id){return}var H=I.split("&");for(var F=0;F<H.length;F++){var G=TRC.text.lsplit(H[F],"=",2);switch(unescape(G[0])){case"item_id":owner.item_id=unescape(G[1]);break;case"publisher_id":owner.publisher_id=unescape(G[1]);break}}};this.trcGetPublisherParams=function(){var F=document.getElementsByTagName("script");for(var I=0;I<F.length;I++){var H=F[I].src.split("taboolasyndication.com/libtrc/")[1];if(H){if(F[I].src.search(/taboolasyndication.com.*page_management/)>=0){H=H.split("?")[0];var G=H.split("/");owner.page_id=G[0];if(G.length>2){owner.page_id+="/"+G[1]}owner.trcParseParams(F[I].src.split("?")[1])}}}};this.getPageData=function(){if(owner.page_id!=null){return owner.page_id}var F=Array.prototype.slice.call(arguments);if((F.length<2)&&(owner.page_id==null)){owner.trcGetPublisherParams();owner.page_id=n(g.location.href+owner.publisher_id+owner.item_id);return owner.page_id}if(F[1]!=null){owner.publisher_id=F[1]}if(F[0]!=null){owner.item_id=F[0];if(owner.page_id==null){owner.page_id=n(g.location.href+owner.publisher_id+owner.item_id)}return owner.page_id}return null};this.storeValue=function(F,G){this.storePublisherValue("taboola global",F,G)};this.getValue=function(F){return this.getPublisherValue("taboola global",F)};this.storePublisherValue=function(G,F,H){if(H==null||H==undefined){return}this.getLocalStorageImplementation().setValue(G+":"+F,H)};this.getPublisherValue=function(G,F){return this.getLocalStorageImplementation().getValue(G+":"+F)};this.sortByLength=function(G,F){return G.domain.lenth-F.domain.length};this.setDomainConfiguration=function(G){try{var L=m(G);if(L.documentElement.tagName!="domains"||L.getElementsByTagName("domain").length<1){throw"Invalid configuration document: "+G}var F=L.getElementsByTagName("domain");this.state.m_publisherDomains={host:[],path:[],query:[]};for(var H=0;H<F.length;H++){var I=F[H];var K=this.state.m_publisherDomains[I.getAttribute("type")];if(!(K instanceof Array)){throw"Invalid domain type in configuration: "+I.getAttribute("type")}K.push({domain:I.text?I.text:I.textContent,keep:I.getAttribute("keep")?true:false,staging:I.getAttribute("staging")?true:false})}}catch(J){this.state.m_publisherDomains={}}};this.matchOn=function(I,F,G){if(!I||I.length<1){return[]}if(I.matching){return I.matching.slice(0)}I.matching=[];for(var H=0;H<I.length;H++){if(F(G,I[H].domain)){I.matching.push(I[H])}}return I.matching.slice(0)};this.getMatchingHosts=function(){return this.matchOn(this.state.m_publisherDomains.host,function(F,G){return(F.slice(F.length-G.split(".").length).join(".")==G)},g.location.host.split("."))},this.getMatchingPaths=function(){return this.matchOn(this.state.m_publisherDomains.path,function(G,F){return(G.slice(0,F.split("/").length).join("/")==F)},g.location.pathname.split("/"))};this.getMatchingQuery=function(){return this.matchOn(this.state.m_publisherDomains.query,function(I,M){var L=M.split("&");for(var H=0;H<L.length;H++){var K=L[H].split("=");var J=false;for(var G=0;G<I.length;G++){var F=I[G].split("=");J=J||(unescape(K[0])==unescape(F[0])&&unescape(K[1])==unescape(F[1]))}if(!J){return false}}return true},g.location.search.replace(/^\?/,"").split("&"))};this.isEmbeddedView=function(){return this.state.m_publisherDomains.host&&this.state.m_publisherDomains.host.length&&this.getMatchingHosts().length<=0&&(g.location.host.search(/taboola\w*.com$/)<0)};this.isStagingView=function(){if(this.isEmbeddedView()){return false}return(function(){for(var F=0;F<arguments.length;F++){if((function(G){while(G.length>0){if(G.shift().staging){return true}}})(arguments[F])){return true}}return false})(this.getMatchingHosts(),this.getMatchingPaths(),this.getMatchingQuery())};this.fixRecommendationURL=function(G){function Q(S,Y){var X=S.substring(1).split("/").reverse();var W=Y.substring(1).split("/");var V="";for(var U=0;U<W.length&&U<X.length;U++){for(var T=0;T<X.length;T++){if(U-T<0){V="/"+W.slice(0,U+1).join("/");break}if(X[T]!=W[U-T]){break}}}return Y.substring(V.length)}function K(U){var S={};for(var T=0;T<U.length;T++){kv=TRC.text.lsplit(U[T],"=",2);S[kv[0]]=kv[1]}return S}var F;try{F=new TRC.URL(G)}catch(M){return G}var N=this.getMatchingHosts().sort(this.sortByLength);if(N.length<1){return G}while(N.length>0&&!N[0].keep){N.shift()}if(N.length>0){F.host=g.location.host}var R=this.getMatchingPaths().sort(this.sortByLength);while(R.length>0&&!R[0].keep){R.shift()}if(R.length>0){F.pathname=R[0].domain+Q(R[0].domain,F.pathname)}var L=this.getMatchingQuery();var I=F.search.replace(/^\?/,"").split("&");if(I[0]==""){I.shift()}for(var J=0;J<L.length;J++){var O=K(L[J].domain.split("&"));for(var J=0;J<I.length;J++){var P=TRC.text.lsplit(I[J],"=",2).shift();var H=O[P];if(typeof H!="undefined"){I[J]=P+"="+H;delete O[P]}}for(var P in O){I.push(P+"="+O[P])}}F.search=(I.length>0)?"?"+I.join("&"):"";return F.toString()};this.additionalDispatchParams=function(){if(this.state.moreDispatchParams==null){this.state.moreDispatchParams=this.getCurrentURL().filtered}if(this.state.moreDispatchParams.length==0){return""}return"&"+this.state.moreDispatchParams.join("&")};this.getCurrentURL=function(){var H=new TRC.URL(g.location.href);var I=[],G=[];H.search.replace(/^\?/,"").split(/&/).forEach(function(J){if(!J){return}if(J.search("trc_")==0||J=="taboola-debug"){G.push(J)}else{I.push(J)}});H.search=I.length>0?"?"+I.join("&"):"";var F=new String(H.toString());F.filtered=G;return F};this.initState=function(){if(typeof this.state=="undefined"){this.state={}}this.state.privateStorageImpl=null;this.state.m_publisherDomains={host:[],path:[],query:[]};this.state.moreDispatchParams=null};this.pushState=function(){this.stateStack.push(this.state);delete this.state;this.initState()};this.popState=function(){if(this.stateStack.length>0){this.state=this.stateStack.pop()}};this.initState();return this};D.getPageData=function(){var F=Array.prototype.slice.call(arguments);return B.getPageData.apply(null,F)};D.storeValue=function(F,G){return B.storeValue(F,G)};D.storePublisherValue=function(G,F,H){return B.storePublisherValue(G,F,H)};D.getValue=function(F){return B.getValue(F)};D.getPublisherValue=function(G,F){return B.getPublisherValue(G,F)};D.setDomainConfiguration=function(F){return B.setDomainConfiguration(F)};D.isEmbeddedView=function(){return B.isEmbeddedView()};D.isStagingView=function(){return B.isStagingView()};D.fixRecommendationURL=function(F){return B.fixRecommendationURL(F)};D.additionalDispatchParams=function(){return B.additionalDispatchParams()};D.getCurrentURL=function(){return B.getCurrentURL()};D.pushState=function(){return B.pushState()};D.popState=function(){return B.popState()};TRC.pageManager=B=TRC.pageManager||new D();g.PageManager=g.PageManager||D})(window,document);(function(f,d){var b=false;var c=false;var a=null;TRC.brightcove_support=function(){if(c||b){return}if(typeof APIModules=="undefined"){TRC.net.loadScript("http://admin.brightcove.com/js/APIModules_all.js","js",function(){TRC.brightcove_support()});return}var g=function(i){if(c){return}if(!f.TRCImpl){f.setTimeout(arguments.callee.trcBind(null,i),100);return}if(!(i in f.brightcove.instances)){return}c=true;var k=f.brightcove.getExperience(i);if(typeof k!="object"){return}a=k.getModule(APIModules.VIDEO_PLAYER);function j(m){if(!f.TRCImpl){var n=arguments;f.setTimeout(function(){j.apply(f,n)},100);return}var l=a.getCurrentVideo();if(l){TRCImpl.playVideo((TRCImpl["brightcove-uses-reference"]==true)?l.referenceId:l.id)}}if(TRCImpl.getProperty(null,"read-paused-bcplayer")){k.getModule(APIModules.EXPERIENCE).addEventListener(BCExperienceEvent.CONTENT_LOAD,j)}a.addEventListener(BCVideoEvent.VIDEO_START,j);a.addEventListener(BCVideoEvent.VIDEO_COMPLETE,function(){TRC.dispatch("videoDone",{videoid:f.trc_video_id})});if(a.isPlaying()||TRCImpl.getProperty(null,"read-paused-bcplayer")){j(null)}};(function(){if(c){return}if(typeof f.brightcove=="object"&&f.TRCImpl&&TRCImpl.modes){for(var j in f.brightcove.instances){try{var k=brightcove.getExperience(j);if(!k.getModule(APIModules.EXPERIENCE).getReady()){continue}if(brightcove.getExperience(j).getModule(APIModules.VIDEO_PLAYER)){g(j);return}}catch(i){}}}f.setTimeout(arguments.callee,500)})();var h=null;if(typeof f.onTemplateLoaded=="function"){h=f.onTemplateLoaded}f.onTemplateLoaded=function(i){g(i);if(h!=null){h(i)}};b=true};TRC.brightcove_playVideo=function(h){var g=(h.search(/video/)>=0)?h.split("video")[1]:h;if(a==null){return false}a.loadVideo(g,TRCImpl["brightcove-uses-reference"]?"referenceId":"id");scroll(0,0);return true}}(window,document));(function(f,d){var a="onKalturaPlayerReady";function c(){return Math.floor(Math.random()*2147483648).toString(36)}function b(i,h,j){if(typeof j!="object"){j={data:j}}j.originatingPlayer=i;TRC.dispatch("kaltura_"+h,j);return j}function g(k,m,l){var j,i,h;if(f.trc_video_id){trc_video_id=null;try{delete f.trc_video_id}catch(n){}}i=l+k+"playerPlayed";f[i]=function(o){h=true;o=b(k,"playerPlayed",o);try{TRC.dispatch("videoPlaying",o)}catch(q){__trcError("Problem in Kaltura_support",q)}TRCImpl.playVideo(m.evaluate("{entry.id}"))};m.addJsListener("playerPlayed",i);j=l+k+"playerPlayEnd";f[j]=function(o){o=b(k,"playerPlayEnd",o);o.videoid=trc_video_id;TRC.dispatch("videoDone",o)};m.addJsListener("playerPlayEnd",j);j=l+k+"playerUpdatePlayhead";f[j]=function(o){if(!h){f[i](o)}b(k,"playerUpdatePlayhead",o)};m.addJsListener("playerPlayEnd",j);events.forEach(function(s,r,o){var q=l+k+s;f[q]=b.trcBind(this,k,s);m.addJsListener(s,q)})}TRC.kaltura_support=function(){var i="trc_cb_"+c()+"handleKalturaEvent",j=f[a],h=("playerPaused playerUpdateNewAsset playerProgress hasOpenedFullScreen hasCloseFullScreen captureThumbnailSuccess captureThumbnailFailed endEntrySession").split(" ");if(TRC.kaltura_API){return}f[a]=function(k){if(j){try{j(k)}catch(l){}}if(TRC.kaltura_API){return}TRC.kaltura_API=d.getElementById(k);g(k,TRC.kaltura_API,i)}};TRC.kaltura_playVideo=function(h){if(!TRC.kaltura_API){return false}TRC.kaltura_API.insertMedia("-1",h,"true");scroll(0,0);return true}})(window,document);(function(c,b){var a=TRC.ooyala_API=null;TRC.ooyala_support=function(){if(TRC.ooyala_API){return}var l=(function(n){for(var o=0;o<n.length;o++){if(!n[o].src){continue}var q=n[o].src.match(new RegExp("ooyala\\.com/player\\.js.*callback=([^&]+)"));if(q&&q.length>1){return q[1]}}return false})(document.getElementsByTagName("script"));if(l==false&&c.OOYALA_PLAYER_JS){l=c.OOYALA_PLAYER_JS.customerCallbackName}if(l==false){__trcWarn("Ooyala link_target set, but no Ooyala player with JS API found!");return}var j=null;TRC.ooyala_API=a=function(){if(j!=null){return j}var n=document.getElementsByClassName("OoyalaVideoPlayer");if(n!=null&&n.length>0){return j=n[0]}};if(c.trc_video_id){trc_video_id=null;try{delete c.trc_video_id}catch(k){}}var m=false;var h=function(o,n,q){if(typeof q!="object"){q={data:q}}q.originatingPlayer=o;if(!m){m=true}TRC.dispatch("ooyala_"+n,q)};var d=l.split(".");l=d.pop();var i=c;while(d.length&&i){var g=d.shift();if(typeof i[g]=="object"){i=i[g];continue}i=(i[g]={})}var f=(typeof i[l]=="function")?i[l]:null;i[l]=function(){try{h.apply(c,arguments)}catch(n){}if(f!=null){f.apply(c,arguments)}};i[l].trc=true;TRC.listen(["ooyala_startContentDownload","ooyala_stateChanged"],function(n){if(a()==null){return}if(n.type=="ooyala_stateChanged"&&n.state!="playing"){return}try{TRC.dispatch("videoPlaying",n)}catch(o){__trcError("Problem in ooyala_support",o)}TRCImpl.playVideo(a().getCurrentItem().embedCode)});TRC.listen(["ooyala_currentItemEmbedCodeChanged","ooyala_embedCodeChanged"],function(n){if(!c.trc_video_id){return}TRCImpl.playVideo(n.embedCode)});TRC.listen("ooyala_playComplete",function(n){TRC.dispatch("videoDone",{videoid:trc_video_id})})};TRC.ooyala_playVideo=function(d){if(!a){return false}a().setQueryStringParameters({embedCode:d,autoplay:1});scroll(0,0);return true}})(window,document);(function(d,c){var b=[];var a=TRC.PostRenderQueue=function(){return this};a.prototype.pushBack=function(f,g){__trcInfo("postRenderQueue.pushBack("+f+")");b.push({name:f,func:g})};a.prototype.pushFront=function(f,g){__trcInfo("postRenderQueue.pushFront("+f+")");b.unshift({name:f,func:g})};a.prototype.popFront=function(){if(b.length==0){return null}var f=b.shift();if(typeof f=="function"){return{name:"unknown",func:f}}return f}})(window,document);(function(b,a){TRC.text={lsplit:function(g,d,c){var f=g.split(d);return f.slice(0,c-1).concat(f.length>=c?f.slice(c-1).join(d):[])},parseCSV:function(c){var f=c.split(",");var d=[];while(f.length){var g=f.shift();if(g[0]!='"'){d.push(g);continue}do{if(g.slice(1).replace(/""/g,"").slice(-1)=='"'){break}g+=","+f.shift()}while(f.length);d.push(g.slice(1,g.length-1).replace(/""/g,'"'))}return d},toStringList:function(d){if(!d){return[]}if(!(d instanceof Array)){return[""+d]}var c=[];d.forEach(function(f){if(!f){return}c.push(""+f)});return c}}})(window,document);(function(f,d){var b=new Array(),a={};var c=TRC.Manager=function(h,g){this.renderRBox=function(i){var j=document.trcGetParentByClassName(i.getContainer(),"trc_rbox_container");j.style.display="block";i.load(function(){j.style.display="none"})};this.getConfig=function(j,i){if(typeof j[i]!="undefined"){return j[i]}if(typeof f["trc_"+i]!="undefined"&&f["trc_"+i]!=null){return j[i]=f["trc_"+i]}if(typeof this[i]!="undefined"&&this[i]!=null){return j[i]=this[i]}return j[i]=this[i]};this.getAutoItemMeta=function(k){if(typeof this["normalize-"+k]!="function"){this["normalize-"+k]=function(m){return m}}var l=(function(m){return this.urlPreNormalizer(this["prenormalize-"+k],m)}).trcBind(this);var j=(function(){var n=document.head.getElementsByTagName("meta");for(var o=0;o<n.length;o++){if(n[o].name==k){return n[o].content}}return null})();j=j||(function(){var n=document.head.getElementsByTagName("link");for(var o=0;o<n.length;o++){if(n[o].rel=="canonical"){return l(n[o].href)}}return null})();j=j||(function(){var n=document.head.getElementsByTagName("meta");for(var o=0;o<n.length;o++){if(n[o].getAttribute("property")=="og:url"){return l(n[o].content)}}return null})();var i=!!j;j=j||l(TRC.pageManager.getCurrentURL().toString());return this["normalize-"+k](j,typeof f.trc_video_id!="undefined"?"video":"text",i)};this.getItemId=function(){var i=this.itemid;if(typeof f.trc_video_id!="undefined"){i=f.trc_video_id}else{if(typeof f.trc_article_id!="undefined"){i=f.trc_article_id}}if(i==""){i=this.getAutoItemMeta("item-id")}return this.itemid=i};this.getItemUrl=function(){var i=this.itemurl;if(typeof trc_item_url!="undefined"){i=trc_item_url}else{if(this.itemurl==null){i=this.getAutoItemMeta("item-url")}}return this.itemurl=i};this.urlPreNormalizer=function(q,k){if(!q){return k}(q["truncate-at"]||[]).forEach(function(s){var t=k.search(s);if(t>=0){k=k.substr(0,t)}});var j=new f.TRC.URL(k);for(var n in q){if(!q[n]){continue}switch(n){case"host":delete j.host;break;case"trailing-dirsep":while(j.pathname.substr(j.pathname.length-1)=="/"){j.pathname=j.pathname.substr(0,j.pathname.length-1)}break;case"query":var o=[],m=j.search.replace(/^\?/,"").split("&"),r=q[n];if(typeof r=="string"){r=new RegExp(r)}var i=(function(){if(r instanceof Array){return function(t){for(var s=0;s<r.length;s++){if(t==r[s]){return true}}return false}}if(r instanceof RegExp){return r.test.trcBind(r)}return function(){return false}})();m.forEach(function(s){if(i(decodeURIComponent(s.split("=")[0]))){o.push(s)}});j.search=(o.length?"?":"")+o.join("&");break;case"fragment":var r=q[n],l=j.hash.replace(/^#/,"");if(typeof r=="string"){r=new RegExp(r)}j.hash="";if(r instanceof RegExp&&r.test(l)){j.hash="#"+l}else{if(r instanceof Array){r.forEach(function(s){if(l.search(s)>=0){j.hash="#"+l}})}}break}}if(!j.pathname){j.pathname="/"}return j.toString().toLowerCase()};this.genCallback=function(j){var i="recommendations_"+(this.auto_gen_callback_seq=this.auto_gen_callback_seq+1||1);TRC.callbacks[i]=j;return"TRC.callbacks."+i};this.formatTRCRequest=function(o,u){var j=[];var t={ii:this.getItemId(),it:this.getItemType(),sd:TRC.pageManager.getPublisherValue(TRC.publisherId,"session-data"),ui:TRC.pageManager.getValue("user-id"),cv:this.version,uiv:this.getPublisherVersion(),id:parseInt(Math.random()*1000)};if(u){t.it=u}if(this.excludedItems){t.ex=TRC.text.toStringList(this.excludedItems)}var i=this.getItemUrl();for(p in o){var s=o[p];if(!s.placement){continue}if(s.item_id){t.ii=s.item_id}if(s.origin.toString()==="h2v"){t.ii="_homepage_"}if(s.item_type){t.it=s.item_type}if(s.item_url){i=s.item_url}var v={li:s.list_id||"rbox-"+(s.visible?s.origin.toString():"tracking"),s:s.visible?this.getProperty(s.mode_name,"list-size"):0,uim:s.mode_name,uip:s.placement};if(s.category){v.ac=s.category}if(s.article){v.sii=s.article;v.sit="text"}else{if(s.video){v.sii=s.video;v.sit="video"}}if(s.exclude){v.ex=TRC.text.toStringList(s.exclude)}var n=this.getProperty(s.mode_name,"required-attributes");if(typeof n=="string"&&n!="none"){v.ra=n}if(typeof s.container=="string"){s.container=document.getElementById(s.container)}v=this["normalize-request-param"](v,s.mode_name);j.push(v)}function l(m){switch(m){case"user":return"u";case"uploader":return"U";case"content-rating":return"c";case"publish-date":return"t";case"duration":return"d";case"category":return"x";case"v":case"r":default:return m}}if(f.trc_testmode){t.y=true}if(this.trc_url_auto_detection==t.ii){var k=this.getProperty(j[0].uim,"remove-url-playvideo-behavior");if(k){i=null}}if(i!=null){t.u=i}if(document.referrer&&!/https?:\/\/(\w+)\.taboola(syndication)?\.com/.test(document.referrer)){t.e=document.referrer.substr(0,400)}var q={};if(this.tags&&this.tags.length){q.k=this.tags.join(",")}for(p in this.metadata){if(this.metadata[p]){q[l(p)]=this.metadata[p]}}if((function(){for(p in q){return true}return false})()){t.m=q}t=this["normalize-request-param"](t,null);t.r=j;return t};this.dispatchLoadRequest=function(k){this.preloadRequest=k;if((function(n){for(p in n){return false}return true})(k)){return}if(this.getItemId()==null){this.delayedDispatchLoadRequest=this.dispatchLoadRequest.trcBind(this,k);return}this.delayedDispatchLoadRequest=null;var l=this.getProperty(null,"timeout")||8000;try{var j=this.formatTRCRequest(this.preloadRequest);j.cb=this.genCallback(this.handleLoadResponse.trcBind(this));var i="http://"+this.domain+"/"+escape(TRC.publisherId)+"/trc/3/json?tim="+escape(__trcClientTimestamp())+"&data="+encodeURIComponent(__trcJSONify(j))+TRC.pageManager.additionalDispatchParams();if(f.trc_debug_level>1){i+="&llvl="+f.trc_debug_level}this.preloadRequestLoader=this.loadExternal(i,"js",this.handleLoadResponseFailure.trcBind(this),true);this.preloadRequestLoader.timeout=f.setTimeout(this.abortLoadRequest.trcBind(this,true),l)}catch(m){__trcError("TRC.dispatchLoadRequest: Error in request processing",m)}};this.abortLoadRequest=function(j){if(!!this.preloadRequestLoader){this.preloadRequestLoader.parentNode.removeChild(this.preloadRequestLoader);this.preloadRequestLoader=null}for(pl in this.preloadRequest){if(pl.search("rbox-tracking")>=0){continue}if(!!j){j=false;__trcWarn("TRC.abortLoadRequest: pv3 timeout")}var i=this.preloadRequest[pl];delete this.preloadRequest[pl];this.internalDrawRBox(i)}};this.handleLoadResponseFailure=function(i){i=f.event||i;if(this.preloadRequestLoader==null){return}f.clearTimeout(this.preloadRequestLoader.timeout);__trcError("Server did not respond to loadRBox");this.abortLoadRequest()};this.handleLoadResponse=function(j){if(!!this.preloadRequestLoader){f.clearTimeout(this.preloadRequestLoader.timeout)}if(!j||!j.trc||!j.trc.vl||!j.trc.vl.length){__trcError("Invalid response from server: "+j);this.abortLoadRequest();return}TRC.pageManager.storePublisherValue(TRC.publisherId,"session-data",j.trc.sd);TRC.pageManager.storeValue("user-id",j.trc.ui);for(var m=0;m<j.trc.vl.length;m++){var l=j.trc.vl[m].uip;if(l.search("rbox-tracking")>=0){continue}if(typeof this.preloadRequest[l]=="undefined"){__trcWarn("Invalid placement in server response",l);continue}this.preloadRequest[l].response={trc:{req:j.trc.vl[m]["ri"],"session-id":j.trc.si,"session-data":j.trc.sd,"user-id":j.trc.ui,"watched-item":j.trc.wi,"country-code":j.trc.cc,"test-variant":j.trc.t,"video-list":{video:j.trc.vl[m]["v"]}}};if(typeof this.preloadRequest[l].container!="undefined"){this.internalDrawRBox(this.preloadRequest[l])}}for(var n in this.preloadRequest){if(this.preloadRequest[n].response==null&&n.search("rbox-tracking")<0){__trcWarn("Server did not provide response for '"+n+'"!');var k=this.preloadRequest[n];delete this.preloadRequest[n];__trcDebug("Recovering internalDrawRBox("+n+")");this.internalDrawRBox(k)}}if(!!this.preloadRequestLoader){this.preloadRequestLoader.parentNode.removeChild(this.preloadRequestLoader);this.preloadRequestLoader=null}};this.init=function(j){__trcCopyProps(j,this);TRC.dom.injectStyle(this.defaults.style+this.global.style);TRC.dom.injectStyleOverflowFix(this.defaults.style+this.global.style);TRC.pageManager.setDomainConfiguration(this.global["publisher-domains"]);this.domain=(this.global["requests-domain"])?this.global["requests-domain"]:"urc.taboolasyndication.com";if(!(this.origin instanceof Array)){this.origin=[this.origin]}if(this.userMetadata!=null){this.metadata.user=__trcJSONify(this.userMetadata)}else{if(typeof trc_user_id=="undefined"){this.metadata.user=this["get-user"]()}else{this.metadata.user=trc_user_id}}try{this["publisher-start"]()}catch(i){__trcError("Error running publisher-start",i)}this.metadata.uploader=this["get-creator"]();this.tags=this["get-tags"]();try{this.metadata.v=this["get-views"]();this.metadata.r=this["get-rating"]();this["metafields"].split(",").forEach((function(k){if(!k){return}this.metadata[k]=(this["get-"+k])?this["get-"+k]():this.readMetaTag(k)}).trcBind(this))}catch(i){}this.gt=new Gettext({domain:"rbox",locale_data:this.global.locale});f.trc_testmode=!!f.trc_testmode||TRC.pageManager.isStagingView();this.setupOVP();this.init=function(){}};this.pollTillContainerAvailable=function(l,q){var k=1000,i=40,n=this,j=l.container,m=function(){n.internalDrawRBox(l)};q=typeof q==="undefined"?k:q;if(l.player||TRC.dom.isReady){return TRC.dom.onReady(m)}try{l.container=this.ensureValidContainer(l.container,true)}catch(o){}if(!l.container){l.container=j;if(q--){q=TRC.dom.isReady?Math.min(q,1):q;setTimeout(function(){n.pollTillContainerAvailable.call(n,l,q)},i);return}return TRC.dom.onReady(m)}this.internalDrawRBox(l)};this.countTrcContainerMissingError=0;this.ensureValidContainer=function(m,o){var n="trc_related_container";if(typeof m=="string"){m=document.getElementById(m);if(o){if(!m){return null}}}if(typeof m!="object"){m=null}if(m!=null){if(!!m.className.match(n)){return m}while(m.hasChildNodes()){m.removeChild(m.firstChild)}m.className+=" "+n;return m}if((m=document.getElementById(n))!=null){if(m.className.search(n)<=0){m.className+=" "+n}return m}var k=null;var j=document.body.getElementsByTagName("script");for(var l=0;l<j.length;l++){if(!j[l].src&&/TRC\.drawRBox\(/.test(j[l].innerHTML)){k=j[l];break}}if(!k||!k.parentNode){if(this.countTrcContainerMissingError<2){this.countTrcContainerMissingError+=1;__trcError("Didn't manage to find TRC container for R-Box ("+this.countTrcContainerMissingError+") "+(TRC.dom.isReady?"(Document is Ready)":"")+"!")}return null}var q=document.createElement("div");q.id=q.className=n;k.parentNode.insertBefore(q,k);return q};this.getPublisherVersion=function(){try{if(TRC.baseDomain.search(TRC.publisherId)>=0){var i=TRC.baseDomain.split("/");if(i[i.length-1]==""){i.pop()}if(i[i.length-1]!=TRC.publisherId){return i[i.length-1]}}}catch(j){}return"default"};this.getItemType=function(){switch(TRC.listOrigin.getSource()){case"h":return"home";case"c":return"category";case"t":return"text";case"s":return"search";case"p":return"photo";case"v":default:return"video"}};this.playVideo=function(j,n){if(typeof j=="undefined"){return}if(f.trc_video_id==j){return}var m=TRC.listOrigin.getSource();if(typeof n=="undefined"){if((typeof f.trc_video_id=="undefined")&&m=="v"){n=this.getAutoItemMeta("item-url");this.trc_url_auto_detection=j}else{n=null}}f.trc_video_id=j;f.trc_item_url=n;if(this.delayedDispatchLoadRequest!=null){this.delayedDispatchLoadRequest()}if(f.TRC.trc_drawRBox==false){return}var i=0;for(var l in this.boxes){if(!(/(rbox-blended|rplayer)/.test(this.boxes[l].getListId()))){continue}if(this.boxes[l].updateRecommendations("video")){i++}}if(i<1){var k={};options=this.computeRBoxOptions({mode:"rbox-tracking",item_id:j,item_url:n,item_type:"video",visible:false});delete options.container;k[options.placement]=options;this.dispatchLoadRequest(k)}};this.setUser=function(i){this.userMetadata=i};this.getUIInstance=function(j){var i=this.getProperty(j,"impl-class");if(!!i&&i in f.TRC.implClasses){return f.TRC.implClasses[i]}return TRC.implClasses.TRCRBox};this.calculatePlacement=function(i){var j=(i.mode_name+(i.category?"-"+i.category:""));if(typeof this.unique_placement_count[j]!="undefined"){j+="#"+(++this.unique_placement_count[j])}return j};this.computeRBoxOptions=function(i){if(typeof i=="string"){i={mode_name:i}}if(i.pubOpts){return i}i.pubOpts=__trcCopyProps(i,{});f.trc_testmode=(!!f.trc_testmode||!!i.testmode);i.syndicator=i.syndicator||this.syndicator;i.tracking=((this.tracking)?this.tracking:"")+((i.tracking)?i.tracking:"");i.target_type=i.target_type||this.target_type||this.getProperty(i.mode_name,"target_type")||"video";i.origin=new TRC.ListOriginBuilder(TRC.listOrigin.getSource(),i.target_type);i.mode_name=(!!i.mode&&i.mode)||(!!i.mode_name&&i.mode_name)||(!!f.trc_mode_name&&f.trc_mode_name)||(i.syndicator?"rbox-syndication":"rbox-"+i.origin.toString());i.mode_name=i.mode_name.replace(/\s+/g,"");i.category=(!!i.category&&i.category);i.link_target=i.link_target||this.link_target||this.getProperty(i.mode_name,"link-target")||"normal";if(i.syndicator&&["lightbox","normal"].indexOf(i.link_target)<0){i.link_target="blank"}if(typeof i.placement=="undefined"){i.placement=this.calculatePlacement(i)}this.unique_placement_count[i.placement]=0;i.visible=typeof i.visible=="boolean"?i.visible:!this.invisible;if(typeof i.autoplaybox=="string"){i.autoplaybox=document.getElementById(i.autoplaybox)}if(!i.player&&i.visible){i.container=this.ensureValidContainer(i.container)}this.setupOVP(i);i.response=null;i.computed=true;return i};this.listenToPlayer=function(j,k){var l="trc_related_container",i;i=TRC.listen("videoPlaying",(function(q){var m=document.getElementById(q.originatingPlayer),n,o;if(TRC.dom.isAncestor(k,m,true)){i.remove();TRC.listen("videoPlaying",function(r){if(r.originatingPlayer===k.originatingPlayer){n.style.left="-999999em"}});k.originatingPlayer=q.originatingPlayer;if(j.container){if(typeof j.container==="string"){j.container=document.getElementById(j.container)}n=j.container}if(!n){j.container=n=document.createElement("div")}n.className=l+" trc-inplayer-rbox";n.style.left="-999999em";n.style.width=m.offsetWidth+"px";n.style.marginTop="-"+m.offsetHeight+"px";if(TRC.Browser.ieUpto(6)){k.style.position="absolute"}k.appendChild(n);if(TRC.kaltura_API&&TRC.Browser.firefox){delete TRC.kaltura_API;TRC.kaltura_support()}j.getListId=function(){return"rplayer-after"};this.internalDrawRBox(j)}}).trcBind(this));TRC.listen("videoDone",function(n){var m=j.container;if(n.originatingPlayer===k.originatingPlayer){m.style.left="0"}});if(TRC.ooyala_API){TRC.listen("ooyala_stateChanged",function(n){var m=j.container;if(n.originatingPlayer===k.originatingPlayer){m.style.left="-999999em"}});TRC.listen("ooyala_activePanelChanged",function(q,n,m){var o=j.container;if(q.originatingPlayer===k.originatingPlayer){o.style.left=q.activePanel==="more"?"0":"-999999em"}})}};this.internalDrawRBox=function(j){j=this.computeRBoxOptions(j);if(j.player){var k=j.player;delete j.player;this.listenToPlayer(j,document.getElementById(k));return}var l=j.container;if(!l){return}if(!j.visible){l.style.display="none"}if(j.response==null&&this.loadCalled&&typeof this.preloadRequest[j.placement]!="undefined"){j.response=this.preloadRequest[j.placement].response;__trcCopyProps(j,this.preloadRequest[j.placement]);if(j.response==null){this.preloadRequest[j.placement]["container"]=j.container;return}}var i=new (this.getUIInstance(j.mode_name))(j.origin.toString(),j,this);this.boxes[i.id]=i;if(!l._trc_container){l._trc_container=document.createElement("div");l._trc_container.className="trc_rbox_container";l._trc_anonbox=document.createElement("div");l._trc_container.appendChild(l._trc_anonbox);l.appendChild(l._trc_container)}i.render(l._trc_anonbox);this.renderRBox(i);f.TRC.trc_drawRBox=true};this.loadRBox=function(){var l=Array.prototype.slice.call(arguments),j,m={},k,i=40;if(l.length<1){return}try{if(this.loadCalled){throw new Error("loadRBox() may only be called once!")}if(l[0] instanceof Array){l=l[0]}j=l.slice(0);while(l.length){k=this.computeRBoxOptions(__trcCopyProps(l.shift(),{}));if(k.player){this.internalDrawRBox(k);continue}if(!!m[k.placement]){throw new Error("Placement '"+k.placement+"' is not unique in loadRBox()!")}m[k.placement]=k;if(!k.container||k.container.nodeType!==1){if(!TRC.dom.isReady){setTimeout(this.loadRBox.trcBind(this,j),i);return}this.error("Invalid container provided for request "+k.placement+" ("+k.container+")!");delete m[k.placement]}}this.loadCalled=true;this.dispatchLoadRequest(m)}catch(n){__trcError("Error in loadRBox()",n);throw n}};this.parseLoaderParams(g);TRC.dom.init();this.init(h);return this};c.prototype["list-size"]=0;c.prototype.MAX_RETRY=2;c.prototype.drawInterface=false;c.prototype.delayedDispatchLoadRequest=null;c.prototype.invisible=false;c.prototype.excludedItems=null;c.prototype.boxes={};c.prototype.itemid=null;c.prototype.itemurl=null;c.prototype.tags=[];c.prototype.metadata={};c.prototype.gt={};c.prototype.userMetadata=null;c.prototype.loadCalled=false;c.prototype.unique_placement_count={};c.prototype.trc_url_auto_detection=null;c.prototype.getProperty=function(h,g){if(typeof this.modes=="undefined"||typeof this.modes[h]=="undefined"||typeof this.modes[h][g]=="undefined"){return this[g]}return this.modes[h][g]};c.prototype.getFunction=function(j,g){var h=Array.prototype.slice.call(arguments,2);var i=this.getProperty(j,g);if(typeof i=="function"){return i.apply(this,h)}return undefined};c.prototype.readMetaTag=function(j){var g=document.head.getElementsByTagName("meta");var h=null;for(var k=0;k<g.length;k++){if(!g[k].name){continue}if(g[k].name.toLowerCase()=="item-"+j.toLowerCase()){return g[k].content}if(g[k].name.toLowerCase()==j.toLowerCase()){h=g[k].content}}return h};c.prototype.get_intent=function(h){var g=f.location.href;var i=TRC.pageManager.getPublisherValue(TRC.publisherId,"auto-play-intent");if(i!=null){var j=i.split(":");if(parseInt(j[0])>new Date().getTime()-30000&&j[1]==this.getItemId()){if(typeof j[2]!="undefined"){return j[2]}return"n"}}if(g.search(this.getItemId())>=0){return"s"}return"u"};c.prototype["get-creator"]=function(){return this.readMetaTag("uploader")||this.readMetaTag("creator")};c.prototype["get-tags"]=function(){var h=null;var g=h?h.split(","):[];while(g.length>0&&!g[0]){g.shift()}return g};TRC.ads_use_renderer=false;TRC.implClasses=TRC.implClasses||{};c.prototype.logTrcEvent=function(m,j,o){for(var i in j){j[i]=this["normalize-log-param"](i,j[i])}var g=this["normalize-log-param"]("publisher",TRC.publisherId);m=this["normalize-log-param"]("type",m);try{var h="http://"+this.domain+"/"+g+"/log/3/"+escape(m)+"?";h+="tim="+escape(__trcClientTimestamp())+"&";for(name in j){var k=name.charAt(0)=="_"?name.substr(1):name;if(typeof j[name]!="undefined"&&j[name]!=null){h+=escape(k)+"="+escape(j[name])+"&"}}if(f.trc_debug_level){h+="llvl="+f.trc_debug_level+"&"}h+="id="+parseInt(Math.random()*10000);var n=function(){if(typeof o=="function"){try{o()}catch(r){__trcError("Error in event callback",r)}}return true};var q=new Image();b.push(q);q.onload=n;q.src=h+"&url="+escape("http://cdn.taboolasyndication.com/pixel.gif")}catch(l){__trcError("Error in sending event",l)}};c.prototype.log1=function(h,i,k,g){var j=h+":"+((g)?g:(i.li+i.ii))+i.ri;if(i.ii&&i.it){j=h+":"+i.li+i.ii+i.ri}if(a[j]){a[j]++;return}this.logTrcEvent(h,i,k);a[j]=1};c.prototype.loadExternal=function(){return TRC.net.loadScript.apply(null,arguments)};c.prototype.createAdPlayerDiv=function(){function i(){if(f.innerHeight!==undefined){A=[f.innerWidth,f.innerHeight]}else{var m=(document.body.clientWidth)?document.body:document.documentElement;A=[m.clientWidth,m.clientHeight]}return A}var j=document.getElementsByTagName("body")[0];var l=f.trc_adPlayer;if(l==null){f.trc_adPlayer=l=document.createElement("div");l.id="ad_player";l.className="ad_player_div";l.style.display="none";var k=document.createElement("div");k.innerHTML="Loading...";l.appendChild(k);j.appendChild(l);var h=document.createElement("div");h.className="snippetCloseButton";h.innerHTML="x";h.onclick=function(){l.style.display="none"};l.appendChild(h)}var g=i();l.style.height=g[1]+"px";l.style.width=g[0]+"px";l.style.left="0px";l.style.top="0px";l.style.opacity="0.9";l.style.display="block"};c.prototype.parseLoaderParams=function(g){for(var i in g){var h=g[i];if(h=="unknown"){continue}if(h=="auto"){h=""}switch(i){case"visible":this.invisible=!(typeof h=="boolean"?h:"false"!=h);break;case"video":f.trc_video_id=h;TRC.listOrigin.setSource("v");break;case"article":f.trc_article_id=h;TRC.listOrigin.setSource("t");break;case"category":f.trc_article_id=h;TRC.listOrigin.setSource("c");break;case"home":f.trc_article_id=h;TRC.listOrigin.setSource("h");break;case"search":f.trc_article_id=h;TRC.listOrigin.setSource("s");break;case"photo":f.trc_article_id=h;TRC.listOrigin.setSource("p");break;case"link_target":this.link_target=h;break;case"video_source":this.video_source=h;break;case"target_type":TRC.listOrigin.setTarget(this.target_type=h);break;case"exclude":this.excludedItems=h instanceof Array?h:[h];break;case"syndicator":this.syndicator=h;break;case"tracking":this.tracking=h;break}}};c.prototype.setupOVP=function(g){g=g||{};switch(this.getConfig(g,"video_source")||this.getConfig(g,"link_target")){case"brightcove":TRC.brightcove_support();break;case"ooyala":TRC.ooyala_support();break;case"kaltura":TRC.kaltura_support();break}};c.prototype.log=__trcLog;c.prototype.error=__trcError;c.prototype.warn=__trcWarn;c.prototype.info=__trcInfo;c.prototype.debug=__trcDebug})(window,document);(function(win,doc){TRC.implClasses=TRC.implClasses||{};var TRCRBox=TRC.implClasses.TRCRBox=function(origin,options,parent){this.domain=parent.domain;this.origin=origin;this.header=false;this.id="trc_"+Math.floor(Math.random()*100000);this.response=this.request=null;__trcCopyProps(options,this);this.loaded=false;this.element=null;this.listContainer=null;this.retryCount=0;this.drawList=false;this.forceItemType=false;this.trc=parent;this.timeoutId=null;this.errorHandler="";this.boxes=[];this.visible_boxes={};this.synd_visible_boxes={};this.recommendationList=null;this.autoPlayer=null;this.use_cdn=(this.trc.getProperty(this.mode_name,"use-cdn-recommendations")===true);this.postRenderQueue=new TRC.PostRenderQueue();this.pager=null;this.src=null;this.publisher=this.syndicator||TRC.publisherId;this.auto_scroll_interval=null;this.auto_scroll=null;if(this.syndicator&&typeof this.trc.global!="undefined"){this.link_target=this.trc.global[this.syndicator+"-syndication-product"]}this.reqParams={"item-type":this.trc.getItemType(),"item-id":this.trc.getItemId()};return this};TRCRBox.prototype.genRBoxURL=function(){if(win.trc_testmode){return this.getRetryUrl("static-preview")}var request={};request[this.placement]={placement:this.placement,visible:this.visible,origin:this.syndicator?"syndication":this.origin,mode_name:this.mode_name,ac:this.category,article:this.article,video:this.video,exclude:this.exclude,syndicator:this.syndicator,list_id:this.getListId(),intent:typeof this.trc.get_intent=="function"?this.trc.get_intent(this):undefined};var req=this.trc.formatTRCRequest(request,this.forceItemType);req.cb=this.trc.genCallback(this.loadScriptCallback.trcBind(this));return"http://"+this.domain+"/"+escape(TRC.publisherId)+"/trc/3/json?tim="+escape(__trcClientTimestamp())+"&data="+encodeURIComponent(__trcJSONify(req))+TRC.pageManager.additionalDispatchParams()+(win.trc_debug_level>1?"&llvl="+win.trc_debug_level:"")};TRCRBox.prototype.getListId=function(){if(!this.visible){return"rbox-tracking"}if(this.syndicator){return"rbox-syndication"}return"rbox-"+this.origin};TRCRBox.prototype.getItemType=function(){if(this.forceItemType){return this.forceItemType}return this.trc.getItemType()};TRCRBox.prototype.generateRDiv=function(){var div=document.createElement("div");div.id=this.getListId();div.className="trc_rbox_div trc_rbox_border_elm";if(this.element.style.display!="none"){div.style.display="none"}div.style.overflowX="hidden";div.style.overflowY="hidden";return div};TRCRBox.prototype.is_box_visible=function(box){if(box.clientHeight<=0){return false}var top=(box.offsetTop<0)?0:box.offsetTop;var left=(box.offsetLeft<0)?0:box.offsetLeft;var rightTop=box.offsetLeft+box.clientWidth*0.5;var leftBottom=box.offsetTop+box.clientHeight*0.5;if(((top>=this.listContainer.scrollTop)&&(top<(this.listContainer.scrollTop+this.listContainer.offsetHeight)))&&((leftBottom>this.listContainer.scrollTop)&&(leftBottom<=(this.listContainer.scrollTop+this.listContainer.offsetHeight)))&&((left>=this.listContainer.scrollLeft)&&(left<(this.listContainer.scrollLeft+this.listContainer.offsetWidth)))&&((rightTop>this.listContainer.scrollLeft)&&(rightTop<=(this.listContainer.scrollLeft+this.listContainer.offsetWidth)))){return true}return false};TRCRBox.prototype.generateHeader=function(){var head=document.createElement("div");head.id=this.id.replace("trc_","trc_header_");head.className="trc_rbox_header trc_rbox_border_elm";var head_span=document.createElement("span");head_span.className="trc_rbox_header_span";head.ext=document.createElement("div");head.ext.className="trc_header_ext";head.appendChild(head.ext);var header=this.trc.getProperty(this.mode_name,"header");head_span.innerHTML=(header!="No Header")?header:"";if(!this.addSyndicatorLink(head,head_span)){head.appendChild(head_span)}head.titleBox=head_span;return head};TRCRBox.prototype.render=function(container){var auto=this.trc.getProperty(this.mode_name,"auto-scroll");this.element=document.createElement("div");this.element.id=this.id.replace("trc_","trc_wrapper_");this.element.className="trc_rbox "+this.mode_name;this.element.style.overflow="hidden";if(typeof auto!="undefined"){if(auto!="none"){this.element.onmouseover=function(){if(this.auto_scroll_interval!=null){win.clearInterval(this.auto_scroll_interval)}};this.element.onmouseout=function(){if(typeof this.auto_scroll=="function"){if(this.auto_scroll_interval!=null){win.clearInterval(this.auto_scroll_interval)}this.auto_scroll_interval=win.setInterval(this.auto_scroll,parseInt(auto))}}}}container.appendChild(this.element);this.element.style.display="none"};TRCRBox.prototype.generateVisibleParts=function(){if(this.listContainer!=null){return}this.header=this.generateHeader();if(typeof this.header=="object"){this.element.appendChild(this.header)}var outerdiv=document.createElement("div");outerdiv.id=this.id.replace("trc_","outer_");outerdiv.className="trc_rbox_outer";outerdiv.style.overflow="hidden";this.listContainer=this.generateRDiv();outerdiv.appendChild(this.listContainer);this.element.appendChild(outerdiv);this.element.style.display="block";this.addTaboolaLogo()};TRCRBox.prototype.getRetryUrl=function(error){var publisher=this.trc.publisherId;if(this.syndicator){publisher=this.syndicator}base_domain="http://cdn.taboolasyndication.com/libtrc/"+publisher+"/";if(error=="preview"){return base_domain+"trc-"+error+".js"}return base_domain+"trc-"+this.getListId()+"-"+error+".js"};TRCRBox.prototype.check_preview_size_error=function(call_back_src,response){var videos=response.trc["video-list"].video;if(!(videos instanceof Array)){videos=[videos]}if(call_back_src!=this.getRetryUrl("preview")){if(videos.length<10){this.src=this.getRetryUrl("preview");return true}}return false};TRCRBox.prototype.loadScriptCallback=function(response){var method_signature="TRCRBox.loadScriptCallback(retry="+this.retryCount+")",trc=response.trc;__trcInfo("Enter "+method_signature);this.abortRequest();var is_preview=win.trc_testmode?true:false;if(trc.vl&&trc.vl.length){var res=trc.vl.shift();response.trc=trc=__trcCopyProps({req:res.ri,"session-id":response.trc.si,"session-data":response.trc.sd,"user-id":response.trc.ui,"watched-item":response.trc.wi,"country-code":response.trc.cc,"test-variant":response.trc.t,"video-list":{video:res.v}},response.trc)}if(!trc||!trc["video-list"]||!trc["video-list"].video){__trcError("Exit "+method_signature+": pv2 format error");if(this.use_cdn||is_preview){this.src=this.getRetryUrl(is_preview?"preview":"error");this.getData()}else{this.abortRendering()}return}if(is_preview&&this.check_preview_size_error(this.src,response)){__trcInfo("Exit "+method_signature+": preview with not enough items");this.getData();return}TRC.pageManager.storePublisherValue(TRC.publisherId,"session-data",trc["session-data"]);TRC.pageManager.storeValue("user-id",trc["user-id"]);if(this.getListId()!="rbox-tracking"&&typeof this.trc.modes[this.mode_name]=="undefined"){__trcError("TRCRBox.loadScriptCallback: Mode name '"+this.mode_name+"' doesn't exist in configuration file ");return}if(this.drawList){__trcWarn("Exit "+method_signature+": got another response after already drawing");return}this.response=response;if(trc["video-list"].video.length<1){__trcInfo("Exit "+method_signature+": no items in response");this.abortRendering();this.sendEvent("available",{},true);return}this.recommendationList=trc["video-list"].video;this.hasSyndicatedContent=this.hasSyndicated(this.recommendationList);if(typeof trc==="object"&&typeof trc["test-variant"]!=="undefined"){if(typeof this.trc.modes["ab_"+this.mode_name+"_"+trc["test-variant"]]!="undefined"){this.mode_name="ab_"+this.mode_name+"_"+trc["test-variant"];this.element.className="trc_rbox "+this.mode_name}}__trcInfo("Exit "+method_signature+": success");this.drawList=true;this.generateVisibleParts();this.drawListBody(trc)};TRCRBox.prototype.loadFailureHandler=function(){var method_signature="TRCRBox.loadFailureHandler(retry="+this.retryCount+")";__trcInfo("Enter "+method_signature);if(!this.request){__trcInfo("Exit "+method_signature+": request was aborted");return}if(typeof trc_json_response=="object"){__trcWarn("Exit "+method_signature+": old style response");this.loadScriptCallback(trc_json_response);delete trc_json_response;return}this.abortRequest();if(this.response){__trcInfo("Exit "+method_signature+": response already received");return}if(!!win.trc_testmode){this.src=this.getRetryUrl("preview");__trcInfo("Exit "+method_signature+": preview")}else{if(!this.use_cdn){__trcError("Aborting on error due to use-cdn=false");this.abortRendering();return}this.src=this.getRetryUrl("error");__trcWarn("Exit "+method_signature+": retrying with "+this.src.split("/")[2].split(".")[0].toUpperCase())}this.getData()};TRCRBox.prototype.abortRequest=function(){if(this.timeoutId){win.clearTimeout(this.timeoutId);this.timeoutId=null}if(!this.request){return}this.request.parentNode.removeChild(this.request);this.request=null};TRCRBox.prototype.sendRequest=function(){var method_signature="TRCRBox.sendRequest(retry="+this.retryCount+")";__trcInfo("Enter "+method_signature);if(this.response){__trcInfo("Exit "+method_signature+": already have response");this.loadScriptCallback(this.response);return}var timeout=this.trc.getProperty(this.mode_name,"timeout")||8000;this.timeoutId=win.setTimeout((function(){this.timeoutHappened=this.timeoutHappened+1||1;if(!this.use_cdn){__trcError("Timedout waiting for server but not aborting");return}this.abortRequest();this.src=this.getRetryUrl("timeout");__trcWarn("Called TRCRBox.sendRequest.timeout("+this.timeoutHappened+"): retrying with "+this.src.split("/")[2].split(".")[0].toUpperCase());this.getData()}).trcBind(this),timeout);this.response=null;try{this.request=this.trc.loadExternal(this.src,"js",this.loadFailureHandler.trcBind(this),true)}catch(e){__trcError("Exit "+method_signature+": error in loadExternal",e);return}__trcInfo("Exit "+method_signature+": success")};TRCRBox.prototype.abortRendering=function(){var method_signature="TRCRBox.abortRendering(retry="+this.retryCount+")";__trcInfo("Called "+method_signature);this.drawList=true;switch(typeof this.errorHandler){case"string":if(this.listContainer!=null){this.listContainer.appendChild(document.createTextNode("Error getting recommendations: "+this.errorHandler))}return;case"function":this.errorHandler();return}};TRCRBox.prototype.getData=function(){this.loaded=true;this.retryCount++;var method_signature="TRCRBox.getData(retry="+this.retryCount+")";__trcInfo("Enter "+method_signature);if(!this.cdnEventHandler){this.cdnEventHandler=TRC.listen("staticRecommendationsReceived",(function(data){if(!this.response){this.loadScriptCallback(data.response)}}).trcBind(this))}if(this.retryCount>this.trc.MAX_RETRY){__trcError("Exit "+method_signature+": max retry - last call was to "+this.src.split("/")[2].split(".")[0].toUpperCase());this.abortRendering();return}TRC.dom.onReady(this.sendRequest.trcBind(this),(TRC.Browser.ie)?false:true);__trcInfo("Exit "+method_signature+": success")};TRCRBox.prototype.getContainer=function(){return this.element.parentNode};TRCRBox.prototype.getMainBox=function(){return this.element};TRCRBox.prototype.sendEvent=function(type,params,once,callback,timeout){var wasCalled=false,eventParams={ri:this.response.trc.req,sd:TRC.pageManager.getPublisherValue(TRC.publisherId,"session-data"),ui:TRC.pageManager.getValue("user-id"),pi:this.trc.getItemId(),wi:this.response?this.response.trc["watched-item"]:null,pt:this.getItemType(),li:this.getListId()},passedCallback=function(){if(wasCalled){return}wasCalled=true;if(callback){callback()}};__trcCopyProps(params,eventParams);if(once){this.trc.log1(type,eventParams,passedCallback,this.placement)}else{this.trc.logTrcEvent(type,eventParams,passedCallback)}if(typeof timeout=="number"){setTimeout(passedCallback,timeout)}};TRCRBox.prototype.load=function(errorHandler){if(this.loaded){return}var itemid=this.trc.getItemId();var requestIsValid=(typeof itemid!="undefined"&&itemid!=null&&itemid.length!=0);if(requestIsValid){this.src=this.genRBoxURL();this.errorHandler=errorHandler;this.getData()}else{this.loaded=true}};TRCRBox.prototype.updateRecommendations=function(type){this.retryCount=0;this.drawList=false;this.response=null;this.forceItemType=type;this.reqParams={"item-type":this.trc.getItemType(),"item-id":this.trc.getItemId()};if(this.timeoutId){win.clearTimeout(this.timeoutId);this.timeoutId=null}this.loaded=false;this.trc.renderRBox(this);return true};TRCRBox.prototype.isVisible=function(container){container=(container)?container:this.container;function isAncestor(elm,ancestor){if(!elm.parentNode||elm.parentNode==document.documentElement&&elm!=ancestor){return false}return elm==ancestor||isAncestor(elm.parentNode,ancestor)}var rect=container.getBoundingClientRect();var targetX=rect.left+Math.round((rect.right-rect.left)/2),targetY=rect.top+Math.round((rect.bottom-rect.top)/2);var maxX=document.compatMode==="CSS1Compat"&&document.documentElement.clientWidth||document.body.clientWidth;var maxY=document.compatMode==="CSS1Compat"&&document.documentElement.clientHeight||document.body.clientHeight;var content=(TRC.Browser.operaUpto(10.1)||TRC.Browser.safariUpto(4))?document.elementFromPoint(targetX+document.body.scrollLeft,targetY+document.body.scrollTop):document.elementFromPoint(targetX,targetY);return targetX>0&&targetX<maxX&&targetY>0&&targetY<maxY&&content&&isAncestor(content,container)};TRCRBox.prototype.visible_items_collection=function(){var i;var visible_items_count=0;for(i=0;i<this.boxes.length;i++){if(this.isVisible(this.boxes[i])){if(this.boxes[i].video_data["is-syndicated"]){this.synd_visible_boxes[this.boxes[i].video_data["item-id"]]=this.boxes[i].video_data["item-id"]}else{this.visible_boxes[this.boxes[i].video_data["item-id"]]=this.boxes[i].video_data["item-id"]}visible_items_count++}}return visible_items_count};TRCRBox.prototype.clearChilds=function(e){while(e.hasChildNodes()){e.removeChild(e.lastChild)}};TRCRBox.prototype.addSyndicatorLogo=function(){if(this.syndicator&&typeof TRCobj.global!="undefined"){var header=this.header;var branding_url=TRCobj.global[this.syndicator+"-syndication-branding-url"];if(typeof branding_url!="undefined"&&branding_url!=""){var branding_div=document.createElement("div");branding_div.className="branding_div";var branding_img=document.createElement("img");branding_img.className="branding_img";branding_img.display="block";branding_img.style.border="0";branding_img.style.visibility="hidden";branding_img.style.position="absolute";var rand_id="";if(TRC.Browser.ieUpto(8)){rand_id="?id="+parseInt(Math.random()*10000)}branding_img.src=branding_url+rand_id;if(TRCobj.direction=="ltr"){branding_div.style.textAlign="right"}else{branding_div.style.textAlign="left"}branding_div.style.height="auto";branding_img.onload=function(){var max_width=Math.max(self.listContainer.clientWidth,self.listContainer.parentNode.clientWidth)-header_span.offsetWidth;if(Math.max(header_span.scrollHeight,header_span.offsetHeight)<=0){header_span.innerHTML="&nbsp;"}var max_height=Math.max(header.clientHeight,header.scrollHeight,header_span.scrollHeight);branding_div.style.height=this.height+"px";if(this.width>max_width){this.style.width=Math.max(max_width-5,0)+"px";branding_div.style.height=this.style.height="auto"}if(max_height<this.height){this.style.width="auto";this.height=max_height;branding_div.style.height=this.style.height=max_height+"px"}this.style.position="relative";this.style.visibility="visible";header.style.minHeight=this.clientHeight+"px"};branding_div.appendChild(branding_img);this.header.ext.insertBefore(branding_div,this.header.ext.firstChild)}}};TRCRBox.prototype.addSyndicatorLink=function(header,header_span){if(this.syndicator){return false}if(header_span.innerHTML==""||typeof this.trc.global=="undefined"||typeof this.trc.global[this.syndicator+"-syndication-main-link"]=="undefined"){return false}var syndication_link=document.createElement("a");syndication_link.className="trc-syndication-link";syndication_link.href=this.trc.global[this.syndicator+"-syndication-main-link"];syndication_link.target="blank";syndication_link.appendChild(header_span);header.appendChild(syndication_link);return true};TRCRBox.prototype.hasSyndicated=function(list){var i=0,item;for(;item=list[i];i++){if(item["is-syndicated"]){return true}}};TRCRBox.prototype.rePositionDurationElement=function(durationElement,width,height){if(TRC.Browser.ieUpto(6)){durationElement.style.marginLeft=(width/2-3)+"px";durationElement.style.top=(height/2-15)+"px"}else{if(TRC.Browser.ie===7){durationElement.style.left=(width-3)+"px";durationElement.style.top=(height-15)+"px"}else{durationElement.style.marginLeft=(width-3)+"px";durationElement.style.top=(height-15)+"px"}}};TRCRBox.prototype.getFirstVideoItem=function(trcrbox){var i=0,boxes=trcrbox.boxes,result=null;for(i=0;i<boxes.length;i++){if(!boxes[i].video_data.isAd&&!boxes[i].video_data["is-syndicated"]){result=boxes[i].video_data;break}}return result};TRCRBox.prototype.hasDuration=function(){var detail,detail_order=this.trc.getProperty(this.mode_name,"detail-order").split(",");for(var i=0;detail=detail_order[i];i++){if(detail=="duration"){return true}}};TRCRBox.prototype.cleanStyleDimensions=function(box){var durationElement=null;try{__trcDOMWalker(box,function(o){if(o.style.cssText){o.style.width="";o.style.height=""}if((o.className+"").indexOf("video-duration")!==-1){durationElement=o}})}catch(e){}return durationElement};TRCRBox.prototype.createBillboard=function(){var insertPoint=__trcGetElementsByClass("trc_rbox_outer","div",this.element)[0];if(!insertPoint){return null}var elem=document.createElement("div");this.billboard=elem;elem.className="trc_billboard";elem.style.width="auto";insertPoint.parentNode.insertBefore(elem,insertPoint);insertPoint.style.clear="both";return elem};TRCRBox.prototype.createEmbedThumb=function(video){var containerElement=this["player-container-id"]&&document.getElementById(this["player-container-id"]),template=this.trc.getProperty(this.mode_name,"player-detail-order"),innerContainer=document.createElement("DIV"),renderPlayerInfo=this.trc.getProperty(this.mode_name,"render-player-info"),box,durationElement,link,that=this,defaultHeight=this.trc.getProperty(this.mode_name,"player-thumbnail-height")||300,playerThumbnailWidth=this.trc.getProperty(this.mode_name,"player-thumbnail-width")||400;video=video||this.getFirstVideoItem(this);if(!video){__trcError("outerbox.js: video item was not found");return}containerElement=containerElement||this.createBillboard();if(!containerElement){__trcError("Can't find container element for createEmbedThumb!");return}containerElement.innerHTML="";containerElement.className+=" "+this.mode_name;containerElement.hasDuration=this.hasDuration();innerContainer.style.height="100%";innerContainer.style.cssFloat="left";innerContainer.className="playerCube";containerElement.appendChild(innerContainer);box=this.drawVideoBox(video,containerElement.hasDuration,template,"top");innerContainer.appendChild(box);link=box.getElementsByTagName("A");if(renderPlayerInfo){box.fixTextOverflow()}else{if(link[1]){link[1].parentNode.removeChild(link[1])}}if(box.thumb&&box.img&&box.img_src){box.thumb.appendChild(box.img);box.img.onload=(function(){var thumbWidth=renderPlayerInfo?playerThumbnailWidth:box.clientWidth,thumbHeight=renderPlayerInfo||this.billboard?defaultHeight:box.clientHeight;if(!(box.img.offsetWidth+box.img.offsetHeight)){setTimeout(function(){thumbWidth=renderPlayerInfo?playerThumbnailWidth:box.clientWidth,thumbHeight=renderPlayerInfo||this.billboard?defaultHeight:box.clientHeight;that.FixVideoImage(thumbWidth,thumbHeight,box.img)},10)}else{this.FixVideoImage(thumbWidth,thumbHeight,box.img)}}).trcBind(this);durationElement=this.cleanStyleDimensions(box);box.style.marginLeft="0";box.style.width="auto";box.style.height="100%";box.style.cssFloat="none";box.style.styleFloat="none";box.thumb.style.width=(renderPlayerInfo||this.billboard)?playerThumbnailWidth+"px":"100%";box.thumb.style.height=renderPlayerInfo||this.billboard?defaultHeight+"px":"100%";box.thumb.style.marginRight="0";box.thumb.style.position="relative";box.img.src=this.getThumbnailURL(video,box.thumb.offsetWidth,box.thumb.offsetHeight);if(TRC.Browser.ieUpto(6)){box.onmouseover=function(){this.className+=" playerCube_hover"};box.onmouseout=function(){this.className=this.className.replace(/\b\s+playerCube_hover\b/g,"")}}containerElement.videoBlock=link[0];link[0].onclick=(function(e){var embedCode=this.trc.getProperty(this.mode_name,"player-embed-code");e=e||event;if(typeof embedCode=="function"&&containerElement&&!win.trc_testmode){this.playInsideHostingContainer(video,embedCode,containerElement)}else{win.open(video.logger_url)}if(e.preventDefault){e.preventDefault()}return e.returnValue=false}).trcBind(this);box.visCheckDone=true;if(durationElement){this.rePositionDurationElement(durationElement,box.thumb.clientWidth,box.thumb.clientHeight)}}};TRCRBox.prototype.drawListBody=function(trc,delayCount){if(typeof trc!="object"){return}delayCount=(delayCount||0);var listContainer=this.listContainer;this.boxes=[];var internalc_width=0;var TRCobj=this.trc;this.injectQuantcast();function autoHeight(elm){var oldVal=parseInt(document.trcGetCurrentStyle(elm,"height"));if(isNaN(oldVal)){return true}var p=document.createElement("span");with(p.style){display="block";height="10px";width="10px"}elm.appendChild(p);var newVal=parseInt(document.trcGetCurrentStyle(elm,"height"));elm.removeChild(p);return(newVal!=oldVal)}function setHeight(elm,height){elm.style.height=height+"px";var factor=0;while(elm.clientHeight>height){elm.style.height=(height-(++factor))+"px"}}var has_duration_label=false;var detail_order=this.trc.getProperty(this.mode_name,"detail-order");var orientation=this.trc.getProperty(this.mode_name,"orientation");detail_order=detail_order.split(",");for(var i=0;i<detail_order.length;i++){if(detail_order[i]=="duration"){has_duration_label=true}}var explore_delay=0;this.exploreTimeoutId=null;if(typeof this.trc.global!="undefined"){explore_delay=(this.trc.global["explore-delay"])?this.trc.global["explore-delay"]:explore_delay}var self=this;this.container.onmouseover=(function(e){var element=null;if(win.event){element=win.event.srcElement}else{if(e){element=e.target}}if((element!=this.container&&this.exploreTimeoutId!=null)||(element==this.container&&this.exploreTimeoutId!=null)){return}this.exploreTimeoutId=win.setTimeout((function(){if(this.exploreTimeoutId){win.clearTimeout(this.exploreTimeoutId);this.exploreTimeoutId=null}this.sendEvent("explore",{},true)}).trcBind(this),explore_delay)}).trcBind(this);if(explore_delay!=0){this.container.onmouseout=(function(e){e=e||win.event;var dimentions=this.container.getBoundingClientRect();if((e.clientX>=dimentions.left&&e.clientX<dimentions.right)&&(e.clientY>=dimentions.top&&e.clientY<dimentions.bottom)){return}if(this.exploreTimeoutId){win.clearTimeout(this.exploreTimeoutId);this.exploreTimeoutId=null}}).trcBind(this)}var internalc=document.createElement("div");internalc.id="internal_"+this.id;while(listContainer.firstChild){listContainer.removeChild(listContainer.firstChild)}listContainer.appendChild(internalc);if(listContainer.style.display=="none"||listContainer.parentNode.style.display=="none"){this.listContainer.style.display="block";this.listContainer.parentNode.style.display="block"}var trcmeta={};__trcCopyProps(trc,trcmeta);delete trcmeta["video-list"];internalc.meta=trcmeta;this.firstVideo=null;var listSize=TRCobj.getProperty(this.mode_name,"list-size");listSize=Math.min(listSize,this.recommendationList.length);if(orientation=="horizontal"){listContainer.style.overflowY="hidden";listContainer.style.overflowX="auto";internalc.style.width="5000px"}else{listContainer.style.overflowX="hidden";listContainer.style.overflowY="auto"}for(var i=0;i<listSize;i++){var cur=this.recommendationList[i];if(this.firstVideo==null&&cur.type=="video"){this.firstVideo=cur}try{this.trc.getFunction(this.mode_name,"item-data-filter",cur);var box=this.drawVideoBox(cur,has_duration_label);if(orientation=="vertical"){var clear_div=document.createElement("div");clear_div.style.clear="both";box.appendChild(clear_div)}if(TRCobj.getProperty(this.mode_name,"navigation-type")!="scrolling"){internalc.appendChild(box);if(box.offsetHeight>listContainer.offsetHeight){var diff=box.offsetHeight-listContainer.offsetHeight;box.style.height=parseInt(document.trcGetCurrentStyle(box,"height"))-diff+"px"}internalc.removeChild(box)}else{internalc.appendChild(box);box.fixTextOverflow();if(!box.video_data.isAd){if(typeof box.image_div=="undefined"){box.thumb.appendChild(box.img)}else{box.thumb.appendChild(box.image_div);box.image_div.appendChild(box.img)}box.img.src=box.img_src}var mrg_right=parseInt(document.trcGetCurrentStyle(box,"margin-right"));internalc_width=box.clientWidth+box.offsetLeft+(isNaN(mrg_right)?0:mrg_right);if(orientation=="horizontal"&&autoHeight(box)){setHeight(box,listContainer.offsetHeight)}}this.boxes.push(box)}catch(e){__trcError("Error in drawVideoBox",e)}}if(TRCobj.getProperty(this.mode_name,"navigation-type")!="scrolling"){internalc.style.width="auto";var pagerDiv=self.drawPager();var auto=TRCobj.getProperty(self.mode_name,"auto-scroll");if(typeof auto!="undefined"&&typeof pagerDiv!="undefined"&&auto!="none"){self.auto_scroll=function(){var auto_index=0;for(i=0;i<pagerDiv.pages.length;i++){if(pagerDiv.pages[i]==pagerDiv.current&&i!=(pagerDiv.pages.length-1)){auto_index=++i;break}}pagerDiv.pages[auto_index].page_switch()};if(self.auto_scroll_interval!=null){win.clearInterval(self.auto_scroll_interval)}self.auto_scroll_interval=win.setInterval(self.auto_scroll,parseInt(auto))}}else{internalc.style.width=internalc_width+"px";if(TRC.Browser.ieUpto(6)&&listContainer.parentNode.parentNode.clientWidth*1.1<listContainer.clientWidth){listContainer.style.width="99%"}(function(attr){if(listContainer["client"+attr]+1>=listContainer["scroll"+attr]){return}if(TRC.Browser.ie&&TRC.Browser.ie<8){listContainer.style[attr.toLowerCase()]=internalc["client"+attr]+18+"px";if(attr=="Width"){this.element.style.width=listContainer.style[attr.toLowerCase()]}return}var step=Math.floor(Math.max(1,(listContainer["scroll"+attr]-listContainer["client"+attr])));step-=Math.max(0,listContainer["scroll"+attr]-listContainer.parentNode["scroll"+attr]);var oldVal=parseInt(listContainer.style[attr.toLowerCase()]);var targetWidth=(Math.max(listContainer["scroll"+attr],isNaN(oldVal)?0:oldVal)+step)+"px";listContainer.style[attr.toLowerCase()]=targetWidth;if(attr=="Width"){this.element.style.width=targetWidth}this.postRenderQueue.pushFront("adapt to scrollbar",arguments.callee.trcBind(this,attr))}).call(this,(TRCobj.getProperty(this.mode_name,"orientation")=="horizontal")?"Height":"Width");if(TRCobj.getProperty(this.mode_name,"shade-scroll")){this.postRenderQueue.pushBack("drawShade",(function(o){this.drawShade(o)}).trcBind(this,orientation))}listContainer.onscroll=(function(){this.sendEvent("explore",{},true);this.check_visibility()}).trcBind(this);this.check_visibility()}if(this.hasSyndicatedContent){this.postRenderQueue.pushBack("syndication hint icon",this.addSyndicationHintIcon.trcBind(this,internalc))}if("embed"===this.link_target){this.postRenderQueue.pushBack("createEmbedThumb",this.createEmbedThumb.trcBind(this))}this.postRenderQueue.pushBack("list-suffix,publisher-end",function(internalc){this.trc.getFunction(this.mode_name,"list-suffix",internalc,this);this.trc["publisher-end"](this.id)}.trcBind(this,internalc));this.postRender();this.sendEvent("available",{},true);var visible_delay=0;this.visibleTimeoutId=null;if(typeof this.trc.global!="undefined"){visible_delay=(this.trc.global["visible-delay"])?this.trc.global["visible-delay"]:visible_delay}(function(){var ilarr,silarr;this.visible_boxes={};this.synd_visible_boxes={};if(((this.visible_items_collection())>=2)||this.isVisible()){var external=arguments.callee;this.visibleTimeoutId=win.setTimeout((function(){if(this.visibleTimeoutId){win.clearTimeout(this.visibleTimeoutId);this.visibleTimeoutId=null}if(((this.visible_items_collection())>=2)||this.isVisible()){ilarr=[];silarr=[];for(var key in this.visible_boxes){ilarr.push(key)}for(var key in this.synd_visible_boxes){silarr.push(key)}if(ilarr.length>0||silarr.length>0){this.sendEvent("visible",{il:ilarr.join(","),sil:silarr.join(",")},true);this.trc.getFunction(this.mode_name,"after-visible",internalc,this);return}return}win.setTimeout(external.trcBind(this),1000)}).trcBind(this),visible_delay)}else{win.setTimeout(arguments.callee.trcBind(this),1000)}}).trcBind(this)();var active=this.trc.getProperty(this.mode_name,"auto-advance");if(active!=-1&&typeof active!="undefined"){if(this.autoPlayer==null){this.autoPlayer=this.startAutoPlayManager(this.firstVideo,active)}else{this.autoPlayer.getPlaylistItem("n")}}};TRCRBox.prototype.postRender=function(execute){if(execute){var front=this.postRenderQueue.popFront();if(front==null){__trcInfo("TRCRBox.postRender: finished");return}__trcInfo("TRCRBox.postRender: executing "+front.name);try{front.func.call(this)}catch(e){__trcError("Error in TRCRBox.postRender while executing "+front.name,e)}}win.setTimeout(this.postRender.trcBind(this,true),0)};TRCRBox.prototype.addSyndicationHintIcon=function(parent){var attributionText=this.trc.getProperty(this.mode_name,"syndicated-attribution"),hintText=this.trc.getProperty(this.mode_name,"syndicated-attribution-tooltip"),pos=this.trc.getProperty(this.mode_name,"syndicated-attribution-position"),iconElement=document.createElement("a"),re=/\btrc_rbox\b/,that=this,serviceURL="http://services.taboolasyndication.com/publisher/"+this.publisher+"/rbox?service=info&topic=synd";iconElement.href="#about_syndication";iconElement.appendChild(document.createTextNode(attributionText));iconElement.title=hintText;iconElement.style.display="block";iconElement.className="whatsThisSyndicated a-"+pos;this.syndicatedAttributionElement=iconElement;while(!re.test(parent.className)){parent=parent.parentNode}parent.appendChild(iconElement);if("absolute"!==parent.style.position){parent.style.position="relative"}TRC.dom.on(iconElement,"click",function(e){return that.handleSyndicationIconClick(e,serviceURL)})};TRCRBox.prototype.handleSyndicationIconClick=function(e,url){e=e||event;e.returnValue=false;e.cancelBubble=true;if(e.stopPropagation){e.stopPropagation()}if(e.preventDefault){e.preventDefault()}win.open(url,"aboutSyndication","location=0, width=330, height=410, resizable=0, status=0, menubar=0, toolbar=0, titlebar=0, scrollbars=0");return false};TRCRBox.prototype.injectQuantcast=function(){var quantcastLabel=[this.publisher,this.getItemType(),this.mode].join(".");if(quantcastLabel){if(typeof __qc==="undefined"){win._qevents=win._qevents||[];this.trc.loadExternal((document.location.protocol=="https:"?"https://secure":"http://edge")+".quantserve.com/quant.js","js")}win._qevents.push({qacct:"p-82ntF_h97O-3c",labels:quantcastLabel})}};TRCRBox.prototype.drawShade=function(orientation){if(TRC.Browser.ie&&TRC.Browser.ie<=6){return}var shadeSize=this.listContainer["client"+(orientation=="vertical"?"Width":"Height")]+"px";var shadeSpace=(this.listContainer["client"+(orientation=="vertical"?"Height":"Width")]+this.listContainer["client"+(orientation=="vertical"?"Top":"Left")]-10)+"px";var start_shade=document.createElement("div");start_shade.className=orientation+"-start-shade";start_shade.style[orientation=="vertical"?"width":"height"]=shadeSize;start_shade.style["margin"+(orientation=="vertical"?"Top":"Left")]=this.listContainer["client"+(orientation=="vertical"?"Top":"Left")]+"px";var end_shade=document.createElement("div");end_shade.className=orientation+"-end-shade";end_shade.style[orientation=="vertical"?"width":"height"]=shadeSize;this.listContainer.parentNode.insertBefore(start_shade,this.listContainer);this.listContainer.parentNode.insertBefore(end_shade,this.listContainer);end_shade.style["margin"+(orientation=="vertical"?"Top":"Left")]=shadeSpace;end_shade.style.backgroundRepeat=start_shade.style.backgroundRepeat="repeat-"+(orientation=="vertical"?"x":"y")};TRCRBox.prototype.drawPager=function(){var TRCobj=this.trc;var pager_style=TRCobj.getProperty(this.mode_name,"pager-type-style");var cyclical=TRCobj.getProperty(this.mode_name,"cyclical-paging");var pager_position=TRCobj.getProperty(this.mode_name,"pager-position");var pager_btn_location=TRCobj.getProperty(this.mode_name,"pager-button-location");var pager_btn_style=TRCobj.getProperty(this.mode_name,"pager-button-style");var mode_name=this.mode_name;var listContainer=this.listContainer;var orientation=TRCobj.getProperty(mode_name,"orientation");var pageContainer=listContainer.firstChild;function count_number_of_pages(){var pages_indexes=new Array();var j=0;var start_index=0;for(i=0;i<this.boxes.length;i++){var box=this.boxes[i];pageContainer.appendChild(box);box.fixTextOverflow(true);if(orientation=="vertical"){if((pageContainer.offsetHeight-5)>=listContainer.clientHeight){pageContainer.removeChild(box);pages_indexes[j++]={start_index:start_index,end_index:((i-1)<start_index)?start_index:i-1};if((i-1)>=start_index){start_index=i--}else{start_index=i}this.clearChilds(pageContainer)}}else{if(((listContainer.clientHeight*1.1))<listContainer.scrollHeight){pageContainer.removeChild(box);pages_indexes[j++]={start_index:start_index,end_index:((i-1)<=start_index)?start_index:i-1};if((i-1)>=start_index){start_index=i--}else{start_index=i}this.clearChilds(pageContainer)}}}pages_indexes[j]={start_index:start_index,end_index:i-1};this.clearChilds(pageContainer);return pages_indexes}this.clearChilds(pageContainer);listContainer.style.overflowX="hidden";listContainer.style.overflowY="hidden";var pages_indexes=count_number_of_pages.call(this);var clear_div=document.createElement("div");clear_div.style.clear="both";for(var i=pages_indexes[0].start_index;i<=pages_indexes[0].end_index;i++){if(i>=this.boxes.length){continue}var box=this.boxes[i];pageContainer.appendChild(box);if(box.video_data.isAd){if(box.img_src!=null){box.video_data.ad_load_count=new Date().getTime();box.thumb.appendChild(box.img);box.img.src=box.img_src;if(box.spnoverlay!=null){var overlay=box.spnoverlay;var in_span=overlay.firstChild;var sponsored_span=overlay.lastChild;var sponsored_height=sponsored_span[(sponsored_span.clientHeight>0?"client":"scroll")+"Height"];in_span.style.width=sponsored_span[(sponsored_span.clientWidth>0?"client":"scroll")+"Width"]+"px";overlay.style.height=in_span.style.height=Math.max(sponsored_height,parseInt(in_span.style.height))+"px"}box.img_src=null}}else{try{if(box.img_src!=null){if(typeof box.image_div=="undefined"){box.thumb.appendChild(box.img)}else{box.thumb.appendChild(box.image_div);box.image_div.appendChild(box.img)}box.img.src=box.img_src;box.img_src=null}}catch(e){__trcError("Pager thumbnail images fixing errors",e)}}box.fixTextOverflow()}pageContainer.appendChild(clear_div);var pager_el=this.pager;if(pager_el!=null){try{pager_el.parentNode.removeChild(pager_el)}catch(e){}}var countPages=pages_indexes.length;if(countPages<=1||TRCobj.getProperty(this.mode_name,"navigation-type")=="none"){this.check_visibility();return}var paderDiv_parent=document.createElement("div");paderDiv_parent.style.position="absolute";paderDiv_parent.style.width=(listContainer.clientWidth/2)+"px";var pagerDiv=document.createElement("div");paderDiv_parent.appendChild(pagerDiv);listContainer.parentNode.appendChild(paderDiv_parent);pagerDiv.id="trc_pager_"+this.id;pagerDiv.className="trc_pager";pagerDiv.current=null;pagerDiv.pages=new Array();pagerDiv.curPage=0;var listContainer_width=listContainer.clientWidth;var prevButton=document.createElement("div");prevButton.id="pager_prev_"+this.id;prevButton.className="trc_pager_prev";if(pager_btn_location=="sides"){prevButton.style.width="auto";prevButton.style.paddingTop=(listContainer.clientHeight-prevButton.clientHeight)/2+"px";prevButton.style.position="absolute";prevButton.style[(TRCobj.direction=="ltr")?"left":"right"]="0px";listContainer.parentNode.insertBefore(prevButton,listContainer)}else{pagerDiv.appendChild(prevButton)}prevButton.onclick=function(){if(pagerDiv.curPage>0){pagerDiv.pages[pagerDiv.curPage-1].onclick()}else{if(cyclical){pagerDiv.pages[pagerDiv.pages.length-1].onclick()}}};var nextButton=document.createElement("div");nextButton.id="pager_next_"+this.id;nextButton.className="trc_pager_next";nextButton.onclick=function(){if(pagerDiv.curPage+1<pagerDiv.pages.length){pagerDiv.pages[pagerDiv.curPage+1].onclick()}else{if(cyclical){pagerDiv.pages[0].onclick()}}};var inactive_img=TRCobj.getProperty(this.mode_name,"pager-button-inactive-image");var active_img=TRCobj.getProperty(this.mode_name,"pager-button-active-image");var hover_img=TRCobj.getProperty(this.mode_name,"pager-button-hover-image");if(pager_btn_location!="none"){if(pager_btn_style=="image"){if(inactive_img!=""){prevButton.image=document.createElement("img");if(pager_btn_location=="sides"){prevButton.image.onload=function(){listContainer.style.paddingLeft=listContainer.style.paddingRight=this.clientWidth+"px"}}prevButton.image.src=inactive_img;prevButton.appendChild(prevButton.image);nextButton.image=document.createElement("img");if(pager_btn_location=="sides"){nextButton.image.onload=function(){listContainer.style.paddingLeft=listContainer.style.paddingRight=this.clientWidth+"px";this.style[(TRCobj.direction=="ltr")?"left":"right"]=listContainer_width-this.clientWidth+"px"}}nextButton.image.src=inactive_img;nextButton.appendChild(nextButton.image);prevButton.onmouseover=function(){this.before_image=this.image.src;if(hover_img!=this.image.src){this.image.src=hover_img}};prevButton.onmouseout=function(){if(typeof this.before_image!="undefined"){if(this.before_image!=this.image.src){this.image.src=this.before_image}}};nextButton.onmouseover=function(){this.before_image=this.image.src;if(hover_img!=this.image.src){this.image.src=hover_img}};nextButton.onmouseout=function(){if(typeof this.before_image!="undefined"){if(this.before_image!=this.image.src){this.image.src=this.before_image}}}}else{prevButton.innerHTML="&lt;";nextButton.innerHTML="&gt;"}}else{var btn_next_prev=pager_btn_style.split("|");btn_prev=btn_next_prev[0];btn_next=btn_next_prev[1];prevButton.innerHTML=btn_prev;nextButton.innerHTML=btn_next}}else{prevButton.style.display="none";nextButton.style.display="none"}var pagesContainer=document.createElement("div");pagesContainer.className="trc_pager_pages";pagerDiv.appendChild(pagesContainer);var pager_active_img=TRCobj.getProperty(this.mode_name,"pager-style-active-image");var pager_inactive_img=TRCobj.getProperty(this.mode_name,"pager-style-inactive-image");var pager_hover_img=TRCobj.getProperty(this.mode_name,"pager-style-hover-image");for(var i=0;i<countPages;i++){var page=document.createElement("div");switch(pager_style){case"none":page.innerHTML="";pagesContainer.style.cssText="display:none !important;";break;case"numbers":page.innerHTML=""+(i+1);break;case"counter":var counter_span=document.createElement("span");counter_span.className="trc_pager_counter";counter_span.innerHTML=Gettext.strargs(TRCobj.gt.gettext("%1 of %2"),[(i+1),pagerDiv.pages.length]);page.appendChild(counter_span);if(pagesContainer.className.search("trc_pager_counter")<0){pagesContainer.className+=" trc_pager_counter"}break;case"bullets":page.innerHTML='<span style="font-weight: bold;">&bull;</span>';break;case"image":if(pager_active_img!=""){page.inner_img=document.createElement("img");page.inner_img.src=pager_inactive_img;page.appendChild(page.inner_img)}else{page.innerHTML=""+(i+1)}break}page.className="trc_pager_unselected";pagesContainer.appendChild(page);page.index=i;var self=this;page.page_switch=function(){try{pageContainer.removeChild(clear_div)}catch(e){}if(pagerDiv.current!=null){if(pager_style=="image"){if(pager_inactive_img!=""){page.inner_img.src=pager_inactive_img}}pagerDiv.current.className="trc_pager_unselected";for(i=pages_indexes[pagerDiv.curPage].start_index;i<=(pages_indexes[pagerDiv.curPage].end_index);i++){if(i<self.boxes.length){pageContainer.removeChild(self.boxes[i])}}for(i=pages_indexes[this.index].start_index;i<=pages_indexes[this.index].end_index;i++){if(i>=self.boxes.length){continue}var box=self.boxes[i];pageContainer.appendChild(box);if(typeof box.img!="undefined"){if(box.img_src!=null){box.video_data.ad_load_count=new Date().getTime();if(typeof box.image_div=="undefined"){box.thumb.appendChild(box.img)}else{box.thumb.appendChild(box.image_div);box.image_div.appendChild(box.img)}box.img.src=box.img_src;box.img_src=null}}if(box.spnoverlay!=null){var overlay=box.spnoverlay;var in_span=overlay.firstChild;var sponsored_span=overlay.lastChild;var sponsored_height=sponsored_span[(sponsored_span.clientHeight>0?"client":"scroll")+"Height"];in_span.style.width=sponsored_span[(sponsored_span.clientWidth>0?"client":"scroll")+"Width"]+"px";overlay.style.height=in_span.style.height=Math.max(sponsored_height,parseInt(in_span.style.height))+"px";box.spnoverlay=null}box.fixTextOverflow();self.postRender()}}pageContainer.appendChild(clear_div);pagerDiv.current=this;if(pager_style=="image"){if(pager_active_img!=""){page.inner_img.src=pager_active_img}}this.className="trc_pager_selected";pagerDiv.curPage=this.index;if(typeof nextButton!="undefined"){if((this.index+1>=pagerDiv.pages.length)&&(!cyclical)){if(inactive_img!=""&&pager_btn_location!="none"){nextButton.image.src=inactive_img}nextButton.className="trc_pager_next pager_disabled"}else{if(active_img!=""&&pager_btn_location!="none"){nextButton.image.src=active_img}nextButton.className="trc_pager_next pager_enabled"}}if(typeof prevButton!="undefined"){if(this.index<=0&&(!cyclical)){if(inactive_img!=""&&pager_btn_location!="none"){prevButton.image.src=inactive_img}prevButton.className="trc_pager_prev pager_disabled"}else{if(active_img!=""&&pager_btn_location!="none"){prevButton.image.src=active_img}prevButton.className="trc_pager_prev pager_enabled"}}if(pager_style=="counter"){var divelm=document.createElement("div");divelm.appendChild(document.createTextNode(Gettext.strargs(TRCobj.gt.gettext("%1 of %2"),[(this.index+1),pagerDiv.pages.length])));while(pagesContainer.firstChild){pagesContainer.removeChild(pagesContainer.firstChild)}pagesContainer.appendChild(divelm)}self.check_visibility()};page.onclick=function(){this.page_switch();if(this.index!=0){self.sendEvent("explore",{},true)}};page.onmouseover=function(){if(pager_style=="image"){if(pager_hover_img!=""){this.prev_img=this.inner_img.src;this.inner_img.src=pager_hover_img}}};page.onmouseout=function(){if(pager_style=="image"){if(typeof this.prev_img!="undefined"){this.inner_img.src=this.prev_img}}};pagerDiv.pages.push(page)}if(pager_btn_location=="sides"){nextButton.style.width="auto";nextButton.style.paddingTop=(listContainer.clientHeight-nextButton.clientHeight)/2+"px";nextButton.style.position="absolute";listContainer.parentNode.insertBefore(nextButton,listContainer);listContainer.style.paddingLeft=listContainer.style.paddingRight=nextButton.clientWidth+"px";nextButton.style[(this.trc.direction=="ltr")?"left":"right"]=listContainer_width+nextButton.clientWidth+"px"}else{pagerDiv.appendChild(nextButton)}pagerDiv.pages[0].onclick();this.pager=pagerDiv;if(pager_position=="center"){pagerDiv.style.position="absolute";pagerDiv.style.cssFloat="none";pagerDiv.style.styleFloat="none";pagerDiv.style.display="block";var pagerWidth=pagerDiv.clientWidth;pagerDiv.style.width=(pagerWidth+2)+"px";pagerDiv.style.position="relative";var padLeft=((listContainer.clientWidth-pagerWidth)/2);pagerDiv.parentNode.style.width=(pagerWidth+2+padLeft)+"px";pagerDiv.style.marginLeft=padLeft+"px"}else{if(pager_position=="header"){if(this.header.ext){pagerDiv.parentNode.removeChild(pagerDiv);pagerDiv.className+=" in_trc_header";var pagerContainer=document.createElement("div");pagerContainer.appendChild(pagerDiv);pagerContainer.id=pagerDiv.id;pagerDiv.id="";var clear=document.createElement("div");clear.style.clear="left";pagerContainer.appendChild(clear);if(!this.header.titleBox.innerHTML){this.header.titleBox.innerHTML="&nbsp;"}this.header.ext.appendChild(pagerContainer)}}}return pagerDiv};TRCRBox.prototype.check_visibility=function(){for(var i=0;i<this.boxes.length;i++){var box=this.boxes[i];if(box.visCheckDone){continue}if(!this.is_box_visible(box)){continue}if(!box.video_data.isAd){continue}box.video_data.ad_load_count=new Date().getTime();if(box.thumb&&box.img&&box.img_src){box.thumb.appendChild(box.img);box.img.src=box.img_src}if(typeof box.onvisible=="function"){box.onvisible()}if(box.spnoverlay!=null){var overlay=box.spnoverlay;var in_span=overlay.firstChild;var sponsored_span=overlay.lastChild;var sponsored_height=sponsored_span[(sponsored_span.clientHeight>0?"client":"scroll")+"Height"];in_span.style.width=sponsored_span[(sponsored_span.clientWidth>0?"client":"scroll")+"Width"]+"px";overlay.style.height=in_span.style.height=Math.max(sponsored_height,parseInt(in_span.style.height))+"px";box.spnoverlay=null}box.visCheckDone=true}};TRCRBox.prototype.startAutoPlayManager=function(recommendation,active){if(typeof this.autoplaybox!="object"){return null}var container=this.autoplaybox;var playerbox=document.createElement("div");container.playerbox=playerbox;container.appendChild(playerbox);var autoPlayer=new TRC.AutoPlaylistController(this,this.publisher,null,container,recommendation,this.listContainer.id,active);autoPlayer.render(playerbox);return autoPlayer};TRCRBox.prototype.playInsideHostingContainer=function(recommendation,embedCode,containerElement){var renderPlayerInfo=this.trc.getProperty(this.mode_name,"render-player-info"),defaultHeight,box,link,template=this.trc.getProperty(this.mode_name,"player-detail-order"),newVideoBlock;if(containerElement.videoBlock){if("A"===containerElement.videoBlock.tagName.toUpperCase()){defaultHeight=this.trc.getProperty(this.mode_name,"player-thumbnail-height")||300;containerElement.videoBlock.parentNode.replaceChild(newVideoBlock=document.createElement("DIV"),containerElement.videoBlock);containerElement.videoBlock=newVideoBlock;containerElement.videoBlock.style.height=renderPlayerInfo?defaultHeight+"px":"";containerElement.videoBlock.style.overflow="hidden";if(renderPlayerInfo){containerElement.videoBlock.style.width=(this.trc.getProperty(this.mode_name,"player-thumbnail-width")||400)+"px";containerElement.videoBlock.style.height=(this.trc.getProperty(this.mode_name,"player-thumbnail-height")||300)+"px"}}__trcPurgeEventHandlers(containerElement.videoBlock);containerElement.videoBlock.innerHTML="";link=containerElement.getElementsByTagName("A")[0];embedCode.apply(null,[containerElement.videoBlock,recommendation]);if(renderPlayerInfo){box=this.drawVideoBox(recommendation,containerElement.hasDuration,template,"top");__trcPurgeEventHandlers(link);link.parentNode.replaceChild(box.getElementsByTagName("A")[1],link)}this.sendEvent("click",{ii:recommendation["item-id"],it:recommendation.type})}else{__trcError("Error opening autoPlayContainer",e)}};TRCRBox.prototype.openPlayer=function(recommendation,code,clickEvent){var publisher=this.publisher;var global_prefix="";if(this.syndicator){global_prefix=this.syndicator+"-";publisher=this.syndicator}var autoplayTime=this.trc.global[global_prefix+"auto-advance"];if(typeof autoplayTime=="undefined"){autoplayTime=-1}var affiliate_id=this.trc.global["syndicator-affiliate-id"];if(typeof affiliate_id=="undefined"){affiliate_id=null}if(typeof window.trc_lightboxOpen=="function"){window.trc_lightboxOpen()}try{var container=new TRC.LightBoxManager(this.trc.getProperty(this.mode_name,"lightbox-display-title"),clickEvent,this.listContainer.id,this.trc.direction);container.createHeader(recommendation.title,this.trc.global[this.syndicator+"-syndication-branding-url"]);container.addElements({bottom:new TRC.AutoPlaylistController(this,publisher,true,container,recommendation,"rbox-lightbox",autoplayTime)});container.open();this.sendEvent("click",{ii:recommendation["item-id"],it:recommendation.type})}catch(e){__trcError("Error opening autoPlayContainer",e)}};TRCRBox.prototype.findElement=function(predicate,parent,tag,dflt){if(typeof parent=="undefined"){parent=document}if(typeof tag=="undefined"){tag="*"}var elms=parent.getElementsByTagName(tag);for(var i=0;i<elms.length;i++){if(predicate(elms[i])){return elms[i]}}return dflt};TRCRBox.prototype.findFlash=function(predicate){var flash=this.findElement(predicate,document,"embed");if(flash){return flash}return this.findElement(predicate,document,"object")};TRCRBox.prototype.pauseVideo=function(reason){var flashObj=this.findFlash(function(o){return typeof o.pauseVideo=="function"});try{if(flashObj){flashObj.pauseVideo(reason)}}catch(e){__trcError("Error in pauseVideo",e)}if(typeof window.trc_pauseVideo=="function"){window.trc_pauseVideo(reason)}};TRCRBox.prototype.playVideoAd=function(video,reqId,sesData,mylistid){var flashObj=this.findFlash(function(o){return typeof o.playVideoAd=="function"});try{if(flashObj){flashObj.playVideoAd(video.title,video["display-url"],video["landing-url"],video.url,reqId,sesData,video["item-id"],mylistid)}}catch(e){__trcError("Error in playVideoAd",e)}};TRCRBox.prototype.createVideoLink=function(video,title){var link=document.createElement("a");link.title=title;video.link_target=this.link_target;if(video.type=="video-ad"){link.href="#";link.onmouseover=this.sendEvent.trcBind(this,"discover",{ii:video["item-id"],it:video.type},true,null,null);link.onclick=(function(e){e=e||event;this.sendEvent("click",{ii:video["item-id"],it:video.type},false,this.playVideoAd.trcBind(this,video,this.response.trc.req,TRC.pageManager.getPublisherValue(TRC.publisherId,"session-data"),this.listContainer.id));if(e.preventDefault){e.preventDefault()}return e.returnValue=false}).trcBind(this)}else{if(video.type=="text-ad"){link.href=video.logger_url;link.target="_blank";link.onmouseover=this.sendEvent.trcBind(this,"discover",{ii:video["item-id"],it:video.type},true,null,null);link.onclick=(function(e){e=e||win.event;this.pauseVideo("link");win.open(video.logger_url);if(e.preventDefault){e.preventDefault()}return e.returnValue=false}).trcBind(this)}else{if(video["is-syndicated"]){link.href=video.url;link.logger_url=video.logger_url.replace("&url=","&redir=");link.target="_blank";link.onmousedown=function(e){link.href=link.logger_url};link.onclick=(function(e){this.pauseVideo("link");return true}).trcBind(this)}else{link.href=video.url;if(this.link_target!="blank"){link.target="_parent"}link.onmousedown=function(e){link.href=video.logger_url};link.onclick=this.videoLinkClickHandler.trcBind(this,video,link)}}}return link};TRCRBox.prototype.videoLinkClickHandler=(function(){var CLICK_TIMEOUT=2000,openLightbox=function(rbox,video,e){var global_prefix=rbox.syndicator?rbox.syndicator+"-":"",embed_code=rbox.trc.global[global_prefix+"syndication-embed-code"];if(typeof embed_code=="function"&&!win.trc_testmode){rbox.openPlayer(video,embed_code,e)}else{win.open(video.logger_url)}return false},openEmbedbox=function(rbox,video){var embedCode=rbox.trc.getProperty(rbox.mode_name,"player-embed-code"),playerContainerId=rbox["player-container-id"],containerElement=rbox.billboard||document.getElementById(playerContainerId);if(video.isAd){win.open(video.url)}else{if(typeof embedCode=="function"&&containerElement&&!win.trc_testmode){rbox.playInsideHostingContainer(video,embedCode,containerElement,rbox.mode_name)}else{win.open(video.logger_url)}}return false},openBlankbox=function(rbox,video,link){if(video.type=="video"){rbox.pauseVideo("link")}link.target="_blank";link.href=video.url;rbox.sendEvent("click",{ii:video["item-id"],it:video.type},false);return true},playVideo=function(plugin,id){switch(plugin){case"brightcove":return TRC.brightcove_playVideo(id);case"ooyala":return TRC.ooyala_playVideo(id);case"kaltura":return TRC.kaltura_playVideo(id)}},openDefault=function(video){var videoTarget=video.link_target;if(videoTarget==="local"){if(typeof window.trc_videoSelected=="function"){window.trc_videoSelected.call(window,video.id,video.url);return}videoTarget=this.trc.video_source}if(playVideo(videoTarget,video.id)){return}this.clickLink(video.url)};return function(video,link,e){e=e||event;var videoTarget=video.link_target;var result=false;if(videoTarget==="lightbox"&&this.trc.global){return openLightbox(this,video,e)}switch(videoTarget){case"embed":result=openEmbedbox(this,video,link);break;case"blank":result=openBlankbox(this,video,link);break;default:this.sendEvent("click",{ii:video["item-id"],it:video.type},false,this.publisherClickHandler.trcBind(this,video,openDefault.trcBind(this,video)),CLICK_TIMEOUT)}if(video.url!=video.original_url){__trcDebug("url:"+video.original_url+", changed to:"+video.url+", on page:"+win.location.href)}if(!result){e.cancelBubble=true;if(e.stopPropagation){e.stopPropagation()}}return result}}());TRCRBox.prototype.clickLink=function(url,target){if(TRC.Browser.firefoxUpto(8)){win.location.href=url}var tempLink=document.createElement("a");tempLink.href=url;tempLink.target=!target?"_parent":target;tempLink.style.visibility="hidden";document.body.appendChild(tempLink);if(tempLink.click){tempLink.click();return}var e=document.createEvent("MouseEvent");e.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);tempLink.dispatchEvent(e)};TRCRBox.prototype.publisherClickHandler=function(video,callback){var publicRecommendation=__trcCopyProps(video,{});delete publicRecommendation["item-id"];delete publicRecommendation.link;try{if(typeof this.onclick=="function"&&!this.onclick.call(this.pubOpts,publicRecommendation)){return false}if(typeof this.trc.onclick=="function"&&!this.trc.onclick.call(this.pubOpts,publicRecommendation)){return false}}catch(e){__trcError("Publisher 'onclick' handler had an error",e)}return callback(this)};TRCRBox.prototype.add_span=function(span_class,span_innerHtml,span_parent){var span=document.createElement("span");if(span_class!=null){span.className=span_class}if(span_innerHtml!=null){if(typeof span_innerHtml=="object"){span.appendChild(span_innerHtml)}else{span.innerHTML=span_innerHtml}}if(typeof span_parent!="undefined"){span_parent.appendChild(span)}return span};TRCRBox.prototype.genSponsoredLabel=function(video,thumbBlock,div){var parent=this.listContainer;var sponsored_location=this.trc.getProperty(this.mode_name,"sponsored-location");if(!sponsored_location.match(/^thumbnail/)){div.spnoverlay=null;return}var thumbnail_height=this.trc.getProperty(this.mode_name,"thumbnail-height");var thumbnail_width=this.trc.getProperty(this.mode_name,"thumbnail-width");var text_ad_text=this.trc.getProperty(this.mode_name,"sponsored-link-text");var video_ad_text=this.trc.getProperty(this.mode_name,"sponsored-video-text");try{var overlay=document.createElement("span");if(sponsored_location=="thumbnail"){overlay.className="trc_sponsored_overlay_base"}else{overlay.className="trc_sponsored_overlay_base round"}var in_span=this.add_span("",null,parent);in_span.className="trc_sponsored_overlay";if(typeof thumbnail_width!="undefined"&&sponsored_location=="thumbnail"){overlay.style.width=thumbnail_width+"px";in_span.style.width=thumbnail_width+"px"}else{overlay.style.width="auto";in_span.style.width="auto"}thumbBlock.appendChild(overlay);div.spnoverlay=overlay;var sponsored_span=null;if(video.type=="video-ad"){sponsored_span=this.add_span("sponsored",this.trc.gt.gettext(video_ad_text),parent)}else{if(video.type=="text-ad"){sponsored_span=this.add_span("sponsored",this.trc.gt.gettext(text_ad_text),parent)}}if(sponsored_span!=null){var fontSize=(this.getFontSize(sponsored_span)+1);var lineHeight=Math.ceil(fontSize*1.29);parent.removeChild(sponsored_span);overlay.appendChild(in_span);overlay.appendChild(sponsored_span);in_span.style.height=overlay.style.height=lineHeight+"px";sponsored_span.style.lineHeight=Math.ceil(fontSize*1.1)+"px";if(sponsored_location=="thumbnail"){overlay.style.marginTop=(thumbnail_height-lineHeight)+"px"}else{if(sponsored_location=="thumbnail-top"){overlay.style.marginTop="4px"}else{overlay.style.marginTop=(thumbnail_height-lineHeight)-4+"px"}}}}catch(e){__trcError("Error while generating sponsored label",e)}};TRCRBox.prototype.genBidiLabel=function(labels_box,text,type){function check_direction(str){var ltrChars="A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02B8\u0300-\u0590\u0800-\u1FFF\u2C00-\uFB1C\uFE00-\uFE6F\uFEFD-\uFFFF";var rtlChars="\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC";var matches=str.match(new RegExp("^[^"+ltrChars+rtlChars+"]*(?:(["+ltrChars+"]+)|(["+rtlChars+"]+))"));if(!matches){return null}if(matches[2]){var bde_el=document.createElement("bde");bde_el.dir="rtl";bde_el.innerHTML=str;return bde_el}return null}var content=check_direction(text);if(content==null){content=text}return this.add_span("video-label "+type,content,labels_box)};TRCRBox.prototype.buildLabelBox=function(labels_box,video,detail_order){var i,data;for(i=0;i<detail_order.length;i++){data=detail_order[i];switch(data){case"title":this.genBidiLabel(labels_box,video.title,"video-title");break;case"uploader":if(typeof video.uploader!="undefined"){this.add_span("video-label video-uploader",this.formatData("uploader",video.uploader),labels_box)}break;case"category":if(typeof video.category!="undefined"){this.add_span("video-label video-category",this.formatData("category",decodeURIComponent(video.category.split(";")[0].split("//")[0])),labels_box)}break;case"views":this.add_span("video-label video-views",this.formatData("views",video.views),labels_box);break;case"rating":this.add_span("video-label video-rating",this.formatData("rating",video.rating),labels_box);break;case"description":if(video.isAd&&!video.description){break}var desc_span=this.genBidiLabel(labels_box,video.description,"video-description");desc_span.title='"Description: '+this.removeHtmlTags(video.description)+'"';break;case"duration":if((typeof video.duration!="undefined")&&(video.duration!="")){this.add_span("video-label video-duration-detail",this.formatData("duration",video.duration),labels_box)}break;case"branding":if(video["branding-text"]){this.add_span("branding",this.formatData("syndicator",video["branding-text"]),labels_box)}else{if(video["branding-url"]){this.add_span("branding","<img src='"+video["branding-url"]+"'>",labels_box)}}break;case"url":break;default:if(typeof video[data]!="undefined"&&video[data]){this.add_span("video-label video-"+data,this.formatData(data,video[data]),labels_box)}}}};TRCRBox.prototype.FixVideoImage=function(frame_width,frame_height,img){if(img.height==0||img.width==0||(!img.complete)||TRC.Browser.ieUpto(6)){img.style.width=frame_width+"px";img.style.height=frame_height+"px";img.style.visibility="visible";return}var frame_aspect_ratio=frame_width/frame_height;var image_aspect_ratio=img.width/img.height;if(frame_aspect_ratio>image_aspect_ratio){var culculated_image_height=Math.floor(frame_width/image_aspect_ratio);var top=Math.floor((frame_height-culculated_image_height)/2);img.style.width=frame_width+"px";if(top!=0){if(TRC.Browser.ieAtleast(8)){img.style.position="relative";img.style.top=top+"px"}else{img.style.marginTop=top+"px"}}}else{var culculated_image_width=Math.floor(frame_height*image_aspect_ratio);var left=Math.floor((frame_width-culculated_image_width)/2);img.style.height=frame_height+"px";if(left!=0){if(TRC.Browser.ieAtleast(8)){img.style.position="relative";if(this.trc.direction=="ltr"){img.style.left=left+"px"}else{img.style.left=left*(-1)+"px"}}else{if(this.trc.direction=="ltr"){img.style.marginLeft=left+"px"}else{img.style.marginRight=left+"px"}}}}img.style.visibility="visible"};TRCRBox.prototype.trackAdLoaded=function(video,src_hostname){if(!!video["tracking-image"]){var params={pi:this.trc.getItemId(),ri:this.response.trc.req,sd:TRC.pageManager.getPublisherValue(TRC.publisherId,"session-data"),ui:TRC.pageManager.getValue("user-id"),it:video.type,ii:video["item-id"],pt:this.getItemType(),li:this.listContainer.id,url:video["tracking-image"],id:Math.floor(Math.random()*100)};var queryString=[];for(var key in params){this.trc["normalize-log-param"](key,params[key]);queryString.push(encodeURIComponent(key)+"="+encodeURIComponent(params[key]))}var tracking_url="http://"+this.domain+"/"+encodeURIComponent(this.trc["normalize-log-param"]("publisher",TRC.publisherId))+"/log/3/tracking?"+queryString.join("&");var img=document.createElement("img");img.style.height="1px";img.style.width="1px";img.style.visibility="hidden";img.style.position="absolute";img.src=tracking_url;this.element.appendChild(img)}this.sendEvent("display",{ii:video["item-id"],it:video.type,p:video["is-syndicated"]?video.publisher:null},true)};TRCRBox.prototype.drawThumbnailLink=function(videoCube,has_duration_label,video,title,thumbnail_position){var duration="";var rbox=this;if(!has_duration_label){if((video.type=="video")&&(typeof video.duration!="undefined")&&(video.duration!="")&&(video.duration!="0")){duration=this.genDuration(video.duration)}}var thumbLink=this.createVideoLink(video,title);if((typeof video["thumbnail-clickable"]!="undefined")&&(video["thumbnail-clickable"]=="false")){thumbLink.title="";thumbLink.style.cursor="default";thumbLink.onclick=function(e){return false}}var thumbnail_height=this.trc.getProperty(this.mode_name,"thumbnail-height");var thumbnail_width=this.trc.getProperty(this.mode_name,"thumbnail-width");var thumbBlock=document.createElement("span");thumbBlock.className="thumbBlock";if(typeof thumbnail_height!="undefined"){thumbBlock.style.height=thumbnail_height+"px"}if(typeof thumbnail_width!="undefined"){thumbBlock.style.width=thumbnail_width+"px"}var thumbnail_img=document.createElement("img");thumbnail_img.style.visibility="hidden";if(video.isAd){thumbBlock.style.overflowX="hidden";thumbBlock.style.overflowY="hidden";thumbnail_img.style.display="inline";thumbnail_img.onerror=function(){video.ad_load_count=new Date().getTime();this.onerror=null;this.src="http://cdn.taboolasyndication.com/taboola/logo.png"};thumbnail_img.onload=(function(thumb){video.ad_load_count=new Date().getTime()-video.ad_load_count;if(thumb.complete){this.FixVideoImage(thumbnail_width,thumbnail_height,thumb)}else{win.setTimeout(arguments.callee.trcBind(this,thumb),1000)}rbox.trackAdLoaded(video,this.src.match("://([^/]+)")[1])}).trcBind(this,thumbnail_img);if(TRC.Browser.ie===7){videoCube.image_div=document.createElement("div")}video.ad_load_count=null}else{var overlay=this.add_span("thumbnail-overlay",null,thumbBlock);if(TRC.Browser.ieUpto(6)){overlay.style.display="none"}var emblem_src=this.trc.getProperty(this.mode_name,"emblem");var emblem=null;if(emblem_src!=null&&emblem_src!="null"&&(!TRC.Browser.ie||TRC.Browser.ieAtleast(7))){emblem=this.add_span("thumbnail-emblem",null,thumbBlock);emblem.style.backgroundImage="url("+emblem_src+")"}if(typeof thumbnail_height!="undefined"){overlay.style.height=thumbnail_height+"px";if(emblem!=null){emblem.style.height=thumbnail_height+"px"}}if(typeof thumbnail_width!="undefined"){overlay.style.width=thumbnail_width+"px";if(emblem!=null){emblem.style.width=thumbnail_width+"px"}}thumbnail_img.onerror=(function(thumb){__trcWarn("Failed to load thumbnail "+thumb.src+" for item="+video["item-id"]+", loading default thumbnail instead");thumb.onerror=null;thumb.src=(this.trc.getProperty(this.mode_name,"default-thumbnail")!="undefined")?this.trc.getProperty(this.mode_name,"default-thumbnail"):""}).trcBind(this,thumbnail_img);thumbnail_img.onload=(function(thumb){if(thumb.complete){this.FixVideoImage(thumbnail_width,thumbnail_height,thumb)}else{win.setTimeout(arguments.callee.trcBind(this,thumb),1000)}}).trcBind(this,thumbnail_img);if(TRC.Browser.ie===7){videoCube.image_div=document.createElement("div")}if(video["is-syndicated"]){var branding=document.createElement("span");branding.className="branding";if(video["branding-text"]){branding.appendChild(document.createTextNode(this.formatData("syndicator",video["branding-text"])))}else{if(video["branding-url"]){var img=document.createElement("img");img.src=video["branding-url"];branding.appendChild(img)}}thumbBlock.style.position="relative";thumbBlock.appendChild(branding);var syndicated_text=document.createElement("span");var syndicated_stat_text=this.trc.getProperty(this.mode_name,"syndicated-static-text");var syndicated_stat_position=this.trc.getProperty(this.mode_name,"syndicated-static-text-position");syndicated_text.className="static-text "+syndicated_stat_position;if(syndicated_stat_text){syndicated_text.appendChild(document.createTextNode(syndicated_stat_text))}thumbBlock.appendChild(syndicated_text);rbox.trackAdLoaded(video,this.src.match("://([^/]+)")[1])}}videoCube.thumb=thumbBlock;videoCube.img=thumbnail_img;videoCube.img_src=this.getThumbnailURL(video,thumbnail_width,thumbnail_height);if(duration!=""){var dur=document.createElement("div");dur.className="video-duration video-duration-detail";dur.style.left=0;if(typeof thumbnail_width!="undefined"){if(TRC.Browser.ieUpto(6)){dur.style.marginLeft=(thumbnail_width/2-3)+"px";dur.style.top=(thumbnail_height/2-15)+"px"}else{if(TRC.Browser.ie===7){dur.style.left=(thumbnail_width-3)+"px";dur.style.top=(thumbnail_height-15)+"px"}else{dur.style.marginLeft=(thumbnail_width-3)+"px";dur.style.top=(thumbnail_height-15)+"px"}}}dur.appendChild(duration);var p=this.genDuration(video.duration);p.style.opacity=1;p.style.filter="alpha(opacity=100)";p.style.backgroundColor="transparent";dur.appendChild(p);thumbBlock.appendChild(dur)}thumbLink.appendChild(thumbBlock);switch(thumbnail_position){case"bottom":thumbBlock.style.cssFloat="none";thumbBlock.style.styleFloat="none";thumbBlock.style.display="block";thumbBlock.style.width=thumbnail_width+"px";break;case"top":thumbBlock.style.cssFloat="none";thumbBlock.style.styleFloat="none";thumbBlock.style.display="block";thumbBlock.style.width=thumbnail_width+"px";break;case"end":thumbBlock.style.cssFloat="right";thumbBlock.style.styleFloat="right";break}return thumbLink};TRCRBox.prototype.drawVideoBox=function(video,has_duration_label,detailOrderTemplate,thumbnailPositionTemplate){var title="";var text_ad_text=this.trc.getProperty(this.mode_name,"sponsored-link-text");var video_ad_text=this.trc.getProperty(this.mode_name,"sponsored-video-text");video=__trcCopyProps(video,{});video.isAd=(video.type==="video-ad")||(video.type==="text-ad");video.isPhoto=video.type==="photo";video.tags=(typeof video.tags=="string")?TRC.text.parseCSV(video.tags):[];var div=document.createElement("div");div.rbox=this;var thumbnail_position=(thumbnailPositionTemplate||this.trc.getProperty(this.mode_name,"thumbnail-position"+(video.isAd?"-ad":"")));if(video.isAd&&(typeof thumbnail_position=="undefined"||thumbnail_position=="inherit")){thumbnail_position=this.trc.getProperty(this.mode_name,"thumbnail-position")}div.video_data=video;div.className="videoCube "+this.trc.getProperty(this.mode_name,"orientation")+" "+(video.isAd?"sponsored-":"origin-")+video.origin+" thumbnail_"+thumbnail_position+(video["is-syndicated"]?" syndicatedItem":"")+(video.isPhoto?" photoItem":"");var directURL=video.url;if(directURL.search(/\w{3,4}:\/\/(\w+)\.taboola(syndication)?.com/)==0){var snaps=directURL.split(/[\?&]/);for(var i=0;i<snaps.length;i++){if(snaps[i].split("=")[0]=="url"){directURL=decodeURIComponent(snaps[i].split("=")[1]);break}}}if(!video.isAd&&!video["is-syndicated"]){video.original_url=directURL;directURL=this.trc.getFunction(this.mode_name,"change-url",directURL,div,this.tracking);if(directURL==video.original_url&&this.tracking){var parts=directURL.split("#");directURL=parts[0]+((parts[0].search("\\?")>=0)?"&":"?")+this.tracking+((parts[1])?("#"+parts[1]):"")}if(typeof TRC.pageManager=="function"){directURL=TRC.pageManager.fixRecommendationURL(directURL)}}video.url=directURL;if(this.syndicator&&typeof this.trc.global!="undefined"){if((typeof this.trc.global[this.syndicator+"-syndication-affiliate-link-parameter"]!="undefined")&&(typeof this.trc.global["syndicator-affiliate-id"]!="undefined")){var syndicator=this.trc.global[this.syndicator+"-syndication-affiliate-link-parameter"].replace("{affiliate_id}",this.trc.global["syndicator-affiliate-id"]);if(directURL.search("\\?")>=0){directURL+="&"+syndicator}else{directURL+="?"+syndicator}}}var params={pi:this.trc.getItemId(),ri:this.response.trc.req,sd:TRC.pageManager.getPublisherValue(TRC.publisherId,"session-data"),ui:TRC.pageManager.getValue("user-id"),it:video.type,ii:video["item-id"],pt:this.getItemType(),li:this.listContainer.id,url:directURL,p:(video["is-syndicated"])?video.publisher:"",r:Math.floor(Math.random()*100)};var queryString=[];for(var key in params){if(params[key]){this.trc["normalize-log-param"](key,params[key]);queryString.push(encodeURIComponent(key)+"="+encodeURIComponent(params[key]))}}video.logger_url="http://"+this.domain+"/"+encodeURIComponent(this.trc["normalize-log-param"]("publisher",TRC.publisherId))+"/log/3/click?"+queryString.join("&");if(video.isAd){title=this.trc.gt.gettext((video.type=="video-ad"?video_ad_text:text_ad_text)+":")}title+=video.title;var link=this.createVideoLink(video,title);video.link=link;var labels_box=document.createElement("span");labels_box.style.display="block";labels_box.className="video-label-box";link.appendChild(labels_box);div.appendChild(link);if(thumbnail_position=="none"){if(video.isAd){TRC.dom.on(div,"visible",function(){this.video_data.ad_load_count=0;this.rbox.trackAdLoaded(video,"")})}}else{var thumbLink=this.drawThumbnailLink(div,has_duration_label,video,title,thumbnail_position);if(thumbnail_position=="bottom"){div.appendChild(thumbLink)}else{div.insertBefore(thumbLink,link)}}var detail_order=detailOrderTemplate||this.trc.getProperty(this.mode_name,video.isAd?"detail-order-ad":"detail-order"+(video["is-syndicated"]?"-syndicated":""));detail_order=detail_order.split(",");if(video.isAd){if(thumbnail_position!="none"){this.genSponsoredLabel(video,div.thumb,div)}this.buildLabelBox(labels_box,video,detail_order);var host=directURL.match(new RegExp("^\\w{3,5}://([^/]+)/?"));if(host){host=host[1]}else{host=directURL.split("/")[0]}if(typeof video["display-url"]!="undefined"){host=video["display-url"]}var sponsored_span=this.add_span("sponsored-url",host,link);if(thumbnail_position=="bottom"){sponsored_span.style.cssFloat="none";sponsored_span.style.styleFloat="none"}var sponsored_location=this.trc.getProperty(this.mode_name,"sponsored-location");if(!sponsored_location.match(/^thumbnail/)){var sponsored=this.add_span("sponsored",this.trc.gt.gettext(video.type=="video-ad"?video_ad_text:text_ad_text));if(thumbnail_position=="end"){sponsored.style.textAlign="left"}if(sponsored_location=="top"){link.insertBefore(sponsored,labels_box)}else{link.appendChild(sponsored);sponsored.style.cssFloat="left";sponsored.style.styleFloat="left";sponsored.style.clear="both";sponsored.style.width="100%";TRC.dom.on(div,"visible",(function(d,s){s.style.marginTop=(div.clientHeight-s.offsetTop)+"px"}).trcBind(this,div,sponsored))}}}else{this.buildLabelBox(labels_box,video,detail_order)}div.fixTextOverflow=this.fixBoxTitleAndDesc.trcBind(this,video,labels_box);if(TRC.Browser.ieUpto(6)){div.onmouseover=function(){this.className+=" videoCube_hover"};div.onmouseout=function(){this.className=this.className.replace(/\b\s+videoCube_hover\b/g,"")}}try{if(!video.isAd||TRC.ads_use_renderer){this.trc.getFunction(this.mode_name,"item-renderer",div,div.video_data)}}catch(e){__trcError("Error in itemRenderer",e)}return div};TRCRBox.prototype.getThumbnailURL=function(videoData,thumbWidth,thumbHeight){if(typeof videoData["thumb-size"]=="undefined"){return videoData.thumbnail}var thumbs=[{w:videoData["thumb-size"].split("x")[0],h:videoData["thumb-size"].split("x")[1],u:videoData.thumbnail}];for(var i=1;;i++){if(typeof videoData["thumb-size-"+i]=="undefined"){break}thumbs.push({w:videoData["thumb-size-"+i].split("x")[0],h:videoData["thumb-size-"+i].split("x")[1],u:videoData["thumbnail-"+i]})}thumbs=thumbs.sort(function(a,b){return(a.w*a.h)-(b.w*b.h)});for(var i=0;i<thumbs.length;i++){if(thumbWidth*thumbHeight<=thumbs[i].w*thumbs[i].h){return thumbs[i].u}}return thumbs.pop().u};TRCRBox.prototype.parseCSV=function(csv){var parts=csv.split(",");var out=[];while(parts.length){var cur=parts.shift();if(cur[0]!='"'){out.push(cur);continue}do{if(cur.slice(1).replace(/""/g,"").slice(-1)=='"'){break}cur+=","+parts.shift()}while(parts.length);out.push(cur.slice(1,cur.length-1).replace(/""/g,'"'))}return out};TRCRBox.prototype.addTaboolaLogo=function(){var that=this;var attribution=this.trc.attribution;var attribution_text=this.trc.getProperty(this.mode_name,"attribution-text");var trc_logo=this.trc.getProperty(this.mode_name,"logo-image");var attribution_position=this.trc.getProperty(this.mode_name,"attribution-position");var serviceURL="http://services.taboolasyndication.com/publisher/"+this.publisher+"/rbox?item-id="+this.trc.getItemId();var autoSyndicatedAttribution=this.trc.getProperty(this.mode_name,"auto-syndicated-attribution");if(attribution==false){return}var logoDiv=document.createElement("div");logoDiv.className="logoDiv";logoDiv.innerHTML="&nbsp;";if(this.trc.direction=="rtl"){logoDiv.style.cssFloat="left";logoDiv.style.styleFloat="left"}else{logoDiv.style.cssFloat="right";logoDiv.style.styleFloat="right"}var logo_link=document.createElement("a");logo_link.href=serviceURL;logo_link.target="taboola";logoDiv.appendChild(logo_link);if(attribution_position=="top"){if(typeof this.header=="object"){this.header.ext.appendChild(logoDiv)}}else{this.element.appendChild(logoDiv)}var clearDiv=document.createElement("div");var clearStyle="clear:both; _height:1px; _overflow:hidden;";if(typeof(clearDiv.style.cssText)=="string"){clearDiv.style.cssText=clearStyle}else{clearDiv.setAttribute("style",clearStyle)}this.element.appendChild(clearDiv);if(typeof trc_logo=="string"&&(attribution_text==null||attribution_text==""||attribution_text=="null")){if(TRC.Browser.ieUpto(6)){var a_inner_span=document.createElement("span");a_inner_span.style.width="45px";a_inner_span.style.height="11px";a_inner_span.backgroundImage="none";a_inner_span.style.display="block";a_inner_span.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+trc_logo+'")';logo_link.appendChild(a_inner_span)}else{var logoimg=document.createElement("img");logoimg.src=trc_logo;logoimg.style.border="0";logo_link.appendChild(logoimg)}return}logo_link.innerHTML+=attribution_text;if(this.hasSyndicatedContent&&autoSyndicatedAttribution){serviceURL="http://services.taboolasyndication.com/publisher/"+this.publisher+"/rbox?service=info&topic=synd";logo_link.onclick=function(e){return that.handleSyndicationIconClick(e,serviceURL)}}};TRCRBox.prototype.genDuration=function(dur){var durlabel=this.formatDuration(dur);var op_dt=document.createElement("dt");op_dt.style.position="absolute";op_dt.style.overflow="hidden";op_dt.style.height="auto";op_dt.style.width="auto";op_dt.style.zIndex=48;op_dt.style.right=0;var op_label=document.createElement("div");op_label.style.zIndex=50;op_label.style.paddingLeft="4px";op_label.style.paddingRight="4px";op_label.innerHTML=durlabel;op_dt.appendChild(op_label);return op_dt};TRCRBox.prototype.fixBoxTitleAndDesc=function(video,labels_box,immediate){if(!immediate){this.postRenderQueue.pushBack("fixBoxTitleAndDesc",this.fixBoxTitleAndDesc.trcBind(this,video,labels_box,true));return}try{this.fixBoxOverflow(this.findElement(function(e){return e.className.search("title")>=0},labels_box,"span",null),video.title,false,video["truncate-title"]!="false");this.fixBoxOverflow(this.findElement(function(e){return(e.className.search("description")>=0)},labels_box,"span",null),video.description,true,true)}catch(e){__trcError("Problem in fixTextOverflow",e)}};TRCRBox.prototype.fixBoxOverflow=function(span,originalText,byWords,doTruncate){if(span==null){return}if(span.clientHeight<=0||span.clientWidth<=0){return}if(typeof doTruncate=="undefined"){doTruncate=true}var was_overflow=false;var store=span.innerHTML;span.innerHTML="";var measure=this.add_span(null,"H",span);var lineHeight=Math.max(measure.offsetHeight,measure.clientHeight);var extra=Math.max(0,span.scrollHeight-span.clientHeight);span.removeChild(measure);span.innerHTML=store;originalText=originalText.replace(/^\s+|\s+$/g,"");while((span.clientHeight+extra+(lineHeight/2))<span.scrollHeight){was_overflow=true;if(doTruncate){originalText=byWords&&originalText.search(/\s/)>=0?originalText.replace(/\s+\S+$/,""):originalText.substr(0,originalText.length-1);var bde_el=span.getElementsByTagName("bde");if(span.getElementsByTagName("span").length>0){span.removeChild(span.getElementsByTagName("span")[0])}((bde_el.length>0)?bde_el[0]:span).innerHTML=originalText;this.add_span(null,"&hellip;",span)}else{var fontSize=this.getFontSize(span);if(parseInt(fontSize)<=9){break}fontSize=parseInt(fontSize)-1;var font_str="font-size: "+fontSize+"px!important; line-height: "+fontSize*1.25+"px!important;";if(typeof(span.style.cssText)=="string"){span.style.cssText=font_str}else{span.setAttribute("style",font_str)}}}if(TRC.Browser.ie&&!was_overflow){span.style.height="auto"}};TRCRBox.prototype.removeTagsEntities=function(text){var reg=new RegExp("<[^>]*>$");if(!reg.test(text)){reg=new RegExp("&w+;$");if(!reg.test(text)){return text}}return text.replace(reg,"")};TRCRBox.prototype.removeHtmlTags=function(desc){return desc.replace(new RegExp("<[^>]+>","g"),"")};TRCRBox.prototype.formatData=function(formatname,data){var format=this.trc.getProperty(this.mode_name,"format-"+formatname);format=format||"%s";if(typeof format=="function"){return format.call(this,data)}if((formatname.search("duration")>=0)||(formatname.search("Duration")>=0)){data=this.formatDuration(data)}if(typeof data=="undefined"){data=""}return format.replace(new RegExp("%\\w"),'<dt style="display:inline">'+data+"</dt>")};TRCRBox.prototype.formatDuration=function(dur){var hours=parseInt(dur/3600);if(hours>=1){dur=dur%3600}else{hours=0}var min=parseInt(dur/60);var sec=parseInt(dur%60);if(typeof hours!="number"||typeof min!="number"||typeof sec!="number"||isNaN(hours)||isNaN(min)||isNaN(sec)||dur<1){return""}return(hours>=1?(hours+":"):"")+(min<10?"0":"")+min+":"+(sec<10?"0":"")+sec};TRCRBox.prototype.formatNumber=function(num){if(typeof num=="undefined"){return""}return this.trc.getFunction(this.mode_name,"format-number",num)};TRCRBox.prototype.dateFormatISO=function(published_date){var publish_date=new Date(parseInt(published_date)*1000);var publish_date_year=publish_date.getFullYear();var publish_date_month=publish_date.getMonth()+1;var publish_date_days=publish_date.getDate();if(publish_date_days<10){publish_date_days="0"+publish_date_days}if(publish_date_month<10){publish_date_month="0"+publish_date_month}return publish_date_year+"-"+publish_date_month+"-"+publish_date_days};TRCRBox.prototype.dateFormatAmerican=function(published_date){var publish_date=new Date(parseInt(published_date)*1000);var publish_date_year=publish_date.getFullYear();var publish_date_month=publish_date.getMonth()+1;var publish_date_days=publish_date.getDate();return publish_date_month+"/"+publish_date_days+"/"+publish_date_year};TRCRBox.prototype.dateFormatEuropean=function(published_date){var publish_date=new Date(parseInt(published_date)*1000);var publish_date_year=publish_date.getFullYear();var publish_date_month=publish_date.getMonth()+1;var publish_date_days=publish_date.getDate();return publish_date_days+"/"+publish_date_month+"/"+publish_date_year};TRCRBox.prototype.dateFormatDays=function(published_date){var now=new Date();var added_ago_str=" months ago";var now_year=now.getFullYear();var now_month=now.getMonth();var publish_date=new Date();if(typeof published_date!="undefined"||parseInt(published_date)!=0){publish_date=new Date(parseInt(published_date)*1000)}var publish_date_year=publish_date.getFullYear();var publish_date_month=publish_date.getMonth();var past=(now_year*12+now_month)-(publish_date_year*12+publish_date_month);if(past==0){var now_days=now.getDate();var publish_date_days=publish_date.getDate();past=now_days-publish_date_days;if(past<=1){added_ago_str=" day ago"}else{added_ago_str=" days ago"}}else{if(past==1){added_ago_str=" month ago"}}return past+added_ago_str};TRCRBox.prototype.ratingStars=function(rating,max_num){if(max_num>5){max_num=Math.floor(max_num/2)}if(typeof rating=="undefined"){return""}var cont=document.createElement("span");for(var i=0;i<max_num;i++){var img=document.createElement("img");img.style.width="16px";img.style.height="16px";img.style.display="inline";var on="http://cdn.taboolasyndication.com/taboola/star-on.png";var off="http://cdn.taboolasyndication.com/taboola/star-off.png";if(i<parseInt(rating)){img.src=on}else{img.src=off}cont.appendChild(img)}return cont};TRCRBox.prototype.getFontSize=function(obj){var i=0;var hasStr=false;var fontSize=document.trcGetCurrentStyle(obj,"font-size");var substr=["px","pt","em","ch"];while((!hasStr)&&(i<substr.length)){if(fontSize.indexOf(substr[i])){fontSize=parseInt(fontSize);switch(substr[i]){case"px":fontSize=fontSize-1;break;case"pt":fontSize=(fontSize/0.75)-1;break;case"em":case"ch":fontSize=(fontSize*10)-1;break}hasStr=true}i++}return fontSize}})(window,document);(function(c,b){var a=TRC.URL=function(g){var f=TRC.text.lsplit;if(!g){throw new Error("Invalid URL!")}this.href=g;var d=f(g,"#",2);this.hash=(d.length>1)?"#"+d.pop():"";g=d[0];d=f(g,"?",2);this.search=(d.length>1)?"?"+d.pop():"";g=d[0];d=f(g,"://",2);this.protocol=(d.length>1)?d.shift()+":":"";g=d[0];d=f(g,"/",2);this.pathname=(d.length>1)?"/"+d.pop():"/";g=d[0];d=f(g,"@",2);this.auth=(d.length>1)?d.shift():"";g=d[0];d=f(g,":",2);this.port=(d.length>1)?parseInt(d.pop()):0;this.host=d[0];return this};a.prototype.toString=function(d){return(this.host?this.protocol+"//"+(this.auth?this.auth+"@":"")+this.host+(this.port?":"+this.port:""):"")+this.pathname+this.search+(d?"":(this.hash||""))}})(window,document);Gettext=function(i){this.domain="messages";this.locale_data=undefined;var f=["domain","locale_data"];if(this.isValidObject(i)){for(var h in i){for(var g=0;g<f.length;g++){if(h==f[g]){if(this.isValidObject(i[h])){this[h]=i[h]}}}}}this.try_load_lang();return this};Gettext.context_glue="\004";Gettext._locale_data={};Gettext.prototype.try_load_lang=function(){if(typeof(this.locale_data)!="undefined"){var h=this.locale_data;this.locale_data=undefined;this.parse_locale_data(h);if(typeof(Gettext._locale_data[this.domain])=="undefined"){throw new Error("Error: Gettext 'locale_data' does not contain the domain '"+this.domain+"'")}}var f=this.get_lang_refs();if(typeof(f)=="object"&&f.length>0){for(var g=0;g<f.length;g++){var i=f[g];if(i.type=="application/json"){if(!this.try_load_lang_json(i.href)){throw new Error("Error: Gettext 'try_load_lang_json' failed. Unable to exec xmlhttprequest for link ["+i.href+"]")}}else{if(i.type=="application/x-po"){if(!this.try_load_lang_po(i.href)){throw new Error("Error: Gettext 'try_load_lang_po' failed. Unable to exec xmlhttprequest for link ["+i.href+"]")}}else{throw new Error("TODO: link type ["+i.type+"] found, and support is planned, but not implemented at this time.")}}}}};Gettext.prototype.parse_locale_data=function(v){if(typeof(Gettext._locale_data)=="undefined"){Gettext._locale_data={}}for(var w in v){if((!v.hasOwnProperty(w))||(!this.isValidObject(v[w]))){continue}var z=false;for(var B in v[w]){z=true;break}if(!z){continue}var u=v[w];if(w==""){w="messages"}if(!this.isValidObject(Gettext._locale_data[w])){Gettext._locale_data[w]={}}if(!this.isValidObject(Gettext._locale_data[w].head)){Gettext._locale_data[w].head={}}if(!this.isValidObject(Gettext._locale_data[w].msgs)){Gettext._locale_data[w].msgs={}}for(var h in u){if(h==""){var s=u[h];for(var o in s){var t=o.toLowerCase();Gettext._locale_data[w].head[t]=s[o]}}else{Gettext._locale_data[w].msgs[h]=u[h]}}}for(var w in Gettext._locale_data){if(this.isValidObject(Gettext._locale_data[w].head["plural-forms"])&&typeof(Gettext._locale_data[w].head.plural_func)=="undefined"){var q=Gettext._locale_data[w].head["plural-forms"];var x=new RegExp("^(\\s*nplurals\\s*=\\s*[0-9]+\\s*;\\s*plural\\s*=\\s*(?:\\s|[-\\?\\|&=!<>+*/%:;a-zA-Z0-9_()])+)","m");if(x.test(q)){var r=Gettext._locale_data[w].head["plural-forms"];if(!/;\s*$/.test(r)){r=r.concat(";")}var y="var plural; var nplurals; "+r+' return { "nplural" : nplurals, "plural" : (plural === true ? 1 : plural ? plural : 0) };';Gettext._locale_data[w].head.plural_func=new Function("n",y)}else{throw new Error("Syntax error in language file. Plural-Forms header is invalid ["+q+"]")}}else{if(typeof(Gettext._locale_data[w].head.plural_func)=="undefined"){Gettext._locale_data[w].head.plural_func=function(b){var a=(b!=1)?1:0;return{nplural:2,plural:a}}}}}return};Gettext.prototype.try_load_lang_po=function(f){var i=this.sjax(f);if(!i){return}var j=this.uri_basename(f);var g=this.parse_po(i);var h={};if(g){if(!g[""]){g[""]={}}if(!g[""]["domain"]){g[""]["domain"]=j}j=g[""]["domain"];h[j]=g;this.parse_locale_data(h)}return 1};Gettext.prototype.uri_basename=function(d){var g;if(g=d.match(/^(.*\/)?(.*)/)){var f;if(f=g[2].match(/^(.*)\..+$/)){return f[1]}else{return g[2]}}else{return""}};Gettext.prototype.parse_po=function(u){var G={};var z={};var C="";var E=[];var K=u.split("\n");for(var x=0;x<K.length;x++){K[x]=K[x].replace(/(\n|\r)+$/,"");var F;if(/^$/.test(K[x])){if(typeof(z.msgid)!="undefined"){var v=(typeof(z.msgctxt)!="undefined"&&z.msgctxt.length)?z.msgctxt+Gettext.context_glue+z.msgid:z.msgid;var y=(typeof(z.msgid_plural)!="undefined"&&z.msgid_plural.length)?z.msgid_plural:null;var I=[];for(var B in z){var F;if(F=B.match(/^msgstr_(\d+)/)){I[parseInt(F[1])]=z[B]}}I.unshift(y);if(I.length>1){G[v]=I}z={};C=""}}else{if(/^#/.test(K[x])){continue}else{if(F=K[x].match(/^msgctxt\s+(.*)/)){C="msgctxt";z[C]=this.parse_po_dequote(F[1])}else{if(F=K[x].match(/^msgid\s+(.*)/)){C="msgid";z[C]=this.parse_po_dequote(F[1])}else{if(F=K[x].match(/^msgid_plural\s+(.*)/)){C="msgid_plural";z[C]=this.parse_po_dequote(F[1])}else{if(F=K[x].match(/^msgstr\s+(.*)/)){C="msgstr_0";z[C]=this.parse_po_dequote(F[1])}else{if(F=K[x].match(/^msgstr\[0\]\s+(.*)/)){C="msgstr_0";z[C]=this.parse_po_dequote(F[1])}else{if(F=K[x].match(/^msgstr\[(\d+)\]\s+(.*)/)){C="msgstr_"+F[1];z[C]=this.parse_po_dequote(F[2])}else{if(/^"/.test(K[x])){z[C]+=this.parse_po_dequote(K[x])}else{E.push("Strange line ["+x+"] : "+K[x])}}}}}}}}}}if(typeof(z.msgid)!="undefined"){var v=(typeof(z.msgctxt)!="undefined"&&z.msgctxt.length)?z.msgctxt+Gettext.context_glue+z.msgid:z.msgid;var y=(typeof(z.msgid_plural)!="undefined"&&z.msgid_plural.length)?z.msgid_plural:null;var I=[];for(var B in z){var F;if(F=B.match(/^msgstr_(\d+)/)){I[parseInt(F[1])]=z[B]}}I.unshift(y);if(I.length>1){G[v]=I}z={};C=""}if(G[""]&&G[""][1]){var J={};var w=G[""][1].split(/\\n/);for(var x=0;x<w.length;x++){if(!w.length){continue}var H=w[x].indexOf(":",0);if(H!=-1){var t=w[x].substring(0,H);var i=w[x].substring(H+1);var D=t.toLowerCase();if(J[D]&&J[D].length){E.push("SKIPPING DUPLICATE HEADER LINE: "+w[x])}else{if(/#-#-#-#-#/.test(D)){E.push("SKIPPING ERROR MARKER IN HEADER: "+w[x])}else{i=i.replace(/^\s+/,"");J[D]=i}}}else{E.push("PROBLEM LINE IN HEADER: "+w[x]);J[w[x]]=""}}G[""]=J}else{G[""]={}}return G};Gettext.prototype.parse_po_dequote=function(c){var d;if(d=c.match(/^"(.*)"/)){c=d[1]}c=c.replace(/\\"/,"");return c};Gettext.prototype.try_load_lang_json=function(f){var d=this.sjax(f);if(!d){return}var g=this.JSON(d);this.parse_locale_data(g);return 1};Gettext.prototype.get_lang_refs=function(){var g=new Array();var f=document.getElementsByTagName("link");for(var d=0;d<f.length;d++){if(f[d].rel=="gettext"&&f[d].href){if(typeof(f[d].type)=="undefined"||f[d].type==""){if(/\.json$/i.test(f[d].href)){f[d].type="application/json"}else{if(/\.js$/i.test(f[d].href)){f[d].type="application/json"}else{if(/\.po$/i.test(f[d].href)){f[d].type="application/x-po"}else{if(/\.mo$/i.test(f[d].href)){f[d].type="application/x-mo"}else{throw new Error("LINK tag with rel=gettext found, but the type and extension are unrecognized.")}}}}}f[d].type=f[d].type.toLowerCase();if(f[d].type=="application/json"){f[d].type="application/json"}else{if(f[d].type=="text/javascript"){f[d].type="application/json"}else{if(f[d].type=="application/x-po"){f[d].type="application/x-po"}else{if(f[d].type=="application/x-mo"){f[d].type="application/x-mo"}else{throw new Error("LINK tag with rel=gettext found, but the type attribute ["+f[d].type+"] is unrecognized.")}}}}g.push(f[d])}}return g};Gettext.prototype.textdomain=function(b){if(b&&b.length){this.domain=b}return this.domain};Gettext.prototype.gettext=function(j){var h;var g;var i;var f;return this.dcnpgettext(null,h,j,g,i,f)};Gettext.prototype.dgettext=function(k,l){var i;var h;var j;var g;return this.dcnpgettext(k,i,l,h,j,g)};Gettext.prototype.dcgettext=function(k,l,g){var i;var h;var j;return this.dcnpgettext(k,i,l,h,j,g)};Gettext.prototype.ngettext=function(j,g,h){var i;var f;return this.dcnpgettext(null,i,j,g,h,f)};Gettext.prototype.dngettext=function(k,l,h,i){var j;var g;return this.dcnpgettext(k,j,l,h,i,g)};Gettext.prototype.dcngettext=function(k,l,h,i,g){var j;return this.dcnpgettext(k,j,l,h,i,g,g)};Gettext.prototype.pgettext=function(h,j){var g;var i;var f;return this.dcnpgettext(null,h,j,g,i,f)};Gettext.prototype.dpgettext=function(k,i,l){var h;var j;var g;return this.dcnpgettext(k,i,l,h,j,g)};Gettext.prototype.dcpgettext=function(k,i,l,g){var h;var j;return this.dcnpgettext(k,i,l,h,j,g)};Gettext.prototype.npgettext=function(h,j,g,i){var f;return this.dcnpgettext(null,h,j,g,i,f)};Gettext.prototype.dnpgettext=function(k,i,l,h,j){var g;return this.dcnpgettext(k,i,l,h,j,g)};Gettext.prototype.dcnpgettext=function(i,N,j,D,I,G){if(!this.isValidObject(j)){return""}var L=this.isValidObject(D);var B=this.isValidObject(N)?N+Gettext.context_glue+j:j;var R=this.isValidObject(i)?i:this.isValidObject(this.domain)?this.domain:"messages";var n="LC_MESSAGES";var G=5;var H=new Array();if(typeof(Gettext._locale_data)!="undefined"&&this.isValidObject(Gettext._locale_data[R])){H.push(Gettext._locale_data[R])}else{if(typeof(Gettext._locale_data)!="undefined"){for(var z in Gettext._locale_data){H.push(Gettext._locale_data[z])}}}var Q=[];var M=false;var J;if(H.length){for(var C=0;C<H.length;C++){var E=H[C];if(this.isValidObject(E.msgs[B])){for(var F=0;F<E.msgs[B].length;F++){Q[F]=E.msgs[B][F]}Q.shift();J=E;M=true;if(Q.length>0&&Q[0].length!=0){break}}}}if(Q.length==0||Q[0].length==0){Q=[j,D]}var O=Q[0];if(L){var K;if(M&&this.isValidObject(J.head.plural_func)){var P=J.head.plural_func(I);if(!P.plural){P.plural=0}if(!P.nplural){P.nplural=0}if(P.nplural<=P.plural){P.plural=0}K=P.plural}else{K=(I!=1)?1:0}if(this.isValidObject(Q[K])){O=Q[K]}}return O};Gettext.strargs=function(j,n){if(null==n||"undefined"==typeof(n)){n=[]}else{if(n.constructor!=Array){n=[n]}}var k="";while(true){var m=j.indexOf("%");var i;if(m==-1){k+=j;break}k+=j.substr(0,m);if(j.substr(m,2)=="%%"){k+="%";j=j.substr((m+2))}else{if(i=j.substr(m).match(/^%(\d+)/)){var l=parseInt(i[1]);var h=i[1].length;if(l>0&&n[l-1]!=null&&typeof(n[l-1])!="undefined"){k+=n[l-1]}j=j.substr((m+1+h))}else{k+="%";j=j.substr((m+1))}}}return k};Gettext.prototype.strargs=function(c,d){return Gettext.strargs(c,d)};Gettext.prototype.isArray=function(b){return this.isValidObject(b)&&b.constructor==Array};Gettext.prototype.isValidObject=function(b){if(null==b){return false}else{if("undefined"==typeof(b)){return false}else{return true}}};Gettext.prototype.sjax=function(j){var k;if(window.XMLHttpRequest){k=new XMLHttpRequest()}else{if(navigator.userAgent.toLowerCase().indexOf("msie 5")!=-1){k=new ActiveXObject("Microsoft.XMLHTTP")}else{k=new ActiveXObject("Msxml2.XMLHTTP")}}if(!k){throw new Error("Your browser doesn't do Ajax. Unable to support external language files.")}k.open("GET",j,false);try{k.send(null)}catch(i){return}var h=k.status;if(h==200||h==0){return k.responseText}else{var g=k.statusText+" (Error "+k.status+")";if(k.responseText.length){g+="\n"+k.responseText}alert(g);return}};Gettext.prototype.JSON=function(data){return eval("("+data+")")};(function(d,c){d.trc_debug_level=d.location.getParameter("taboola-debug");if(isNaN(parseInt(d.trc_debug_level))){trc_debug_level=1}TRC.callbacks={cdnRecommendations:function(f){TRC.dispatch("staticRecommendationsReceived",{response:f})}};TRC.trc_drawRBox=false;TRC.listOrigin=new TRC.ListOriginBuilder();TRC.baseDomain=TRC.baseDomain||"http://cdn.taboolasyndication.com/libtrc/"+TRC.publisherId+"/";TRC.prototype=TRC.prototype||{};try{var a=TRC.ready({style:".trc_rbox_container{direction:ltr;text-align:left;}.trc_rbox_header{border-style:solid;border-width:0;}.in_trc_header{position:relative!important;float:right;margin:0;}#trc_rbox_css_loaded{overflow:hidden;width:0;height:0;}.trc_rbox{margin-top:0;}.trc_rbox_div{margin:0 0 3px;direction:ltr;padding:0;box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;-webkit-box-sizing:border-box;overflow:auto;position:relative;width:auto;*width:auto;border:solid #CCC 1px;}.loading-animation span{display:block;}.videoCube{zoom:1;cursor:pointer;float:none;overflow:hidden;box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;-webkit-box-sizing:border-box;}div.videoCube:hover,.videoCube_hover{cursor:pointer;}.videoCube span.video-title:hover,.videoCube_hover span.video-title{text-decoration:underline;}.videoCube a{text-decoration:none;border:0;color:black;cursor:pointer;}.videoCube a:hover,.videoCube_hover a,.videoCube a:link,.videoCube a{text-decoration:none!important;outline:none;}.videoCube a .thumbBlock{float:left;display:block;overflow:hidden!important;}.videoCube a img,.videoCube img{border:0;_border:0;display:block;margin:0;height:auto;width:auto;}.videoCube .video-label{display:block;overflow:hidden;}.videoCube .video-title{width:auto!important;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word;}.videoCube .video-duration{height:0;float:left;position:relative;color:white;font-size:11px;}.videoCube .video-duration dt{border-radius:4px;-moz-border-radius:4px;-webkit-border-radius:4px;background-color:black;opacity:.6;filter:alpha(opacity=60);}.sponsored-default .video-description{font-weight:normal;color:black;font-size:9px;max-height:22px;*height:22px;overflow:hidden;line-height:9px;}.video-duration.video-duration-detail div{color:white;}.sponsored-default{background-color:#f7f6c6;padding-bottom:0!important;}.sponsored{position:relative;display:block;overflow:visible;height:auto;width:auto;padding-right:.0;text-align:right;font-size:9px;}.sponsored-url{white-space:nowrap;float:left;overflow:hidden;width:98%;height:auto;margin-top:0;margin-left:1px;padding-bottom:2px;color:#008000;font-size:9px;text-decoration:underline;}.sponsored-default .video-title{height:26px;font-size:11px;line-height:13px;max-height:26px;*height:26px;}.sponsored-default .thumbBlock{text-align:center;background-color:transparent;}.trc_rbox_div{height:410px;}.videoCube{direction:ltr;font-size:11px;margin:0;color:black;border-width:0;}.videoCube.vertical:first-child{border-top:0;margin-top:0;}.videoCube.horizontal:first-child{border-left:0;margin-left:0;}.trc_rbox .trc_rbox_div .videoCube.vertical{_margin-top:expression(this.previousSibling==null?\'0\':\'default\');}.trc_rbox .trc_rbox_div .videoCube.horizontal{_margin-left:expression(this.previousSibling==null?\'0\':\'default\');}div.videoCube:hover,.videoCube_hover{background-color:#EBF0FF;color:black;}.videoCube .thumbBlock{margin-right:5px;margin-left:1px;border-style:solid;}.videoCube a img,.videoCube img{border-color:#ececec;}.videoCube .video-label-box{margin-left:81px;}.videoCube .video-label dt{font-weight:bold;}.videoCube .video-title{height:auto;margin-bottom:3px;white-space:normal;}.sponsored-default{padding-bottom:0;}.loading-animation{font-family:sans;font-size:1.5em;text-align:center;color:gray;height:100%;}.trc_rbox_header{font-family:Arial,Helvetica,sans-serif;font-size:12px;font-weight:bold;text-decoration:none;color:black;}.branding_div{overflow:visible;float:right;}.branding_div img{height:20px;}.trc_pager div{float:left;font-family:sans;cursor:pointer;margin-left:2px;margin-right:2px;}.trc_pager{font-weight:normal;}.trc_pager_pages{display:block!important;}.trc_related_container div.horizontal{float:left;box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;-webkit-box-sizing:border-box;}.trc_related_container DIV.videoCube.thumbnail_top .thumbBlock,.trc_related_container DIV.videoCube.thumbnail_bottom .thumbBlock{float:none;}@media screen and(-webkit-min-device-pixel-ratio:0){.sponsored-url{margin-top:2px;}}.vidiscovery-note{display:none;}.pager_disabled{cursor:auto;}.videoCube .thumbBlock .trc_sponsored_overlay_base{display:block;width:auto;margin-left:0;position:absolute;color:white!important;}.videoCube .thumbBlock .trc_sponsored_overlay{filter:alpha(opacity=60);opacity:.6;display:block;position:absolute;*left:0;}.videoCube .thumbBlock .trc_sponsored_overlay_base .sponsored{position:relative;display:block;overflow:visible;width:auto;text-align:center;padding:0 5px;margin-top:0;}.videoCube .thumbBlock .trc_sponsored_overlay_base.round .trc_sponsored_overlay{border-radius:4px;-moz-border-radius:4px;-webkit-border-radius:4px;}.videoCube .thumbBlock .trc_sponsored_overlay_base.round{margin-left:4px;}.thumbnail-emblem{background-color:transparent;background-repeat:no-repeat;position:absolute;z-index:50;}.playerCube .thumbnail-overlay,.videoCube .thumbnail-overlay{position:absolute;background-color:transparent;background-repeat:no-repeat;z-index:50;}.videoCube:hover .thumbnail-overlay,.videoCube_hover .thumbnail-overlay{position:absolute;background-color:transparent;background-repeat:no-repeat;z-index:50;}.thumbnail_bottom{padding-bottom:8px;}.trc_pager_next img,trc_pager_next pager_disabled img,trc_pager_next:hover img{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:\"FlipH\";}.trc_cover_iframe{position:absolute;z-index:100000;top:0;left:0;background:#000;opacity:.4;filter:alpha(opacity=40);border:0;}.trc_lightbox_base{z-index:100001;}.trc_lightbox_overlay{background-color:transparent;position:absolute;z-index:100002;}.trc_lightbox_transparent{position:absolute;z-index:100003;}#trc_lightbox_header{font-family:\"Trebuchet MS\",Helvetica,sans-serif;}.trc_whitebox{background-color:white;position:relative;z-index:100004;padding:0 20px 20px 20px;margin:0 auto;border:2px solid black;-moz-box-shadow:3px 3px 20px #000;-webkit-box-shadow:3px 3px 20px #000;box-shadow:3px 3px 20px #000;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;}.trc_whiteboxCloseButton{width:32px;height:32px;border:0;position:absolute;right:-16px;top:-14px;cursor:pointer;background:url(\'http://cdn.taboolasyndication.com/taboola-generic/close.png\') no-repeat top left transparent;color:white;color:transparent;font-size:0;}.trc_related_container .logoDiv{font-family:Arial,Helvetica,sans-serif;white-space:nowrap;font-size:9px;}.trc_related_container .logoDiv a{font-size:9px;text-decoration:none!important;color:black;margin-right:1px;vertical-align:text-bottom;}.logoDiv a span:hover{text-decoration:underline;}.trc_rbox_header .logoDiv{font-size:1em;}.trc_related_container .vertical-start-shade{background-image:url(\"http://cdn.taboolasyndication.com/taboola-generic/shade-down.png\");height:10px;width:auto;position:absolute;z-index:5;}.trc_related_container .vertical-end-shade{background-image:url(\"http://cdn.taboolasyndication.com/taboola-generic/shade-up.png\");height:10px;width:auto;position:absolute;z-index:5;}.trc_related_container .horizontal-start-shade{background-image:url(\"http://cdn.taboolasyndication.com/taboola-generic/shade-right.png\");height:auto;width:10px;position:absolute;z-index:5;}.trc_related_container .horizontal-end-shade{background-image:url(\"http://cdn.taboolasyndication.com/taboola-generic/shade-left.png\");height:auto;width:10px;position:absolute;z-index:5;}DIV.trc_autoplaylist-box{margin:6px auto 0;border:0;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;padding:4px;font-family:\"Trebuchet MS\",Helvetica,sans-serif;width:320px;background:#191919;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=\'#191919\',endColorstr=\'#393939\');-ms-filter:\"progid:DXImageTransform.Microsoft.gradient(startColorstr=#191919,endColorstr=#393939)\";background:-webkit-gradient(linear,left top,left bottom,from(#191919),to(#393939));background:-moz-linear-gradient(top,#191919,#393939);background:linear-gradient(top,#191919,#393939);}DIV.trc_autoplaylist-box .trc-next-up-header{font-size:14px;color:#CCC;float:left;line-height:31px;margin:0 4px 0 6px;overflow:hidden;white-space:nowrap;}DIV.trc_autoplaylist-box .trc-next-up-countdown{color:white;font-weight:bold;font-size:15px;padding-left:4px;}DIV.trc_autoplaylist-box .nextup{cursor:pointer;}DIV.trc_autoplaylist-box .nextup .thumbblock{border:solid #FEFEFE 1px;margin-right:10px;}DIV.trc_autoplaylist-box:hover .nextup .thumbblock SPAN.thumbnail-overlay{background-image:url(\'http://cdn.taboolasyndication.com/taboola-generic/lightbox-overlay.png\');}DIV.trc_autoplaylist-box .nextup .video-label-box{color:white;font-weight:bold;font-size:12px;line-height:14px;}.trc-syndication-link{text-decoration:none;color:inherit;}.playerCube{width:100%;height:100%;position:relative;cursor:pointer;}.playerCube .thumbnail-overlay{width:100%;height:100%;top:0;left:0;position:absolute;}.trc_related_container .whatsThisSyndicated{position:absolute;cursor:pointer;}.trc_related_container .whatsThisSyndicated.a-bottom-right,.trc_related_container .static-text.bottom-right{bottom:0;right:0;}.trc_related_container .whatsThisSyndicated.a-top-right,.trc_related_container .static-text.top-right{top:0;right:0;}.trc_related_container .whatsThisSyndicated.a-bottom-left,.trc_related_container .static-text.bottom-left{bottom:0;left:0;}.trc_related_container .whatsThisSyndicated.a-top-left,.trc_related_container .static-text.top-left{top:0;left:0;}.trc_related_container .videoCube .thumbBlock .branding{position:absolute;bottom:0;z-index:1;width:100%;margin:0;padding:5px 0;text-align:center;}.trc_related_container .videoCube .thumbBlock .static-text{position:absolute;z-index:1;margin:0;padding:5px;background-color:black;color:white;display:block;font-family:Arial,Helvetica,sans-serif;font-size:10px;font-weight:normal;text-align:left;text-decoration:none;opacity:.7;}.trc_related_container .static-text.top{width:100%;top:0;padding:5px 0;}.trc_related_container .static-text.bottom{width:100%;bottom:0;padding:2px 0;}.trc-inplayer-rbox{background:#333;background:rgba(30,30,30,0.9);*background:#333;bottom:0;position:absolute;height:300px;text-align:center;}.trc-inplayer-rbox .trc_rbox_container{margin:50px auto 0;width:640px;}"});if(!a.invisible){return}TRC.dom.onReady(function(){var f=c.body.appendChild(c.createElement("div"));f.style.display="none";a.internalDrawRBox({mode:"rbox-tracking",container:f})})}catch(b){__trcError("Error in libtrc initialization",b)}})(window,document);