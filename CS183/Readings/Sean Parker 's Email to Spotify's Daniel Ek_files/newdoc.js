/* :asset_packager_compatibility, 'config/asset_packages.yml' @ 1339185887 */
/* public/javascripts/depends_on.js @ 1339185887 */

if(!window.Scribd)var Scribd=new Object();Scribd.DependsOn=(function(){var PREFIX="lzy_js_";var PATH_PREFIXES={"public/":"public/javascripts/","views/":"app/views/"}
PATH_PREFIXES["p/"]=PATH_PREFIXES["public/"];PATH_PREFIXES["v/"]=PATH_PREFIXES["views/"];var alreadyLoaded={};function globalEval(js){var el=document.createElement('script');el.text=js;document.body.appendChild(el);}
function loadJS(js){globalEval(window[PREFIX+js]);}
function applyExpandedPath(path){for(index in PATH_PREFIXES){var expandedPath=PATH_PREFIXES[index];if(path.startsWith(index)){path=path.substr(index.length,path.length);return expandedPath+path;}}
return path;}
function filterPath(path){path=applyExpandedPath(path);path=path.gsub("/","_");return path;}
return function(dependsOn,callback){if(dependsOn.each==undefined){dependsOn=Array(dependsOn);}
dependsOn.each(function(jsFile){jsFile=filterPath(jsFile);if(alreadyLoaded[jsFile]!=true){loadJS(jsFile);alreadyLoaded[jsFile]=true;}});if(callback)callback.call();}})();Scribd.LoadJS=Scribd.DependsOn;


/* public/javascripts/prototype_1_7.js @ 1339185887 */

var Prototype={Version:'1.7',Browser:(function(){var ua=navigator.userAgent;var isOpera=Object.prototype.toString.call(window.opera)=='[object Opera]';return{IE:!!window.attachEvent&&!isOpera,Opera:isOpera,WebKit:ua.indexOf('AppleWebKit/')>-1,Gecko:ua.indexOf('Gecko')>-1&&ua.indexOf('KHTML')===-1,MobileSafari:/Apple.*Mobile/.test(ua)}})(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:(function(){var constructor=window.Element||window.HTMLElement;return!!(constructor&&constructor.prototype);})(),SpecificElementExtensions:(function(){if(typeof window.HTMLDivElement!=='undefined')
return true;var div=document.createElement('div'),form=document.createElement('form'),isSupported=false;if(div['__proto__']&&(div['__proto__']!==form['__proto__'])){isSupported=true;}
div=form=null;return isSupported;})()},ScriptFragment:'<script[^>]*>([\\S\\s]*?)<\/script>',JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(x){return x}};if(Prototype.Browser.MobileSafari)
Prototype.BrowserFeatures.SpecificElementExtensions=false;var Abstract={};var Try={these:function(){var returnValue;for(var i=0,length=arguments.length;i<length;i++){var lambda=arguments[i];try{returnValue=lambda();break;}catch(e){}}
return returnValue;}};var Class=(function(){var IS_DONTENUM_BUGGY=(function(){for(var p in{toString:1}){if(p==='toString')return false;}
return true;})();function subclass(){};function create(){var parent=null,properties=$A(arguments);if(Object.isFunction(properties[0]))
parent=properties.shift();function klass(){this.initialize.apply(this,arguments);}
Object.extend(klass,Class.Methods);klass.superclass=parent;klass.subclasses=[];if(parent){subclass.prototype=parent.prototype;klass.prototype=new subclass;parent.subclasses.push(klass);}
for(var i=0,length=properties.length;i<length;i++)
klass.addMethods(properties[i]);if(!klass.prototype.initialize)
klass.prototype.initialize=Prototype.emptyFunction;klass.prototype.constructor=klass;return klass;}
function addMethods(source){var ancestor=this.superclass&&this.superclass.prototype,properties=Object.keys(source);if(IS_DONTENUM_BUGGY){if(source.toString!=Object.prototype.toString)
properties.push("toString");if(source.valueOf!=Object.prototype.valueOf)
properties.push("valueOf");}
for(var i=0,length=properties.length;i<length;i++){var property=properties[i],value=source[property];if(ancestor&&Object.isFunction(value)&&value.argumentNames()[0]=="$super"){var method=value;value=(function(m){return function(){return ancestor[m].apply(this,arguments);};})(property).wrap(method);value.valueOf=method.valueOf.bind(method);value.toString=method.toString.bind(method);}
this.prototype[property]=value;}
return this;}
return{create:create,Methods:{addMethods:addMethods}};})();(function(){var _toString=Object.prototype.toString,NULL_TYPE='Null',UNDEFINED_TYPE='Undefined',BOOLEAN_TYPE='Boolean',NUMBER_TYPE='Number',STRING_TYPE='String',OBJECT_TYPE='Object',FUNCTION_CLASS='[object Function]',BOOLEAN_CLASS='[object Boolean]',NUMBER_CLASS='[object Number]',STRING_CLASS='[object String]',ARRAY_CLASS='[object Array]',DATE_CLASS='[object Date]',NATIVE_JSON_STRINGIFY_SUPPORT=window.JSON&&typeof JSON.stringify==='function'&&JSON.stringify(0)==='0'&&typeof JSON.stringify(Prototype.K)==='undefined';function Type(o){switch(o){case null:return NULL_TYPE;case(void 0):return UNDEFINED_TYPE;}
var type=typeof o;switch(type){case'boolean':return BOOLEAN_TYPE;case'number':return NUMBER_TYPE;case'string':return STRING_TYPE;}
return OBJECT_TYPE;}
function extend(destination,source){for(var property in source)
destination[property]=source[property];return destination;}
function inspect(object){try{if(isUndefined(object))return'undefined';if(object===null)return'null';return object.inspect?object.inspect():String(object);}catch(e){if(e instanceof RangeError)return'...';throw e;}}
function toJSON(value){return Str('',{'':value},[]);}
function Str(key,holder,stack){var value=holder[key],type=typeof value;if(Type(value)===OBJECT_TYPE&&typeof value.toJSON==='function'){value=value.toJSON(key);}
var _class=_toString.call(value);switch(_class){case NUMBER_CLASS:case BOOLEAN_CLASS:case STRING_CLASS:value=value.valueOf();}
switch(value){case null:return'null';case true:return'true';case false:return'false';}
type=typeof value;switch(type){case'string':return value.inspect(true);case'number':return isFinite(value)?String(value):'null';case'object':for(var i=0,length=stack.length;i<length;i++){if(stack[i]===value){throw new TypeError();}}
stack.push(value);var partial=[];if(_class===ARRAY_CLASS){for(var i=0,length=value.length;i<length;i++){var str=Str(i,value,stack);partial.push(typeof str==='undefined'?'null':str);}
partial='['+partial.join(',')+']';}else{var keys=Object.keys(value);for(var i=0,length=keys.length;i<length;i++){var key=keys[i],str=Str(key,value,stack);if(typeof str!=="undefined"){partial.push(key.inspect(true)+':'+str);}}
partial='{'+partial.join(',')+'}';}
stack.pop();return partial;}}
function stringify(object){return JSON.stringify(object);}
function toQueryString(object){return $H(object).toQueryString();}
function toHTML(object){return object&&object.toHTML?object.toHTML():String.interpret(object);}
function keys(object){if(Type(object)!==OBJECT_TYPE){throw new TypeError();}
var results=[];for(var property in object){if(object.hasOwnProperty(property)){results.push(property);}}
return results;}
function values(object){var results=[];for(var property in object)
results.push(object[property]);return results;}
function clone(object){return extend({},object);}
function isElement(object){return!!(object&&object.nodeType==1);}
function isArray(object){return _toString.call(object)===ARRAY_CLASS;}
var hasNativeIsArray=(typeof Array.isArray=='function')&&Array.isArray([])&&!Array.isArray({});if(hasNativeIsArray){isArray=Array.isArray;}
function isHash(object){return object instanceof Hash;}
function isFunction(object){return _toString.call(object)===FUNCTION_CLASS;}
function isString(object){return _toString.call(object)===STRING_CLASS;}
function isNumber(object){return _toString.call(object)===NUMBER_CLASS;}
function isDate(object){return _toString.call(object)===DATE_CLASS;}
function isUndefined(object){return typeof object==="undefined";}
extend(Object,{extend:extend,inspect:inspect,toJSON:NATIVE_JSON_STRINGIFY_SUPPORT?stringify:toJSON,toQueryString:toQueryString,toHTML:toHTML,keys:Object.keys||keys,values:values,clone:clone,isElement:isElement,isArray:isArray,isHash:isHash,isFunction:isFunction,isString:isString,isNumber:isNumber,isDate:isDate,isUndefined:isUndefined});})();Object.extend(Function.prototype,(function(){var slice=Array.prototype.slice;function update(array,args){var arrayLength=array.length,length=args.length;while(length--)array[arrayLength+length]=args[length];return array;}
function merge(array,args){array=slice.call(array,0);return update(array,args);}
function argumentNames(){var names=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,'').replace(/\s+/g,'').split(',');return names.length==1&&!names[0]?[]:names;}
function bind(context){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;var __method=this,args=slice.call(arguments,1);return function(){var a=merge(args,arguments);return __method.apply(context,a);}}
function bindAsEventListener(context){var __method=this,args=slice.call(arguments,1);return function(event){var a=update([event||window.event],args);return __method.apply(context,a);}}
function curry(){if(!arguments.length)return this;var __method=this,args=slice.call(arguments,0);return function(){var a=merge(args,arguments);return __method.apply(this,a);}}
function delay(timeout){var __method=this,args=slice.call(arguments,1);timeout=timeout*1000;return window.setTimeout(function(){return __method.apply(__method,args);},timeout);}
function defer(){var args=update([0.01],arguments);return this.delay.apply(this,args);}
function wrap(wrapper){var __method=this;return function(){var a=update([__method.bind(this)],arguments);return wrapper.apply(this,a);}}
function methodize(){if(this._methodized)return this._methodized;var __method=this;return this._methodized=function(){var a=update([this],arguments);return __method.apply(null,a);};}
return{argumentNames:argumentNames,bind:bind,bindAsEventListener:bindAsEventListener,curry:curry,delay:delay,defer:defer,wrap:wrap,methodize:methodize}})());(function(proto){function toISOString(){return this.getUTCFullYear()+'-'+
(this.getUTCMonth()+1).toPaddedString(2)+'-'+
this.getUTCDate().toPaddedString(2)+'T'+
this.getUTCHours().toPaddedString(2)+':'+
this.getUTCMinutes().toPaddedString(2)+':'+
this.getUTCSeconds().toPaddedString(2)+'Z';}
function toJSON(){return this.toISOString();}
if(!proto.toISOString)proto.toISOString=toISOString;if(!proto.toJSON)proto.toJSON=toJSON;})(Date.prototype);RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(str){return String(str).replace(/([.*+?^=!:${}()|[\]\/\\])/g,'\\$1');};var PeriodicalExecuter=Class.create({initialize:function(callback,frequency){this.callback=callback;this.frequency=frequency;this.currentlyExecuting=false;this.registerCallback();},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1000);},execute:function(){this.callback(this);},stop:function(){if(!this.timer)return;clearInterval(this.timer);this.timer=null;},onTimerEvent:function(){if(!this.currentlyExecuting){try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false;}catch(e){this.currentlyExecuting=false;throw e;}}}});Object.extend(String,{interpret:function(value){return value==null?'':String(value);},specialChar:{'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','\\':'\\\\'}});Object.extend(String.prototype,(function(){var NATIVE_JSON_PARSE_SUPPORT=window.JSON&&typeof JSON.parse==='function'&&JSON.parse('{"test": true}').test;function prepareReplacement(replacement){if(Object.isFunction(replacement))return replacement;var template=new Template(replacement);return function(match){return template.evaluate(match)};}
function gsub(pattern,replacement){var result='',source=this,match;replacement=prepareReplacement(replacement);if(Object.isString(pattern))
pattern=RegExp.escape(pattern);if(!(pattern.length||pattern.source)){replacement=replacement('');return replacement+source.split('').join(replacement)+replacement;}
while(source.length>0){if(match=source.match(pattern)){result+=source.slice(0,match.index);result+=String.interpret(replacement(match));source=source.slice(match.index+match[0].length);}else{result+=source,source='';}}
return result;}
function sub(pattern,replacement,count){replacement=prepareReplacement(replacement);count=Object.isUndefined(count)?1:count;return this.gsub(pattern,function(match){if(--count<0)return match[0];return replacement(match);});}
function scan(pattern,iterator){this.gsub(pattern,iterator);return String(this);}
function truncate(length,truncation){length=length||30;truncation=Object.isUndefined(truncation)?'...':truncation;return this.length>length?this.slice(0,length-truncation.length)+truncation:String(this);}
function strip(){return this.replace(/^\s+/,'').replace(/\s+$/,'');}
function stripTags(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,'');}
function stripScripts(){return this.replace(new RegExp(Prototype.ScriptFragment,'img'),'');}
function extractScripts(){var matchAll=new RegExp(Prototype.ScriptFragment,'img'),matchOne=new RegExp(Prototype.ScriptFragment,'im');return(this.match(matchAll)||[]).map(function(scriptTag){return(scriptTag.match(matchOne)||['',''])[1];});}
function evalScripts(){return this.extractScripts().map(function(script){return eval(script)});}
function escapeHTML(){return this.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}
function unescapeHTML(){return this.stripTags().replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&amp;/g,'&');}
function toQueryParams(separator){var match=this.strip().match(/([^?#]*)(#.*)?$/);if(!match)return{};return match[1].split(separator||'&').inject({},function(hash,pair){if((pair=pair.split('='))[0]){var key=decodeURIComponent(pair.shift()),value=pair.length>1?pair.join('='):pair[0];if(value!=undefined)value=decodeURIComponent(value);if(key in hash){if(!Object.isArray(hash[key]))hash[key]=[hash[key]];hash[key].push(value);}
else hash[key]=value;}
return hash;});}
function toArray(){return this.split('');}
function succ(){return this.slice(0,this.length-1)+
String.fromCharCode(this.charCodeAt(this.length-1)+1);}
function times(count){return count<1?'':new Array(count+1).join(this);}
function camelize(){return this.replace(/-+(.)?/g,function(match,chr){return chr?chr.toUpperCase():'';});}
function capitalize(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase();}
function underscore(){return this.replace(/::/g,'/').replace(/([A-Z]+)([A-Z][a-z])/g,'$1_$2').replace(/([a-z\d])([A-Z])/g,'$1_$2').replace(/-/g,'_').toLowerCase();}
function dasherize(){return this.replace(/_/g,'-');}
function inspect(useDoubleQuotes){var escapedString=this.replace(/[\x00-\x1f\\]/g,function(character){if(character in String.specialChar){return String.specialChar[character];}
return'\\u00'+character.charCodeAt().toPaddedString(2,16);});if(useDoubleQuotes)return'"'+escapedString.replace(/"/g,'\\"')+'"';return"'"+escapedString.replace(/'/g,'\\\'')+"'";}
function unfilterJSON(filter){return this.replace(filter||Prototype.JSONFilter,'$1');}
function isJSON(){var str=this;if(str.blank())return false;str=str.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@');str=str.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']');str=str.replace(/(?:^|:|,)(?:\s*\[)+/g,'');return(/^[\],:{}\s]*$/).test(str);}
function evalJSON(sanitize){var json=this.unfilterJSON(),cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;if(cx.test(json)){json=json.replace(cx,function(a){return'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);});}
try{if(!sanitize||json.isJSON())return eval('('+json+')');}catch(e){}
throw new SyntaxError('Badly formed JSON string: '+this.inspect());}
function parseJSON(){var json=this.unfilterJSON();return JSON.parse(json);}
function include(pattern){return this.indexOf(pattern)>-1;}
function startsWith(pattern){return this.lastIndexOf(pattern,0)===0;}
function endsWith(pattern){var d=this.length-pattern.length;return d>=0&&this.indexOf(pattern,d)===d;}
function empty(){return this=='';}
function blank(){return/^\s*$/.test(this);}
function interpolate(object,pattern){return new Template(this,pattern).evaluate(object);}
return{gsub:gsub,sub:sub,scan:scan,truncate:truncate,strip:String.prototype.trim||strip,stripTags:stripTags,stripScripts:stripScripts,extractScripts:extractScripts,evalScripts:evalScripts,escapeHTML:escapeHTML,unescapeHTML:unescapeHTML,toQueryParams:toQueryParams,parseQuery:toQueryParams,toArray:toArray,succ:succ,times:times,camelize:camelize,capitalize:capitalize,underscore:underscore,dasherize:dasherize,inspect:inspect,unfilterJSON:unfilterJSON,isJSON:isJSON,evalJSON:NATIVE_JSON_PARSE_SUPPORT?parseJSON:evalJSON,include:include,startsWith:startsWith,endsWith:endsWith,empty:empty,blank:blank,interpolate:interpolate};})());var Template=Class.create({initialize:function(template,pattern){this.template=template.toString();this.pattern=pattern||Template.Pattern;},evaluate:function(object){if(object&&Object.isFunction(object.toTemplateReplacements))
object=object.toTemplateReplacements();return this.template.gsub(this.pattern,function(match){if(object==null)return(match[1]+'');var before=match[1]||'';if(before=='\\')return match[2];var ctx=object,expr=match[3],pattern=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;match=pattern.exec(expr);if(match==null)return before;while(match!=null){var comp=match[1].startsWith('[')?match[2].replace(/\\\\]/g,']'):match[1];ctx=ctx[comp];if(null==ctx||''==match[3])break;expr=expr.substring('['==match[3]?match[1].length:match[0].length);match=pattern.exec(expr);}
return before+String.interpret(ctx);});}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;var $break={};var Enumerable=(function(){function each(iterator,context){var index=0;try{this._each(function(value){iterator.call(context,value,index++);});}catch(e){if(e!=$break)throw e;}
return this;}
function eachSlice(number,iterator,context){var index=-number,slices=[],array=this.toArray();if(number<1)return array;while((index+=number)<array.length)
slices.push(array.slice(index,index+number));return slices.collect(iterator,context);}
function all(iterator,context){iterator=iterator||Prototype.K;var result=true;this.each(function(value,index){result=result&&!!iterator.call(context,value,index);if(!result)throw $break;});return result;}
function any(iterator,context){iterator=iterator||Prototype.K;var result=false;this.each(function(value,index){if(result=!!iterator.call(context,value,index))
throw $break;});return result;}
function collect(iterator,context){iterator=iterator||Prototype.K;var results=[];this.each(function(value,index){results.push(iterator.call(context,value,index));});return results;}
function detect(iterator,context){var result;this.each(function(value,index){if(iterator.call(context,value,index)){result=value;throw $break;}});return result;}
function findAll(iterator,context){var results=[];this.each(function(value,index){if(iterator.call(context,value,index))
results.push(value);});return results;}
function grep(filter,iterator,context){iterator=iterator||Prototype.K;var results=[];if(Object.isString(filter))
filter=new RegExp(RegExp.escape(filter));this.each(function(value,index){if(filter.match(value))
results.push(iterator.call(context,value,index));});return results;}
function include(object){if(Object.isFunction(this.indexOf))
if(this.indexOf(object)!=-1)return true;var found=false;this.each(function(value){if(value==object){found=true;throw $break;}});return found;}
function inGroupsOf(number,fillWith){fillWith=Object.isUndefined(fillWith)?null:fillWith;return this.eachSlice(number,function(slice){while(slice.length<number)slice.push(fillWith);return slice;});}
function inject(memo,iterator,context){this.each(function(value,index){memo=iterator.call(context,memo,value,index);});return memo;}
function invoke(method){var args=$A(arguments).slice(1);return this.map(function(value){return value[method].apply(value,args);});}
function max(iterator,context){iterator=iterator||Prototype.K;var result;this.each(function(value,index){value=iterator.call(context,value,index);if(result==null||value>=result)
result=value;});return result;}
function min(iterator,context){iterator=iterator||Prototype.K;var result;this.each(function(value,index){value=iterator.call(context,value,index);if(result==null||value<result)
result=value;});return result;}
function partition(iterator,context){iterator=iterator||Prototype.K;var trues=[],falses=[];this.each(function(value,index){(iterator.call(context,value,index)?trues:falses).push(value);});return[trues,falses];}
function pluck(property){var results=[];this.each(function(value){results.push(value[property]);});return results;}
function reject(iterator,context){var results=[];this.each(function(value,index){if(!iterator.call(context,value,index))
results.push(value);});return results;}
function sortBy(iterator,context){return this.map(function(value,index){return{value:value,criteria:iterator.call(context,value,index)};}).sort(function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0;}).pluck('value');}
function toArray(){return this.map();}
function zip(){var iterator=Prototype.K,args=$A(arguments);if(Object.isFunction(args.last()))
iterator=args.pop();var collections=[this].concat(args).map($A);return this.map(function(value,index){return iterator(collections.pluck(index));});}
function size(){return this.toArray().length;}
function inspect(){return'#<Enumerable:'+this.toArray().inspect()+'>';}
return{each:each,eachSlice:eachSlice,all:all,every:all,any:any,some:any,collect:collect,map:collect,detect:detect,findAll:findAll,select:findAll,filter:findAll,grep:grep,include:include,member:include,inGroupsOf:inGroupsOf,inject:inject,invoke:invoke,max:max,min:min,partition:partition,pluck:pluck,reject:reject,sortBy:sortBy,toArray:toArray,entries:toArray,zip:zip,size:size,inspect:inspect,find:detect};})();function $A(iterable){if(!iterable)return[];if('toArray'in Object(iterable))return iterable.toArray();var length=iterable.length||0,results=new Array(length);while(length--)results[length]=iterable[length];return results;}
function $w(string){if(!Object.isString(string))return[];string=string.strip();return string?string.split(/\s+/):[];}
Array.from=$A;(function(){var arrayProto=Array.prototype,slice=arrayProto.slice,_each=arrayProto.forEach;function each(iterator,context){for(var i=0,length=this.length>>>0;i<length;i++){if(i in this)iterator.call(context,this[i],i,this);}}
if(!_each)_each=each;function clear(){this.length=0;return this;}
function first(){return this[0];}
function last(){return this[this.length-1];}
function compact(){return this.select(function(value){return value!=null;});}
function flatten(){return this.inject([],function(array,value){if(Object.isArray(value))
return array.concat(value.flatten());array.push(value);return array;});}
function without(){var values=slice.call(arguments,0);return this.select(function(value){return!values.include(value);});}
function reverse(inline){return(inline===false?this.toArray():this)._reverse();}
function uniq(sorted){return this.inject([],function(array,value,index){if(0==index||(sorted?array.last()!=value:!array.include(value)))
array.push(value);return array;});}
function intersect(array){return this.uniq().findAll(function(item){return array.detect(function(value){return item===value});});}
function clone(){return slice.call(this,0);}
function size(){return this.length;}
function inspect(){return'['+this.map(Object.inspect).join(', ')+']';}
function indexOf(item,i){i||(i=0);var length=this.length;if(i<0)i=length+i;for(;i<length;i++)
if(this[i]===item)return i;return-1;}
function lastIndexOf(item,i){i=isNaN(i)?this.length:(i<0?this.length+i:i)+1;var n=this.slice(0,i).reverse().indexOf(item);return(n<0)?n:i-n-1;}
function concat(){var array=slice.call(this,0),item;for(var i=0,length=arguments.length;i<length;i++){item=arguments[i];if(Object.isArray(item)&&!('callee'in item)){for(var j=0,arrayLength=item.length;j<arrayLength;j++)
array.push(item[j]);}else{array.push(item);}}
return array;}
Object.extend(arrayProto,Enumerable);if(!arrayProto._reverse)
arrayProto._reverse=arrayProto.reverse;Object.extend(arrayProto,{_each:_each,clear:clear,first:first,last:last,compact:compact,flatten:flatten,without:without,reverse:reverse,uniq:uniq,intersect:intersect,clone:clone,toArray:clone,size:size,inspect:inspect});var CONCAT_ARGUMENTS_BUGGY=(function(){return[].concat(arguments)[0][0]!==1;})(1,2)
if(CONCAT_ARGUMENTS_BUGGY)arrayProto.concat=concat;if(!arrayProto.indexOf)arrayProto.indexOf=indexOf;if(!arrayProto.lastIndexOf)arrayProto.lastIndexOf=lastIndexOf;})();function $H(object){return new Hash(object);};var Hash=Class.create(Enumerable,(function(){function initialize(object){this._object=Object.isHash(object)?object.toObject():Object.clone(object);}
function _each(iterator){for(var key in this._object){var value=this._object[key],pair=[key,value];pair.key=key;pair.value=value;iterator(pair);}}
function set(key,value){return this._object[key]=value;}
function get(key){if(this._object[key]!==Object.prototype[key])
return this._object[key];}
function unset(key){var value=this._object[key];delete this._object[key];return value;}
function toObject(){return Object.clone(this._object);}
function keys(){return this.pluck('key');}
function values(){return this.pluck('value');}
function index(value){var match=this.detect(function(pair){return pair.value===value;});return match&&match.key;}
function merge(object){return this.clone().update(object);}
function update(object){return new Hash(object).inject(this,function(result,pair){result.set(pair.key,pair.value);return result;});}
function toQueryPair(key,value){if(Object.isUndefined(value))return key;return key+'='+encodeURIComponent(String.interpret(value));}
function toQueryString(){return this.inject([],function(results,pair){var key=encodeURIComponent(pair.key),values=pair.value;if(values&&typeof values=='object'){if(Object.isArray(values)){var queryValues=[];for(var i=0,len=values.length,value;i<len;i++){value=values[i];queryValues.push(toQueryPair(key,value));}
return results.concat(queryValues);}}else results.push(toQueryPair(key,values));return results;}).join('&');}
function inspect(){return'#<Hash:{'+this.map(function(pair){return pair.map(Object.inspect).join(': ');}).join(', ')+'}>';}
function clone(){return new Hash(this);}
return{initialize:initialize,_each:_each,set:set,get:get,unset:unset,toObject:toObject,toTemplateReplacements:toObject,keys:keys,values:values,index:index,merge:merge,update:update,toQueryString:toQueryString,inspect:inspect,toJSON:toObject,clone:clone};})());Hash.from=$H;Object.extend(Number.prototype,(function(){function toColorPart(){return this.toPaddedString(2,16);}
function succ(){return this+1;}
function times(iterator,context){$R(0,this,true).each(iterator,context);return this;}
function toPaddedString(length,radix){var string=this.toString(radix||10);return'0'.times(length-string.length)+string;}
function abs(){return Math.abs(this);}
function round(){return Math.round(this);}
function ceil(){return Math.ceil(this);}
function floor(){return Math.floor(this);}
return{toColorPart:toColorPart,succ:succ,times:times,toPaddedString:toPaddedString,abs:abs,round:round,ceil:ceil,floor:floor};})());function $R(start,end,exclusive){return new ObjectRange(start,end,exclusive);}
var ObjectRange=Class.create(Enumerable,(function(){function initialize(start,end,exclusive){this.start=start;this.end=end;this.exclusive=exclusive;}
function _each(iterator){var value=this.start;while(this.include(value)){iterator(value);value=value.succ();}}
function include(value){if(value<this.start)
return false;if(this.exclusive)
return value<this.end;return value<=this.end;}
return{initialize:initialize,_each:_each,include:include};})());var Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest()},function(){return new ActiveXObject('Msxml2.XMLHTTP')},function(){return new ActiveXObject('Microsoft.XMLHTTP')})||false;},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(iterator){this.responders._each(iterator);},register:function(responder){if(!this.include(responder))
this.responders.push(responder);},unregister:function(responder){this.responders=this.responders.without(responder);},dispatch:function(callback,request,transport,json){this.each(function(responder){if(Object.isFunction(responder[callback])){try{responder[callback].apply(responder,[request,transport,json]);}catch(e){}}});}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});Ajax.Base=Class.create({initialize:function(options){this.options={method:'post',asynchronous:true,contentType:'application/x-www-form-urlencoded',encoding:'UTF-8',parameters:'',evalJSON:true,evalJS:true};Object.extend(this.options,options||{});this.options.method=this.options.method.toLowerCase();if(Object.isHash(this.options.parameters))
this.options.parameters=this.options.parameters.toObject();}});Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,url,options){$super(options);this.transport=Ajax.getTransport();this.request(url);},request:function(url){this.url=url;this.method=this.options.method;var params=Object.isString(this.options.parameters)?this.options.parameters:Object.toQueryString(this.options.parameters);if(!['get','post'].include(this.method)){params+=(params?'&':'')+"_method="+this.method;this.method='post';}
if(params&&this.method==='get'){this.url+=(this.url.include('?')?'&':'?')+params;}
this.parameters=params.toQueryParams();try{var response=new Ajax.Response(this);if(this.options.onCreate)this.options.onCreate(response);Ajax.Responders.dispatch('onCreate',this,response);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);if(this.options.asynchronous)this.respondToReadyState.bind(this).defer(1);this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=='post'?(this.options.postBody||params):null;this.transport.send(this.body);if(!this.options.asynchronous&&this.transport.overrideMimeType)
this.onStateChange();}
catch(e){this.dispatchException(e);}},onStateChange:function(){var readyState=this.transport.readyState;if(readyState>1&&!((readyState==4)&&this._complete))
this.respondToReadyState(this.transport.readyState);},setRequestHeaders:function(){var headers={'X-Requested-With':'XMLHttpRequest','X-Prototype-Version':Prototype.Version,'Accept':'text/javascript, text/html, application/xml, text/xml, */*'};if(this.method=='post'){headers['Content-type']=this.options.contentType+
(this.options.encoding?'; charset='+this.options.encoding:'');if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005)
headers['Connection']='close';}
if(typeof this.options.requestHeaders=='object'){var extras=this.options.requestHeaders;if(Object.isFunction(extras.push))
for(var i=0,length=extras.length;i<length;i+=2)
headers[extras[i]]=extras[i+1];else
$H(extras).each(function(pair){headers[pair.key]=pair.value});}
for(var name in headers)
this.transport.setRequestHeader(name,headers[name]);},success:function(){var status=this.getStatus();return!status||(status>=200&&status<300)||status==304;},getStatus:function(){try{if(this.transport.status===1223)return 204;return this.transport.status||0;}catch(e){return 0}},respondToReadyState:function(readyState){var state=Ajax.Request.Events[readyState],response=new Ajax.Response(this);if(state=='Complete'){try{this._complete=true;(this.options['on'+response.status]||this.options['on'+(this.success()?'Success':'Failure')]||Prototype.emptyFunction)(response,response.headerJSON);}catch(e){this.dispatchException(e);}
var contentType=response.getHeader('Content-type');if(this.options.evalJS=='force'||(this.options.evalJS&&this.isSameOrigin()&&contentType&&contentType.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i)))
this.evalResponse();}
try{(this.options['on'+state]||Prototype.emptyFunction)(response,response.headerJSON);Ajax.Responders.dispatch('on'+state,this,response,response.headerJSON);}catch(e){this.dispatchException(e);}
if(state=='Complete'){this.transport.onreadystatechange=Prototype.emptyFunction;}},isSameOrigin:function(){var m=this.url.match(/^\s*https?:\/\/[^\/]*/);return!m||(m[0]=='#{protocol}//#{domain}#{port}'.interpolate({protocol:location.protocol,domain:document.domain,port:location.port?':'+location.port:''}));},getHeader:function(name){try{return this.transport.getResponseHeader(name)||null;}catch(e){return null;}},evalResponse:function(){try{return eval((this.transport.responseText||'').unfilterJSON());}catch(e){this.dispatchException(e);}},dispatchException:function(exception){(this.options.onException||Prototype.emptyFunction)(this,exception);Ajax.Responders.dispatch('onException',this,exception);}});Ajax.Request.Events=['Uninitialized','Loading','Loaded','Interactive','Complete'];Ajax.Response=Class.create({initialize:function(request){this.request=request;var transport=this.transport=request.transport,readyState=this.readyState=transport.readyState;if((readyState>2&&!Prototype.Browser.IE)||readyState==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(transport.responseText);this.headerJSON=this._getHeaderJSON();}
if(readyState==4){var xml=transport.responseXML;this.responseXML=Object.isUndefined(xml)?null:xml;this.responseJSON=this._getResponseJSON();}},status:0,statusText:'',getStatus:Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||'';}catch(e){return''}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders();}catch(e){return null}},getResponseHeader:function(name){return this.transport.getResponseHeader(name);},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders();},_getHeaderJSON:function(){var json=this.getHeader('X-JSON');if(!json)return null;json=decodeURIComponent(escape(json));try{return json.evalJSON(this.request.options.sanitizeJSON||!this.request.isSameOrigin());}catch(e){this.request.dispatchException(e);}},_getResponseJSON:function(){var options=this.request.options;if(!options.evalJSON||(options.evalJSON!='force'&&!(this.getHeader('Content-type')||'').include('application/json'))||this.responseText.blank())
return null;try{return this.responseText.evalJSON(options.sanitizeJSON||!this.request.isSameOrigin());}catch(e){this.request.dispatchException(e);}}});Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,container,url,options){this.container={success:(container.success||container),failure:(container.failure||(container.success?null:container))};options=Object.clone(options);var onComplete=options.onComplete;options.onComplete=(function(response,json){this.updateContent(response.responseText);if(Object.isFunction(onComplete))onComplete(response,json);}).bind(this);$super(url,options);},updateContent:function(responseText){var receiver=this.container[this.success()?'success':'failure'],options=this.options;if(!options.evalScripts)responseText=responseText.stripScripts();if(receiver=$(receiver)){if(options.insertion){if(Object.isString(options.insertion)){var insertion={};insertion[options.insertion]=responseText;receiver.insert(insertion);}
else options.insertion(receiver,responseText);}
else receiver.update(responseText);}}});Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,container,url,options){$super(options);this.onComplete=this.options.onComplete;this.frequency=(this.options.frequency||2);this.decay=(this.options.decay||1);this.updater={};this.container=container;this.url=url;this.start();},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent();},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments);},updateComplete:function(response){if(this.options.decay){this.decay=(response.responseText==this.lastText?this.decay*this.options.decay:1);this.lastText=response.responseText;}
this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency);},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options);}});function $(element){if(arguments.length>1){for(var i=0,elements=[],length=arguments.length;i<length;i++)
elements.push($(arguments[i]));return elements;}
if(Object.isString(element))
element=document.getElementById(element);return Element.extend(element);}
if(Prototype.BrowserFeatures.XPath){document._getElementsByXPath=function(expression,parentElement){var results=[];var query=document.evaluate(expression,$(parentElement)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var i=0,length=query.snapshotLength;i<length;i++)
results.push(Element.extend(query.snapshotItem(i)));return results;};}
if(!Node)var Node={};if(!Node.ELEMENT_NODE){Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12});}
(function(global){function shouldUseCache(tagName,attributes){if(tagName==='select')return false;if('type'in attributes)return false;return true;}
var HAS_EXTENDED_CREATE_ELEMENT_SYNTAX=(function(){try{var el=document.createElement('<input name="x">');return el.tagName.toLowerCase()==='input'&&el.name==='x';}
catch(err){return false;}})();var element=global.Element;global.Element=function(tagName,attributes){attributes=attributes||{};tagName=tagName.toLowerCase();var cache=Element.cache;if(HAS_EXTENDED_CREATE_ELEMENT_SYNTAX&&attributes.name){tagName='<'+tagName+' name="'+attributes.name+'">';delete attributes.name;return Element.writeAttribute(document.createElement(tagName),attributes);}
if(!cache[tagName])cache[tagName]=Element.extend(document.createElement(tagName));var node=shouldUseCache(tagName,attributes)?cache[tagName].cloneNode(false):document.createElement(tagName);return Element.writeAttribute(node,attributes);};Object.extend(global.Element,element||{});if(element)global.Element.prototype=element.prototype;})(this);Element.idCounter=1;Element.cache={};Element._purgeElement=function(element){var uid=element._prototypeUID;if(uid){Element.stopObserving(element);element._prototypeUID=void 0;delete Element.Storage[uid];}}
Element.Methods={visible:function(element){return $(element).style.display!='none';},toggle:function(element){element=$(element);Element[Element.visible(element)?'hide':'show'](element);return element;},hide:function(element){element=$(element);element.style.display='none';return element;},show:function(element){element=$(element);element.style.display='';return element;},remove:function(element){element=$(element);element.parentNode.removeChild(element);return element;},update:(function(){var SELECT_ELEMENT_INNERHTML_BUGGY=(function(){var el=document.createElement("select"),isBuggy=true;el.innerHTML="<option value=\"test\">test</option>";if(el.options&&el.options[0]){isBuggy=el.options[0].nodeName.toUpperCase()!=="OPTION";}
el=null;return isBuggy;})();var TABLE_ELEMENT_INNERHTML_BUGGY=(function(){try{var el=document.createElement("table");if(el&&el.tBodies){el.innerHTML="<tbody><tr><td>test</td></tr></tbody>";var isBuggy=typeof el.tBodies[0]=="undefined";el=null;return isBuggy;}}catch(e){return true;}})();var LINK_ELEMENT_INNERHTML_BUGGY=(function(){try{var el=document.createElement('div');el.innerHTML="<link>";var isBuggy=(el.childNodes.length===0);el=null;return isBuggy;}catch(e){return true;}})();var ANY_INNERHTML_BUGGY=SELECT_ELEMENT_INNERHTML_BUGGY||TABLE_ELEMENT_INNERHTML_BUGGY||LINK_ELEMENT_INNERHTML_BUGGY;var SCRIPT_ELEMENT_REJECTS_TEXTNODE_APPENDING=(function(){var s=document.createElement("script"),isBuggy=false;try{s.appendChild(document.createTextNode(""));isBuggy=!s.firstChild||s.firstChild&&s.firstChild.nodeType!==3;}catch(e){isBuggy=true;}
s=null;return isBuggy;})();function update(element,content){element=$(element);var purgeElement=Element._purgeElement;var descendants=element.getElementsByTagName('*'),i=descendants.length;while(i--)purgeElement(descendants[i]);if(content&&content.toElement)
content=content.toElement();if(Object.isElement(content))
return element.update().insert(content);content=Object.toHTML(content);var tagName=element.tagName.toUpperCase();if(tagName==='SCRIPT'&&SCRIPT_ELEMENT_REJECTS_TEXTNODE_APPENDING){element.text=content;return element;}
if(ANY_INNERHTML_BUGGY){if(tagName in Element._insertionTranslations.tags){while(element.firstChild){element.removeChild(element.firstChild);}
Element._getContentFromAnonymousElement(tagName,content.stripScripts()).each(function(node){element.appendChild(node)});}else if(LINK_ELEMENT_INNERHTML_BUGGY&&Object.isString(content)&&content.indexOf('<link')>-1){while(element.firstChild){element.removeChild(element.firstChild);}
var nodes=Element._getContentFromAnonymousElement(tagName,content.stripScripts(),true);nodes.each(function(node){element.appendChild(node)});}
else{element.innerHTML=content.stripScripts();}}
else{element.innerHTML=content.stripScripts();}
content.evalScripts.bind(content).defer();return element;}
return update;})(),replace:function(element,content){element=$(element);if(content&&content.toElement)content=content.toElement();else if(!Object.isElement(content)){content=Object.toHTML(content);var range=element.ownerDocument.createRange();range.selectNode(element);content.evalScripts.bind(content).defer();content=range.createContextualFragment(content.stripScripts());}
element.parentNode.replaceChild(content,element);return element;},insert:function(element,insertions){element=$(element);if(Object.isString(insertions)||Object.isNumber(insertions)||Object.isElement(insertions)||(insertions&&(insertions.toElement||insertions.toHTML)))
insertions={bottom:insertions};var content,insert,tagName,childNodes;for(var position in insertions){content=insertions[position];position=position.toLowerCase();insert=Element._insertionTranslations[position];if(content&&content.toElement)content=content.toElement();if(Object.isElement(content)){insert(element,content);continue;}
content=Object.toHTML(content);tagName=((position=='before'||position=='after')?element.parentNode:element).tagName.toUpperCase();childNodes=Element._getContentFromAnonymousElement(tagName,content.stripScripts());if(position=='top'||position=='after')childNodes.reverse();childNodes.each(insert.curry(element));content.evalScripts.bind(content).defer();}
return element;},wrap:function(element,wrapper,attributes){element=$(element);if(Object.isElement(wrapper))
$(wrapper).writeAttribute(attributes||{});else if(Object.isString(wrapper))wrapper=new Element(wrapper,attributes);else wrapper=new Element('div',wrapper);if(element.parentNode)
element.parentNode.replaceChild(wrapper,element);wrapper.appendChild(element);return wrapper;},inspect:function(element){element=$(element);var result='<'+element.tagName.toLowerCase();$H({'id':'id','className':'class'}).each(function(pair){var property=pair.first(),attribute=pair.last(),value=(element[property]||'').toString();if(value)result+=' '+attribute+'='+value.inspect(true);});return result+'>';},recursivelyCollect:function(element,property,maximumLength){element=$(element);maximumLength=maximumLength||-1;var elements=[];while(element=element[property]){if(element.nodeType==1)
elements.push(Element.extend(element));if(elements.length==maximumLength)
break;}
return elements;},ancestors:function(element){return Element.recursivelyCollect(element,'parentNode');},descendants:function(element){return Element.select(element,"*");},firstDescendant:function(element){element=$(element).firstChild;while(element&&element.nodeType!=1)element=element.nextSibling;return $(element);},immediateDescendants:function(element){var results=[],child=$(element).firstChild;while(child){if(child.nodeType===1){results.push(Element.extend(child));}
child=child.nextSibling;}
return results;},previousSiblings:function(element,maximumLength){return Element.recursivelyCollect(element,'previousSibling');},nextSiblings:function(element){return Element.recursivelyCollect(element,'nextSibling');},siblings:function(element){element=$(element);return Element.previousSiblings(element).reverse().concat(Element.nextSiblings(element));},match:function(element,selector){element=$(element);if(Object.isString(selector))
return Prototype.Selector.match(element,selector);return selector.match(element);},up:function(element,expression,index){element=$(element);if(arguments.length==1)return $(element.parentNode);var ancestors=Element.ancestors(element);return Object.isNumber(expression)?ancestors[expression]:Prototype.Selector.find(ancestors,expression,index);},down:function(element,expression,index){element=$(element);if(arguments.length==1)return Element.firstDescendant(element);return Object.isNumber(expression)?Element.descendants(element)[expression]:Element.select(element,expression)[index||0];},previous:function(element,expression,index){element=$(element);if(Object.isNumber(expression))index=expression,expression=false;if(!Object.isNumber(index))index=0;if(expression){return Prototype.Selector.find(element.previousSiblings(),expression,index);}else{return element.recursivelyCollect("previousSibling",index+1)[index];}},next:function(element,expression,index){element=$(element);if(Object.isNumber(expression))index=expression,expression=false;if(!Object.isNumber(index))index=0;if(expression){return Prototype.Selector.find(element.nextSiblings(),expression,index);}else{var maximumLength=Object.isNumber(index)?index+1:1;return element.recursivelyCollect("nextSibling",index+1)[index];}},select:function(element){element=$(element);var expressions=Array.prototype.slice.call(arguments,1).join(', ');return Prototype.Selector.select(expressions,element);},adjacent:function(element){element=$(element);var expressions=Array.prototype.slice.call(arguments,1).join(', ');return Prototype.Selector.select(expressions,element.parentNode).without(element);},identify:function(element){element=$(element);var id=Element.readAttribute(element,'id');if(id)return id;do{id='anonymous_element_'+Element.idCounter++}while($(id));Element.writeAttribute(element,'id',id);return id;},readAttribute:function(element,name){element=$(element);if(Prototype.Browser.IE){var t=Element._attributeTranslations.read;if(t.values[name])return t.values[name](element,name);if(t.names[name])name=t.names[name];if(name.include(':')){return(!element.attributes||!element.attributes[name])?null:element.attributes[name].value;}}
return element.getAttribute(name);},writeAttribute:function(element,name,value){element=$(element);var attributes={},t=Element._attributeTranslations.write;if(typeof name=='object')attributes=name;else attributes[name]=Object.isUndefined(value)?true:value;for(var attr in attributes){name=t.names[attr]||attr;value=attributes[attr];if(t.values[attr])name=t.values[attr](element,value);if(value===false||value===null)
element.removeAttribute(name);else if(value===true)
element.setAttribute(name,name);else element.setAttribute(name,value);}
return element;},getHeight:function(element){return Element.getDimensions(element).height;},getWidth:function(element){return Element.getDimensions(element).width;},classNames:function(element){return new Element.ClassNames(element);},hasClassName:function(element,className){if(!(element=$(element)))return;var elementClassName=element.className;return(elementClassName.length>0&&(elementClassName==className||new RegExp("(^|\\s)"+className+"(\\s|$)").test(elementClassName)));},addClassName:function(element,className){if(!(element=$(element)))return;if(!Element.hasClassName(element,className))
element.className+=(element.className?' ':'')+className;return element;},removeClassName:function(element,className){if(!(element=$(element)))return;element.className=element.className.replace(new RegExp("(^|\\s+)"+className+"(\\s+|$)"),' ').strip();return element;},toggleClassName:function(element,className){if(!(element=$(element)))return;return Element[Element.hasClassName(element,className)?'removeClassName':'addClassName'](element,className);},cleanWhitespace:function(element){element=$(element);var node=element.firstChild;while(node){var nextNode=node.nextSibling;if(node.nodeType==3&&!/\S/.test(node.nodeValue))
element.removeChild(node);node=nextNode;}
return element;},empty:function(element){return $(element).innerHTML.blank();},descendantOf:function(element,ancestor){element=$(element),ancestor=$(ancestor);if(element.compareDocumentPosition)
return(element.compareDocumentPosition(ancestor)&8)===8;if(ancestor.contains)
return ancestor.contains(element)&&ancestor!==element;while(element=element.parentNode)
if(element==ancestor)return true;return false;},scrollTo:function(element){element=$(element);var pos=Element.cumulativeOffset(element);window.scrollTo(pos[0],pos[1]);return element;},getStyle:function(element,style){element=$(element);style=style=='float'?'cssFloat':style.camelize();var value=element.style[style];if(!value||value=='auto'){var css=document.defaultView.getComputedStyle(element,null);value=css?css[style]:null;}
if(style=='opacity')return value?parseFloat(value):1.0;return value=='auto'?null:value;},getOpacity:function(element){return $(element).getStyle('opacity');},setStyle:function(element,styles){element=$(element);var elementStyle=element.style,match;if(Object.isString(styles)){element.style.cssText+=';'+styles;return styles.include('opacity')?element.setOpacity(styles.match(/opacity:\s*(\d?\.?\d*)/)[1]):element;}
for(var property in styles)
if(property=='opacity')element.setOpacity(styles[property]);else
elementStyle[(property=='float'||property=='cssFloat')?(Object.isUndefined(elementStyle.styleFloat)?'cssFloat':'styleFloat'):property]=styles[property];return element;},setOpacity:function(element,value){element=$(element);element.style.opacity=(value==1||value==='')?'':(value<0.00001)?0:value;return element;},makePositioned:function(element){element=$(element);var pos=Element.getStyle(element,'position');if(pos=='static'||!pos){element._madePositioned=true;element.style.position='relative';if(Prototype.Browser.Opera){element.style.top=0;element.style.left=0;}}
return element;},undoPositioned:function(element){element=$(element);if(element._madePositioned){element._madePositioned=undefined;element.style.position=element.style.top=element.style.left=element.style.bottom=element.style.right='';}
return element;},makeClipping:function(element){element=$(element);if(element._overflow)return element;element._overflow=Element.getStyle(element,'overflow')||'auto';if(element._overflow!=='hidden')
element.style.overflow='hidden';return element;},undoClipping:function(element){element=$(element);if(!element._overflow)return element;element.style.overflow=element._overflow=='auto'?'':element._overflow;element._overflow=null;return element;},clonePosition:function(element,source){var options=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},arguments[2]||{});source=$(source);var p=Element.viewportOffset(source),delta=[0,0],parent=null;element=$(element);if(Element.getStyle(element,'position')=='absolute'){parent=Element.getOffsetParent(element);delta=Element.viewportOffset(parent);}
if(parent==document.body){delta[0]-=document.body.offsetLeft;delta[1]-=document.body.offsetTop;}
if(options.setLeft)element.style.left=(p[0]-delta[0]+options.offsetLeft)+'px';if(options.setTop)element.style.top=(p[1]-delta[1]+options.offsetTop)+'px';if(options.setWidth)element.style.width=source.offsetWidth+'px';if(options.setHeight)element.style.height=source.offsetHeight+'px';return element;}};Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants});Element._attributeTranslations={write:{names:{className:'class',htmlFor:'for'},values:{}}};if(Prototype.Browser.Opera){Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(proceed,element,style){switch(style){case'height':case'width':if(!Element.visible(element))return null;var dim=parseInt(proceed(element,style),10);if(dim!==element['offset'+style.capitalize()])
return dim+'px';var properties;if(style==='height'){properties=['border-top-width','padding-top','padding-bottom','border-bottom-width'];}
else{properties=['border-left-width','padding-left','padding-right','border-right-width'];}
return properties.inject(dim,function(memo,property){var val=proceed(element,property);return val===null?memo:memo-parseInt(val,10);})+'px';default:return proceed(element,style);}});Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(proceed,element,attribute){if(attribute==='title')return element.title;return proceed(element,attribute);});}
else if(Prototype.Browser.IE){Element.Methods.getStyle=function(element,style){element=$(element);style=(style=='float'||style=='cssFloat')?'styleFloat':style.camelize();var value=element.style[style];if(!value&&element.currentStyle)value=element.currentStyle[style];if(style=='opacity'){if(value=(element.getStyle('filter')||'').match(/alpha\(opacity=(.*)\)/))
if(value[1])return parseFloat(value[1])/100;return 1.0;}
if(value=='auto'){if((style=='width'||style=='height')&&(element.getStyle('display')!='none'))
return element['offset'+style.capitalize()]+'px';return null;}
return value;};Element.Methods.setOpacity=function(element,value){function stripAlpha(filter){return filter.replace(/alpha\([^\)]*\)/gi,'');}
element=$(element);var currentStyle=element.currentStyle;if((currentStyle&&!currentStyle.hasLayout)||(!currentStyle&&element.style.zoom=='normal'))
element.style.zoom=1;var filter=element.getStyle('filter'),style=element.style;if(value==1||value===''){(filter=stripAlpha(filter))?style.filter=filter:style.removeAttribute('filter');return element;}else if(value<0.00001)value=0;style.filter=stripAlpha(filter)+'alpha(opacity='+(value*100)+')';return element;};Element._attributeTranslations=(function(){var classProp='className',forProp='for',el=document.createElement('div');el.setAttribute(classProp,'x');if(el.className!=='x'){el.setAttribute('class','x');if(el.className==='x'){classProp='class';}}
el=null;el=document.createElement('label');el.setAttribute(forProp,'x');if(el.htmlFor!=='x'){el.setAttribute('htmlFor','x');if(el.htmlFor==='x'){forProp='htmlFor';}}
el=null;return{read:{names:{'class':classProp,'className':classProp,'for':forProp,'htmlFor':forProp},values:{_getAttr:function(element,attribute){return element.getAttribute(attribute);},_getAttr2:function(element,attribute){return element.getAttribute(attribute,2);},_getAttrNode:function(element,attribute){var node=element.getAttributeNode(attribute);return node?node.value:"";},_getEv:(function(){var el=document.createElement('div'),f;el.onclick=Prototype.emptyFunction;var value=el.getAttribute('onclick');if(String(value).indexOf('{')>-1){f=function(element,attribute){attribute=element.getAttribute(attribute);if(!attribute)return null;attribute=attribute.toString();attribute=attribute.split('{')[1];attribute=attribute.split('}')[0];return attribute.strip();};}
else if(value===''){f=function(element,attribute){attribute=element.getAttribute(attribute);if(!attribute)return null;return attribute.strip();};}
el=null;return f;})(),_flag:function(element,attribute){return $(element).hasAttribute(attribute)?attribute:null;},style:function(element){return element.style.cssText.toLowerCase();},title:function(element){return element.title;}}}}})();Element._attributeTranslations.write={names:Object.extend({cellpadding:'cellPadding',cellspacing:'cellSpacing'},Element._attributeTranslations.read.names),values:{checked:function(element,value){element.checked=!!value;},style:function(element,value){element.style.cssText=value?value:'';}}};Element._attributeTranslations.has={};$w('colSpan rowSpan vAlign dateTime accessKey tabIndex '+'encType maxLength readOnly longDesc frameBorder').each(function(attr){Element._attributeTranslations.write.names[attr.toLowerCase()]=attr;Element._attributeTranslations.has[attr.toLowerCase()]=attr;});(function(v){Object.extend(v,{href:v._getAttr2,src:v._getAttr2,type:v._getAttr,action:v._getAttrNode,disabled:v._flag,checked:v._flag,readonly:v._flag,multiple:v._flag,onload:v._getEv,onunload:v._getEv,onclick:v._getEv,ondblclick:v._getEv,onmousedown:v._getEv,onmouseup:v._getEv,onmouseover:v._getEv,onmousemove:v._getEv,onmouseout:v._getEv,onfocus:v._getEv,onblur:v._getEv,onkeypress:v._getEv,onkeydown:v._getEv,onkeyup:v._getEv,onsubmit:v._getEv,onreset:v._getEv,onselect:v._getEv,onchange:v._getEv});})(Element._attributeTranslations.read.values);if(Prototype.BrowserFeatures.ElementExtensions){(function(){function _descendants(element){var nodes=element.getElementsByTagName('*'),results=[];for(var i=0,node;node=nodes[i];i++)
if(node.tagName!=="!")
results.push(node);return results;}
Element.Methods.down=function(element,expression,index){element=$(element);if(arguments.length==1)return element.firstDescendant();return Object.isNumber(expression)?_descendants(element)[expression]:Element.select(element,expression)[index||0];}})();}}
else if(Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent)){Element.Methods.setOpacity=function(element,value){element=$(element);element.style.opacity=(value==1)?0.999999:(value==='')?'':(value<0.00001)?0:value;return element;};}
else if(Prototype.Browser.WebKit){Element.Methods.setOpacity=function(element,value){element=$(element);element.style.opacity=(value==1||value==='')?'':(value<0.00001)?0:value;if(value==1)
if(element.tagName.toUpperCase()=='IMG'&&element.width){element.width++;element.width--;}else try{var n=document.createTextNode(' ');element.appendChild(n);element.removeChild(n);}catch(e){}
return element;};}
if('outerHTML'in document.documentElement){Element.Methods.replace=function(element,content){element=$(element);if(content&&content.toElement)content=content.toElement();if(Object.isElement(content)){element.parentNode.replaceChild(content,element);return element;}
content=Object.toHTML(content);var parent=element.parentNode,tagName=parent.tagName.toUpperCase();if(Element._insertionTranslations.tags[tagName]){var nextSibling=element.next(),fragments=Element._getContentFromAnonymousElement(tagName,content.stripScripts());parent.removeChild(element);if(nextSibling)
fragments.each(function(node){parent.insertBefore(node,nextSibling)});else
fragments.each(function(node){parent.appendChild(node)});}
else element.outerHTML=content.stripScripts();content.evalScripts.bind(content).defer();return element;};}
Element._returnOffset=function(l,t){var result=[l,t];result.left=l;result.top=t;return result;};Element._getContentFromAnonymousElement=function(tagName,html,force){var div=new Element('div'),t=Element._insertionTranslations.tags[tagName];var workaround=false;if(t)workaround=true;else if(force){workaround=true;t=['','',0];}
if(workaround){div.innerHTML='&nbsp;'+t[0]+html+t[1];div.removeChild(div.firstChild);for(var i=t[2];i--;){div=div.firstChild;}}
else{div.innerHTML=html;}
return $A(div.childNodes);};Element._insertionTranslations={before:function(element,node){element.parentNode.insertBefore(node,element);},top:function(element,node){element.insertBefore(node,element.firstChild);},bottom:function(element,node){element.appendChild(node);},after:function(element,node){element.parentNode.insertBefore(node,element.nextSibling);},tags:{TABLE:['<table>','</table>',1],TBODY:['<table><tbody>','</tbody></table>',2],TR:['<table><tbody><tr>','</tr></tbody></table>',3],TD:['<table><tbody><tr><td>','</td></tr></tbody></table>',4],SELECT:['<select>','</select>',1]}};(function(){var tags=Element._insertionTranslations.tags;Object.extend(tags,{THEAD:tags.TBODY,TFOOT:tags.TBODY,TH:tags.TD});})();Element.Methods.Simulated={hasAttribute:function(element,attribute){attribute=Element._attributeTranslations.has[attribute]||attribute;var node=$(element).getAttributeNode(attribute);return!!(node&&node.specified);}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);(function(div){if(!Prototype.BrowserFeatures.ElementExtensions&&div['__proto__']){window.HTMLElement={};window.HTMLElement.prototype=div['__proto__'];Prototype.BrowserFeatures.ElementExtensions=true;}
div=null;})(document.createElement('div'));Element.extend=(function(){function checkDeficiency(tagName){if(typeof window.Element!='undefined'){var proto=window.Element.prototype;if(proto){var id='_'+(Math.random()+'').slice(2),el=document.createElement(tagName);proto[id]='x';var isBuggy=(el[id]!=='x');delete proto[id];el=null;return isBuggy;}}
return false;}
function extendElementWith(element,methods){for(var property in methods){var value=methods[property];if(Object.isFunction(value)&&!(property in element))
element[property]=value.methodize();}}
var HTMLOBJECTELEMENT_PROTOTYPE_BUGGY=checkDeficiency('object');if(Prototype.BrowserFeatures.SpecificElementExtensions){if(HTMLOBJECTELEMENT_PROTOTYPE_BUGGY){return function(element){if(element&&typeof element._extendedByPrototype=='undefined'){var t=element.tagName;if(t&&(/^(?:object|applet|embed)$/i.test(t))){extendElementWith(element,Element.Methods);extendElementWith(element,Element.Methods.Simulated);extendElementWith(element,Element.Methods.ByTag[t.toUpperCase()]);}}
return element;}}
return Prototype.K;}
var Methods={},ByTag=Element.Methods.ByTag;var extend=Object.extend(function(element){if(!element||typeof element._extendedByPrototype!='undefined'||element.nodeType!=1||element==window)return element;var methods=Object.clone(Methods),tagName=element.tagName.toUpperCase();if(ByTag[tagName])Object.extend(methods,ByTag[tagName]);extendElementWith(element,methods);element._extendedByPrototype=Prototype.emptyFunction;return element;},{refresh:function(){if(!Prototype.BrowserFeatures.ElementExtensions){Object.extend(Methods,Element.Methods);Object.extend(Methods,Element.Methods.Simulated);}}});extend.refresh();return extend;})();if(document.documentElement.hasAttribute){Element.hasAttribute=function(element,attribute){return element.hasAttribute(attribute);};}
else{Element.hasAttribute=Element.Methods.Simulated.hasAttribute;}
Element.addMethods=function(methods){var F=Prototype.BrowserFeatures,T=Element.Methods.ByTag;if(!methods){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{"FORM":Object.clone(Form.Methods),"INPUT":Object.clone(Form.Element.Methods),"SELECT":Object.clone(Form.Element.Methods),"TEXTAREA":Object.clone(Form.Element.Methods),"BUTTON":Object.clone(Form.Element.Methods)});}
if(arguments.length==2){var tagName=methods;methods=arguments[1];}
if(!tagName)Object.extend(Element.Methods,methods||{});else{if(Object.isArray(tagName))tagName.each(extend);else extend(tagName);}
function extend(tagName){tagName=tagName.toUpperCase();if(!Element.Methods.ByTag[tagName])
Element.Methods.ByTag[tagName]={};Object.extend(Element.Methods.ByTag[tagName],methods);}
function copy(methods,destination,onlyIfAbsent){onlyIfAbsent=onlyIfAbsent||false;for(var property in methods){var value=methods[property];if(!Object.isFunction(value))continue;if(!onlyIfAbsent||!(property in destination))
destination[property]=value.methodize();}}
function findDOMClass(tagName){var klass;var trans={"OPTGROUP":"OptGroup","TEXTAREA":"TextArea","P":"Paragraph","FIELDSET":"FieldSet","UL":"UList","OL":"OList","DL":"DList","DIR":"Directory","H1":"Heading","H2":"Heading","H3":"Heading","H4":"Heading","H5":"Heading","H6":"Heading","Q":"Quote","INS":"Mod","DEL":"Mod","A":"Anchor","IMG":"Image","CAPTION":"TableCaption","COL":"TableCol","COLGROUP":"TableCol","THEAD":"TableSection","TFOOT":"TableSection","TBODY":"TableSection","TR":"TableRow","TH":"TableCell","TD":"TableCell","FRAMESET":"FrameSet","IFRAME":"IFrame"};if(trans[tagName])klass='HTML'+trans[tagName]+'Element';if(window[klass])return window[klass];klass='HTML'+tagName+'Element';if(window[klass])return window[klass];klass='HTML'+tagName.capitalize()+'Element';if(window[klass])return window[klass];var element=document.createElement(tagName),proto=element['__proto__']||element.constructor.prototype;element=null;return proto;}
var elementPrototype=window.HTMLElement?HTMLElement.prototype:Element.prototype;if(F.ElementExtensions){copy(Element.Methods,elementPrototype);copy(Element.Methods.Simulated,elementPrototype,true);}
if(F.SpecificElementExtensions){for(var tag in Element.Methods.ByTag){var klass=findDOMClass(tag);if(Object.isUndefined(klass))continue;copy(T[tag],klass.prototype);}}
Object.extend(Element,Element.Methods);delete Element.ByTag;if(Element.extend.refresh)Element.extend.refresh();Element.cache={};};document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()};},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);}};(function(viewport){var B=Prototype.Browser,doc=document,element,property={};function getRootElement(){if(B.WebKit&&!doc.evaluate)
return document;if(B.Opera&&window.parseFloat(window.opera.version())<9.5)
return document.body;return document.documentElement;}
function define(D){if(!element)element=getRootElement();property[D]='client'+D;viewport['get'+D]=function(){return element[property[D]]};return viewport['get'+D]();}
viewport.getWidth=define.curry('Width');viewport.getHeight=define.curry('Height');})(document.viewport);Element.Storage={UID:1};Element.addMethods({getStorage:function(element){if(!(element=$(element)))return;var uid;if(element===window){uid=0;}else{if(typeof element._prototypeUID==="undefined")
element._prototypeUID=Element.Storage.UID++;uid=element._prototypeUID;}
if(!Element.Storage[uid])
Element.Storage[uid]=$H();return Element.Storage[uid];},store:function(element,key,value){if(!(element=$(element)))return;if(arguments.length===2){Element.getStorage(element).update(key);}else{Element.getStorage(element).set(key,value);}
return element;},retrieve:function(element,key,defaultValue){if(!(element=$(element)))return;var hash=Element.getStorage(element),value=hash.get(key);if(Object.isUndefined(value)){hash.set(key,defaultValue);value=defaultValue;}
return value;},clone:function(element,deep){if(!(element=$(element)))return;var clone=element.cloneNode(deep);clone._prototypeUID=void 0;if(deep){var descendants=Element.select(clone,'*'),i=descendants.length;while(i--){descendants[i]._prototypeUID=void 0;}}
return Element.extend(clone);},purge:function(element){if(!(element=$(element)))return;var purgeElement=Element._purgeElement;purgeElement(element);var descendants=element.getElementsByTagName('*'),i=descendants.length;while(i--)purgeElement(descendants[i]);return null;}});(function(){function toDecimal(pctString){var match=pctString.match(/^(\d+)%?$/i);if(!match)return null;return(Number(match[1])/100);}
function getPixelValue(value,property,context){var element=null;if(Object.isElement(value)){element=value;value=element.getStyle(property);}
if(value===null){return null;}
if((/^(?:-)?\d+(\.\d+)?(px)?$/i).test(value)){return window.parseFloat(value);}
var isPercentage=value.include('%'),isViewport=(context===document.viewport);if(/\d/.test(value)&&element&&element.runtimeStyle&&!(isPercentage&&isViewport)){var style=element.style.left,rStyle=element.runtimeStyle.left;element.runtimeStyle.left=element.currentStyle.left;element.style.left=value||0;value=element.style.pixelLeft;element.style.left=style;element.runtimeStyle.left=rStyle;return value;}
if(element&&isPercentage){context=context||element.parentNode;var decimal=toDecimal(value);var whole=null;var position=element.getStyle('position');var isHorizontal=property.include('left')||property.include('right')||property.include('width');var isVertical=property.include('top')||property.include('bottom')||property.include('height');if(context===document.viewport){if(isHorizontal){whole=document.viewport.getWidth();}else if(isVertical){whole=document.viewport.getHeight();}}else{if(isHorizontal){whole=$(context).measure('width');}else if(isVertical){whole=$(context).measure('height');}}
return(whole===null)?0:whole*decimal;}
return 0;}
function toCSSPixels(number){if(Object.isString(number)&&number.endsWith('px')){return number;}
return number+'px';}
function isDisplayed(element){var originalElement=element;while(element&&element.parentNode){var display=element.getStyle('display');if(display==='none'){return false;}
element=$(element.parentNode);}
return true;}
var hasLayout=Prototype.K;if('currentStyle'in document.documentElement){hasLayout=function(element){if(!element.currentStyle.hasLayout){element.style.zoom=1;}
return element;};}
function cssNameFor(key){if(key.include('border'))key=key+'-width';return key.camelize();}
Element.Layout=Class.create(Hash,{initialize:function($super,element,preCompute){$super();this.element=$(element);Element.Layout.PROPERTIES.each(function(property){this._set(property,null);},this);if(preCompute){this._preComputing=true;this._begin();Element.Layout.PROPERTIES.each(this._compute,this);this._end();this._preComputing=false;}},_set:function(property,value){return Hash.prototype.set.call(this,property,value);},set:function(property,value){throw"Properties of Element.Layout are read-only.";},get:function($super,property){var value=$super(property);return value===null?this._compute(property):value;},_begin:function(){if(this._prepared)return;var element=this.element;if(isDisplayed(element)){this._prepared=true;return;}
var originalStyles={position:element.style.position||'',width:element.style.width||'',visibility:element.style.visibility||'',display:element.style.display||''};element.store('prototype_original_styles',originalStyles);var position=element.getStyle('position'),width=element.getStyle('width');if(width==="0px"||width===null){element.style.display='block';width=element.getStyle('width');}
var context=(position==='fixed')?document.viewport:element.parentNode;element.setStyle({position:'absolute',visibility:'hidden',display:'block'});var positionedWidth=element.getStyle('width');var newWidth;if(width&&(positionedWidth===width)){newWidth=getPixelValue(element,'width',context);}else if(position==='absolute'||position==='fixed'){newWidth=getPixelValue(element,'width',context);}else{var parent=element.parentNode,pLayout=$(parent).getLayout();newWidth=pLayout.get('width')-
this.get('margin-left')-
this.get('border-left')-
this.get('padding-left')-
this.get('padding-right')-
this.get('border-right')-
this.get('margin-right');}
element.setStyle({width:newWidth+'px'});this._prepared=true;},_end:function(){var element=this.element;var originalStyles=element.retrieve('prototype_original_styles');element.store('prototype_original_styles',null);element.setStyle(originalStyles);this._prepared=false;},_compute:function(property){var COMPUTATIONS=Element.Layout.COMPUTATIONS;if(!(property in COMPUTATIONS)){throw"Property not found.";}
return this._set(property,COMPUTATIONS[property].call(this,this.element));},toObject:function(){var args=$A(arguments);var keys=(args.length===0)?Element.Layout.PROPERTIES:args.join(' ').split(' ');var obj={};keys.each(function(key){if(!Element.Layout.PROPERTIES.include(key))return;var value=this.get(key);if(value!=null)obj[key]=value;},this);return obj;},toHash:function(){var obj=this.toObject.apply(this,arguments);return new Hash(obj);},toCSS:function(){var args=$A(arguments);var keys=(args.length===0)?Element.Layout.PROPERTIES:args.join(' ').split(' ');var css={};keys.each(function(key){if(!Element.Layout.PROPERTIES.include(key))return;if(Element.Layout.COMPOSITE_PROPERTIES.include(key))return;var value=this.get(key);if(value!=null)css[cssNameFor(key)]=value+'px';},this);return css;},inspect:function(){return"#<Element.Layout>";}});Object.extend(Element.Layout,{PROPERTIES:$w('height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height'),COMPOSITE_PROPERTIES:$w('padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height'),COMPUTATIONS:{'height':function(element){if(!this._preComputing)this._begin();var bHeight=this.get('border-box-height');if(bHeight<=0){if(!this._preComputing)this._end();return 0;}
var bTop=this.get('border-top'),bBottom=this.get('border-bottom');var pTop=this.get('padding-top'),pBottom=this.get('padding-bottom');if(!this._preComputing)this._end();return bHeight-bTop-bBottom-pTop-pBottom;},'width':function(element){if(!this._preComputing)this._begin();var bWidth=this.get('border-box-width');if(bWidth<=0){if(!this._preComputing)this._end();return 0;}
var bLeft=this.get('border-left'),bRight=this.get('border-right');var pLeft=this.get('padding-left'),pRight=this.get('padding-right');if(!this._preComputing)this._end();return bWidth-bLeft-bRight-pLeft-pRight;},'padding-box-height':function(element){var height=this.get('height'),pTop=this.get('padding-top'),pBottom=this.get('padding-bottom');return height+pTop+pBottom;},'padding-box-width':function(element){var width=this.get('width'),pLeft=this.get('padding-left'),pRight=this.get('padding-right');return width+pLeft+pRight;},'border-box-height':function(element){if(!this._preComputing)this._begin();var height=element.offsetHeight;if(!this._preComputing)this._end();return height;},'border-box-width':function(element){if(!this._preComputing)this._begin();var width=element.offsetWidth;if(!this._preComputing)this._end();return width;},'margin-box-height':function(element){var bHeight=this.get('border-box-height'),mTop=this.get('margin-top'),mBottom=this.get('margin-bottom');if(bHeight<=0)return 0;return bHeight+mTop+mBottom;},'margin-box-width':function(element){var bWidth=this.get('border-box-width'),mLeft=this.get('margin-left'),mRight=this.get('margin-right');if(bWidth<=0)return 0;return bWidth+mLeft+mRight;},'top':function(element){var offset=element.positionedOffset();return offset.top;},'bottom':function(element){var offset=element.positionedOffset(),parent=element.getOffsetParent(),pHeight=parent.measure('height');var mHeight=this.get('border-box-height');return pHeight-mHeight-offset.top;},'left':function(element){var offset=element.positionedOffset();return offset.left;},'right':function(element){var offset=element.positionedOffset(),parent=element.getOffsetParent(),pWidth=parent.measure('width');var mWidth=this.get('border-box-width');return pWidth-mWidth-offset.left;},'padding-top':function(element){return getPixelValue(element,'paddingTop');},'padding-bottom':function(element){return getPixelValue(element,'paddingBottom');},'padding-left':function(element){return getPixelValue(element,'paddingLeft');},'padding-right':function(element){return getPixelValue(element,'paddingRight');},'border-top':function(element){return getPixelValue(element,'borderTopWidth');},'border-bottom':function(element){return getPixelValue(element,'borderBottomWidth');},'border-left':function(element){return getPixelValue(element,'borderLeftWidth');},'border-right':function(element){return getPixelValue(element,'borderRightWidth');},'margin-top':function(element){return getPixelValue(element,'marginTop');},'margin-bottom':function(element){return getPixelValue(element,'marginBottom');},'margin-left':function(element){return getPixelValue(element,'marginLeft');},'margin-right':function(element){return getPixelValue(element,'marginRight');}}});if('getBoundingClientRect'in document.documentElement){Object.extend(Element.Layout.COMPUTATIONS,{'right':function(element){var parent=hasLayout(element.getOffsetParent());var rect=element.getBoundingClientRect(),pRect=parent.getBoundingClientRect();return(pRect.right-rect.right).round();},'bottom':function(element){var parent=hasLayout(element.getOffsetParent());var rect=element.getBoundingClientRect(),pRect=parent.getBoundingClientRect();return(pRect.bottom-rect.bottom).round();}});}
Element.Offset=Class.create({initialize:function(left,top){this.left=left.round();this.top=top.round();this[0]=this.left;this[1]=this.top;},relativeTo:function(offset){return new Element.Offset(this.left-offset.left,this.top-offset.top);},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this);},toString:function(){return"[#{left}, #{top}]".interpolate(this);},toArray:function(){return[this.left,this.top];}});function getLayout(element,preCompute){return new Element.Layout(element,preCompute);}
function measure(element,property){return $(element).getLayout().get(property);}
function getDimensions(element){element=$(element);var display=Element.getStyle(element,'display');if(display&&display!=='none'){return{width:element.offsetWidth,height:element.offsetHeight};}
var style=element.style;var originalStyles={visibility:style.visibility,position:style.position,display:style.display};var newStyles={visibility:'hidden',display:'block'};if(originalStyles.position!=='fixed')
newStyles.position='absolute';Element.setStyle(element,newStyles);var dimensions={width:element.offsetWidth,height:element.offsetHeight};Element.setStyle(element,originalStyles);return dimensions;}
function getOffsetParent(element){element=$(element);if(isDocument(element)||isDetached(element)||isBody(element)||isHtml(element))
return $(document.body);var isInline=(Element.getStyle(element,'display')==='inline');if(!isInline&&element.offsetParent)return $(element.offsetParent);while((element=element.parentNode)&&element!==document.body){if(Element.getStyle(element,'position')!=='static'){return isHtml(element)?$(document.body):$(element);}}
return $(document.body);}
function cumulativeOffset(element){element=$(element);var valueT=0,valueL=0;if(element.parentNode){do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;element=element.offsetParent;}while(element);}
return new Element.Offset(valueL,valueT);}
function positionedOffset(element){element=$(element);var layout=element.getLayout();var valueT=0,valueL=0;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;element=element.offsetParent;if(element){if(isBody(element))break;var p=Element.getStyle(element,'position');if(p!=='static')break;}}while(element);valueL-=layout.get('margin-top');valueT-=layout.get('margin-left');return new Element.Offset(valueL,valueT);}
function cumulativeScrollOffset(element){var valueT=0,valueL=0;do{valueT+=element.scrollTop||0;valueL+=element.scrollLeft||0;element=element.parentNode;}while(element);return new Element.Offset(valueL,valueT);}
function viewportOffset(forElement){element=$(element);var valueT=0,valueL=0,docBody=document.body;var element=forElement;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;if(element.offsetParent==docBody&&Element.getStyle(element,'position')=='absolute')break;}while(element=element.offsetParent);element=forElement;do{if(element!=docBody){valueT-=element.scrollTop||0;valueL-=element.scrollLeft||0;}}while(element=element.parentNode);return new Element.Offset(valueL,valueT);}
function absolutize(element){element=$(element);if(Element.getStyle(element,'position')==='absolute'){return element;}
var offsetParent=getOffsetParent(element);var eOffset=element.viewportOffset(),pOffset=offsetParent.viewportOffset();var offset=eOffset.relativeTo(pOffset);var layout=element.getLayout();element.store('prototype_absolutize_original_styles',{left:element.getStyle('left'),top:element.getStyle('top'),width:element.getStyle('width'),height:element.getStyle('height')});element.setStyle({position:'absolute',top:offset.top+'px',left:offset.left+'px',width:layout.get('width')+'px',height:layout.get('height')+'px'});return element;}
function relativize(element){element=$(element);if(Element.getStyle(element,'position')==='relative'){return element;}
var originalStyles=element.retrieve('prototype_absolutize_original_styles');if(originalStyles)element.setStyle(originalStyles);return element;}
if(Prototype.Browser.IE){getOffsetParent=getOffsetParent.wrap(function(proceed,element){element=$(element);if(isDocument(element)||isDetached(element)||isBody(element)||isHtml(element))
return $(document.body);var position=element.getStyle('position');if(position!=='static')return proceed(element);element.setStyle({position:'relative'});var value=proceed(element);element.setStyle({position:position});return value;});positionedOffset=positionedOffset.wrap(function(proceed,element){element=$(element);if(!element.parentNode)return new Element.Offset(0,0);var position=element.getStyle('position');if(position!=='static')return proceed(element);var offsetParent=element.getOffsetParent();if(offsetParent&&offsetParent.getStyle('position')==='fixed')
hasLayout(offsetParent);element.setStyle({position:'relative'});var value=proceed(element);element.setStyle({position:position});return value;});}else if(Prototype.Browser.Webkit){cumulativeOffset=function(element){element=$(element);var valueT=0,valueL=0;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;if(element.offsetParent==document.body)
if(Element.getStyle(element,'position')=='absolute')break;element=element.offsetParent;}while(element);return new Element.Offset(valueL,valueT);};}
Element.addMethods({getLayout:getLayout,measure:measure,getDimensions:getDimensions,getOffsetParent:getOffsetParent,cumulativeOffset:cumulativeOffset,positionedOffset:positionedOffset,cumulativeScrollOffset:cumulativeScrollOffset,viewportOffset:viewportOffset,absolutize:absolutize,relativize:relativize});function isBody(element){return element.nodeName.toUpperCase()==='BODY';}
function isHtml(element){return element.nodeName.toUpperCase()==='HTML';}
function isDocument(element){return element.nodeType===Node.DOCUMENT_NODE;}
function isDetached(element){return element!==document.body&&!Element.descendantOf(element,document.body);}
if('getBoundingClientRect'in document.documentElement){Element.addMethods({viewportOffset:function(element){element=$(element);if(isDetached(element))return new Element.Offset(0,0);var rect=element.getBoundingClientRect(),docEl=document.documentElement;return new Element.Offset(rect.left-docEl.clientLeft,rect.top-docEl.clientTop);}});}})();window.$$=function(){var expression=$A(arguments).join(', ');return Prototype.Selector.select(expression,document);};Prototype.Selector=(function(){function select(){throw new Error('Method "Prototype.Selector.select" must be defined.');}
function match(){throw new Error('Method "Prototype.Selector.match" must be defined.');}
function find(elements,expression,index){index=index||0;var match=Prototype.Selector.match,length=elements.length,matchIndex=0,i;for(i=0;i<length;i++){if(match(elements[i],expression)&&index==matchIndex++){return Element.extend(elements[i]);}}}
function extendElements(elements){for(var i=0,length=elements.length;i<length;i++){Element.extend(elements[i]);}
return elements;}
var K=Prototype.K;return{select:select,match:match,find:find,extendElements:(Element.extend===K)?K:extendElements,extendElement:Element.extend};})();Prototype._original_property=window.Sizzle;/*
 * Sizzle CSS Selector Engine - v1.0
 *  Copyright 2009, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
(function(){var chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,done=0,toString=Object.prototype.toString,hasDuplicate=false,baseHasDuplicate=true;[0,0].sort(function(){baseHasDuplicate=false;return 0;});var Sizzle=function(selector,context,results,seed){results=results||[];var origContext=context=context||document;if(context.nodeType!==1&&context.nodeType!==9){return[];}
if(!selector||typeof selector!=="string"){return results;}
var parts=[],m,set,checkSet,check,mode,extra,prune=true,contextXML=isXML(context),soFar=selector;while((chunker.exec(""),m=chunker.exec(soFar))!==null){soFar=m[3];parts.push(m[1]);if(m[2]){extra=m[3];break;}}
if(parts.length>1&&origPOS.exec(selector)){if(parts.length===2&&Expr.relative[parts[0]]){set=posProcess(parts[0]+parts[1],context);}else{set=Expr.relative[parts[0]]?[context]:Sizzle(parts.shift(),context);while(parts.length){selector=parts.shift();if(Expr.relative[selector])
selector+=parts.shift();set=posProcess(selector,set);}}}else{if(!seed&&parts.length>1&&context.nodeType===9&&!contextXML&&Expr.match.ID.test(parts[0])&&!Expr.match.ID.test(parts[parts.length-1])){var ret=Sizzle.find(parts.shift(),context,contextXML);context=ret.expr?Sizzle.filter(ret.expr,ret.set)[0]:ret.set[0];}
if(context){var ret=seed?{expr:parts.pop(),set:makeArray(seed)}:Sizzle.find(parts.pop(),parts.length===1&&(parts[0]==="~"||parts[0]==="+")&&context.parentNode?context.parentNode:context,contextXML);set=ret.expr?Sizzle.filter(ret.expr,ret.set):ret.set;if(parts.length>0){checkSet=makeArray(set);}else{prune=false;}
while(parts.length){var cur=parts.pop(),pop=cur;if(!Expr.relative[cur]){cur="";}else{pop=parts.pop();}
if(pop==null){pop=context;}
Expr.relative[cur](checkSet,pop,contextXML);}}else{checkSet=parts=[];}}
if(!checkSet){checkSet=set;}
if(!checkSet){throw"Syntax error, unrecognized expression: "+(cur||selector);}
if(toString.call(checkSet)==="[object Array]"){if(!prune){results.push.apply(results,checkSet);}else if(context&&context.nodeType===1){for(var i=0;checkSet[i]!=null;i++){if(checkSet[i]&&(checkSet[i]===true||checkSet[i].nodeType===1&&contains(context,checkSet[i]))){results.push(set[i]);}}}else{for(var i=0;checkSet[i]!=null;i++){if(checkSet[i]&&checkSet[i].nodeType===1){results.push(set[i]);}}}}else{makeArray(checkSet,results);}
if(extra){Sizzle(extra,origContext,results,seed);Sizzle.uniqueSort(results);}
return results;};Sizzle.uniqueSort=function(results){if(sortOrder){hasDuplicate=baseHasDuplicate;results.sort(sortOrder);if(hasDuplicate){for(var i=1;i<results.length;i++){if(results[i]===results[i-1]){results.splice(i--,1);}}}}
return results;};Sizzle.matches=function(expr,set){return Sizzle(expr,null,null,set);};Sizzle.find=function(expr,context,isXML){var set,match;if(!expr){return[];}
for(var i=0,l=Expr.order.length;i<l;i++){var type=Expr.order[i],match;if((match=Expr.leftMatch[type].exec(expr))){var left=match[1];match.splice(1,1);if(left.substr(left.length-1)!=="\\"){match[1]=(match[1]||"").replace(/\\/g,"");set=Expr.find[type](match,context,isXML);if(set!=null){expr=expr.replace(Expr.match[type],"");break;}}}}
if(!set){set=context.getElementsByTagName("*");}
return{set:set,expr:expr};};Sizzle.filter=function(expr,set,inplace,not){var old=expr,result=[],curLoop=set,match,anyFound,isXMLFilter=set&&set[0]&&isXML(set[0]);while(expr&&set.length){for(var type in Expr.filter){if((match=Expr.match[type].exec(expr))!=null){var filter=Expr.filter[type],found,item;anyFound=false;if(curLoop==result){result=[];}
if(Expr.preFilter[type]){match=Expr.preFilter[type](match,curLoop,inplace,result,not,isXMLFilter);if(!match){anyFound=found=true;}else if(match===true){continue;}}
if(match){for(var i=0;(item=curLoop[i])!=null;i++){if(item){found=filter(item,match,i,curLoop);var pass=not^!!found;if(inplace&&found!=null){if(pass){anyFound=true;}else{curLoop[i]=false;}}else if(pass){result.push(item);anyFound=true;}}}}
if(found!==undefined){if(!inplace){curLoop=result;}
expr=expr.replace(Expr.match[type],"");if(!anyFound){return[];}
break;}}}
if(expr==old){if(anyFound==null){throw"Syntax error, unrecognized expression: "+expr;}else{break;}}
old=expr;}
return curLoop;};var Expr=Sizzle.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(elem){return elem.getAttribute("href");}},relative:{"+":function(checkSet,part,isXML){var isPartStr=typeof part==="string",isTag=isPartStr&&!/\W/.test(part),isPartStrNotTag=isPartStr&&!isTag;if(isTag&&!isXML){part=part.toUpperCase();}
for(var i=0,l=checkSet.length,elem;i<l;i++){if((elem=checkSet[i])){while((elem=elem.previousSibling)&&elem.nodeType!==1){}
checkSet[i]=isPartStrNotTag||elem&&elem.nodeName===part?elem||false:elem===part;}}
if(isPartStrNotTag){Sizzle.filter(part,checkSet,true);}},">":function(checkSet,part,isXML){var isPartStr=typeof part==="string";if(isPartStr&&!/\W/.test(part)){part=isXML?part:part.toUpperCase();for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var parent=elem.parentNode;checkSet[i]=parent.nodeName===part?parent:false;}}}else{for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){checkSet[i]=isPartStr?elem.parentNode:elem.parentNode===part;}}
if(isPartStr){Sizzle.filter(part,checkSet,true);}}},"":function(checkSet,part,isXML){var doneName=done++,checkFn=dirCheck;if(!/\W/.test(part)){var nodeCheck=part=isXML?part:part.toUpperCase();checkFn=dirNodeCheck;}
checkFn("parentNode",part,doneName,checkSet,nodeCheck,isXML);},"~":function(checkSet,part,isXML){var doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!/\W/.test(part)){var nodeCheck=part=isXML?part:part.toUpperCase();checkFn=dirNodeCheck;}
checkFn("previousSibling",part,doneName,checkSet,nodeCheck,isXML);}},find:{ID:function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?[m]:[];}},NAME:function(match,context,isXML){if(typeof context.getElementsByName!=="undefined"){var ret=[],results=context.getElementsByName(match[1]);for(var i=0,l=results.length;i<l;i++){if(results[i].getAttribute("name")===match[1]){ret.push(results[i]);}}
return ret.length===0?null:ret;}},TAG:function(match,context){return context.getElementsByTagName(match[1]);}},preFilter:{CLASS:function(match,curLoop,inplace,result,not,isXML){match=" "+match[1].replace(/\\/g,"")+" ";if(isXML){return match;}
for(var i=0,elem;(elem=curLoop[i])!=null;i++){if(elem){if(not^(elem.className&&(" "+elem.className+" ").indexOf(match)>=0)){if(!inplace)
result.push(elem);}else if(inplace){curLoop[i]=false;}}}
return false;},ID:function(match){return match[1].replace(/\\/g,"");},TAG:function(match,curLoop){for(var i=0;curLoop[i]===false;i++){}
return curLoop[i]&&isXML(curLoop[i])?match[1]:match[1].toUpperCase();},CHILD:function(match){if(match[1]=="nth"){var test=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(match[2]=="even"&&"2n"||match[2]=="odd"&&"2n+1"||!/\D/.test(match[2])&&"0n+"+match[2]||match[2]);match[2]=(test[1]+(test[2]||1))-0;match[3]=test[3]-0;}
match[0]=done++;return match;},ATTR:function(match,curLoop,inplace,result,not,isXML){var name=match[1].replace(/\\/g,"");if(!isXML&&Expr.attrMap[name]){match[1]=Expr.attrMap[name];}
if(match[2]==="~="){match[4]=" "+match[4]+" ";}
return match;},PSEUDO:function(match,curLoop,inplace,result,not){if(match[1]==="not"){if((chunker.exec(match[3])||"").length>1||/^\w/.test(match[3])){match[3]=Sizzle(match[3],null,null,curLoop);}else{var ret=Sizzle.filter(match[3],curLoop,inplace,true^not);if(!inplace){result.push.apply(result,ret);}
return false;}}else if(Expr.match.POS.test(match[0])||Expr.match.CHILD.test(match[0])){return true;}
return match;},POS:function(match){match.unshift(true);return match;}},filters:{enabled:function(elem){return elem.disabled===false&&elem.type!=="hidden";},disabled:function(elem){return elem.disabled===true;},checked:function(elem){return elem.checked===true;},selected:function(elem){elem.parentNode.selectedIndex;return elem.selected===true;},parent:function(elem){return!!elem.firstChild;},empty:function(elem){return!elem.firstChild;},has:function(elem,i,match){return!!Sizzle(match[3],elem).length;},header:function(elem){return/h\d/i.test(elem.nodeName);},text:function(elem){return"text"===elem.type;},radio:function(elem){return"radio"===elem.type;},checkbox:function(elem){return"checkbox"===elem.type;},file:function(elem){return"file"===elem.type;},password:function(elem){return"password"===elem.type;},submit:function(elem){return"submit"===elem.type;},image:function(elem){return"image"===elem.type;},reset:function(elem){return"reset"===elem.type;},button:function(elem){return"button"===elem.type||elem.nodeName.toUpperCase()==="BUTTON";},input:function(elem){return/input|select|textarea|button/i.test(elem.nodeName);}},setFilters:{first:function(elem,i){return i===0;},last:function(elem,i,match,array){return i===array.length-1;},even:function(elem,i){return i%2===0;},odd:function(elem,i){return i%2===1;},lt:function(elem,i,match){return i<match[3]-0;},gt:function(elem,i,match){return i>match[3]-0;},nth:function(elem,i,match){return match[3]-0==i;},eq:function(elem,i,match){return match[3]-0==i;}},filter:{PSEUDO:function(elem,match,i,array){var name=match[1],filter=Expr.filters[name];if(filter){return filter(elem,i,match,array);}else if(name==="contains"){return(elem.textContent||elem.innerText||"").indexOf(match[3])>=0;}else if(name==="not"){var not=match[3];for(var i=0,l=not.length;i<l;i++){if(not[i]===elem){return false;}}
return true;}},CHILD:function(elem,match){var type=match[1],node=elem;switch(type){case'only':case'first':while((node=node.previousSibling)){if(node.nodeType===1)return false;}
if(type=='first')return true;node=elem;case'last':while((node=node.nextSibling)){if(node.nodeType===1)return false;}
return true;case'nth':var first=match[2],last=match[3];if(first==1&&last==0){return true;}
var doneName=match[0],parent=elem.parentNode;if(parent&&(parent.sizcache!==doneName||!elem.nodeIndex)){var count=0;for(node=parent.firstChild;node;node=node.nextSibling){if(node.nodeType===1){node.nodeIndex=++count;}}
parent.sizcache=doneName;}
var diff=elem.nodeIndex-last;if(first==0){return diff==0;}else{return(diff%first==0&&diff/first>=0);}}},ID:function(elem,match){return elem.nodeType===1&&elem.getAttribute("id")===match;},TAG:function(elem,match){return(match==="*"&&elem.nodeType===1)||elem.nodeName===match;},CLASS:function(elem,match){return(" "+(elem.className||elem.getAttribute("class"))+" ").indexOf(match)>-1;},ATTR:function(elem,match){var name=match[1],result=Expr.attrHandle[name]?Expr.attrHandle[name](elem):elem[name]!=null?elem[name]:elem.getAttribute(name),value=result+"",type=match[2],check=match[4];return result==null?type==="!=":type==="="?value===check:type==="*="?value.indexOf(check)>=0:type==="~="?(" "+value+" ").indexOf(check)>=0:!check?value&&result!==false:type==="!="?value!=check:type==="^="?value.indexOf(check)===0:type==="$="?value.substr(value.length-check.length)===check:type==="|="?value===check||value.substr(0,check.length+1)===check+"-":false;},POS:function(elem,match,i,array){var name=match[2],filter=Expr.setFilters[name];if(filter){return filter(elem,i,match,array);}}}};var origPOS=Expr.match.POS;for(var type in Expr.match){Expr.match[type]=new RegExp(Expr.match[type].source+/(?![^\[]*\])(?![^\(]*\))/.source);Expr.leftMatch[type]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Expr.match[type].source);}
var makeArray=function(array,results){array=Array.prototype.slice.call(array,0);if(results){results.push.apply(results,array);return results;}
return array;};try{Array.prototype.slice.call(document.documentElement.childNodes,0);}catch(e){makeArray=function(array,results){var ret=results||[];if(toString.call(array)==="[object Array]"){Array.prototype.push.apply(ret,array);}else{if(typeof array.length==="number"){for(var i=0,l=array.length;i<l;i++){ret.push(array[i]);}}else{for(var i=0;array[i];i++){ret.push(array[i]);}}}
return ret;};}
var sortOrder;if(document.documentElement.compareDocumentPosition){sortOrder=function(a,b){if(!a.compareDocumentPosition||!b.compareDocumentPosition){if(a==b){hasDuplicate=true;}
return 0;}
var ret=a.compareDocumentPosition(b)&4?-1:a===b?0:1;if(ret===0){hasDuplicate=true;}
return ret;};}else if("sourceIndex"in document.documentElement){sortOrder=function(a,b){if(!a.sourceIndex||!b.sourceIndex){if(a==b){hasDuplicate=true;}
return 0;}
var ret=a.sourceIndex-b.sourceIndex;if(ret===0){hasDuplicate=true;}
return ret;};}else if(document.createRange){sortOrder=function(a,b){if(!a.ownerDocument||!b.ownerDocument){if(a==b){hasDuplicate=true;}
return 0;}
var aRange=a.ownerDocument.createRange(),bRange=b.ownerDocument.createRange();aRange.setStart(a,0);aRange.setEnd(a,0);bRange.setStart(b,0);bRange.setEnd(b,0);var ret=aRange.compareBoundaryPoints(Range.START_TO_END,bRange);if(ret===0){hasDuplicate=true;}
return ret;};}
(function(){var form=document.createElement("div"),id="script"+(new Date).getTime();form.innerHTML="<a name='"+id+"'/>";var root=document.documentElement;root.insertBefore(form,root.firstChild);if(!!document.getElementById(id)){Expr.find.ID=function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?m.id===match[1]||typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id").nodeValue===match[1]?[m]:undefined:[];}};Expr.filter.ID=function(elem,match){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return elem.nodeType===1&&node&&node.nodeValue===match;};}
root.removeChild(form);root=form=null;})();(function(){var div=document.createElement("div");div.appendChild(document.createComment(""));if(div.getElementsByTagName("*").length>0){Expr.find.TAG=function(match,context){var results=context.getElementsByTagName(match[1]);if(match[1]==="*"){var tmp=[];for(var i=0;results[i];i++){if(results[i].nodeType===1){tmp.push(results[i]);}}
results=tmp;}
return results;};}
div.innerHTML="<a href='#'></a>";if(div.firstChild&&typeof div.firstChild.getAttribute!=="undefined"&&div.firstChild.getAttribute("href")!=="#"){Expr.attrHandle.href=function(elem){return elem.getAttribute("href",2);};}
div=null;})();if(document.querySelectorAll)(function(){var oldSizzle=Sizzle,div=document.createElement("div");div.innerHTML="<p class='TEST'></p>";if(div.querySelectorAll&&div.querySelectorAll(".TEST").length===0){return;}
Sizzle=function(query,context,extra,seed){context=context||document;if(!seed&&context.nodeType===9&&!isXML(context)){try{return makeArray(context.querySelectorAll(query),extra);}catch(e){}}
return oldSizzle(query,context,extra,seed);};for(var prop in oldSizzle){Sizzle[prop]=oldSizzle[prop];}
div=null;})();if(document.getElementsByClassName&&document.documentElement.getElementsByClassName)(function(){var div=document.createElement("div");div.innerHTML="<div class='test e'></div><div class='test'></div>";if(div.getElementsByClassName("e").length===0)
return;div.lastChild.className="e";if(div.getElementsByClassName("e").length===1)
return;Expr.order.splice(1,0,"CLASS");Expr.find.CLASS=function(match,context,isXML){if(typeof context.getElementsByClassName!=="undefined"&&!isXML){return context.getElementsByClassName(match[1]);}};div=null;})();function dirNodeCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){var sibDir=dir=="previousSibling"&&!isXML;for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){if(sibDir&&elem.nodeType===1){elem.sizcache=doneName;elem.sizset=i;}
elem=elem[dir];var match=false;while(elem){if(elem.sizcache===doneName){match=checkSet[elem.sizset];break;}
if(elem.nodeType===1&&!isXML){elem.sizcache=doneName;elem.sizset=i;}
if(elem.nodeName===cur){match=elem;break;}
elem=elem[dir];}
checkSet[i]=match;}}}
function dirCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){var sibDir=dir=="previousSibling"&&!isXML;for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){if(sibDir&&elem.nodeType===1){elem.sizcache=doneName;elem.sizset=i;}
elem=elem[dir];var match=false;while(elem){if(elem.sizcache===doneName){match=checkSet[elem.sizset];break;}
if(elem.nodeType===1){if(!isXML){elem.sizcache=doneName;elem.sizset=i;}
if(typeof cur!=="string"){if(elem===cur){match=true;break;}}else if(Sizzle.filter(cur,[elem]).length>0){match=elem;break;}}
elem=elem[dir];}
checkSet[i]=match;}}}
var contains=document.compareDocumentPosition?function(a,b){return a.compareDocumentPosition(b)&16;}:function(a,b){return a!==b&&(a.contains?a.contains(b):true);};var isXML=function(elem){return elem.nodeType===9&&elem.documentElement.nodeName!=="HTML"||!!elem.ownerDocument&&elem.ownerDocument.documentElement.nodeName!=="HTML";};var posProcess=function(selector,context){var tmpSet=[],later="",match,root=context.nodeType?[context]:context;while((match=Expr.match.PSEUDO.exec(selector))){later+=match[0];selector=selector.replace(Expr.match.PSEUDO,"");}
selector=Expr.relative[selector]?selector+"*":selector;for(var i=0,l=root.length;i<l;i++){Sizzle(selector,root[i],tmpSet);}
return Sizzle.filter(later,tmpSet);};window.Sizzle=Sizzle;})();;(function(engine){var extendElements=Prototype.Selector.extendElements;function select(selector,scope){return extendElements(engine(selector,scope||document));}
function match(element,selector){return engine.matches(selector,[element]).length==1;}
Prototype.Selector.engine=engine;Prototype.Selector.select=select;Prototype.Selector.match=match;})(Sizzle);window.Sizzle=Prototype._original_property;delete Prototype._original_property;var Form={reset:function(form){form=$(form);form.reset();return form;},serializeElements:function(elements,options){if(typeof options!='object')options={hash:!!options};else if(Object.isUndefined(options.hash))options.hash=true;var key,value,submitted=false,submit=options.submit,accumulator,initial;if(options.hash){initial={};accumulator=function(result,key,value){if(key in result){if(!Object.isArray(result[key]))result[key]=[result[key]];result[key].push(value);}else result[key]=value;return result;};}else{initial='';accumulator=function(result,key,value){return result+(result?'&':'')+encodeURIComponent(key)+'='+encodeURIComponent(value);}}
return elements.inject(initial,function(result,element){if(!element.disabled&&element.name){key=element.name;value=$(element).getValue();if(value!=null&&element.type!='file'&&(element.type!='submit'||(!submitted&&submit!==false&&(!submit||key==submit)&&(submitted=true)))){result=accumulator(result,key,value);}}
return result;});}};Form.Methods={serialize:function(form,options){return Form.serializeElements(Form.getElements(form),options);},getElements:function(form){var elements=$(form).getElementsByTagName('*'),element,arr=[],serializers=Form.Element.Serializers;for(var i=0;element=elements[i];i++){arr.push(element);}
return arr.inject([],function(elements,child){if(serializers[child.tagName.toLowerCase()])
elements.push(Element.extend(child));return elements;})},getInputs:function(form,typeName,name){form=$(form);var inputs=form.getElementsByTagName('input');if(!typeName&&!name)return $A(inputs).map(Element.extend);for(var i=0,matchingInputs=[],length=inputs.length;i<length;i++){var input=inputs[i];if((typeName&&input.type!=typeName)||(name&&input.name!=name))
continue;matchingInputs.push(Element.extend(input));}
return matchingInputs;},disable:function(form){form=$(form);Form.getElements(form).invoke('disable');return form;},enable:function(form){form=$(form);Form.getElements(form).invoke('enable');return form;},findFirstElement:function(form){var elements=$(form).getElements().findAll(function(element){return'hidden'!=element.type&&!element.disabled;});var firstByIndex=elements.findAll(function(element){return element.hasAttribute('tabIndex')&&element.tabIndex>=0;}).sortBy(function(element){return element.tabIndex}).first();return firstByIndex?firstByIndex:elements.find(function(element){return/^(?:input|select|textarea)$/i.test(element.tagName);});},focusFirstElement:function(form){form=$(form);var element=form.findFirstElement();if(element)element.activate();return form;},request:function(form,options){form=$(form),options=Object.clone(options||{});var params=options.parameters,action=form.readAttribute('action')||'';if(action.blank())action=window.location.href;options.parameters=form.serialize(true);if(params){if(Object.isString(params))params=params.toQueryParams();Object.extend(options.parameters,params);}
if(form.hasAttribute('method')&&!options.method)
options.method=form.method;return new Ajax.Request(action,options);}};Form.Element={focus:function(element){$(element).focus();return element;},select:function(element){$(element).select();return element;}};Form.Element.Methods={serialize:function(element){element=$(element);if(!element.disabled&&element.name){var value=element.getValue();if(value!=undefined){var pair={};pair[element.name]=value;return Object.toQueryString(pair);}}
return'';},getValue:function(element){element=$(element);var method=element.tagName.toLowerCase();return Form.Element.Serializers[method](element);},setValue:function(element,value){element=$(element);var method=element.tagName.toLowerCase();Form.Element.Serializers[method](element,value);return element;},clear:function(element){$(element).value='';return element;},present:function(element){return $(element).value!='';},activate:function(element){element=$(element);try{element.focus();if(element.select&&(element.tagName.toLowerCase()!='input'||!(/^(?:button|reset|submit)$/i.test(element.type))))
element.select();}catch(e){}
return element;},disable:function(element){element=$(element);element.disabled=true;return element;},enable:function(element){element=$(element);element.disabled=false;return element;}};var Field=Form.Element;var $F=Form.Element.Methods.getValue;Form.Element.Serializers=(function(){function input(element,value){switch(element.type.toLowerCase()){case'checkbox':case'radio':return inputSelector(element,value);default:return valueSelector(element,value);}}
function inputSelector(element,value){if(Object.isUndefined(value))
return element.checked?element.value:null;else element.checked=!!value;}
function valueSelector(element,value){if(Object.isUndefined(value))return element.value;else element.value=value;}
function select(element,value){if(Object.isUndefined(value))
return(element.type==='select-one'?selectOne:selectMany)(element);var opt,currentValue,single=!Object.isArray(value);for(var i=0,length=element.length;i<length;i++){opt=element.options[i];currentValue=this.optionValue(opt);if(single){if(currentValue==value){opt.selected=true;return;}}
else opt.selected=value.include(currentValue);}}
function selectOne(element){var index=element.selectedIndex;return index>=0?optionValue(element.options[index]):null;}
function selectMany(element){var values,length=element.length;if(!length)return null;for(var i=0,values=[];i<length;i++){var opt=element.options[i];if(opt.selected)values.push(optionValue(opt));}
return values;}
function optionValue(opt){return Element.hasAttribute(opt,'value')?opt.value:opt.text;}
return{input:input,inputSelector:inputSelector,textarea:valueSelector,select:select,selectOne:selectOne,selectMany:selectMany,optionValue:optionValue,button:valueSelector};})();Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,element,frequency,callback){$super(callback,frequency);this.element=$(element);this.lastValue=this.getValue();},execute:function(){var value=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(value)?this.lastValue!=value:String(this.lastValue)!=String(value)){this.callback(this.element,value);this.lastValue=value;}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element);}});Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element);}});Abstract.EventObserver=Class.create({initialize:function(element,callback){this.element=$(element);this.callback=callback;this.lastValue=this.getValue();if(this.element.tagName.toLowerCase()=='form')
this.registerFormCallbacks();else
this.registerCallback(this.element);},onElementEvent:function(){var value=this.getValue();if(this.lastValue!=value){this.callback(this.element,value);this.lastValue=value;}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this);},registerCallback:function(element){if(element.type){switch(element.type.toLowerCase()){case'checkbox':case'radio':Event.observe(element,'click',this.onElementEvent.bind(this));break;default:Event.observe(element,'change',this.onElementEvent.bind(this));break;}}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element);}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element);}});(function(){var Event={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{}};var docEl=document.documentElement;var MOUSEENTER_MOUSELEAVE_EVENTS_SUPPORTED='onmouseenter'in docEl&&'onmouseleave'in docEl;var isIELegacyEvent=function(event){return false;};if(window.attachEvent){if(window.addEventListener){isIELegacyEvent=function(event){return!(event instanceof window.Event);};}else{isIELegacyEvent=function(event){return true;};}}
var _isButton;function _isButtonForDOMEvents(event,code){return event.which?(event.which===code+1):(event.button===code);}
var legacyButtonMap={0:1,1:4,2:2};function _isButtonForLegacyEvents(event,code){return event.button===legacyButtonMap[code];}
function _isButtonForWebKit(event,code){switch(code){case 0:return event.which==1&&!event.metaKey;case 1:return event.which==2||(event.which==1&&event.metaKey);case 2:return event.which==3;default:return false;}}
if(window.attachEvent){if(!window.addEventListener){_isButton=_isButtonForLegacyEvents;}else{_isButton=function(event,code){return isIELegacyEvent(event)?_isButtonForLegacyEvents(event,code):_isButtonForDOMEvents(event,code);}}}else if(Prototype.Browser.WebKit){_isButton=_isButtonForWebKit;}else{_isButton=_isButtonForDOMEvents;}
function isLeftClick(event){return _isButton(event,0)}
function isMiddleClick(event){return _isButton(event,1)}
function isRightClick(event){return _isButton(event,2)}
function element(event){event=Event.extend(event);var node=event.target,type=event.type,currentTarget=event.currentTarget;if(currentTarget&&currentTarget.tagName){if(type==='load'||type==='error'||(type==='click'&&currentTarget.tagName.toLowerCase()==='input'&&currentTarget.type==='radio'))
node=currentTarget;}
if(node.nodeType==Node.TEXT_NODE)
node=node.parentNode;return Element.extend(node);}
function findElement(event,expression){var element=Event.element(event);if(!expression)return element;while(element){if(Object.isElement(element)&&Prototype.Selector.match(element,expression)){return Element.extend(element);}
element=element.parentNode;}}
function pointer(event){return{x:pointerX(event),y:pointerY(event)};}
function pointerX(event){var docElement=document.documentElement,body=document.body||{scrollLeft:0};return event.pageX||(event.clientX+
(docElement.scrollLeft||body.scrollLeft)-
(docElement.clientLeft||0));}
function pointerY(event){var docElement=document.documentElement,body=document.body||{scrollTop:0};return event.pageY||(event.clientY+
(docElement.scrollTop||body.scrollTop)-
(docElement.clientTop||0));}
function stop(event){Event.extend(event);event.preventDefault();event.stopPropagation();event.stopped=true;}
Event.Methods={isLeftClick:isLeftClick,isMiddleClick:isMiddleClick,isRightClick:isRightClick,element:element,findElement:findElement,pointer:pointer,pointerX:pointerX,pointerY:pointerY,stop:stop};var methods=Object.keys(Event.Methods).inject({},function(m,name){m[name]=Event.Methods[name].methodize();return m;});if(window.attachEvent){function _relatedTarget(event){var element;switch(event.type){case'mouseover':case'mouseenter':element=event.fromElement;break;case'mouseout':case'mouseleave':element=event.toElement;break;default:return null;}
return Element.extend(element);}
var additionalMethods={stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return'[object Event]'}};Event.extend=function(event,element){if(!event)return false;if(!isIELegacyEvent(event))return event;if(event._extendedByPrototype)return event;event._extendedByPrototype=Prototype.emptyFunction;var pointer=Event.pointer(event);Object.extend(event,{target:event.srcElement||element,relatedTarget:_relatedTarget(event),pageX:pointer.x,pageY:pointer.y});Object.extend(event,methods);Object.extend(event,additionalMethods);return event;};}else{Event.extend=Prototype.K;}
if(window.addEventListener){Event.prototype=window.Event.prototype||document.createEvent('HTMLEvents').__proto__;Object.extend(Event.prototype,methods);}
function _createResponder(element,eventName,handler){var registry=Element.retrieve(element,'prototype_event_registry');if(Object.isUndefined(registry)){CACHE.push(element);registry=Element.retrieve(element,'prototype_event_registry',$H());}
var respondersForEvent=registry.get(eventName);if(Object.isUndefined(respondersForEvent)){respondersForEvent=[];registry.set(eventName,respondersForEvent);}
if(respondersForEvent.pluck('handler').include(handler))return false;var responder;if(eventName.include(":")){responder=function(event){if(Object.isUndefined(event.eventName))
return false;if(event.eventName!==eventName)
return false;Event.extend(event,element);handler.call(element,event);};}else{if(!MOUSEENTER_MOUSELEAVE_EVENTS_SUPPORTED&&(eventName==="mouseenter"||eventName==="mouseleave")){if(eventName==="mouseenter"||eventName==="mouseleave"){responder=function(event){Event.extend(event,element);var parent=event.relatedTarget;while(parent&&parent!==element){try{parent=parent.parentNode;}
catch(e){parent=element;}}
if(parent===element)return;handler.call(element,event);};}}else{responder=function(event){Event.extend(event,element);handler.call(element,event);};}}
responder.handler=handler;respondersForEvent.push(responder);return responder;}
function _destroyCache(){for(var i=0,length=CACHE.length;i<length;i++){Event.stopObserving(CACHE[i]);CACHE[i]=null;}}
var CACHE=[];if(Prototype.Browser.IE)
window.attachEvent('onunload',_destroyCache);if(Prototype.Browser.WebKit)
window.addEventListener('unload',Prototype.emptyFunction,false);var _getDOMEventName=Prototype.K,translations={mouseenter:"mouseover",mouseleave:"mouseout"};if(!MOUSEENTER_MOUSELEAVE_EVENTS_SUPPORTED){_getDOMEventName=function(eventName){return(translations[eventName]||eventName);};}
function observe(element,eventName,handler){element=$(element);var responder=_createResponder(element,eventName,handler);if(!responder)return element;if(eventName.include(':')){if(element.addEventListener)
element.addEventListener("dataavailable",responder,false);else{element.attachEvent("ondataavailable",responder);element.attachEvent("onlosecapture",responder);}}else{var actualEventName=_getDOMEventName(eventName);if(element.addEventListener)
element.addEventListener(actualEventName,responder,false);else
element.attachEvent("on"+actualEventName,responder);}
return element;}
function stopObserving(element,eventName,handler){element=$(element);var registry=Element.retrieve(element,'prototype_event_registry');if(!registry)return element;if(!eventName){registry.each(function(pair){var eventName=pair.key;stopObserving(element,eventName);});return element;}
var responders=registry.get(eventName);if(!responders)return element;if(!handler){responders.each(function(r){stopObserving(element,eventName,r.handler);});return element;}
var i=responders.length,responder;while(i--){if(responders[i].handler===handler){responder=responders[i];break;}}
if(!responder)return element;if(eventName.include(':')){if(element.removeEventListener)
element.removeEventListener("dataavailable",responder,false);else{element.detachEvent("ondataavailable",responder);element.detachEvent("onlosecapture",responder);}}else{var actualEventName=_getDOMEventName(eventName);if(element.removeEventListener)
element.removeEventListener(actualEventName,responder,false);else
element.detachEvent('on'+actualEventName,responder);}
registry.set(eventName,responders.without(responder));return element;}
function fire(element,eventName,memo,bubble){element=$(element);if(Object.isUndefined(bubble))
bubble=true;if(element==document&&document.createEvent&&!element.dispatchEvent)
element=document.documentElement;var event;if(document.createEvent){event=document.createEvent('HTMLEvents');event.initEvent('dataavailable',bubble,true);}else{event=document.createEventObject();event.eventType=bubble?'ondataavailable':'onlosecapture';}
event.eventName=eventName;event.memo=memo||{};if(document.createEvent)
element.dispatchEvent(event);else
element.fireEvent(event.eventType,event);return Event.extend(event);}
Event.Handler=Class.create({initialize:function(element,eventName,selector,callback){this.element=$(element);this.eventName=eventName;this.selector=selector;this.callback=callback;this.handler=this.handleEvent.bind(this);},start:function(){Event.observe(this.element,this.eventName,this.handler);return this;},stop:function(){Event.stopObserving(this.element,this.eventName,this.handler);return this;},handleEvent:function(event){var element=Event.findElement(event,this.selector);if(element)this.callback.call(this.element,event,element);}});function on(element,eventName,selector,callback){element=$(element);if(Object.isFunction(selector)&&Object.isUndefined(callback)){callback=selector,selector=null;}
return new Event.Handler(element,eventName,selector,callback).start();}
Object.extend(Event,Event.Methods);Object.extend(Event,{fire:fire,observe:observe,stopObserving:stopObserving,on:on});Element.addMethods({fire:fire,observe:observe,stopObserving:stopObserving,on:on});Object.extend(document,{fire:fire.methodize(),observe:observe.methodize(),stopObserving:stopObserving.methodize(),on:on.methodize(),loaded:false});if(window.Event)Object.extend(window.Event,Event);else window.Event=Event;})();(function(){var timer;function fireContentLoadedEvent(){if(document.loaded)return;if(timer)window.clearTimeout(timer);document.loaded=true;document.fire('dom:loaded');}
function checkReadyState(){if(document.readyState==='complete'){document.stopObserving('readystatechange',checkReadyState);fireContentLoadedEvent();}}
function pollDoScroll(){try{document.documentElement.doScroll('left');}
catch(e){timer=pollDoScroll.defer();return;}
fireContentLoadedEvent();}
if(document.addEventListener){document.addEventListener('DOMContentLoaded',fireContentLoadedEvent,false);}else{document.observe('readystatechange',checkReadyState);if(window==top)
timer=pollDoScroll.defer();}
Event.observe(window,'load',fireContentLoadedEvent);})();Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;var Insertion={Before:function(element,content){return Element.insert(element,{before:content});},Top:function(element,content){return Element.insert(element,{top:content});},Bottom:function(element,content){return Element.insert(element,{bottom:content});},After:function(element,content){return Element.insert(element,{after:content});}};var $continue=new Error('"throw $continue" is deprecated, use "return" instead');var Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;},within:function(element,x,y){if(this.includeScrollOffsets)
return this.withinIncludingScrolloffsets(element,x,y);this.xcomp=x;this.ycomp=y;this.offset=Element.cumulativeOffset(element);return(y>=this.offset[1]&&y<this.offset[1]+element.offsetHeight&&x>=this.offset[0]&&x<this.offset[0]+element.offsetWidth);},withinIncludingScrolloffsets:function(element,x,y){var offsetcache=Element.cumulativeScrollOffset(element);this.xcomp=x+offsetcache[0]-this.deltaX;this.ycomp=y+offsetcache[1]-this.deltaY;this.offset=Element.cumulativeOffset(element);return(this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+element.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+element.offsetWidth);},overlap:function(mode,element){if(!mode)return 0;if(mode=='vertical')
return((this.offset[1]+element.offsetHeight)-this.ycomp)/element.offsetHeight;if(mode=='horizontal')
return((this.offset[0]+element.offsetWidth)-this.xcomp)/element.offsetWidth;},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(element){Position.prepare();return Element.absolutize(element);},relativize:function(element){Position.prepare();return Element.relativize(element);},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(source,target,options){options=options||{};return Element.clonePosition(target,source,options);}};if(!document.getElementsByClassName)document.getElementsByClassName=function(instanceMethods){function iter(name){return name.blank()?null:"[contains(concat(' ', @class, ' '), ' "+name+" ')]";}
instanceMethods.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(element,className){className=className.toString().strip();var cond=/\s/.test(className)?$w(className).map(iter).join(''):iter(className);return cond?document._getElementsByXPath('.//*'+cond,element):[];}:function(element,className){className=className.toString().strip();var elements=[],classNames=(/\s/.test(className)?$w(className):null);if(!classNames&&!className)return elements;var nodes=$(element).getElementsByTagName('*');className=' '+className+' ';for(var i=0,child,cn;child=nodes[i];i++){if(child.className&&(cn=' '+child.className+' ')&&(cn.include(className)||(classNames&&classNames.all(function(name){return!name.toString().blank()&&cn.include(' '+name+' ');}))))
elements.push(Element.extend(child));}
return elements;};return function(className,parentElement){return $(parentElement||document.body).getElementsByClassName(className);};}(Element.Methods);Element.ClassNames=Class.create();Element.ClassNames.prototype={initialize:function(element){this.element=$(element);},_each:function(iterator){this.element.className.split(/\s+/).select(function(name){return name.length>0;})._each(iterator);},set:function(className){this.element.className=className;},add:function(classNameToAdd){if(this.include(classNameToAdd))return;this.set($A(this).concat(classNameToAdd).join(' '));},remove:function(classNameToRemove){if(!this.include(classNameToRemove))return;this.set($A(this).without(classNameToRemove).join(' '));},toString:function(){return $A(this).join(' ');}};Object.extend(Element.ClassNames.prototype,Enumerable);(function(){window.Selector=Class.create({initialize:function(expression){this.expression=expression.strip();},findElements:function(rootElement){return Prototype.Selector.select(this.expression,rootElement);},match:function(element){return Prototype.Selector.match(element,this.expression);},toString:function(){return this.expression;},inspect:function(){return"#<Selector: "+this.expression+">";}});Object.extend(Selector,{matchElements:function(elements,expression){var match=Prototype.Selector.match,results=[];for(var i=0,length=elements.length;i<length;i++){var element=elements[i];if(match(element,expression)){results.push(Element.extend(element));}}
return results;},findElement:function(elements,expression,index){index=index||0;var matchIndex=0,element;for(var i=0,length=elements.length;i<length;i++){element=elements[i];if(Prototype.Selector.match(element,expression)&&index===matchIndex++){return Element.extend(element);}}},findChildElements:function(element,expressions){var selector=expressions.toArray().join(', ');return Prototype.Selector.select(selector,element||document);}});})();


/* public/javascripts/shared/vendor/lazy_image.js @ 1339185887 */

(function(window,document){var
offset=200,lazyAttr='data-src',winH,imgs=[],pageHasLoaded,getWindowHeightT=throttle(getWindowHeight,20),showImagesT=throttle(showImages,20);window['lzld']=onFakeImgLoad;window['force_lzld']=loadImg;getWindowHeight();addEvent(window,'resize',getWindowHeightT);addEvent(window,'scroll',showImagesT);addEvent(document,'DOMContentLoaded',onDomReady);addEvent(window,'load',onLoad);function onFakeImgLoad(img){img.onload=null;showIfVisible(img,imgs.push(img)-1);}
function onDomReady(){showImagesT();setTimeout(showImagesT,20);}
function onLoad(){pageHasLoaded=true;showImagesT();setTimeout(showImagesT,20);}
function throttle(fn,minDelay){var lastCall=0;return function(){var now=+new Date;if(now-lastCall<minDelay){return;}
lastCall=now;fn.apply(this,arguments);}}
function addEvent(el,type,fn){if(el.attachEvent){el.attachEvent&&el.attachEvent('on'+type,fn);}else{el.addEventListener(type,fn,false);}}
function removeEvent(el,type,fn){if(el.detachEvent){el.detachEvent&&el.detachEvent('on'+type,fn);}else{el.removeEventListener(type,fn,false);}}
function loadImg(img,index){if(!img.getAttribute(lazyAttr))return;if(!index)index=imgs.indexOf(img);img.src=img.getAttribute(lazyAttr);img.removeAttribute(lazyAttr);if(!index)return;imgs[index]=null;}
function showIfVisible(img,index){var invis=img.getBoundingClientRect().top==0&&img.getBoundingClientRect().bottom==0
if(!invis&&img.getBoundingClientRect().top<winH+offset){loadImg(img,index);return true;}else{return false;}}
function getWindowHeight(){winH=window.innerHeight||(document.documentElement&&document.documentElement.clientHeight)||(document.body&&document.body.clientHeight)||10000;}
function showImages(){var
last=imgs.length,current,allImagesDone=true;for(current=0;current<last;current++){var img=imgs[current];if(img!==null&&!showIfVisible(img,current)){allImagesDone=false;}}
if(allImagesDone&&pageHasLoaded){}}
function unsubscribe(){}})(this,document);


/* public/javascripts/shared/alerts.js @ 1339185887 */

if(!window.Scribd)var Scribd=new Object();Scribd.alertsManager=Class.create({initialize:function(){},error:function(el,message,options){var options=Object.extend({auto_fade:false},options||{});this.render('error',el,message,options);},progress:function(el,message,options){var options=Object.extend({auto_fade:false},options||{});this.render('progress',el,message,options);},success:function(el,message,options){this.render('success',el,message,options);},success_blue:function(el,message,options){this.render('success_blue',el,message,options);},success_red:function(el,message,options){this.render('success_red',el,message,options);},render:function(type,el,message,options){var options=Object.extend({auto_fade:true,element_to_fade:null,delay:7,duration:1.0},options||{});var el=$(el);el.show();el.update(this[type+'_template'].evaluate({message:message}));var element_to_fade=options.element_to_fade?$(options.element_to_fade):el;if(options.auto_fade){(function(){element_to_fade.fade({duration:options.duration});}).delay(options.delay);}},error_template:new Template("<div class=\"autogen_class_views_shared_alerts_error autogen_class_views_shared_alerts_base error_alert\"><div class=\"inner\">#{message}</div></div>"),success_template:new Template("<div class=\"autogen_class_views_shared_alerts_success autogen_class_views_shared_alerts_base\"><div class=\"inner\">#{message}</div></div>"),success_blue_template:new Template("<div class=\"autogen_class_views_shared_alerts_success_blue autogen_class_views_shared_alerts_base\"><div class=\"inner\">#{message}</div></div>"),success_red_template:new Template("<div class=\"autogen_class_views_shared_alerts_success_red autogen_class_views_shared_alerts_base\"><div class=\"inner\">#{message}</div></div>"),progress_template:new Template("<div class=\"autogen_class_views_shared_alerts_progress autogen_class_views_shared_alerts_base\"><div class=\"inner\"><img src=\"/images/shared/alerts/spinner.gif\" />#{message}</div></div>")});Scribd.Alerts=new Scribd.alertsManager();


/* public/javascripts/effects.js @ 1339185887 */

var Scriptaculous={Version:'1.8.3'}
String.prototype.parseColor=function(){var color='#';if(this.slice(0,4)=='rgb('){var cols=this.slice(4,this.length-1).split(',');var i=0;do{color+=parseInt(cols[i]).toColorPart()}while(++i<3);}else{if(this.slice(0,1)=='#'){if(this.length==4)for(var i=1;i<4;i++)color+=(this.charAt(i)+this.charAt(i)).toLowerCase();if(this.length==7)color=this.toLowerCase();}}
return(color.length==7?color:(arguments[0]||this));};Element.collectTextNodes=function(element){return $A($(element).childNodes).collect(function(node){return(node.nodeType==3?node.nodeValue:(node.hasChildNodes()?Element.collectTextNodes(node):''));}).flatten().join('');};Element.collectTextNodesIgnoreClass=function(element,className){return $A($(element).childNodes).collect(function(node){return(node.nodeType==3?node.nodeValue:((node.hasChildNodes()&&!Element.hasClassName(node,className))?Element.collectTextNodesIgnoreClass(node,className):''));}).flatten().join('');};Element.setContentZoom=function(element,percent){element=$(element);element.setStyle({fontSize:(percent/100)+'em'});if(Prototype.Browser.WebKit)window.scrollBy(0,0);return element;};Element.getInlineOpacity=function(element){return $(element).style.opacity||'';};Element.forceRerendering=function(element){try{element=$(element);var n=document.createTextNode(' ');element.appendChild(n);element.removeChild(n);}catch(e){}};var Effect={_elementDoesNotExistError:{name:'ElementDoesNotExistError',message:'The specified DOM element does not exist, but is required for this effect to operate'},Transitions:{linear:Prototype.K,sinoidal:function(pos){return(-Math.cos(pos*Math.PI)/2)+.5;},reverse:function(pos){return 1-pos;},flicker:function(pos){var pos=((-Math.cos(pos*Math.PI)/4)+.75)+Math.random()/4;return pos>1?1:pos;},wobble:function(pos){return(-Math.cos(pos*Math.PI*(9*pos))/2)+.5;},pulse:function(pos,pulses){return(-Math.cos((pos*((pulses||5)-.5)*2)*Math.PI)/2)+.5;},spring:function(pos){return 1-(Math.cos(pos*4.5*Math.PI)*Math.exp(-pos*6));},none:function(pos){return 0;},full:function(pos){return 1;}},DefaultOptions:{duration:1.0,fps:100,sync:false,from:0.0,to:1.0,delay:0.0,queue:'parallel'},tagifyText:function(element){var tagifyStyle='position:relative';if(Prototype.Browser.IE)tagifyStyle+=';zoom:1';element=$(element);$A(element.childNodes).each(function(child){if(child.nodeType==3){child.nodeValue.toArray().each(function(character){element.insertBefore(new Element('span',{style:tagifyStyle}).update(character==' '?String.fromCharCode(160):character),child);});Element.remove(child);}});},multiple:function(element,effect){var elements;if(((typeof element=='object')||Object.isFunction(element))&&(element.length))
elements=element;else
elements=$(element).childNodes;var options=Object.extend({speed:0.1,delay:0.0},arguments[2]||{});var masterDelay=options.delay;$A(elements).each(function(element,index){new effect(element,Object.extend(options,{delay:index*options.speed+masterDelay}));});},PAIRS:{'slide':['SlideDown','SlideUp'],'blind':['BlindDown','BlindUp'],'appear':['Appear','Fade']},toggle:function(element,effect){element=$(element);effect=(effect||'appear').toLowerCase();var options=Object.extend({queue:{position:'end',scope:(element.id||'global'),limit:1}},arguments[2]||{});Effect[element.visible()?Effect.PAIRS[effect][1]:Effect.PAIRS[effect][0]](element,options);}};Effect.DefaultOptions.transition=Effect.Transitions.sinoidal;Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[];this.interval=null;},_each:function(iterator){this.effects._each(iterator);},add:function(effect){var timestamp=new Date().getTime();var position=Object.isString(effect.options.queue)?effect.options.queue:effect.options.queue.position;switch(position){case'front':this.effects.findAll(function(e){return e.state=='idle'}).each(function(e){e.startOn+=effect.finishOn;e.finishOn+=effect.finishOn;});break;case'with-last':timestamp=this.effects.pluck('startOn').max()||timestamp;break;case'end':timestamp=this.effects.pluck('finishOn').max()||timestamp;break;}
effect.startOn+=timestamp;effect.finishOn+=timestamp;if(!effect.options.queue.limit||(this.effects.length<effect.options.queue.limit))
this.effects.push(effect);if(!this.interval)
this.interval=setInterval(this.loop.bind(this),15);},remove:function(effect){this.effects=this.effects.reject(function(e){return e==effect});if(this.effects.length==0){clearInterval(this.interval);this.interval=null;}},loop:function(){var timePos=new Date().getTime();for(var i=0,len=this.effects.length;i<len;i++)
try{this.effects[i]&&this.effects[i].loop(timePos);}catch(e){}}});Effect.Queues={instances:$H(),get:function(queueName){if(!Object.isString(queueName))return queueName;return this.instances.get(queueName)||this.instances.set(queueName,new Effect.ScopedQueue());}};Effect.Queue=Effect.Queues.get('global');Effect.Base=Class.create({position:null,start:function(options){function codeForEvent(options,eventName){return((options[eventName+'Internal']?'this.options.'+eventName+'Internal(this);':'')+
(options[eventName]?'this.options.'+eventName+'(this);':''));}
if(options&&options.transition===false)options.transition=Effect.Transitions.linear;this.options=Object.extend(Object.extend({},Effect.DefaultOptions),options||{});this.currentFrame=0;this.state='idle';this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;this.render=(function(){function dispatch(effect,eventName){if(effect.options[eventName+'Internal'])
effect.options[eventName+'Internal'](effect);if(effect.options[eventName])
effect.options[eventName](effect);}
return function(pos){if(this.state==="idle"){this.state="running";dispatch(this,'beforeSetup');if(this.setup)this.setup();dispatch(this,'afterSetup');}
if(this.state==="running"){pos=(this.options.transition(pos)*this.fromToDelta)+this.options.from;this.position=pos;dispatch(this,'beforeUpdate');if(this.update)this.update(pos);dispatch(this,'afterUpdate');}};})();this.event('beforeStart');if(!this.options.sync)
Effect.Queues.get(Object.isString(this.options.queue)?'global':this.options.queue.scope).add(this);},loop:function(timePos){if(timePos>=this.startOn){if(timePos>=this.finishOn){this.render(1.0);this.cancel();this.event('beforeFinish');if(this.finish)this.finish();this.event('afterFinish');return;}
var pos=(timePos-this.startOn)/this.totalTime,frame=(pos*this.totalFrames).round();if(frame>this.currentFrame){this.render(pos);this.currentFrame=frame;}}},cancel:function(){if(!this.options.sync)
Effect.Queues.get(Object.isString(this.options.queue)?'global':this.options.queue.scope).remove(this);this.state='finished';},event:function(eventName){if(this.options[eventName+'Internal'])this.options[eventName+'Internal'](this);if(this.options[eventName])this.options[eventName](this);},inspect:function(){var data=$H();for(property in this)
if(!Object.isFunction(this[property]))data.set(property,this[property]);return'#<Effect:'+data.inspect()+',options:'+$H(this.options).inspect()+'>';}});Effect.Parallel=Class.create(Effect.Base,{initialize:function(effects){this.effects=effects||[];this.start(arguments[1]);},update:function(position){this.effects.invoke('render',position);},finish:function(position){this.effects.each(function(effect){effect.render(1.0);effect.cancel();effect.event('beforeFinish');if(effect.finish)effect.finish(position);effect.event('afterFinish');});}});Effect.Tween=Class.create(Effect.Base,{initialize:function(object,from,to){object=Object.isString(object)?$(object):object;var args=$A(arguments),method=args.last(),options=args.length==5?args[3]:null;this.method=Object.isFunction(method)?method.bind(object):Object.isFunction(object[method])?object[method].bind(object):function(value){object[method]=value};this.start(Object.extend({from:from,to:to},options||{}));},update:function(position){this.method(position);}});Effect.Event=Class.create(Effect.Base,{initialize:function(){this.start(Object.extend({duration:0},arguments[0]||{}));},update:Prototype.emptyFunction});Effect.Opacity=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout))
this.element.setStyle({zoom:1});var options=Object.extend({from:this.element.getOpacity()||0.0,to:1.0},arguments[1]||{});this.start(options);},update:function(position){this.element.setOpacity(position);}});Effect.Move=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);var options=Object.extend({x:0,y:0,mode:'relative'},arguments[1]||{});this.start(options);},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle('left')||'0');this.originalTop=parseFloat(this.element.getStyle('top')||'0');if(this.options.mode=='absolute'){this.options.x=this.options.x-this.originalLeft;this.options.y=this.options.y-this.originalTop;}},update:function(position){this.element.setStyle({left:(this.options.x*position+this.originalLeft).round()+'px',top:(this.options.y*position+this.originalTop).round()+'px'});}});Effect.MoveBy=function(element,toTop,toLeft){return new Effect.Move(element,Object.extend({x:toLeft,y:toTop},arguments[3]||{}));};Effect.Scale=Class.create(Effect.Base,{initialize:function(element,percent){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);var options=Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:'box',scaleFrom:100.0,scaleTo:percent},arguments[2]||{});this.start(options);},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle('position');this.originalStyle={};['top','left','width','height','fontSize'].each(function(k){this.originalStyle[k]=this.element.style[k];}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var fontSize=this.element.getStyle('font-size')||'100%';['em','px','%','pt'].each(function(fontSizeType){if(fontSize.indexOf(fontSizeType)>0){this.fontSize=parseFloat(fontSize);this.fontSizeType=fontSizeType;}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode=='box')
this.dims=[this.element.offsetHeight,this.element.offsetWidth];if(/^content/.test(this.options.scaleMode))
this.dims=[this.element.scrollHeight,this.element.scrollWidth];if(!this.dims)
this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth];},update:function(position){var currentScale=(this.options.scaleFrom/100.0)+(this.factor*position);if(this.options.scaleContent&&this.fontSize)
this.element.setStyle({fontSize:this.fontSize*currentScale+this.fontSizeType});this.setDimensions(this.dims[0]*currentScale,this.dims[1]*currentScale);},finish:function(position){if(this.restoreAfterFinish)this.element.setStyle(this.originalStyle);},setDimensions:function(height,width){var d={};if(this.options.scaleX)d.width=width.round()+'px';if(this.options.scaleY)d.height=height.round()+'px';if(this.options.scaleFromCenter){var topd=(height-this.dims[0])/2;var leftd=(width-this.dims[1])/2;if(this.elementPositioning=='absolute'){if(this.options.scaleY)d.top=this.originalTop-topd+'px';if(this.options.scaleX)d.left=this.originalLeft-leftd+'px';}else{if(this.options.scaleY)d.top=-topd+'px';if(this.options.scaleX)d.left=-leftd+'px';}}
this.element.setStyle(d);}});Effect.Highlight=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);var options=Object.extend({startcolor:'#ffff99'},arguments[1]||{});this.start(options);},setup:function(){if(this.element.getStyle('display')=='none'){this.cancel();return;}
this.oldStyle={};if(!this.options.keepBackgroundImage){this.oldStyle.backgroundImage=this.element.getStyle('background-image');this.element.setStyle({backgroundImage:'none'});}
if(!this.options.endcolor)
this.options.endcolor=this.element.getStyle('background-color').parseColor('#ffffff');if(!this.options.restorecolor)
this.options.restorecolor=this.element.getStyle('background-color');this._base=$R(0,2).map(function(i){return parseInt(this.options.startcolor.slice(i*2+1,i*2+3),16)}.bind(this));this._delta=$R(0,2).map(function(i){return parseInt(this.options.endcolor.slice(i*2+1,i*2+3),16)-this._base[i]}.bind(this));},update:function(position){this.element.setStyle({backgroundColor:$R(0,2).inject('#',function(m,v,i){return m+((this._base[i]+(this._delta[i]*position)).round().toColorPart());}.bind(this))});},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}));}});Effect.ScrollTo=function(element){var options=arguments[1]||{},scrollOffsets=document.viewport.getScrollOffsets(),elementOffsets=$(element).cumulativeOffset();if(options.offset)elementOffsets[1]+=options.offset;return new Effect.Tween(null,scrollOffsets.top,elementOffsets[1],options,function(p){scrollTo(scrollOffsets.left,p.round());});};Effect.Fade=function(element){element=$(element);var oldOpacity=element.getInlineOpacity();var options=Object.extend({from:element.getOpacity()||1.0,to:0.0,afterFinishInternal:function(effect){if(effect.options.to!=0)return;effect.element.hide().setStyle({opacity:oldOpacity});}},arguments[1]||{});return new Effect.Opacity(element,options);};Effect.Appear=function(element){element=$(element);var options=Object.extend({from:(element.getStyle('display')=='none'?0.0:element.getOpacity()||0.0),to:1.0,afterFinishInternal:function(effect){effect.element.forceRerendering();},beforeSetup:function(effect){effect.element.setOpacity(effect.options.from).show();}},arguments[1]||{});return new Effect.Opacity(element,options);};Effect.Puff=function(element){element=$(element);var oldStyle={opacity:element.getInlineOpacity(),position:element.getStyle('position'),top:element.style.top,left:element.style.left,width:element.style.width,height:element.style.height};return new Effect.Parallel([new Effect.Scale(element,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(element,{sync:true,to:0.0})],Object.extend({duration:1.0,beforeSetupInternal:function(effect){Position.absolutize(effect.effects[0].element);},afterFinishInternal:function(effect){effect.effects[0].element.hide().setStyle(oldStyle);}},arguments[1]||{}));};Effect.BlindUp=function(element){element=$(element);element.makeClipping();var elementDimensions=element.getDimensions();var m=/(.*?)px/.exec(element.getStyle('height'));var height=m[1]?parseInt(m[1]):elementDimensions.height;return new Effect.Scale(element,0,Object.extend({scaleContent:false,scaleX:false,scaleMode:{originalHeight:height,originalWidth:elementDimensions.width},restoreAfterFinish:true,afterFinishInternal:function(effect){effect.element.hide().undoClipping();}},arguments[1]||{}));};Effect.BlindDown=function(element){element=$(element);var elementDimensions=element.getDimensions();return new Effect.Scale(element,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},restoreAfterFinish:true,afterSetup:function(effect){effect.element.makeClipping().setStyle({height:'0px'}).show();},afterFinishInternal:function(effect){effect.element.undoClipping();}},arguments[1]||{}));};Effect.SwitchOff=function(element){element=$(element);var oldOpacity=element.getInlineOpacity();return new Effect.Appear(element,Object.extend({duration:0.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(effect){new Effect.Scale(effect.element,1,{duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(effect){effect.element.makePositioned().makeClipping();},afterFinishInternal:function(effect){effect.element.hide().undoClipping().undoPositioned().setStyle({opacity:oldOpacity});}});}},arguments[1]||{}));};Effect.DropOut=function(element){element=$(element);var oldStyle={top:element.getStyle('top'),left:element.getStyle('left'),opacity:element.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(element,{x:0,y:100,sync:true}),new Effect.Opacity(element,{sync:true,to:0.0})],Object.extend({duration:0.5,beforeSetup:function(effect){effect.effects[0].element.makePositioned();},afterFinishInternal:function(effect){effect.effects[0].element.hide().undoPositioned().setStyle(oldStyle);}},arguments[1]||{}));};Effect.Shake=function(element){element=$(element);var options=Object.extend({distance:20,duration:0.5},arguments[1]||{});var distance=parseFloat(options.distance);var split=parseFloat(options.duration)/10.0;var oldStyle={top:element.getStyle('top'),left:element.getStyle('left')};return new Effect.Move(element,{x:distance,y:0,duration:split,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:distance*2,y:0,duration:split*2,afterFinishInternal:function(effect){new Effect.Move(effect.element,{x:-distance,y:0,duration:split,afterFinishInternal:function(effect){effect.element.undoPositioned().setStyle(oldStyle);}});}});}});}});}});}});};Effect.SlideDown=function(element){element=$(element).cleanWhitespace();var oldInnerBottom=element.down().getStyle('bottom');var elementDimensions=element.getDimensions();return new Effect.Scale(element,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},restoreAfterFinish:true,afterSetup:function(effect){effect.element.makePositioned();effect.element.down().makePositioned();if(window.opera)effect.element.setStyle({top:''});effect.element.makeClipping().setStyle({height:'0px'}).show();},afterUpdateInternal:function(effect){effect.element.down().setStyle({bottom:(effect.dims[0]-effect.element.clientHeight)+'px'});},afterFinishInternal:function(effect){effect.element.undoClipping().undoPositioned();effect.element.down().undoPositioned().setStyle({bottom:oldInnerBottom});}},arguments[1]||{}));};Effect.SlideUp=function(element){element=$(element).cleanWhitespace();var oldInnerBottom=element.down().getStyle('bottom');var elementDimensions=element.getDimensions();return new Effect.Scale(element,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:'box',scaleFrom:100,scaleMode:{originalHeight:elementDimensions.height,originalWidth:elementDimensions.width},restoreAfterFinish:true,afterSetup:function(effect){effect.element.makePositioned();effect.element.down().makePositioned();if(window.opera)effect.element.setStyle({top:''});effect.element.makeClipping().show();},afterUpdateInternal:function(effect){effect.element.down().setStyle({bottom:(effect.dims[0]-effect.element.clientHeight)+'px'});},afterFinishInternal:function(effect){effect.element.hide().undoClipping().undoPositioned();effect.element.down().undoPositioned().setStyle({bottom:oldInnerBottom});}},arguments[1]||{}));};Effect.Squish=function(element){return new Effect.Scale(element,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(effect){effect.element.makeClipping();},afterFinishInternal:function(effect){effect.element.hide().undoClipping();}});};Effect.Grow=function(element){element=$(element);var options=Object.extend({direction:'center',moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{});var oldStyle={top:element.style.top,left:element.style.left,height:element.style.height,width:element.style.width,opacity:element.getInlineOpacity()};var dims=element.getDimensions();var initialMoveX,initialMoveY;var moveX,moveY;switch(options.direction){case'top-left':initialMoveX=initialMoveY=moveX=moveY=0;break;case'top-right':initialMoveX=dims.width;initialMoveY=moveY=0;moveX=-dims.width;break;case'bottom-left':initialMoveX=moveX=0;initialMoveY=dims.height;moveY=-dims.height;break;case'bottom-right':initialMoveX=dims.width;initialMoveY=dims.height;moveX=-dims.width;moveY=-dims.height;break;case'center':initialMoveX=dims.width/2;initialMoveY=dims.height/2;moveX=-dims.width/2;moveY=-dims.height/2;break;}
return new Effect.Move(element,{x:initialMoveX,y:initialMoveY,duration:0.01,beforeSetup:function(effect){effect.element.hide().makeClipping().makePositioned();},afterFinishInternal:function(effect){new Effect.Parallel([new Effect.Opacity(effect.element,{sync:true,to:1.0,from:0.0,transition:options.opacityTransition}),new Effect.Move(effect.element,{x:moveX,y:moveY,sync:true,transition:options.moveTransition}),new Effect.Scale(effect.element,100,{scaleMode:{originalHeight:dims.height,originalWidth:dims.width},sync:true,scaleFrom:window.opera?1:0,transition:options.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(effect){effect.effects[0].element.setStyle({height:'0px'}).show();},afterFinishInternal:function(effect){effect.effects[0].element.undoClipping().undoPositioned().setStyle(oldStyle);}},options));}});};Effect.Shrink=function(element){element=$(element);var options=Object.extend({direction:'center',moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{});var oldStyle={top:element.style.top,left:element.style.left,height:element.style.height,width:element.style.width,opacity:element.getInlineOpacity()};var dims=element.getDimensions();var moveX,moveY;switch(options.direction){case'top-left':moveX=moveY=0;break;case'top-right':moveX=dims.width;moveY=0;break;case'bottom-left':moveX=0;moveY=dims.height;break;case'bottom-right':moveX=dims.width;moveY=dims.height;break;case'center':moveX=dims.width/2;moveY=dims.height/2;break;}
return new Effect.Parallel([new Effect.Opacity(element,{sync:true,to:0.0,from:1.0,transition:options.opacityTransition}),new Effect.Scale(element,window.opera?1:0,{sync:true,transition:options.scaleTransition,restoreAfterFinish:true}),new Effect.Move(element,{x:moveX,y:moveY,sync:true,transition:options.moveTransition})],Object.extend({beforeStartInternal:function(effect){effect.effects[0].element.makePositioned().makeClipping();},afterFinishInternal:function(effect){effect.effects[0].element.hide().undoClipping().undoPositioned().setStyle(oldStyle);}},options));};Effect.Pulsate=function(element){element=$(element);var options=arguments[1]||{},oldOpacity=element.getInlineOpacity(),transition=options.transition||Effect.Transitions.linear,reverser=function(pos){return 1-transition((-Math.cos((pos*(options.pulses||5)*2)*Math.PI)/2)+.5);};return new Effect.Opacity(element,Object.extend(Object.extend({duration:2.0,from:0,afterFinishInternal:function(effect){effect.element.setStyle({opacity:oldOpacity});}},options),{transition:reverser}));};Effect.Fold=function(element){element=$(element);var oldStyle={top:element.style.top,left:element.style.left,width:element.style.width,height:element.style.height};element.makeClipping();return new Effect.Scale(element,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(effect){new Effect.Scale(element,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(effect){effect.element.hide().undoClipping().setStyle(oldStyle);}});}},arguments[1]||{}));};Effect.Morph=Class.create(Effect.Base,{initialize:function(element){this.element=$(element);if(!this.element)throw(Effect._elementDoesNotExistError);var options=Object.extend({style:{}},arguments[1]||{});if(!Object.isString(options.style))this.style=$H(options.style);else{if(options.style.include(':'))
this.style=options.style.parseStyle();else{this.element.addClassName(options.style);this.style=$H(this.element.getStyles());this.element.removeClassName(options.style);var css=this.element.getStyles();this.style=this.style.reject(function(style){return style.value==css[style.key];});options.afterFinishInternal=function(effect){effect.element.addClassName(effect.options.style);effect.transforms.each(function(transform){effect.element.style[transform.style]='';});};}}
this.start(options);},setup:function(){function parseColor(color){if(!color||['rgba(0, 0, 0, 0)','transparent'].include(color))color='#ffffff';color=color.parseColor();return $R(0,2).map(function(i){return parseInt(color.slice(i*2+1,i*2+3),16);});}
this.transforms=this.style.map(function(pair){var property=pair[0],value=pair[1],unit=null;if(value.parseColor('#zzzzzz')!='#zzzzzz'){value=value.parseColor();unit='color';}else if(property=='opacity'){value=parseFloat(value);if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout))
this.element.setStyle({zoom:1});}else if(Element.CSS_LENGTH.test(value)){var components=value.match(/^([\+\-]?[0-9\.]+)(.*)$/);value=parseFloat(components[1]);unit=(components.length==3)?components[2]:null;}
var originalValue=this.element.getStyle(property);return{style:property.camelize(),originalValue:unit=='color'?parseColor(originalValue):parseFloat(originalValue||0),targetValue:unit=='color'?parseColor(value):value,unit:unit};}.bind(this)).reject(function(transform){return((transform.originalValue==transform.targetValue)||(transform.unit!='color'&&(isNaN(transform.originalValue)||isNaN(transform.targetValue))));});},update:function(position){var style={},transform,i=this.transforms.length;while(i--)
style[(transform=this.transforms[i]).style]=transform.unit=='color'?'#'+
(Math.round(transform.originalValue[0]+
(transform.targetValue[0]-transform.originalValue[0])*position)).toColorPart()+
(Math.round(transform.originalValue[1]+
(transform.targetValue[1]-transform.originalValue[1])*position)).toColorPart()+
(Math.round(transform.originalValue[2]+
(transform.targetValue[2]-transform.originalValue[2])*position)).toColorPart():(transform.originalValue+
(transform.targetValue-transform.originalValue)*position).toFixed(3)+
(transform.unit===null?'':transform.unit);this.element.setStyle(style,true);}});Effect.Transform=Class.create({initialize:function(tracks){this.tracks=[];this.options=arguments[1]||{};this.addTracks(tracks);},addTracks:function(tracks){tracks.each(function(track){track=$H(track);var data=track.values().first();this.tracks.push($H({ids:track.keys().first(),effect:Effect.Morph,options:{style:data}}));}.bind(this));return this;},play:function(){return new Effect.Parallel(this.tracks.map(function(track){var ids=track.get('ids'),effect=track.get('effect'),options=track.get('options');var elements=[$(ids)||$$(ids)].flatten();return elements.map(function(e){return new effect(e,Object.extend({sync:true},options))});}).flatten(),this.options);}});Element.CSS_PROPERTIES=$w('backgroundColor backgroundPosition borderBottomColor borderBottomStyle '+'borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth '+'borderRightColor borderRightStyle borderRightWidth borderSpacing '+'borderTopColor borderTopStyle borderTopWidth bottom clip color '+'fontSize fontWeight height left letterSpacing lineHeight '+'marginBottom marginLeft marginRight marginTop markerOffset maxHeight '+'maxWidth minHeight minWidth opacity outlineColor outlineOffset '+'outlineWidth paddingBottom paddingLeft paddingRight paddingTop '+'right textIndent top width wordSpacing zIndex');Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.__parseStyleElement=document.createElement('div');String.prototype.parseStyle=function(){var style,styleRules=$H();if(Prototype.Browser.WebKit)
style=new Element('div',{style:this}).style;else{String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>';style=String.__parseStyleElement.childNodes[0].style;}
Element.CSS_PROPERTIES.each(function(property){if(style[property])styleRules.set(property,style[property]);});if(Prototype.Browser.IE&&this.include('opacity'))
styleRules.set('opacity',this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1]);return styleRules;};if(document.defaultView&&document.defaultView.getComputedStyle){Element.getStyles=function(element){var css=document.defaultView.getComputedStyle($(element),null);return Element.CSS_PROPERTIES.inject({},function(styles,property){styles[property]=css[property];return styles;});};}else{Element.getStyles=function(element){element=$(element);var css=element.currentStyle,styles;styles=Element.CSS_PROPERTIES.inject({},function(results,property){results[property]=css[property];return results;});if(!styles.opacity)styles.opacity=element.getOpacity();return styles;};}
Effect.Methods={morph:function(element,style){element=$(element);new Effect.Morph(element,Object.extend({style:style},arguments[2]||{}));return element;},visualEffect:function(element,effect,options){element=$(element);var s=effect.dasherize().camelize(),klass=s.charAt(0).toUpperCase()+s.substring(1);new Effect[klass](element,options);return element;},highlight:function(element,options){element=$(element);new Effect.Highlight(element,options);return element;}};$w('fade appear grow shrink fold blindUp blindDown slideUp slideDown '+'pulsate shake puff squish switchOff dropOut').each(function(effect){Effect.Methods[effect]=function(element,options){element=$(element);Effect[effect.charAt(0).toUpperCase()+effect.substring(1)](element,options);return element;};});$w('getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles').each(function(f){Effect.Methods[f]=Element[f];});Element.addMethods(Effect.Methods);


/* public/javascripts/slider.js @ 1339185887 */

if(!Control)var Control={};Control.Slider=Class.create({initialize:function(handle,track,options){var slider=this;if(Object.isArray(handle)){this.handles=handle.collect(function(e){return $(e)});}else{this.handles=[$(handle)];}
this.track=$(track);this.options=options||{};this.axis=this.options.axis||'horizontal';this.increment=this.options.increment||1;this.step=parseInt(this.options.step||'1');this.range=this.options.range||$R(0,1);this.value=0;this.values=this.handles.map(function(){return 0});this.spans=this.options.spans?this.options.spans.map(function(s){return $(s)}):false;this.options.startSpan=$(this.options.startSpan||null);this.options.endSpan=$(this.options.endSpan||null);this.restricted=this.options.restricted||false;this.maximum=this.options.maximum||this.range.end;this.minimum=this.options.minimum||this.range.start;this.alignX=parseInt(this.options.alignX||'0');this.alignY=parseInt(this.options.alignY||'0');this.trackLength=this.maximumOffset()-this.minimumOffset();this.handleLength=this.isVertical()?(this.handles[0].offsetHeight!=0?this.handles[0].offsetHeight:this.handles[0].style.height.replace(/px$/,"")):(this.handles[0].offsetWidth!=0?this.handles[0].offsetWidth:this.handles[0].style.width.replace(/px$/,""));this.active=false;this.dragging=false;this.disabled=false;if(this.options.disabled)this.setDisabled();this.allowedValues=this.options.values?this.options.values.sortBy(Prototype.K):false;if(this.allowedValues){this.minimum=this.allowedValues.min();this.maximum=this.allowedValues.max();}
this.eventMouseDown=this.startDrag.bindAsEventListener(this);this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.update.bindAsEventListener(this);this.handles.each(function(h,i){i=slider.handles.length-1-i;slider.setValue(parseFloat((Object.isArray(slider.options.sliderValue)?slider.options.sliderValue[i]:slider.options.sliderValue)||slider.range.start),i);h.makePositioned().observe("mousedown",slider.eventMouseDown);});this.track.observe("mousedown",this.eventMouseDown);document.observe("mouseup",this.eventMouseUp);document.observe("mousemove",this.eventMouseMove);this.initialized=true;},dispose:function(){var slider=this;Event.stopObserving(this.track,"mousedown",this.eventMouseDown);Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);this.handles.each(function(h){Event.stopObserving(h,"mousedown",slider.eventMouseDown);});},setDisabled:function(){this.disabled=true;},setEnabled:function(){this.disabled=false;},getNearestValue:function(value){if(this.allowedValues){if(value>=this.allowedValues.max())return(this.allowedValues.max());if(value<=this.allowedValues.min())return(this.allowedValues.min());var offset=Math.abs(this.allowedValues[0]-value);var newValue=this.allowedValues[0];this.allowedValues.each(function(v){var currentOffset=Math.abs(v-value);if(currentOffset<=offset){newValue=v;offset=currentOffset;}});return newValue;}
if(value>this.range.end)return this.range.end;if(value<this.range.start)return this.range.start;return value;},setValue:function(sliderValue,handleIdx){if(!this.active){this.activeHandleIdx=handleIdx||0;this.activeHandle=this.handles[this.activeHandleIdx];this.updateStyles();}
handleIdx=handleIdx||this.activeHandleIdx||0;if(this.initialized&&this.restricted){if((handleIdx>0)&&(sliderValue<this.values[handleIdx-1]))
sliderValue=this.values[handleIdx-1];if((handleIdx<(this.handles.length-1))&&(sliderValue>this.values[handleIdx+1]))
sliderValue=this.values[handleIdx+1];}
sliderValue=this.getNearestValue(sliderValue);this.values[handleIdx]=sliderValue;this.value=this.values[0];this.handles[handleIdx].style[this.isVertical()?'top':'left']=this.translateToPx(sliderValue);this.drawSpans();if(!this.dragging||!this.event)this.updateFinished();},setValueBy:function(delta,handleIdx){this.setValue(this.values[handleIdx||this.activeHandleIdx||0]+delta,handleIdx||this.activeHandleIdx||0);},translateToPx:function(value){return Math.round(((this.trackLength-this.handleLength)/(this.range.end-this.range.start))*(value-this.range.start))+"px";},translateToValue:function(offset){return((offset/(this.trackLength-this.handleLength)*(this.range.end-this.range.start))+this.range.start);},getRange:function(range){var v=this.values.sortBy(Prototype.K);range=range||0;return $R(v[range],v[range+1]);},minimumOffset:function(){return(this.isVertical()?this.alignY:this.alignX);},maximumOffset:function(){return(this.isVertical()?(this.track.offsetHeight!=0?this.track.offsetHeight:this.track.style.height.replace(/px$/,""))-this.alignY:(this.track.offsetWidth!=0?this.track.offsetWidth:this.track.style.width.replace(/px$/,""))-this.alignX);},isVertical:function(){return(this.axis=='vertical');},drawSpans:function(){var slider=this;if(this.spans)
$R(0,this.spans.length-1).each(function(r){slider.setSpan(slider.spans[r],slider.getRange(r))});if(this.options.startSpan)
this.setSpan(this.options.startSpan,$R(0,this.values.length>1?this.getRange(0).min():this.value));if(this.options.endSpan)
this.setSpan(this.options.endSpan,$R(this.values.length>1?this.getRange(this.spans.length-1).max():this.value,this.maximum));},setSpan:function(span,range){if(this.isVertical()){span.style.top=this.translateToPx(range.start);span.style.height=this.translateToPx(range.end-range.start+this.range.start);}else{span.style.left=this.translateToPx(range.start);span.style.width=this.translateToPx(range.end-range.start+this.range.start);}},updateStyles:function(){this.handles.each(function(h){Element.removeClassName(h,'selected')});Element.addClassName(this.activeHandle,'selected');},startDrag:function(event){if(Event.isLeftClick(event)){if(!this.disabled){this.active=true;var handle=Event.element(event);var pointer=[Event.pointerX(event),Event.pointerY(event)];var track=handle;if(track==this.track){var offsets=this.track.cumulativeOffset();this.event=event;this.setValue(this.translateToValue((this.isVertical()?pointer[1]-offsets[1]:pointer[0]-offsets[0])-(this.handleLength/2)));var offsets=this.activeHandle.cumulativeOffset();this.offsetX=(pointer[0]-offsets[0]);this.offsetY=(pointer[1]-offsets[1]);}else{while((this.handles.indexOf(handle)==-1)&&handle.parentNode)
handle=handle.parentNode;if(this.handles.indexOf(handle)!=-1){this.activeHandle=handle;this.activeHandleIdx=this.handles.indexOf(this.activeHandle);this.updateStyles();var offsets=this.activeHandle.cumulativeOffset();this.offsetX=(pointer[0]-offsets[0]);this.offsetY=(pointer[1]-offsets[1]);}}}
Event.stop(event);}},update:function(event){if(this.active){if(!this.dragging)this.dragging=true;this.draw(event);if(Prototype.Browser.WebKit)window.scrollBy(0,0);Event.stop(event);}},draw:function(event){var pointer=[Event.pointerX(event),Event.pointerY(event)];var offsets=this.track.cumulativeOffset();pointer[0]-=this.offsetX+offsets[0];pointer[1]-=this.offsetY+offsets[1];this.event=event;this.setValue(this.translateToValue(this.isVertical()?pointer[1]:pointer[0]));if(this.initialized&&this.options.onSlide)
this.options.onSlide(this.values.length>1?this.values:this.value,this);},endDrag:function(event){if(this.active&&this.dragging){this.finishDrag(event,true);Event.stop(event);}
this.active=false;this.dragging=false;},finishDrag:function(event,success){this.active=false;this.dragging=false;this.updateFinished();},updateFinished:function(){if(this.initialized&&this.options.onChange)
this.options.onChange(this.values.length>1?this.values:this.value,this);this.event=null;}});


/* public/javascripts/swfobject.js @ 1339185887 */
var lzy_js_public_javascripts_swfobject="\nif(typeof deconcept==\"undefined\")var deconcept=new Object();if(typeof deconcept.util==\"undefined\")deconcept.util=new Object();if(typeof deconcept.SWFObjectUtil==\"undefined\")deconcept.SWFObjectUtil=new Object();deconcept.SWFObject=function(swf,id,w,h,ver,c,useExpressInstall,quality,xiRedirectUrl,redirectUrl,detectKey){if(!document.getElementById){return;}\nthis.DETECT_KEY=detectKey?detectKey:\'detectflash\';this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object();this.variables=new Object();this.attributes=new Array();if(swf){this.setAttribute(\'swf\',swf);}\nif(id){this.setAttribute(\'id\',id);}\nif(w){this.setAttribute(\'width\',w);}\nif(h){this.setAttribute(\'height\',h);}\nif(ver){this.setAttribute(\'version\',new deconcept.PlayerVersion(ver.toString().split(\".\")));}\nthis.installedVer=deconcept.SWFObjectUtil.getPlayerVersion();if(c){this.addParam(\'bgcolor\',c);}\nvar q=quality?quality:\'high\';this.addParam(\'quality\',q);this.setAttribute(\'useExpressInstall\',useExpressInstall);this.setAttribute(\'doExpressInstall\',false);var xir=(xiRedirectUrl)?xiRedirectUrl:window.location;this.setAttribute(\'xiRedirectUrl\',xir);this.setAttribute(\'redirectUrl\',\'\');if(redirectUrl){this.setAttribute(\'redirectUrl\',redirectUrl);}}\ndeconcept.SWFObject.prototype={setAttribute:function(name,value){this.attributes[name]=value;},getAttribute:function(name){return this.attributes[name];},addParam:function(name,value){this.params[name]=value;},getParams:function(){return this.params;},addVariable:function(name,value){this.variables[name]=value;},getVariable:function(name){return this.variables[name];},getVariables:function(){return this.variables;},getVariablePairs:function(){var variablePairs=new Array();var key;var variables=this.getVariables();for(key in variables){variablePairs.push(key+\"=\"+variables[key]);}\nreturn variablePairs;},getSWFHTML:function(){var swfNode=\"\";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute(\"doExpressInstall\")){this.addVariable(\"MMplayerType\",\"PlugIn\");}\nswfNode=\'<embed type=\"application/x-shockwave-flash\" src=\"\'+this.getAttribute(\'swf\')+\'\" width=\"\'+this.getAttribute(\'width\')+\'\" height=\"\'+this.getAttribute(\'height\')+\'\"\';swfNode+=\' id=\"\'+this.getAttribute(\'id\')+\'\" name=\"\'+this.getAttribute(\'id\')+\'\" \';var params=this.getParams();for(var key in params){swfNode+=[key]+\'=\"\'+params[key]+\'\" \';}\nvar pairs=this.getVariablePairs().join(\"&\");if(pairs.length>0){swfNode+=\'flashvars=\"\'+pairs+\'\"\';}\nswfNode+=\'/>\';}else{if(this.getAttribute(\"doExpressInstall\")){this.addVariable(\"MMplayerType\",\"ActiveX\");}\nswfNode=\'<object id=\"\'+this.getAttribute(\'id\')+\'\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" width=\"\'+this.getAttribute(\'width\')+\'\" height=\"\'+this.getAttribute(\'height\')+\'\">\';swfNode+=\'<param name=\"movie\" value=\"\'+this.getAttribute(\'swf\')+\'\" />\';var params=this.getParams();for(var key in params){swfNode+=\'<param name=\"\'+key+\'\" value=\"\'+params[key]+\'\" />\';}\nvar pairs=this.getVariablePairs().join(\"&\");if(pairs.length>0){swfNode+=\'<param name=\"flashvars\" value=\"\'+pairs+\'\" />\';}\nswfNode+=\"<\/object>\";}\nreturn swfNode;},write:function(elementId){if(this.getAttribute(\'useExpressInstall\')){var expressInstallReqVer=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(expressInstallReqVer)&&!this.installedVer.versionIsValid(this.getAttribute(\'version\'))){this.setAttribute(\'doExpressInstall\',true);this.addVariable(\"MMredirectURL\",escape(this.getAttribute(\'xiRedirectUrl\')));document.title=document.title.slice(0,47)+\" - Flash Player Installation\";this.addVariable(\"MMdoctitle\",document.title);}}\nif(this.skipDetect||this.getAttribute(\'doExpressInstall\')||this.installedVer.versionIsValid(this.getAttribute(\'version\'))){var n=(typeof elementId==\'string\')?document.getElementById(elementId):elementId;n.innerHTML=this.getSWFHTML();return true;}else{if(this.getAttribute(\'redirectUrl\')!=\"\"){document.location.replace(this.getAttribute(\'redirectUrl\'));}}\nreturn false;}}\ndeconcept.SWFObjectUtil.getPlayerVersion=function(){var PlayerVersion=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins[\"Shockwave Flash\"];if(x&&x.description){PlayerVersion=new deconcept.PlayerVersion(x.description.replace(/([a-zA-Z]|\\s)+/,\"\").replace(/(\\s+r|\\s+b[0-9]+)/,\".\").split(\".\"));}}else{try{var axo=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.7\");}catch(e){try{var axo=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.6\");PlayerVersion=new deconcept.PlayerVersion([6,0,21]);axo.AllowScriptAccess=\"always\";}catch(e){if(PlayerVersion.major==6){return PlayerVersion;}}\ntry{axo=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\");}catch(e){}}\nif(axo!=null){PlayerVersion=new deconcept.PlayerVersion(axo.GetVariable(\"$version\").split(\" \")[1].split(\",\"));}}\nreturn PlayerVersion;}\ndeconcept.PlayerVersion=function(arrVersion){this.major=arrVersion[0]!=null?parseInt(arrVersion[0]):0;this.minor=arrVersion[1]!=null?parseInt(arrVersion[1]):0;this.rev=arrVersion[2]!=null?parseInt(arrVersion[2]):0;}\ndeconcept.PlayerVersion.prototype.versionIsValid=function(fv){if(this.major<fv.major)return false;if(this.major>fv.major)return true;if(this.minor<fv.minor)return false;if(this.minor>fv.minor)return true;if(this.rev<fv.rev)return false;return true;}\ndeconcept.util={getRequestParameter:function(param){var q=document.location.search||document.location.hash;if(q){var pairs=q.substring(1).split(\"&\");for(var i=0;i<pairs.length;i++){if(pairs[i].substring(0,pairs[i].indexOf(\"=\"))==param){return pairs[i].substring((pairs[i].indexOf(\"=\")+1));}}}\nreturn\"\";}}\ndeconcept.SWFObjectUtil.cleanupSWFs=function(){if(window.opera||!document.all)return;var objects=document.getElementsByTagName(\"OBJECT\");for(var i=0;i<objects.length;i++){objects[i].style.display=\'none\';for(var x in objects[i]){if(typeof objects[i][x]==\'function\'){objects[i][x]=function(){};}}}}\ndeconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};if(typeof window.onunload==\'function\'){var oldUnload=window.onunload;window.onunload=function(){deconcept.SWFObjectUtil.cleanupSWFs();oldUnload();}}else{window.onunload=deconcept.SWFObjectUtil.cleanupSWFs;}}\nif(typeof window.onbeforeunload==\'function\'){var oldBeforeUnload=window.onbeforeunload;window.onbeforeunload=function(){deconcept.SWFObjectUtil.prepUnload();oldBeforeUnload();}}else{window.onbeforeunload=deconcept.SWFObjectUtil.prepUnload;}\nif(Array.prototype.push==null){Array.prototype.push=function(item){this[this.length]=item;return this.length;}}\nvar getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObject;var SWFObject=deconcept.SWFObject;";


/* public/javascripts/global/base.js @ 1339185887 */

if(!window.Scribd)Scribd={};function jkstrp(f,name){function p(){try{f();}catch(e){var ua=""+navigator.userAgent;trackEvent&&trackEvent("Error",name+" :: "+ua,e.stack||e.message);throw e;}};if(document.loaded)p();else document.observe('dom:loaded',p);}
if(false){Ajax.Responders.register({onException:function(request,exception){(function(){throw exception;}).defer();}});}
Function.prototype.debounce=function(delay,immediate){var fn=this,timeout=null;return function d(){var _this=this,args=arguments;if(immediate&&timeout===null){fn.apply(_this,args);}
if(timeout!==null)window.clearTimeout(timeout);timeout=window.setTimeout(function(){if(!immediate)fn.apply(_this,args);timeout=null;},delay);}};Function.prototype.throttle=function(rate){var fn=this,timeout;return function t(){if(timeout)return;fn.apply(this,arguments);timeout=setTimeout(function(){timeout=null;},rate);}};Scribd.once=function(fn){var called=false;return function(){if(called)return;called=true;return fn.apply(this,arguments);}};Scribd.Remote=(function(){function getElement(e,type){if(e.tagName&&e.tagName==type){var el=$(e);}else{e.stop();var el=e.findElement(type);}
return el;}
function formSendSuccess(req){var reply=req.responseJSON;if(reply&&reply.errors&&this.use_alert){var form=$(document[reply.form_name]);reply.errors.each(function(er){var input=form.down("input[name='"+er.input_name+"']");if(input){var error_node=input.next('.alert');if(!error_node){error_node=new Element('div',{'class':'alert'});input.insert({after:error_node});}
error_node.update(er.msg);}});}}
var pub={Form:function(e,opts){var options=Object.extend({use_alert:true},opts);var form=getElement(e,'FORM');options.form_name=form.readAttribute('name');if(options.use_alert)
form.select('.alert').invoke('update');form.request(Object.extend({evalScripts:true,parameters:'form_name='+encodeURIComponent(form.readAttribute('name')),onSuccess:formSendSuccess.bind(options),onFailure:function(){Scribd.Alerts.error('flashes_placeholder',"Request failed! Please try again later.",{auto_fade:true});$('flashes_placeholder').scrollTo();}.bind(options),onComplete:function(){var form=$$("form[name='"+this.form_name+"']").first();form.enable();form.down(".spinner").hide();}.bind(options)},options));form.disable();var spinner=form.down('.spinner');if(spinner)
spinner.show();form=null;},Link:function(e,opts){var options=opts||{};var link=getElement(e,'A');var url=link.readAttribute('href');new Ajax.Request(url,Object.extend({method:'GET',evalScripts:true},options));link=null;}};return pub;})();Scribd.jsonp=function(options){if(Object.isFunction(options.callback)){var callbackName='jsonp'+Math.floor(Math.random()*1000001);window[callbackName]=function(jsonData){options.callback(jsonData);window[callbackName]=undefined;};}else{var callbackName=options.callback;}
var url=options.url;if(options.params){var params=options.params.toQueryString()+'&callback='+callbackName;if(options.url.indexOf('?')>=0){url+=("&"+params);}else{url+=("?"+params);}}else{url+='?callback='+callbackName;}
var scriptTag=document.createElement('script');scriptTag.setAttribute('src',url);scriptTag.setAttribute('async','true');scriptTag.setAttribute('charset','utf-8')
document.documentElement.firstChild.appendChild(scriptTag);}
Scribd.addDefaultTextEvents=function(element,default_text,cb){element.addClassName('inactive');element.value=default_text;element.observe('focus',function(e){if(this.value==default_text)
this.value='';this.removeClassName('inactive');if(cb)cb(e);});element.observe('blur',function(e){if($F(element)==''){element.value=default_text;element.addClassName('inactive');}});};Scribd.enforceMaxLength=function(textarea,countDisplay,maxLength){if(textarea&&countDisplay){var updateCharCount=function(e){var val=$F(textarea);var left=maxLength-val.length;if(left<0){textarea.setValue(val.slice(0,maxLength));left=0;}
if(left==0){countDisplay.addClassName('limit_reached');}else{countDisplay.removeClassName('limit_reached');}
countDisplay.update(left);}
updateCharCount();textarea.observe('focus',updateCharCount);textarea.observe('change',updateCharCount);textarea.observe('keyup',updateCharCount);}};Scribd.JSONCookie=Class.create({initialize:function(name,jar){this.jar=jar||new CookieJar({path:'/',expires:''});this.name=name;var oldCookie=this.jar.get(name)||{};if(typeof(oldCookie)==="string")
oldCookie=oldCookie.evalJSON(true);this.store=$H(oldCookie);},set:function(k,v){return this.store.set(k,v);},unset:function(key){return this.store.unset(key);},toJSON:function(){return this.store.toJSON();},get:function(key){return this.store.get(key);},save:function(){this.jar.put(this.name,this.toJSON());}});Scribd.usernameRestriction=/[A-Za-z_0-9]/g;Scribd.restrictCharactersForUsername=function(e){if(!e)var e=window.event;if(e.keyCode)code=e.keyCode;else if(e.which)code=e.which;var character=String.fromCharCode(code);if(code==27){this.blur();return false;}
if(!e.ctrlKey&&code!=9&&code!=8&&code!=36&&code!=37&&code!=38&&(code!=39)&&code!=40&&code!=46){if(character.match(Scribd.usernameRestriction)){return true;}else{e.stop();}}};Scribd.logOn=false;Scribd.log=function(msg,obj,logger){if(!logger)
logger='log';if(Scribd.logOn&&window['console']&&window['console'][logger]){console[logger](msg);if(obj)
console[logger](obj);}};Scribd.logError=function(msg,obj){Scribd.log(msg,obj,'error');};Scribd.createCopyButton=function(container,text_field,opts){var options=Object.extend({min_version:8,bg_color:'#cccccc',width:'55',height:'25'},opts||{});options.params=Object.extend({copyTextContainerId:text_field,fontSize:11,fontFace:'Arial',fontColor:"#000000",copyText:'',imageUrl:Scribd.cdn_path+'images/buttons/copy_reg.gif'},options.params||{});$(container).addClassName('copy_button');var swf=new SWFObject(Scribd.cdn_path+'swf/CopyClipboardButton.swf?v=3.0','copy_'+text_field,options.width,options.height,options.min_version,options.bg_color);swf.addParam('flashvars',decodeURIComponent($H(options.params).toQueryString()));swf.addParam('wmode','transparent');swf.addParam('allowscriptaccess','always');swf.addParam('menu',false);swf.write(container);$(container).observe('click',function(){this.addClassName('active');Element.removeClassName.delay(2,this,'active');});};var CopyClipboardButton={getCopyText:function(a){var el=$(a);return Try.these(function(){return el.value;},function(){return el.innerText;},function(){return el.textContent;})||"";}};Scribd.absolutizeAndPad=function(id){var padding;var absolute=$(id);padding=absolute.cloneNode(false);padding.clonePosition(absolute);absolute.writeAttribute({'id':id+'_absolute'});absolute.absolutize();absolute.insert({'after':padding});console.log("Inserting Padding");var updatePosition=function(){absolute.clonePosition(padding);};Event.observe(window,'resize',updatePosition);Event.observe(document,'scribd:move_ads',updatePosition);['zoomed','viewmodeChanged','enteredFullscreen','exitedFullscreen'].each(function(which){docManager.addEvent(which,updatePosition);});};Prototype.Browser.IE6=Prototype.Browser.IE&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))==6;Prototype.Browser.IE7=Prototype.Browser.IE&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))==7;Prototype.Browser.IE8=Prototype.Browser.IE&&!Prototype.Browser.IE6&&!Prototype.Browser.IE7;Scribd.init=function(a){if(arguments.length>0){var len=arguments.length;var prev=null;for(var i=0;i<len;i++){if(arguments[i].length==0)throw"Cannot initialize an empty string";var current=prev?prev[arguments[i]]:window[arguments[i]];var base=prev?prev:window;if(!current)current=base[arguments[i]]={};prev=current;}
return current;}else{return null;}};Scribd.getOption=function(name,defaultVal){var val=window["_sbdOptions_"+name];if(typeof val==='undefined'){val=defaultVal;}
return val;};Scribd.trackSessionLength=function(category,action,label,timestamp){timestamp=timestamp||new Date();document.observe('dom:loaded',function(){timestamp=new Date();});Event.observe(window,'unload',function(){trackEvent(category,action,label,parseInt((new Date()-timestamp)/1000));});};function hideElements(selector){$$(selector).each(function(item){item.hide();})}
function trackEvent(category,action,label,value,interactive){if(typeof(interactive)!=="boolean")
interactive=true;Scribd.log('GA trackEvent: '+category+', '+action+', '+label+', '+value+', '+interactive);try{_gaq.push(['_trackEvent',category,action,label,value,!interactive]);}catch(ohNo){}}
Scribd.dynamicIncluder=(function(){function dispatchCallbacks(status){s.complete(status,loaded,errors);s[status](status=='error'?errors:loaded);clearTimeout(tTimeout);clearTimeout(cssTimeout);};function checkProgress(){if(loaded.length==files.length)Scribd.dynamicIncluder.dispatchCallbacks('success');else if(loaded.length+errors.length==files.length)Scribd.dynamicIncluder.dispatchCallbacks('error');};function addError(){errors.push(this.src);Scribd.dynamicIncluder.checkProgress();};var pub={include:function(src,callback,name){var script=$$('script[src*="'+src+'"]');if(script.length>0){var thisScript=script[0];thisScript.readAttribute('pending')?thisScript.observe('dynamicloader:scriptload',callback):callback();return;};var s=new Element('script',{"type":"text/javascript","src":src,"id":name,"pending":1});if(Prototype.Browser.Gecko){s.onerror=this.addError;}
s.observe('dynamicloader:scriptload',function(){$(this).writeAttribute('pending',null);callback();setTimeout(function(){s.stopObserving('dynamicloader:scriptload');},10);});var done=false;s.onload=s.onreadystatechange=function(){if(!done&&(!this.readyState||/loaded|complete/.test(this.readyState))){done=true;s.onload=s.onreadystatechange=null;s.fire('dynamicloader:scriptload');};};document.getElementsByTagName("head")[0].appendChild(s);}};return pub;})();


/* public/javascripts/global/browser_detect.js @ 1339185887 */

Scribd.BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS";},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1)
return data[i].identity;}
else if(dataProp)
return data[i].identity;}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1)return;return parseFloat(dataString.substring(index+this.versionSearchString.length+1));},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};Scribd.BrowserDetect.init();


/* public/javascripts/document_url.js @ 1339185887 */

if(!window.Scribd)var Scribd=new Object();Scribd.DocumentUrl={urlByDocId:function(doc_id,options){if(!options)options={};var host=options.env=="production"?"scribd.com":window.location.hostname;var port=options.env=="production"?80:window.location.port;var url="/doc/"+doc_id;if(!options.relative_path){if(port&&port!=80&&port!=443)
port=":"+port;else
port="";url="http://"+host+port+url;}
if(options.slag)
url+="/"+options.slag;if(options.secret_password&&options.secret_password.length>0)
url+="?secret_password="+options.secret_password;return url;}};


/* public/javascripts/lightbox.js @ 1339185887 */

if(!window.Scribd)var Scribd=new Object();Scribd.Lightbox=(function(){function center(id,topOffset){if(typeof topOffset=="undefined"){topOffset=0;}
if((id=='toolbar_download_lightbox')||(id=='premium_download')||(id=='premium_credit_card_flow')){var container=$('viewer')||$('content_wrap');c_w=container.getWidth();c_offsets=container.cumulativeOffset();c_left_offset=c_offsets[0];el_w=$(id).getWidth();left=c_left_offset+Math.round((c_w-el_w)/2);}else{el_w=$(id).getWidth();view_w=document.viewport.getWidth();left=Math.round((view_w-el_w)/2);}
if(left<0){left=0;}
$(id).style.left=left+'px';if(topOffset>=0){$(id).style.top=(document.viewport.getScrollOffsets().top+70+topOffset)+'px';}}
return{center:center,current_open:null,isOpen:function(){return this.current_open!==null;},current:function(){return $(this.current_open);},initialize:function(options){document.observe('keydown',function(e){if(Event.KEY_ESC==e.keyCode){this.close(this.current_open);}}.bind(this));if(options){iframeShim=options.iframeShim;}else{iframeShim=null;}
document.observe('dom:loaded',function(){this.overlay=$('overlay');if(!this.overlay){document.body.appendChild(new Element('div',{'id':'overlay',style:'display: none;'}));this.overlay=$('overlay');}
this.overlay.observe("click",function(){if($(this.current_open).down(".close_button")){this.close(this.current_open);}}.bind(this));document.observe("click",function(e){if(e.findElement(".lightbox .close_button")||e.findElement(".lightbox .close_link")){this.closeHandler(e);}}.bind(this));}.bind(this));},create:function(id,options){if($(id))this.destroy(id);var options=Scribd.Options({style:'normal',close:false},options);if(options.style=='tight'){var content_class='content content_tight';}else{var content_class='content';}
element_style='display:none';if(options.width){element_style+=';width:'+options.width+'px';}
var contents='<div class="'+content_class+'"></div><div class="footer"></div>';if(options.title){contents='<div class="title">'+options.title+'</div>'+contents;}
if(options.close){contents='<div class="close_button"></div>'+contents;}
contents='<div class="wrapper">'+contents+'</div>';document.body.appendChild(new Element('div',{'class':'lightbox',id:id,style:element_style}).update(contents));},setTitle:function(id,title){var node=$(id).down(".title");if(!node){node=new Element("div",{"class":"title"});$(id).down(".close_button").insert({after:node});}
node.update(title);},update:function(id,content){$(id).down('.content').update(content).fire("Scribd:dom_updated");},set_content_style_class:function(id,style){if(style=='normal')
$(id).down('.content').removeClassName('content_tight').fire("Scribd:dom_updated");if(style=='tight')
$(id).down('.content').addClassName('content_tight').fire("Scribd:dom_updated");},insert:function(id,content){$(id).down('.content').insert(content).fire("Scribd:dom_updated");},showOverlay:function(){if(!this.overlay.visible()){this.overlay.show();}},hideOverlay:function(){if(this.overlay.visible()){this.overlay.hide();}},getStemOffset:function(id){var stem=$(id).select('.tooltip_stem')[0];var stem_size=stem.getDimensions();var box_position=$(id).cumulativeOffset();var stem_position=stem.cumulativeOffset();return{left:stem_position.left+Math.round(stem_size.width/2)-box_position.left,top:stem_position.top+stem_size.height-box_position.top};},open:function(id,topOffset,stemPosition){var tooltip_style=$(id).hasClassName('tooltip_lightbox');if(!tooltip_style){this.showOverlay();}
if(id==this.current_open){return;}
this.close(this.current_open,true);if(tooltip_style){var old_left=$(id).style.left;$(id).style.left='-9999px';$(id).show();var stemOffset=this.getStemOffset(id);var left=(stemPosition.left-stemOffset.left);var top=(stemPosition.top-stemOffset.top);if(left<0){var stem=$(id).select('.tooltip_stem')[0];stem.style.left=left+'px';left=0;}
$(id).hide();$(id).style.left=left+'px';$(id).style.top=top+'px';}else{center(id,topOffset);}
this.id=id;$(id).appear({duration:0.2});this.current_open=id;$(document).fire('lightbox:open');},show_loading_lightbox:function(id,opts){id=id||"loading";this.create(id,opts);this.update(id,'<div class="spinner_container"><img src="/images/spinner_large_mac_white.gif?1339185887" /></div>');this.open(id,75);},remoteOpen:function(id,url,params,create_options){var params=Scribd.Options({lightbox:true,method:'post'},params);var create_options=Scribd.Options({},create_options);var method=params.method;delete params.method;this.show_loading_lightbox(id,create_options);new Ajax.Request(url,{parameters:params,method:method,evalScripts:true,requestHeaders:{Accept:'application/json'},onSuccess:function(t){var r=t.responseJSON;if(r.content_style_class)
this.set_content_style_class(id,r.content_style_class);if(r.content){this.update(id,r.content);center(id,-1);}
if(r.title){this.setTitle(id,r.title);}
if(r.redirect){Scribd.Lightbox.remoteOpen(id,r.redirect,{},create_options);}}.bind(this)});},secureIframeOpen:function(id,url,options,create_options){var create_options=Scribd.Options({},create_options);var options=Scribd.Options({showLoading:true},options);this.create(id,create_options);var container=new Element('div',{'class':'iframe_container'});this.insert(id,container);var remote=options.remoteUrl?options.remoteUrl:(url.protocol()+'//'+url.domain());var intermediaryUrl=remote+'/easyxdm/intermediary.html#url='+encodeURIComponent(url)+'&showLoading='+(options.showLoading?'1':'0');new easyXDM.Socket({remote:intermediaryUrl,remoteHelper:remote+"/easyxdm/name.html",local:"/easyxdm/name.html",container:container,props:{frameborder:0,border:0,scrolling:'no'},onMessage:function(message,origin){var args=message.split(' ');message=args.shift();if(message=='open'){Scribd.Lightbox.open(args[0],75);}else if(message=='close'){this.close();}else if(message=='resize'){container.down('iframe').style.height=args[0]+"px";}else if(options.onMessage){options.onMessage(message,origin);}}.bind(this)});if(options.height)
container.down('iframe').style.height=options.height+'px';this.open(id,75);},close:function(id,keep_overlay){var lb=id?$(id):$(this.current_open);if(lb&&lb.visible()){lb.fade({duration:0.1});this.current_open=null;document.fire('lightbox:closed',{'lightbox_id':lb.id});if(!keep_overlay)this.hideOverlay();}},toggle:function(id,topOffset,stemPosition){var lb=$(id);if(lb.visible())
this.close(id);else
this.open(id,topOffset,stemPosition);},closeHandler:function(e){e.stop();var lb=e.element().up('.lightbox');if(lb)Scribd.Lightbox.close(lb.id);},destroy:function(id){if($(id)){this.close(id);$(id).remove();}}}})();


/* public/javascripts/doc_cell.js @ 1339185887 */
var lzy_js_public_javascripts_doc_cell="\nScribd.DocumentCell=Class.create({initialize:function(data){this.doc=data;},render:function(template){var template_name_and_control=template.split(\'.\');var template_name=template_name_and_control[0];var control=template_name_and_control[1];return Scribd.DocumentCell.templates[template_name].template.evaluate(this[template_name+\'_template_data\'](control));},collection_template_data:function(control){return({doc_id:this.doc.id,doc_title:this.doc.title,doc_url:this.doc.url,doc_page_count:this.doc.page_count,doc_description:this.doc.description.truncate(270),doc_thumbnail_url:this.doc.thumbnail_small_url,doc_views:this.doc.views,doc_created_on:this.doc.created_on,doc_category:this.doc.category&&this.doc.category.name&&[\'<li class=\"category\"><span class=\"metadata_label\">Category:<\/span><a href=\"\',this.doc.category.url+\'\">\',this.doc.category.name+\'<\/a><\/li>\'].join(\'\'),user_url:this.doc.user.url,user_login:this.doc.user.login,doc_price:this.doc.price&&(\'<li class=\"price\"><span class=\"price\">\'+this.doc.price+\'<\/span><\/li>\'),doc_readcasts:this.doc.readcasts,control:Scribd.DocumentCell.templates.collection.controls[control]});},collection_old_template_data:function(control){return({doc_id:this.doc.id,doc_title:this.doc.title,doc_url:this.doc.url,doc_page_count:this.doc.page_count,doc_description:this.doc.description.truncate(270),doc_thumbnail_url:this.doc.thumbnail_url,doc_views:this.doc.views,doc_created_on:this.doc.created_on,doc_category:this.doc.category&&this.doc.category.name&&[\'<li class=\"category\"><span class=\"metadata_label\">Category:<\/span><a href=\"\',this.doc.category.url+\'\">\',this.doc.category.name+\'<\/a><\/li>\'].join(\'\'),user_url:this.doc.user.url,user_login:this.doc.user.login,doc_price:this.doc.price&&(\'<li class=\"price\"><span class=\"price\">\'+this.doc.price+\'<\/span><\/li>\'),control:Scribd.DocumentCell.templates.collection_old.controls[control]});}});Scribd.DocumentCell.templates={collection:{controls:{add_document:\'<a href=\"#\" class=\"add_document\"> <\/a>\',remove_document:\'<a href=\"#\" class=\"subtle_close_button destroy\"> <\/a>\'},template:new Template(\'\\\n<div class=\"document_mixed document_summary document_#{doc_id}\">\\\n  <div class=\"document_thumbnail\">\\\n    <div class=\"document_thumbnail_shadow gainlayout\">\\\n      <a href=\"#{doc_url}\">\\\n        <div class=\"thumbnail\">\\\n          <img src=\"#{doc_thumbnail_url}\">\\\n          <span class=\"no_of_pages\">#{doc_page_count} p.<\/span>\\\n        <\/div>\\\n      <\/a>\\\n    <\/div>\\\n  <\/div>\\\n  <div class=\"document_body\">\\\n    <h4 class=\"document_title\">\\\n      <a class=\"name_link\" href=\"#{doc_url}\">#{doc_title}<\/a>\\\n    <\/h4>\\\n    <p class=\"document_description\">#{doc_description}<\/p>\\\n    <p class=\"document_attrition\">\\\n      <span>From: <\/span>\\\n      <a href=\"#{user_url}\" class=\"username\">#{user_login}<\/a>\\\n    <\/p>\\\n  <\/div>\\\n  <div class=\"right_toolbar\">#{control}<\/div>\\\n  <ul class=\"document_meta pills\">\\\n    <li class=\"meta_node top\">\\\n      <label>Reads:<\/label>\\\n      <strong>#{doc_views}<\/strong>\\\n      <div class=\"clearfix\"><\/div>\\\n    <\/li>\\\n    <li class=\"meta_node\">\\\n      <label>Readcasts:<\/label>\\\n      <strong>#{doc_readcasts}<\/strong>\\\n      <div class=\"clearfix\"><\/div>\\\n    <\/li>\\\n    <li class=\"meta_node bottom\">\\\n      <label>Uploaded:<\/label>\\\n      <strong>#{doc_created_on}<\/strong>\\\n      <div class=\"clearfix\"><\/div>\\\n    <\/li>\\\n  <\/ul>\\\n  <div class=\"clearfix\"><\/div>\\\n<\/div>\\\n\')},collection_old:{controls:{add_document:\'<a href=\"#\" class=\"add_document\"> <\/a>\',remove_document:\'<a href=\"#\" class=\"close_button destroy\"> <\/a>\'},template:new Template(\'\\\n<div class=\"document_summary document_#{doc_id}\">\\\n    <div class=\"clearfix\">\\\n        <div class=\"right_toolbar\">\\\n            #{control}\\\n        <\/div>\\\n        <input type=\"hidden\" class=\"confirmation\" name=document_ids[] value=\"#{doc_id}\" />\\\n        <div class=\"document_thumbnail_shadow\">\\\n            <a href=\"#{doc_url}\">\\\n                <div class=\"thumbnail\">\\\n                    <img src=\"#{doc_thumbnail_url}\">\\\n                    <span class=\"no_of_pages\">#{doc_page_count} p.<\/span>\\\n                <\/div>\\\n            <\/a>\\\n        <\/div>\\\n        <div class=\"summary clearfix\">\\\n            <h5> \\\n                <a href=\"#{doc_url}\">#{doc_title}<\/a>\\\n            <\/h5>\\\n            <div class=\"description\">\\\n                #{doc_description}\\\n            <\/div>\\\n            <ul class=\"stats_bottom\">\\\n                <div class=\"left_column\">\\\n                    #{doc_price}\\\n                    <li class=\"user\">\\\n                        <span class=\"metadata_label\">From:<\/span>\\\n                        <a class=\"username\" href=\"#{user_url}\">#{user_login}<\/a>\\\n                    <\/li>\\\n                    <li class=\"created_at\">\\\n                        <span class=\"metadata_label\">Uploaded:<\/span> #{doc_created_on}\\\n                    <\/li>\\\n                    <li class=\"views\">\\\n                        <span class=\"metadata_label\">Reads:<\/span> #{doc_views}\\\n                    <\/li>\\\n                    #{doc_category}\\\n                <\/div>\\\n            <\/ul>\\\n        <\/div>\\\n    <\/div>\\\n<\/div>\\\n\')}};";


/* public/javascripts/cookiejar.js @ 1339185887 */

var CookieJar=Class.create();CookieJar.prototype={appendString:"__CJ_",initialize:function(options){this.options={expires:3600,path:'',domain:'',secure:''};Object.extend(this.options,options||{});if(this.options.expires!=''){var date=new Date();date=new Date(date.getTime()+(this.options.expires*1000));this.options.expires='; expires='+date.toGMTString();}
if(this.options.path!=''){this.options.path='; path='+escape(this.options.path);}
if(this.options.domain!=''){this.options.domain='; domain='+escape(this.options.domain);}
if(this.options.secure=='secure'){this.options.secure='; secure';}else{this.options.secure='';}},put:function(name,value){name=this.appendString+name;cookie=this.options;var type=typeof value;switch(type){case'undefined':case'function':case'unknown':return false;case'boolean':case'string':case'number':value=String(value.toString());}
var cookie_str=name+"="+escape(Object.toJSON(value));try{document.cookie=cookie_str+cookie.expires+cookie.path+cookie.domain+cookie.secure;}catch(e){return false;}
return true;},remove:function(name){name=this.appendString+name;cookie=this.options;try{var date=new Date();date.setTime(date.getTime()-(3600*1000));var expires='; expires='+date.toGMTString();document.cookie=name+"="+expires+cookie.path+cookie.domain+cookie.secure;}catch(e){return false;}
return true;},get:function(name){name=this.appendString+name;var cookies=document.cookie.match(name+'=(.*?)(;|$)');if(cookies){return(unescape(cookies[1])).evalJSON();}else{return null;}},empty:function(){keys=this.getKeys();size=keys.size();for(i=0;i<size;i++){this.remove(keys[i]);}},getPack:function(){pack={};keys=this.getKeys();size=keys.size();for(i=0;i<size;i++){pack[keys[i]]=this.get(keys[i]);}
return pack;},getKeys:function(){keys=$A();keyRe=/[^=; ]+(?=\=)/g;str=document.cookie;CJRe=new RegExp("^"+this.appendString);while((match=keyRe.exec(str))!=undefined){if(CJRe.test(match[0].strip())){keys.push(match[0].strip().gsub("^"+this.appendString,""));}}
return keys;}};


/* public/javascripts/login.js @ 1339185887 */

if(!window.Scribd)var Scribd=new Object();Scribd.loginManager=Class.create({initialize:function(options){this.hasFBCallback=false;this.options=options||{};this.lightbox_id="login_lb";this.explanations={premium_reader:'',follow:'to Subscribe to This User',comment:'to Scribble a Comment',readcast:'to Readcast',download:'to Download a Document',discussion:'to Participate in This Discussion',add_to_collections:'to Add to Collections',join:'',upload:'to Publish Your Documents',view_purchased_document:'to View Your Purchased Document',status_reply:'to Reply Status Messages',comment_reply:'to Reply to this Comment',rate:'to Rate this Document',trial:'to Start Your Free Trial',view_mode:"to Change View Mode"};this.explanationBase="You Must be Logged in ";this.after_facebook_signup_url='/login/signup_success';this.after_facebook_login_url='/login/callbacks';this.container=$(this.options.container?this.options.container:this.lightbox_id)
this.login_form=this.container.down('.global_login_form');this.signup_form=this.container.down('.global_signup_form');this.login_header=this.container.down('.login_lb_header');this.signup_header=this.container.down('.signup_header');this.login_section=this.container.down('.login_section');this.signup_toggle=this.container.down('.signup_toggle');this.login_toggle=this.container.down('.login_toggle');this.setEvents();},setTitle:function(title){Scribd.Lightbox.setTitle(this.lightbox_id,title);},setEvents:function(){var submit_listener=this.sendForm.bindAsEventListener(this);this.container.select(".lightbox_form").each(function(elm){elm.onsubmit=function(e){Event.stop(e||window.event);submit_listener(e);return false;}},this);if(this.signup_toggle){this.signup_toggle.down('a').observe('click',function(e){e.stop();e.element().up().toggleClassName('open');this.signup_form.toggle();}.bind(this));}
if(this.login_toggle){this.login_toggle.down('a').observe('click',function(e){e.stop();e.element().up().toggleClassName('open');this.login_form.toggle();}.bind(this));}},defaultExplanation:function(context){switch(context){case'join':return'Sign Up';default:return'Log In';}},sendForm:function(e){Event.stop(e);Scribd.Remote.Form(Event.element(e));},checkField:function(url,el){var name=Element.readAttribute(el,'name');var name_parsed=name.match(/\[([a-z_]+)\]/i);if(name_parsed.length>1)
name=name_parsed[1];var value=$F(el);if(value)
new Ajax.Request(url,{asynchronous:true,evalScripts:true,parameters:name+'='+escape(value)});},open:function(options){if(this.login_form){if(options.context=='join'){this.login_toggle.hide();}else{this.login_toggle.show();}
this.login_form.down('.hidden').update('');this.signup_form.down('.hidden').update('');$H(options).each(function(pair){var input=new Element('input',{'type':'hidden','value':pair.value,'name':'login_params['+pair.key+']'});this.login_form.down('.hidden').appendChild(input);this.signup_form.down('.hidden').appendChild(input.cloneNode(true));$('login_lb').select('.login_add_hidden_form_fields_for_options').each(function(e){e.appendChild(input.cloneNode(true));});}.bind(this));var exp=this.explanations[options.context];if(exp){exp=this.explanationBase+exp;}else{exp=this.defaultExplanation(options.context);}
this.setTitle(exp);Scribd.Lightbox.open('login_lb');this.hasFBCallback=true;this.callbackFBFunction=function(new_user){if(new_user){var url=this.after_facebook_signup_url;}else{var url=this.after_facebook_login_url;}
new Ajax.Request(url,{method:'post',parameters:options,asynchronous:true,evalScripts:true});}.bind(this);}},callbackFB:function(new_user){var cookie=new Scribd.JSONCookie('session_metadata');if(cookie.get('denied_IC')){cookie.unset('denied_IC');cookie.save();}
if(this.hasFBCallback){this.callbackFBFunction(new_user);}else{window.location.reload();}}});


/* public/javascripts/rat.js @ 1339185887 */

var RAT_API_VERSION='2';var ratInit=(function(){function getRandomInt(min,max){return Math.floor(Math.random()*(max-min+1))+min;}
var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(input){var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;input=Base64._utf8_encode(input);while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64;}else if(isNaN(chr3)){enc4=64;}
output=output+
this._keyStr.charAt(enc1)+this._keyStr.charAt(enc2)+
this._keyStr.charAt(enc3)+this._keyStr.charAt(enc4);}
return output;},_utf8_encode:function(string){string=string.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c);}
else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128);}
else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128);}}
return utftext;}};function jsonp(url,callback){var head=document.getElementsByTagName('head')[0];var newScript=document.createElement('script');var callbackName='jsonp'+getRandomInt(0,1000000);window[callbackName]=function(data){callback(data[0]);window[callbackName]=undefined;};var newurl=url.replace(/(.*\?.*)(\?)/,'$1'+callbackName);newScript.src=newurl;newScript.async=true;newScript.defer='defer';head.appendChild(newScript);return newScript;}
function now(){return(new Date()).getTime()/1000.0;}
function encodeObj(raw_args){var args=[];for(var k in raw_args){if(raw_args.hasOwnProperty(k)){var v=raw_args[k];if(v===undefined){v=null;}
v=Base64.encode(Object.toJSON(v));args.push(k+'='+encodeURIComponent(v));}}
return args.join('&');}
function addListener(el,e,f){if(el.addEventListener){el.addEventListener(e,f,false);}else if(el.attachEvent){el.attachEvent('on'+e,f);}}
function removeListener(el,e,f){if(el.removeEventListener){el.removeEventListener(e,f,false);}else if(el.detachEvent){el.detachEvent('on'+e,f);}}
function Rats(hosts,otherData){this.hosts=hosts;this.es=[];this.vs=[];this.ts=[];this.otherData=otherData;this._flushTimeoutId=null;this.lastPing=null;this.numPings=0;this.dhost=this._randHost()+RAT_API_VERSION+'/';}
Rats.prototype.start=function(){var self=this;this._getVid();addListener(window,'load',function(){self.docLoaded=true;});function unloadf(){if(self.lps){self.lps.parentElement.removeChild(self.lps);delete self.lps;self.lps=null;}
self.logEvent('dom.window.beforeunload');self.flushEvents(true);}
this.unloadf=unloadf;addListener(window,'beforeunload',unloadf);};Rats.prototype._getVid=function(callback){var url=this.dhost+'getvid.jsonp?callback=?&'+
encodeObj({l:location.href,r:(document.referrer||document.referer||null),ea:this.otherData,ubtc:this._getUBTC()});var self=this;jsonp(url,function(data){if(data.status!='success'){self.disable();return;}
self.vid=data.vid;self.lastFlushed=now();self._setupPing();self.logTimeoutLen=data.logTimeoutLen;if(callback){callback(self.vid);}});};Rats.prototype._setupPing=function(){if(this.disabled()){return;}
if(this._pingSetup){return;}
this._pingSetup=true;var self=this;function ping(){self.lastPing=now();self.numPings+=1;self._pingSetup=false;self._startFlushTimeout();removeListener(document,'mousemove',ping);setTimeout(function(){self._setupPing();},1000.0);}
addListener(document,'mousemove',ping);};Rats.prototype._resetBuffers=function(){this.es=[];this.ts=[];this.vs=[];this.lastFlushed=this.lastPing;this.lastPing=null;this.numPings=0;this._clearFlushTimeout();};Rats.prototype._getUBTC=function(){this._ubtc=this._ubtc||document.cookie.replace(/; */g,'&').parseQuery().scribd_ubtc;return this._ubtc;};Rats.prototype.flushEvents=function(useImg,callback){if(this.disabled()){return;}
var args=encodeObj({es:this.es,ts:this.ts,vs:this.vs,n:now(),lp:this.lastPing,np:this.numPings,ubtc:this._getUBTC()});this._resetBuffers();var self=this;if(useImg){var i=new Image();i.src=this.dhost+this.vid+'/de.png?rand='+getRandomInt(0,100000)+'&'+args;document.body.appendChild(i);}else{jsonp(this.dhost+this.vid+'/de.jsonp?callback=?&'+args,function(data){if(data.status=='success'){if(callback){callback();}}else{self.disable();}});}};Rats.prototype.logEvent=function(e,v){if(this.disabled()){return;}
var n=now();this.lastPing=n;v=v||null;this.es.push(e);this.vs.push(v);this.ts.push(n);this._startFlushTimeout();};Rats.prototype.l=Rats.prototype.logEvent;Rats.prototype._startFlushTimeout=function(){if(this.disabled()){return;}
if(this._flushTimeoutId!==null||!this.logTimeoutLen){return;}
var self=this;this._flushTimeoutId=window.setTimeout(function(){self.flushEvents(false,function(){self._setupPing();});},this._getTimeoutLen());};Rats.prototype._getTimeoutLen=function(){return this.logTimeoutLen-((now()-this.lastFlushed)*1000.0);};Rats.prototype._clearFlushTimeout=function(){if(this._flushTimeoutId===null){return;}
window.clearTimeout(this._flushTimeoutId);this._flushTimeoutId=null;};Rats.prototype._randHost=function(urlSuffix){urlSuffix=urlSuffix||'';return this.hosts[getRandomInt(0,this.hosts.length-1)]+urlSuffix;};Rats.prototype.disable=function(){this._disabled=true;if(this.unloadf){removeListener(window,'beforeunload',this.unloadf);}};Rats.prototype.disabled=function(){return this._disabled;};Rats.prototype.root=function(){return this;};function makeScope(parent,prefix){function RatScope(e,v){if(prefix){e=prefix+'.'+e;}
parent.logEvent(e,v);}
RatScope.logEvent=RatScope;RatScope.parent=parent;RatScope.root=function(){return parent.root();};RatScope.disable=function(){parent.disable();};RatScope.disabled=function(){return parent.disabled();};RatScope.s=function(prefix){return makeScope(RatScope,prefix);};RatScope.o=function(element,domEvent,logEventNameOrFunction,maxTimes,fireTimeout){maxTimes=maxTimes||-1;fireTimeout=fireTimeout||1000;if(RatScope.disabled()){return;}
var isSetUp=false;function setUp(){if(isSetUp){return;}else{isSetUp=true;}}
isSetUp=true;var self=this;function fire(e){if(!e){e=window.event;}
if(logEventNameOrFunction instanceof Function){RatScope.logEvent(logEventNameOrFunction.call(this,e));}else{RatScope.logEvent(logEventNameOrFunction);}
removeListener(element,domEvent,fire);maxTimes-=1;if(maxTimes==-1||maxTimes>0){setTimeout(function(){setUp();},fireTimeout);}}
addListener(element,domEvent,fire);};return RatScope;}
return function(ratHosts,otherData,disabled){var r=new Rats(ratHosts,otherData);if(disabled){r.disable();}else{r.start();}
return makeScope(r);};})();


/* public/javascripts/perf.js @ 1339185887 */

Scribd.Perf=Class.create({initialize:function(){this.reported_stats=false;},addListener:function(el,e,f){if(el.addEventListener){el.addEventListener(e,f,false);}else if(el.attachEvent){el.attachEvent('on'+e,f);}},recordPerceivedLoadTime:function(t){if($rat&&window.performance&&window.performance.timing){$rat("perceivedLoadTime",t);}},recordPerf:function(e){if($rat&&window.performance&&window.performance.timing&&!this.reported_stats){var objToLog={};var timingObj=window.performance.timing;var values_to_report=['navigationStart','unloadEventStart','unloadEventEnd','redirectStart','redirectEnd','fetchStart','domainLookupStart','domainLookupEnd','connectStart','connectEnd','secureConnectionStart','requestStart','responseStart','responseEnd','domLoading','domInteractive','domContentLoadedStart','domContentLoadedEnd','domComplete','loadEventStart','loadEventEnd','domContentLoadedEventStart','domContentLoadedEventEnd'];for(var i=0;i<values_to_report.length;i++){var k=values_to_report[i];if((typeof timingObj[k]!="undefined")){objToLog[k]=timingObj[k];}else{objToLog[k]=0;}}
if(objToLog['domContentLoadedStart']==0&&objToLog['domContentLoadedEventStart']!=0){objToLog['domContentLoadedStart']=objToLog['domContentLoadedEventStart'];delete objToLog['domContentLoadedEventStart'];}
if(objToLog['domContentLoadedEnd']==0&&objToLog['domContentLoadedEventEnd']!=0){objToLog['domContentLoadedEnd']=objToLog['domContentLoadedEventEnd'];delete objToLog['domContentLoadedEventEnd'];}
if(e=="onload"){if(objToLog['loadEventEnd']==0){objToLog['loadEventEnd']=(new Date()).getTime();}}
$rat('window.performance.timing',objToLog);if(e&&e.type=="beforeunload"&&objToLog['loadEventEnd']==0){$rat('bouncedBeforeOnload',true);}
this.reported_stats=true;}},registerOnbeforeunload:function(){this.addListener(window,'beforeunload',this.recordPerf);},registerOnload:function(){var recordPerfFunc=this.recordPerf;if(window.onload!=null){var oldOnLoad=window.onload;window.onload=function(e){oldOnLoad(e);var func=function(){recordPerfFunc("onload");};func.defer();};}else{window.onload=function(){recordPerfFunc("onload");};};}});


/* public/javascripts/perf_analytics.js @ 1339185887 */

function trackPerfAnalytics(pageTracker,perfStart,perfEnd,total){var category=total?'Page Load':'DOM Load';var perfTime=perfEnd.getTime()-perfStart.getTime();var range;if(perfTime<1000)
range='less than 1s';else if(perfTime<2000)
range='less than 2s';else if(perfTime<5000)
range='less than 5s';else if(perfTime<10000)
range='less than 10s';else if(perfTime<30000)
range='less than 30s';else if(perfTime<45000)
range='less than 45s';else
range='more than 45s';var path=document.location.pathname;if(document.location.search)
path+=document.location.search;try{if(pageTracker){pageTracker._trackEvent(category,range,path,Math.round(perfTime/100));}else{_gaq.push(['pageTrackerPerf._trackEvent',category,range,path,Math.round(perfTime/100)]);}}catch(err){}}


/* public/javascripts/4gen_in_doc_search.js @ 1339185887 */

Scribd.init('Scribd','Annotation');Scribd.init('Scribd','Fourgen');Scribd.init('Scribd','DOM');Scribd.Fourgen.DocSearcher=Class.create({initialize:function(options){var doc_id=options.doc_id,upload_id=options.upload_id,secret_password=options.secret_password;var that=this;this.cache=new Scribd.Fourgen.DocSearcher.Cache(function(query,dataHandler){var cache=this;Scribd.Fourgen.DocSearcher.remote_search({'query':query,'doc_id':doc_id,'upload_id':upload_id,'secret_password':secret_password,success:function(data){if(data){cache.set(query,data);dataHandler(data);that.trackEvent('result.success',data.length);}else{cache.set(query,null);that.trackEvent('result.null');}},failure:function(error){cache.set(query,false);dataHandler(false);that.trackEvent('result.failed');}});});this.queryHistory=[];this.queryHistoryIndex=0;},search:function(query,resultHandler){this.queryHistory.push(query);this.queryHistoryIndex=this.queryHistory.length-1;this.trackEvent('submit');this.cache.fetch(query,resultHandler);},trackEvent:function(eventName,extra){if(window.$rat){if(this.currentQuery()){var eventData=[this.queryHistoryIndex,this.currentQuery()];if(extra!==undefined){eventData.push(extra);}
$rat('fourgen.toolbar.search.'+eventName,eventData);}}},currentResults:function(){return this.cache.get(this.currentQuery());},currentQuery:function(){return this.queryHistory[this.queryHistoryIndex];},setCurrentQueryTo:function(position){if(position>=0&&position<this.queryHistory.length){this.queryHistoryIndex=position;}},pastQueries:function(n){var historyLength=this.queryHistory.length,queries=[];n=Math.min(n||10,historyLength);for(var i=1;i<=n;i++){var position=historyLength-i;queries.push({'position':position,'query':this.queryHistory[position]});}
return queries;}});Scribd.Fourgen.DocSearcher.BASE_URL="/search-4gen";Scribd.Fourgen.DocSearcher.remote_search=function(options){var params={'query':options.query,'wordUploadId':options.upload_id,'wordDocumentId':options.doc_id};if(options.secret_password)
params.secretPassword=options.secret_password;new Ajax.Request(Scribd.Fourgen.DocSearcher.BASE_URL,{parameters:params,method:'get',onSuccess:options.success&&function(resp){options.success(resp.responseJSON);},onFailure:options.failure});};Scribd.Fourgen.DocSearcher.Cache=Class.create({initialize:function(missHandler){this.cache={};this.missHandler=missHandler.bind(this);},fetch:function(key,dataHandler){var data=this.get(key);if(data===undefined){this.missHandler(key,dataHandler);}else{dataHandler(data);}},get:function(key){return this.cache[this._normalizedKey(key)];},set:function(key,data){this.cache[this._normalizedKey(key)]=data;},_normalizedKey:function(key){if(key)
return key.toUpperCase();return key;}});Scribd.Annotation.highlightText=function(node,text,highlightClass){var highlightClass=highlightClass||'fourgen_highlight';var highlighted=0;var highlight=function(node){var skip=0;if(node.nodeType==3){var pos=node.data.toUpperCase().indexOf(text.toUpperCase());if(pos>=0){var span_node=document.createElement('span');span_node.className=highlightClass;var found=node.splitText(pos);found.splitText(text.length);var found_clone=found.cloneNode(true);span_node.appendChild(found_clone);found.parentNode.replaceChild(span_node,found);skip=1;highlighted++;}}else if(node.nodeType==1&&node.childNodes&&!/(script|style)/i.test(node.tagName)){if(node.className?node.className.indexOf(highlightClass)<0:true){for(var i=0;i<node.childNodes.length;++i)
i+=highlight(node.childNodes[i]);}else{highlighted++;}}
return skip;};highlight(node);return highlighted;};Scribd.Annotation.removeHighlight=function(highlightSelector){var highlightSelector=highlightSelector||'.fourgen_highlight'
$$(highlightSelector).each(function(e){var parent=e.parentNode;parent.replaceChild(e.firstChild,e);parent.normalize();});};Scribd.DOM.scaledCumulativeOffset=function(element){if(Prototype.Browser.IE){Scribd.DOM.scaledCumulativeOffset=function(elem){var top=0,left=0;do{var scale=parseFloat(elem.getStyle('zoom'))/100;if(scale){top*=scale;left*=scale;}
top+=elem.offsetTop;left+=elem.offsetLeft;elem=elem.offsetParent;}while(elem);return Element._returnOffset(left,top);}}else if(Prototype.Browser.WebKit||Prototype.Browser.Gecko){var transformStyle=Prototype.Browser.WebKit?'-webkit-transform':'-moz-transform';Scribd.DOM.scaledCumulativeOffset=function(elem){var top=0,left=0,transformParser=new RegExp("scale\\(([0-9\\.]+)\\)|matrix\\(([0-9\\.]+,)");do{var matchedScale=transformParser.exec(Element.getStyle(elem,transformStyle));if(matchedScale&&matchedScale.length>1){var scale=parseFloat(matchedScale[1]||matchedScale[2]);top*=scale;left*=scale;}
top+=elem.offsetTop;left+=elem.offsetLeft;elem=elem.offsetParent;}while(elem);return Element._returnOffset(left,top);}}else{Scribd.DOM.scaledCumulativeOffset=Element.cumulativeOffset;}
return Scribd.DOM.scaledCumulativeOffset(element);};


/* public/javascripts/document_collections_manager.js @ 1339185887 */
var lzy_js_public_javascripts_document_collections_manager="\nScribd.DocumentCollectionsManager={docs_in_collections:{},docs:{},loadPageForDocument:function(doc_id,page,collections_container,progress_indicator){progress_indicator.show();var M=Scribd.DocumentCollectionsManager;if(!M.docs_in_collections[doc_id]){M.docs_in_collections[doc_id]={}};M.getCollectionsForDocument(doc_id,page,{onSuccess:function(data){M.storeCollections(doc_id,data.collections);collections_container.update(M.renderCollectionsIn(doc_id,data));M.attachEvents(doc_id,collections_container.select(\'li.document_collection\'));},onComplete:function(){progress_indicator&&progress_indicator.hide();},onCreate:function(){progress_indicator&&progress_indicator.show();}});},getCollectionsForDocument:function(doc_id,page,callbacks){var collections=[];new Ajax.Request(\'/my_document_collections.json\',{parameters:{view:\'add_document_to_collections\',document_id:doc_id,\'page\':page},method:\'get\',onCreate:callbacks.onCreate,onComplete:callbacks.onComplete,onFailure:callbacks.onFailure,onSuccess:function(response){callbacks.onSuccess(response.responseJSON);}});},storeCollections:function(doc_id,collections){var M=Scribd.DocumentCollectionsManager;collections=$A(collections);collections.select(function(collection){return collection.selected==\'1\';}).each(function(collection){M.docs_in_collections[doc_id][collection.id]=true;});},attachEvents:function(doc_id,collection_containers){var M=Scribd.DocumentCollectionsManager;collection_containers.each(function(container){M.attachEvent(doc_id,container);});},attachEvent:function(doc_id,container){var M=Scribd.DocumentCollectionsManager;var collection_id=container.getAttribute(\'data-document_collection_id\');var checkbox=container.down(\'input\');var loader=container.down(\'.status_loader\');container.observe(\'click\',function(e){e.stop();if(M.docs_in_collections[doc_id][collection_id]){var action=\'/remove_document\';var http_method=\'delete\';}else{var action=\'/add_document\';var http_method=\'post\';}\nnew Ajax.Request(\'/document_collections/\'+collection_id+action,{parameters:{document_id:doc_id},method:http_method,onCreate:function(){loader.show();checkbox.hide();},onComplete:function(){loader.hide();checkbox.show();},onSuccess:function(response){var result=response.responseJSON;if(result&&result.added){checkbox.checked=true;M.docs_in_collections[doc_id][collection_id]=true;}else{checkbox.checked=false;delete M.docs_in_collections[doc_id][collection_id];}}});});},renderCollectionsIn:function(doc_id,data){var M=Scribd.DocumentCollectionsManager;var rendered_collections=$A(data.collections).map(function(collection){var transformed_collection=M.renderingCollectionAttributes(doc_id,collection);return M.collection_template.evaluate(transformed_collection);}).join(\"\\n\");if(data.total==0){var private_text=M.docs[doc_id][\'private\']?\'private \':\'\';rendered_collections=\'<span class=\"no_collections\">You have not created any \'+private_text+\'collections yet.<\/span>\';}\nreturn M.collections_template.evaluate({collections_list:rendered_collections,pagination_control:M.renderPagination(data.page,data.per_page,data.total),\'doc_id\':doc_id});},renderPagination:function(page,per_page,total,window_size){var num_of_pages=Math.ceil(total/per_page);if(num_of_pages<=1){return\'\';}\nvar htmls=[\'<span>\',page,\'<\/span>\'];if(!window_size){window_size=2};var last_page=num_of_pages;var prev_page=next_page=page;for(var i=1;i<=window_size;i++){if(prev_page>1){prev_page=page-i;htmls.unshift(\'<a href=\"#\" data-page=\"\',prev_page,\'\">\',prev_page,\'<\/a>\');}\nif(next_page<last_page){next_page=page+i;htmls.push(\'<a href=\"#\" data-page=\"\',next_page,\'\">\',next_page,\'<\/a>\');}}\nif(prev_page>2){htmls.unshift(\'<span class=\"ellipsis\">...<\/span>\');}\nif(prev_page>1){htmls.unshift(\'<a href=\"#\" data-page=\"\',page-1,\'\">\',\'«\',\'<\/a>\',\'<a href=\"#\" data-page=\"1\">1<\/a>\');}\nif(next_page<last_page-1){htmls.push(\'<span class=\"ellipsis\">...<\/span>\');}\nif(next_page<last_page){htmls.push(\'<a href=\"#\" data-page=\"\',last_page,\'\">\',last_page,\'<\/a>\',\'<a href=\"#\" data-page=\"\',page+1,\'\">\',\'»\',\'<\/a>\');}\nreturn(\'<div class=\"paginator \">\'+htmls.join(\'\')+\'<\/div>\');},renderingCollectionAttributes:function(doc_id,collection){var transformed_collection={\'id\':collection.id,\'name\':collection.name.truncate(80),doc_id:doc_id,privacy_type:collection.privacy_type,combined_privacy_type:collection.combined_privacy_type}\nif(collection.selected==\'1\'){transformed_collection[\'checked\']=\'checked=\"checked\"\';}\nreturn transformed_collection;},addToCollectionsEventHandler:function(doc_id,e){e.stop();var M=Scribd.DocumentCollectionsManager;var add_to_collection=e.findElement();var lightbox=$$(\'#lightbox_document_collections\').first();if(lightbox.visible())\nScribd.Lightbox.toggle(\'lightbox_document_collections\',0);lightbox.down(\'.private\').hide();var manager_container=lightbox.down(\'.manage_collection\');var collections_container=manager_container.down(\'.document_collections_container\');if(collections_container.retrieve(\'document_id\')!==doc_id){collections_container.store(\'document_id\',doc_id);M.renderDoc(doc_id);collections_container.update(\'\');var spinner=manager_container.down(\'img\');M.loadPageForDocument(doc_id,1,collections_container,spinner);}\nScribd.Lightbox.toggle(\'lightbox_document_collections\',75);},setupCollectionsLightbox:function(container,doc_id){container=$(container);doc_id=doc_id||Scribd.current_doc.id;var manager_container=container.down(\".manage_collection\");var collections_container=manager_container.down(\".document_collections_container\");if(collections_container.retrieve(\"document_id\")!==doc_id){collections_container.store(\"document_id\",doc_id);this.renderDoc(doc_id);collections_container.update(\'\');var spinner=manager_container.down(\"img\");this.loadPageForDocument(doc_id,1,collections_container,spinner);}},addPaginationEvent:function(){var M=Scribd.DocumentCollectionsManager;var manager_container=$$(\'#lightbox_document_collections .manage_collection\').first();var collections_container=manager_container.down(\'.document_collections_container\');var spinner=manager_container.down(\'img\');collections_container.observe(\'click\',function(e){var clicker=e.findElement();if(clicker.getAttribute(\'data-page\')){e.stop();var doc_id=collections_container.retrieve(\'document_id\');M.loadPageForDocument(doc_id,clicker.getAttribute(\'data-page\'),collections_container,spinner);}});},renderDoc:function(doc_id){var M=Scribd.DocumentCollectionsManager;var doc=M.docs[doc_id];var document_container=$$(\'#lightbox_document_collections .document_container\').first();if(doc){document_container.update(new Scribd.DocumentCell(doc).render(\'collection_old\'));if(doc[\'private\'])\ndocument_container.parentNode.down(\'.private\').show();}else{document_container.update(\'\');new Ajax.Request(\"/documents/\"+doc_id+\'.json\',{method:\'get\',onSuccess:function(response){if(response.responseJSON){M.docs[doc_id]=response.responseJSON;M.renderDoc(doc_id);}}});}}}\nScribd.DocumentCollectionsManager.Paginator=Class.create({initialize:function(options){this.total=options.total,this.per_page=options.per_page||10,this.window_size=options.window_size;this.url=options.url,this.params=options.params;}});Scribd.DocumentCollectionsManager.collections_template=new Template(\'\\\n<ul style=\"right: auto;\" class=\"add_to_my_collections sub_menu\">\\\n    #{collections_list}\\\n    #{pagination_control}\\\n<\/ul>\');Scribd.DocumentCollectionsManager.collection_template=new Template(\'\\\n<li class=\"clearfix document_collection document_collection_#{id}\" data-document_collection_id=\"#{id}\">\\\n    <span>\\\n        <img src=\"/images/loader_black_on_white.gif?1339185887\" class=\"status_loader\" alt=\"Loader_black_on_white\" style=\"display:none;\">\\\n        <input type=\"checkbox\" value=\"#{id}\" name=\"document_collection_id\" #{checked}/>\\\n    <\/span>\\\n    <label>#{name}<\/label>\\\n    <span class=\"privacy #{privacy_type}\"> #{combined_privacy_type} <\/span>\\\n<\/li>\');";


/* public/javascripts/starbox.js @ 1339185887 */

var Starboxes={options:{buttons:5,className:'default',color:false,duration:0.6,effect:{mouseover:false,mouseout:(window.Effect&&Effect.Morph)},hoverColor:false,hoverClass:'hover',ghostColor:false,ghosting:false,identity:false,indicator:false,inverse:false,locked:false,max:5,onRate:Prototype.emptyFunction,rated:false,ratedClass:'rated',rerate:false,overlay:'default_gradient.png',overlayImages:Scribd.cdn_path+'images/starbox/',stars:5,total:0}};eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('P.1a(n,{2r:"1.6.0.3",2s:"1.8.2",1Q:i(){5.1o("12");5.Q.1R=1;h(/^(2t?:\\/\\/|\\/)/.2u(5.9.1p)){5.1q=5.9.1p}1r{j a=/13(?:-[\\w\\d.]+)?\\.2v(.*)/;5.1q=(($$("2w[C]").1S(i(b){o b.C.2x(a)})||{}).C||"").1T(a,"")+5.9.1p}},1o:i(a){h((2y 1b[a]=="2z")||(5.1s(1b[a].2A)<5.1s(5["1U"+a]))){2B("1V 2C "+a+" >= "+5["1U"+a]);}},1s:i(a){j b=a.1T(/1t.*|\\./g,"");b=1u(b+"0".1v(4-b.2D));o a.2E("1t")>-1?b-1:b},1W:(i(b){j a=l 2F("2G ([\\\\d.]+)").2H(b);o a?(2I(a[1])<7):1X})(2J.2K),Q:i(b){b=$(b);j c=b.2L("1Y"),a=1w.2M;h(c){o c}2N{c="2O"+a.1R++}2P($(c));b.2Q("1Y",c);o c},1x:[],2R:i(a){h(!5.1y(a.C)){5.1x.1c(a)}o a},1y:i(a){o 5.1x.1S(i(b){o b.C==a})},G:[],1Z:i(a){5.G.1c(a)},1d:i(){h(!5.G[0]){5.20=21;o}5.22(5.G[0])},22:i(c){j e=[],b=c.9.23,a=5.1y(b);5.G.H(i(f){h(f.9.23==b){e.1c(f);5.G=5.G.2S(f)}}.y(5));h(!a){j d=l 2T();d.2U=i(){5.1z(e,{C:b,I:d.I,J:d.J,24:d.C})}.y(5);d.C=n.1q+b}1r{5.1z(e,a)}},1z:i(b,a){b.H(i(c){c.1e=a;c.25()});5.1d()},1A:(i(a){o{1f:"1f",R:"R",K:(a?"2V":"K")}})(12.1g.1h),26:i(a){h(!12.1g.1h){a=a.2W(i(e,d){j c=P.2X(5)?5:5.r,b=d.2Y;h(b!=c&&!$A(c.2Z("*")).30(b)){e(d)}})}o a}});n.1Q();31.27("32:33",n.1d.y(n));j 1V=34.35({36:i(a,b){5.r=$(a);5.p=b;5.9=P.1a(P.37(n.9),1w[2]||{});$w("L m D t").H(i(c){5[c]=5.9[c]}.y(5));5.S=5.9.S||(5.m&&!5.9.1B);h(!5.L){5.L=n.Q(5.r)}h(5.9.u&&(5.9.u.R||5.9.u.K)){n.1o("38")}n.1Z(5);h(n.20){n.1d()}},28:i(){$w("K R 1f").H(i(c){j b=c.29(),a=5["1i"+b].39(5);5["1i"+b+"1C"]=(c=="K"&&!12.1g.1h)?n.26(a):a;5.14.27(n.1A[c],5["1i"+b+"1C"])}.y(5));5.M.2a("k",{2b:"3a"})},2c:i(){$w("R K 1f").H(i(a){5.14.3b(n.1A[a],5["1i"+a.29()+"1C"])}.y(5));5.M.2a("k",{2b:"3c"})},25:i(){5.15=5.1e.J;5.16=5.1e.I;5.1D=5.1e.24;5.T=5.15*5.9.1E;5.17=5.T/5.9.M;5.1j=5.9.D/5.9.M;h(5.9.u){5.2d=5.18(0);5.2e=5.18(5.9.D)}j a={N:{U:"N",1k:0,z:0,J:5.T+"q",I:5.16+"q"},1F:{U:"2f",J:5.T+"q",I:5.16+"q"},2g:{U:"N",1k:0,z:0,J:5.15+"q",I:5.16+"q"}};5.r.V("13");5.2h=l s("v",{W:5.9.W||""}).k({U:"2f"}).x(5.19=l s("v").x(5.1l=l s("v").x(5.1G=l s("v",{W:"1E"}).k(P.1a({3d:"2i"},a.1F)))));h(5.m){5.19.V("m")}h(5.S){5.19.V("S")}h(5.9.2j){5.1G.x(5.O=l s("v",{W:"O"}).k(a.N));h(5.9.2k){5.O.k({X:5.9.2k})}h(5.9.u){5.O.E=5.O.Q()}5.Y(5.O,5.p,(1b.Z&&Z.1H))}5.1G.x(5.B=l s("v",{W:"B"}).k(a.N)).x(l s("v").k(a.N).x(5.14=l s("v").k(a.1F)));h(5.9.1I){5.B.k({X:5.9.1I})}h(5.9.u){5.B.E=5.B.Q()}5.9.1E.1v(i(b){j c;5.14.x(c=l s("v").k(P.1a({X:"3e("+5.1D+") 1k z 3f-3g",z:5.15*b+"q"},a.2g)));c.k({z:5.15*b+"q"});h(n.1W){c.k({X:"3h",3i:"3j:3k.3l.3m(C=\'"+5.1D+"\'\', 3n=\'3o\')"})}}.y(5));5.M=[];5.9.M.1v(i(d){j c,b=5.9.2l?5.T-5.17*(d+1):5.17*d;5.14.x(c=l s("v").k({U:"N",1k:0,z:b+"q",J:5.17+(12.1g.1h?1:0)+"q",I:5.16+"q"}));c.F=5.1j*d+5.1j;5.M.1c(c)}.y(5));5.Y(5.B,5.p);5.r.2m(5.2h);5.1J={};$w("p D m 1m t").H(i(b){5.r.x(5.1J[b]=l s("3p",{3q:"2i",3r:5.L+"1t"+b,2n:""+(b=="1m"?!!5[b]:5[b])}))}.y(5));h(5.9.11){5.1l.x(5.11=l s("v",{W:"11"}));5.1K()}h(!5.S){5.28()}},2o:i(a){h(5.m&&5.9.1B){5.p=(5.t*5.p-5.m)/(5.t-1||1)}j b=5.m?5.t:5.t++;5.p=(5.p==0)?a:(5.p*(5.m?b-1:b)+a)/(5.m?b:b+1)},1K:i(){5.11.2m(l 3s(5.9.11).3t({D:5.9.D,t:5.t,p:(5.p*10).3u()/10}))},18:i(b){j a=(5.T-(b/5.1j)*5.17);o 1u(5.9.2l?a.3v():-1*a.3w())},Y:i(a,b){h(5.9.u&&5["1L"+a.E]){Z.3x.3y(a.E).3z(5["1L"+a.E])}j d=5.18(b);h(1w[2]){j c=1u(a.3A("z")),f=5.18(b);h(c==f){o}j e=((5.2e-(c-f).1M()).1M()/5.2d.1M()).3B(2);5["1L"+a.E]=l Z.1H(a,{3C:{z:d+"q"},3D:{U:"3E",3F:1,E:a.E},2p:(5.9.2p*e)})}1r{a.k({z:d+"q"})}},3G:i(c){j b=c.r();h(!b.F){o}5.2o(b.F);h(5.9.11){5.1K()}h(5.9.2j){5.Y(5.O,5.p,(1b.Z&&Z.1H))}h(!5.m){5.19.V("m")}5.1m=!!5.m;5.m=b.F;h(!5.9.1B){5.2c();5.19.V("S");5.2q(c)}j a={};$w("p L D m 1m t").H(i(d){h(d!="L"){5.1J[d].2n=5[d]}a[d]=5[d]}.y(5));5.9.3H(5.r,a);5.r.1N("13:m",a)},2q:i(a){5.Y(5.B,5.p,(5.9.u&&5.9.u.K));5.1O=1X;h(5.9.1n){5.1l.3I(5.9.1n)}h(5.9.1P){5.B.k({X:5.9.1I})}5.r.1N("13:z")},3J:i(b){j a=b.r();h(!a.F){o}5.Y(5.B,a.F,(5.9.u&&5.9.u.R));h(!5.1O&&5.9.1n){5.1l.V(5.9.1n)}5.1O=21;h(5.9.1P){5.B.k({X:5.9.1P})}5.r.1N("13:3K",{Q:5.9.L,D:5.9.D,F:a.F,t:5.t})}});',62,233,'|||||this||||options||||||||if|function|var|setStyle|new|rated|Starboxes|return|average|px|element|Element|total|effect|div||insert|bind|left||colorbar|src|max|scope|rating|buildQueue|each|height|width|mouseout|identity|buttons|absolute|ghost|Object|identify|mouseover|locked|boxWidth|position|addClassName|className|background|setBarPosition|Effect||indicator|Prototype|starbox|starbar|starWidth|starHeight|buttonWidth|getBarPosition|status|extend|window|push|processBuildQueue|imageInfo|click|Browser|IE|on|buttonRating|top|hover|rerated|hoverClass|require|overlayImages|imageSource|else|convertVersionString|_|parseInt|times|arguments|imagecache|getCachedImage|buildBatch|useEvent|rerate|_cached|starSrc|stars|base|wrapper|Morph|color|inputs|updateIndicator|activeEffect_|abs|fire|hovered|hoverColor|load|counter|find|replace|REQUIRED_|Starbox|fixIE|false|id|queueBuild|batchLoading|true|cacheBuildBatch|overlay|fullsrc|build|capture|observe|enable|capitalize|invoke|cursor|disable|zeroPosition|maxPosition|relative|star|container|hidden|ghosting|ghostColor|inverse|update|value|updateAverage|duration|onMouseout|REQUIRED_Prototype|REQUIRED_Scriptaculous|https|test|js|script|match|typeof|undefined|Version|throw|requires|length|indexOf|RegExp|MSIE|exec|parseFloat|navigator|userAgent|readAttribute|callee|do|starbox_|while|writeAttribute|cacheImage|without|Image|onload|mouseleave|wrap|isElement|relatedTarget|select|member|document|dom|loaded|Class|create|initialize|clone|Scriptaculous|bindAsEventListener|pointer|stopObserving|auto|overflow|url|no|repeat|none|filter|progid|DXImageTransform|Microsoft|AlphaImageLoader|sizingMethod|scale|input|type|name|Template|evaluate|round|ceil|floor|Queues|get|remove|getStyle|toFixed|style|queue|end|limit|onClick|onRate|removeClassName|onMouseover|changed'.split('|'),0,{}));


/* public/javascripts/interstitial.js @ 1339185887 */
var lzy_js_public_javascripts_interstitial="\n(function(){function f(a){throw a;}var i=true,j=null,k=false,p,q=this;function aa(a){a=a.split(\".\");for(var b=q,c;c=a.shift();)if(b[c]!=j)b=b[c];else return j;return b}function ba(){}\nfunction ca(a){var b=typeof a;if(b==\"object\")if(a){if(a instanceof Array||!(a instanceof Object)&&Object.prototype.toString.call(a)==\"[object Array]\"||typeof a.length==\"number\"&&typeof a.splice!=\"undefined\"&&typeof a.propertyIsEnumerable!=\"undefined\"&&!a.propertyIsEnumerable(\"splice\"))return\"array\";if(!(a instanceof Object)&&(Object.prototype.toString.call(a)==\"[object Function]\"||typeof a.call!=\"undefined\"&&typeof a.propertyIsEnumerable!=\"undefined\"&&!a.propertyIsEnumerable(\"call\")))return\"function\"}else return\"null\";else if(b==\"function\"&&typeof a.call==\"undefined\")return\"object\";return b}function da(a){return ca(a)==\"array\"}function ea(a){var b=ca(a);return b==\"array\"||b==\"object\"&&typeof a.length==\"number\"}function s(a){return typeof a==\"string\"}function fa(a){return ca(a)==\"function\"}function ga(a){a=ca(a);return a==\"object\"||a==\"array\"||a==\"function\"}function ha(a){return a[ia]||(a[ia]=++ja)}var ia=\"closure_uid_\"+Math.floor(Math.random()*2147483648).toString(36),ja=0;function ka(a){return a.call.apply(a.bind,arguments)}function la(a,b){var c=b||q;if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return function(){var g=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(g,d);return a.apply(c,g)}}else return function(){return a.apply(c,arguments)}}function t(){t=Function.prototype.bind&&Function.prototype.bind.toString().indexOf(\"native code\")!=-1?ka:la;return t.apply(j,arguments)}\nfunction ma(a){var b=Array.prototype.slice.call(arguments,1);return function(){var c=Array.prototype.slice.call(arguments);c.unshift.apply(c,b);return a.apply(this,c)}}var u=Date.now||function(){return+new Date};function na(a){var b={},c;for(c in b){var d=(\"\"+b[c]).replace(/\\$/g,\"$$$$\");a=a.replace(RegExp(\"\\\\{\\\\$\"+c+\"\\\\}\",\"gi\"),d)}return a}\nfunction v(a,b){var c=a.split(\".\"),d=q;!(c[0]in d)&&d.execScript&&d.execScript(\"var \"+c[0]);for(var g;c.length&&(g=c.shift());)if(!c.length&&b!==undefined)d[g]=b;else d=d[g]?d[g]:d[g]={}}function w(a,b){function c(){}c.prototype=b.prototype;a.q=b.prototype;a.prototype=new c};function pa(a){this.stack=Error().stack||\"\";if(a)this.message=String(a)}w(pa,Error);pa.prototype.name=\"CustomError\";function qa(a){for(var b=1;b<arguments.length;b++){var c=String(arguments[b]).replace(/\\$/g,\"$$$$\");a=a.replace(/\\%s/,c)}return a}var ra=/^[a-zA-Z0-9\\-_.!~*\'()]*$/;function sa(a){a=String(a);if(!ra.test(a))return encodeURIComponent(a);return a}function x(a){if(!ta.test(a))return a;if(a.indexOf(\"&\")!=-1)a=a.replace(ua,\"&amp;\");if(a.indexOf(\"<\")!=-1)a=a.replace(va,\"&lt;\");if(a.indexOf(\">\")!=-1)a=a.replace(wa,\"&gt;\");if(a.indexOf(\'\"\')!=-1)a=a.replace(xa,\"&quot;\");return a}\nvar ua=/&/g,va=/<\/g,wa=/>/g,xa=/\\\"/g,ta=/[&<>\\\"]/;function y(a){a=String(a);var b=a.indexOf(\".\");if(b==-1)b=a.length;return Array(Math.max(0,2-b)+1).join(\"0\")+a}\nfunction ya(a,b){for(var c=0,d=String(a).replace(/^[\\s\\xa0]+|[\\s\\xa0]+$/g,\"\").split(\".\"),g=String(b).replace(/^[\\s\\xa0]+|[\\s\\xa0]+$/g,\"\").split(\".\"),e=Math.max(d.length,g.length),h=0;c==0&&h<e;h++){var l=d[h]||\"\",m=g[h]||\"\",n=RegExp(\"(\\\\d*)(\\\\D*)\",\"g\"),oa=RegExp(\"(\\\\d*)(\\\\D*)\",\"g\");do{var r=n.exec(l)||[\"\",\"\",\"\"],o=oa.exec(m)||[\"\",\"\",\"\"];if(r[0].length==0&&o[0].length==0)break;c=za(r[1].length==0?0:parseInt(r[1],10),o[1].length==0?0:parseInt(o[1],10))||za(r[2].length==0,o[2].length==0)||za(r[2],o[2])}while(c==0)}return c}function za(a,b){if(a<b)return-1;else if(a>b)return 1;return 0};function Aa(a,b){b.unshift(a);pa.call(this,qa.apply(j,b));b.shift();this.a=a}w(Aa,pa);Aa.prototype.name=\"AssertionError\";function Ba(a,b){if(!a){var c=Array.prototype.slice.call(arguments,2),d=\"Assertion failed\";if(b){d+=\": \"+b;var g=c}f(new Aa(\"\"+d,g||[]))}}function Ca(a){f(new Aa(\"Failure\"+(a?\": \"+a:\"\"),Array.prototype.slice.call(arguments,1)))};var z=Array.prototype,Da=z.indexOf?function(a,b,c){Ba(a.length!=j);return z.indexOf.call(a,b,c)}:function(a,b,c){c=c==j?0:c<0?Math.max(0,a.length+c):c;if(s(a)){if(!s(b)||b.length!=1)return-1;return a.indexOf(b,c)}for(c=c;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Ea=z.forEach?function(a,b,c){Ba(a.length!=j);z.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,g=s(a)?a.split(\"\"):a,e=0;e<d;e++)e in g&&b.call(c,g[e],e,a)};function Fa(a,b){var c=Da(a,b),d;if(d=c>=0){Ba(a.length!=j);z.splice.call(a,c,1)}return d}function Ga(){return z.concat.apply(z,arguments)}function Ha(a){if(da(a))return Ga(a);else{for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}}function Ia(a){Ba(a.length!=j);z.splice.apply(a,Ja(arguments,1))}function Ja(a,b,c){Ba(a.length!=j);return arguments.length<=2?z.slice.call(a,b):z.slice.call(a,b,c)};var Ka,La,Ma,Na,Oa,Pa,Qa;function Ra(){return q.navigator?q.navigator.userAgent:j}function Sa(){return q.navigator}Oa=Na=Ma=La=Ka=k;var Ta;if(Ta=Ra()){var Ua=Sa();Ka=Ta.indexOf(\"Opera\")==0;La=!Ka&&Ta.indexOf(\"MSIE\")!=-1;Na=(Ma=!Ka&&Ta.indexOf(\"WebKit\")!=-1)&&Ta.indexOf(\"Mobile\")!=-1;Oa=!Ka&&!Ma&&Ua.product==\"Gecko\"}var A=Ka,B=La,Va=Oa,C=Ma,Wa=Na,Xa,Ya=Sa();Xa=Ya&&Ya.platform||\"\";Pa=Xa.indexOf(\"Mac\")!=-1;Qa=Xa.indexOf(\"Win\")!=-1;var Za=!!Sa()&&(Sa().appVersion||\"\").indexOf(\"X11\")!=-1,$a;a:{var ab=\"\",bb;if(A&&q.opera){var cb=q.opera.version;ab=typeof cb==\"function\"?cb():cb}else{if(Va)bb=/rv\\:([^\\);]+)(\\)|;)/;else if(B)bb=/MSIE\\s+([^\\);]+)(\\)|;)/;else if(C)bb=/WebKit\\/(\\S+)/;if(bb){var db=bb.exec(Ra());ab=db?db[1]:\"\"}}if(B){var eb,fb=q.document;eb=fb?fb.documentMode:undefined;if(eb>parseFloat(ab)){$a=String(eb);break a}}$a=ab}var gb={};function D(a){return gb[a]||(gb[a]=ya($a,a)>=0)};var hb,ib=!B||D(\"9\");B&&D(\"9\");function jb(a){return(a=a.className)&&typeof a.split==\"function\"?a.split(/\\s+/):[]}function kb(a){var b=jb(a),c;c=Ja(arguments,1);for(var d=0,g=0;g<c.length;g++)if(!(Da(b,c[g])>=0)){b.push(c[g]);d++}c=d==c.length;a.className=b.join(\" \");return c}function lb(a){for(var b=jb(a),c=Ja(arguments,1),d=0,g=0;g<b.length;g++)if(Da(c,b[g])>=0){Ia(b,g--,1);d++}a.className=b.join(\" \")};function E(a,b){this.x=a!==undefined?a:0;this.y=b!==undefined?b:0}E.prototype.J=function(){return new E(this.x,this.y)};E.prototype.toString=function(){return\"(\"+this.x+\", \"+this.y+\")\"};function G(a,b){this.width=a;this.height=b}G.prototype.J=function(){return new G(this.width,this.height)};G.prototype.toString=function(){return\"(\"+this.width+\" x \"+this.height+\")\"};G.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};G.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function mb(a,b,c){for(var d in a)b.call(c,a[d],d,a)}function nb(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function ob(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var pb=[\"constructor\",\"hasOwnProperty\",\"isPrototypeOf\",\"propertyIsEnumerable\",\"toLocaleString\",\"toString\",\"valueOf\"];function qb(a){for(var b,c,d=1;d<arguments.length;d++){c=arguments[d];for(b in c)a[b]=c[b];for(var g=0;g<pb.length;g++){b=pb[g];if(Object.prototype.hasOwnProperty.call(c,b))a[b]=c[b]}}};function H(a){return a?new rb(I(a)):hb||(hb=new rb)}function sb(a){return s(a)?document.getElementById(a):a}function tb(a,b){mb(b,function(c,d){if(d==\"style\")a.style.cssText=c;else if(d==\"class\")a.className=c;else if(d==\"for\")a.htmlFor=c;else if(d in ub)a.setAttribute(ub[d],c);else a[d]=c})}var ub={cellpadding:\"cellPadding\",cellspacing:\"cellSpacing\",colspan:\"colSpan\",rowspan:\"rowSpan\",valign:\"vAlign\",height:\"height\",width:\"width\",usemap:\"useMap\",frameborder:\"frameBorder\",type:\"type\"};function vb(a){var b=a.document;if(C&&!D(\"500\")&&!Wa){if(typeof a.innerHeight==\"undefined\")a=window;b=a.innerHeight;var c=a.document.documentElement.scrollHeight;if(a==a.top)if(c<b)b-=15;return new G(a.innerWidth,b)}a=b.compatMode==\"CSS1Compat\";if(A&&!D(\"9.50\"))a=k;a=a?b.documentElement:b.body;return new G(a.clientWidth,a.clientHeight)}function wb(a){return a?a.parentWindow||a.defaultView:window}function xb(){return yb(document,arguments)}\nfunction yb(a,b){var c=b[0],d=b[1];if(!ib&&d&&(d.name||d.type)){c=[\"<\",c];d.name&&c.push(\' name=\"\',x(d.name),\'\"\');if(d.type){c.push(\' type=\"\',x(d.type),\'\"\');var g={};qb(g,d);d=g;delete d.type}c.push(\">\");c=c.join(\"\")}c=a.createElement(c);if(d)if(s(d))c.className=d;else da(d)?kb.apply(j,[c].concat(d)):tb(c,d);b.length>2&&zb(a,c,b);return c}\nfunction zb(a,b,c){function d(h){if(h)b.appendChild(s(h)?a.createTextNode(h):h)}for(var g=2;g<c.length;g++){var e=c[g];ea(e)&&!(ga(e)&&e.nodeType>0)?Ea(Ab(e)?Ha(e):e,d):d(e)}}function Bb(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function I(a){return a.nodeType==9?a:a.ownerDocument||a.document}function Ab(a){if(a&&typeof a.length==\"number\")if(ga(a))return typeof a.item==\"function\"||typeof a.item==\"string\";else if(fa(a))return typeof a.item==\"function\";return k}\nfunction rb(a){this.a=a||q.document||document}p=rb.prototype;p.v=H;function Cb(a){return a.a}p.f=function(a){return s(a)?this.a.getElementById(a):a};p.t=function(){return yb(this.a,arguments)};p.createElement=function(a){return this.a.createElement(a)};p.createTextNode=function(a){return this.a.createTextNode(a)};function Db(a){a=!C&&a.a.compatMode==\"CSS1Compat\"?a.a.documentElement:a.a.body;return new E(a.scrollLeft,a.scrollTop)}p.appendChild=function(a,b){a.appendChild(b)};var Eb;var Fb=(Eb=\"ScriptEngine\"in q&&q.ScriptEngine()==\"JScript\")?q.ScriptEngineMajorVersion()+\".\"+q.ScriptEngineMinorVersion()+\".\"+q.ScriptEngineBuildVersion():\"0\";function Gb(a){return\'\\t<div id=\"\'+x(String(a.zb))+\'\"><div id=\"\'+x(String(a.xb))+\'\"><\/div><div id=\"\'+x(String(a.yb))+\'\"><\/div><\/div>\'};function Hb(a){if(typeof a.aa==\"function\")return a.aa();if(s(a))return a.split(\"\");if(ea(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return nb(a)}function Ib(a,b,c){if(typeof a.forEach==\"function\")a.forEach(b,c);else if(ea(a)||s(a))Ea(a,b,c);else{var d;if(typeof a.na==\"function\")d=a.na();else if(typeof a.aa!=\"function\")if(ea(a)||s(a)){d=[];for(var g=a.length,e=0;e<g;e++)d.push(e);d=d}else d=ob(a);else d=void 0;g=Hb(a);e=g.length;for(var h=0;h<e;h++)b.call(c,g[h],d&&d[h],a)}};function Jb(a){this.b={};this.a=[];var b=arguments.length;if(b>1){if(b%2)f(Error(\"Uneven number of arguments\"));for(var c=0;c<b;c+=2)this.da(arguments[c],arguments[c+1])}else if(a){if(a instanceof Jb){b=a.na();c=a.aa()}else{b=ob(a);c=nb(a)}for(var d=0;d<b.length;d++)this.da(b[d],c[d])}}p=Jb.prototype;p.u=0;p.$b=0;p.aa=function(){Kb(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a};p.na=function(){Kb(this);return this.a.concat()};function Kb(a){if(a.u!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];if(Object.prototype.hasOwnProperty.call(a.b,d))a.a[c++]=d;b++}a.a.length=c}if(a.u!=a.a.length){var g={};for(c=b=0;b<a.a.length;){d=a.a[b];if(!Object.prototype.hasOwnProperty.call(g,d)){a.a[c++]=d;g[d]=1}b++}a.a.length=c}}function Lb(a,b){if(Object.prototype.hasOwnProperty.call(a.b,b))return a.b[b]}p.da=function(a,b){if(!Object.prototype.hasOwnProperty.call(this.b,a)){this.u++;this.a.push(a);this.$b++}this.b[a]=b};p.J=function(){return new Jb(this)};function Mb(a){return Nb(a||arguments.callee.caller,[])}\nfunction Nb(a,b){var c=[];if(Da(b,a)>=0)c.push(\"[...circular reference...]\");else if(a&&b.length<50){c.push(Ob(a)+\"(\");for(var d=a.arguments,g=0;g<d.length;g++){g>0&&c.push(\", \");var e;e=d[g];switch(typeof e){case\"object\":e=e?\"object\":\"null\";break;case\"string\":e=e;break;case\"number\":e=String(e);break;case\"boolean\":e=e?\"true\":\"false\";break;case\"function\":e=(e=Ob(e))?e:\"[fn]\";break;default:e=typeof e}if(e.length>40)e=e.substr(0,40)+\"...\";c.push(e)}b.push(a);c.push(\")\\n\");try{c.push(Nb(a.caller,b))}catch(h){c.push(\"[exception trying to get caller]\\n\")}}else a?c.push(\"[...long stack...]\"):c.push(\"[end]\");return c.join(\"\")}function Ob(a){a=String(a);if(!Pb[a]){var b=/function ([^\\(]+)/.exec(a);Pb[a]=b?b[1]:\"[Anonymous]\"}return Pb[a]}var Pb={};function Qb(a,b,c,d,g){this.N=typeof g==\"number\"?g:Rb++;this.k=d||u();this.c=a;this.e=b;this.p=c;delete this.b;delete this.a}Qb.prototype.N=0;Qb.prototype.b=j;Qb.prototype.a=j;var Rb=0;function J(a){this.p=a}J.prototype.c=j;J.prototype.b=j;J.prototype.e=j;J.prototype.a=j;function Sb(a,b){this.name=a;this.value=b}Sb.prototype.toString=function(){return this.name};var Tb=new Sb(\"SHOUT\",1200),Ub=new Sb(\"SEVERE\",1E3),Vb=new Sb(\"WARNING\",900),Wb=new Sb(\"INFO\",800),Xb=new Sb(\"CONFIG\",700),Yb=new Sb(\"ALL\",0);function Zb(a){if(a.b)return a.b;if(a.c)return Zb(a.c);Ca(\"Root logger has no level set.\");return j}\nJ.prototype.log=function(a,b,c){if(a.value>=Zb(this).value){a=this.k(a,b,c);if(q.console&&q.console.markTimeline)q.console.markTimeline(\"log:\"+a.e);for(b=this;b;){c=b;var d=a;if(c.a)for(var g=0,e=void 0;e=c.a[g];g++)e(d);b=b.c}}};J.prototype.k=function(a,b,c){var d=new Qb(a,String(b),this.p);if(c){d.b=c;var g;var e=arguments.callee.caller;try{var h,l=aa(\"window.location.href\");h=typeof c==\"string\"?{message:c,name:\"Unknown error\",lineNumber:\"Not available\",fileName:l,stack:\"Not available\"}:!c.lineNumber||!c.fileName||!c.stack?{message:c.message,name:c.name,lineNumber:c.lineNumber||c.kd||\"Not available\",fileName:c.fileName||c.filename||c.sourceURL||l,stack:c.stack||\"Not available\"}:c;g=\"Message: \"+x(h.message)+\'\\nUrl: <a href=\"view-source:\'+\nh.fileName+\'\" target=\"_new\">\'+h.fileName+\"<\/a>\\nLine: \"+h.lineNumber+\"\\n\\nBrowser stack:\\n\"+x(h.stack+\"-> \")+\"[end]\\n\\nJS stack traversal:\\n\"+x(Mb(e)+\"-> \")}catch(m){g=\"Exception trying to expose exception! You win, we lose. \"+m}d.a=g}return d};J.prototype.info=function(a,b){this.log(Wb,a,b)};var $b={},ac=j;function bc(){if(!ac){ac=new J(\"\");$b[\"\"]=ac;ac.b=Xb}}\nfunction cc(a){bc();var b;if(!(b=$b[a])){b=new J(a);var c=a.lastIndexOf(\".\"),d=a.substr(c+1);c=cc(a.substr(0,c));if(!c.e)c.e={};c.e[d]=b;b.c=c;b=$b[a]=b}return b};function dc(){}dc.prototype.fb=k;dc.prototype.r=function(){if(!this.fb){this.fb=i;this.i()}};dc.prototype.i=function(){};var ec,fc=!B||D(\"9\"),gc=B&&!D(\"8\");function K(a,b){this.type=a;this.a=this.target=b}w(K,dc);p=K.prototype;p.i=function(){delete this.type;delete this.target;delete this.a};p.O=k;p.ea=i;p.ra=function(){this.O=i};p.K=function(){this.ea=k};function hc(a){a.ra()}function ic(a){a.K()};var jc={fc:\"click\",mc:\"dblclick\",Fc:\"mousedown\",Jc:\"mouseup\",Ic:\"mouseover\",Hc:\"mouseout\",Gc:\"mousemove\",bd:\"selectstart\",Ac:\"keypress\",zc:\"keydown\",Bc:\"keyup\",bc:\"blur\",tc:\"focus\",nc:\"deactivate\",uc:B?\"focusin\":\"DOMFocusIn\",vc:B?\"focusout\":\"DOMFocusOut\",ec:\"change\",ad:\"select\",cd:\"submit\",yc:\"input\",Uc:\"propertychange\",rc:\"dragstart\",oc:\"dragenter\",qc:\"dragover\",pc:\"dragleave\",sc:\"drop\",gd:\"touchstart\",fd:\"touchmove\",ed:\"touchend\",dd:\"touchcancel\",ic:\"contextmenu\",tb:\"error\",xc:\"help\",Dc:\"load\",Ec:\"losecapture\",Vc:\"readystatechange\",Wc:\"resize\",$c:\"scroll\",hd:\"unload\",wc:\"hashchange\",Pc:\"pagehide\",Qc:\"pageshow\",Tc:\"popstate\",jc:\"copy\",Rc:\"paste\",lc:\"cut\"};var kc=new Function(\"a\",\"return a\");function L(a,b){a&&this.init(a,b)}w(L,K);var lc=[1,4,2];p=L.prototype;p.target=j;p.bb=j;p.Hb=0;p.Ib=0;p.clientX=0;p.clientY=0;p.pa=0;p.qa=0;p.Db=0;p.keyCode=0;p.Eb=0;p.Fb=k;p.Cb=k;p.cb=k;p.Gb=k;p.Vb=k;p.G=j;p.init=function(a,b){var c=this.type=a.type;this.target=a.target||a.srcElement;this.a=b;var d=a.relatedTarget;if(d){if(Va)try{kc(d.nodeName)}catch(g){d=j}}else if(c==\"mouseover\")d=a.fromElement;else if(c==\"mouseout\")d=a.toElement;this.bb=d;this.Hb=a.offsetX!==undefined?a.offsetX:a.layerX;this.Ib=a.offsetY!==undefined?a.offsetY:a.layerY;this.clientX=a.clientX!==undefined?a.clientX:a.pageX;this.clientY=a.clientY!==undefined?a.clientY:a.pageY;this.pa=a.screenX||0;this.qa=a.screenY||0;this.Db=a.button;this.keyCode=a.keyCode||0;this.Eb=a.charCode||(c==\"keypress\"?a.keyCode:0);this.Fb=a.ctrlKey;this.Cb=a.altKey;this.cb=a.shiftKey;this.Gb=a.metaKey;this.Vb=Pa?a.metaKey:a.ctrlKey;this.b=a.state;this.G=a;delete this.ea;delete this.O};p.ra=function(){L.q.ra.call(this);if(this.G.stopPropagation)this.G.stopPropagation();else this.G.cancelBubble=i};p.K=function(){L.q.K.call(this);var a=this.G;if(a.preventDefault)a.preventDefault();else{a.returnValue=k;if(gc)try{if(a.ctrlKey||a.keyCode>=112&&a.keyCode<=123)a.keyCode=-1}catch(b){}}};p.i=function(){L.q.i.call(this);this.bb=this.a=this.target=this.G=j};function mc(){}var nc=0;p=mc.prototype;p.key=0;p.V=k;p.Wa=k;p.init=function(a,b,c,d,g,e){if(fa(a))this.a=i;else if(a&&a.handleEvent&&fa(a.handleEvent))this.a=k;else f(Error(\"Invalid listener argument\"));this.U=a;this.b=b;this.src=c;this.type=d;this.capture=!!g;this.ta=e;this.Wa=k;this.key=++nc;this.V=k};p.handleEvent=function(a){if(this.a)return this.U.call(this.ta||this.src,a);return this.U.handleEvent.call(this.U,a)};function M(a,b){this.e=b;this.b=[];if(a>this.e)f(Error(\"[goog.structs.SimplePool] Initial cannot be greater than max\"));for(var c=0;c<a;c++)this.b.push(this.a?this.a():{})}w(M,dc);M.prototype.a=j;M.prototype.c=j;function oc(a){if(a.b.length)return a.b.pop();return a.a?a.a():{}}function pc(a,b){a.b.length<a.e?a.b.push(b):qc(a,b)}function qc(a,b){if(a.c)a.c(b);else if(ga(b))if(fa(b.r))b.r();else for(var c in b)delete b[c]}\nM.prototype.i=function(){M.q.i.call(this);for(var a=this.b;a.length;)qc(this,a.pop());delete this.b};var rc,sc,tc,uc,vc,wc,xc,yc,zc,Ac,Bc;(function(){function a(){return{u:0,B:0}}function b(){return[]}function c(){function o(F){return h.call(o.src,o.key,F)}return o}function d(){return new mc}function g(){return new L}var e=Eb&&!(ya(Fb,\"5.7\")>=0),h;wc=function(o){h=o};if(e){rc=function(){return oc(l)};sc=function(o){pc(l,o)};tc=function(){return oc(m)};uc=function(o){pc(m,o)};vc=function(){return oc(n)};xc=function(){pc(n,c())};yc=function(){return oc(oa)};zc=function(o){pc(oa,o)};Ac=function(){return oc(r)};Bc=function(o){pc(r,o)};var l=new M(0,600);l.a=a;var m=new M(0,600);m.a=b;var n=new M(0,600);n.a=c;var oa=new M(0,600);oa.a=d;var r=new M(0,600);r.a=g}else{rc=a;sc=ba;tc=b;uc=ba;vc=c;xc=ba;yc=d;zc=ba;Ac=g;Bc=ba}})();var Cc={},N={},O={},Dc={};function P(a,b,c,d,g){if(b)if(da(b)){for(var e=0;e<b.length;e++)P(a,b[e],c,d,g);return j}else{d=!!d;var h=N;b in h||(h[b]=rc());h=h[b];if(!(d in h)){h[d]=rc();h.u++}h=h[d];var l=ha(a),m;h.B++;if(h[l]){m=h[l];for(e=0;e<m.length;e++){h=m[e];if(h.U==c&&h.ta==g){if(h.V)break;return m[e].key}}}else{m=h[l]=tc();h.u++}e=vc();e.src=a;h=yc();h.init(c,e,a,b,d,g);c=h.key;e.key=c;m.push(h);Cc[c]=h;O[l]||(O[l]=tc());O[l].push(h);if(a.addEventListener){if(a==q||!a.Ya)a.addEventListener(b,e,d)}else a.attachEvent(Ec(b),e);return c}else f(Error(\"Invalid event type\"))}function Fc(a,b,c,d,g){if(da(b))for(var e=0;e<b.length;e++)Fc(a,b[e],c,d,g);else{d=!!d;if(a=Gc(a,b,d))for(e=0;e<a.length;e++)if(a[e].U==c&&a[e].capture==d&&a[e].ta==g){Q(a[e].key);break}}}\nfunction Q(a){if(Cc[a]){var b=Cc[a];if(!b.V){var c=b.src,d=b.type,g=b.b,e=b.capture;if(c.removeEventListener){if(c==q||!c.Ya)c.removeEventListener(d,g,e)}else c.detachEvent&&c.detachEvent(Ec(d),g);c=ha(c);g=N[d][e][c];if(O[c]){var h=O[c];Fa(h,b);h.length==0&&delete O[c]}b.V=i;g.gb=i;Hc(d,e,c,g);delete Cc[a]}}}\nfunction Hc(a,b,c,d){if(!d.wa)if(d.gb){for(var g=0,e=0;g<d.length;g++)if(d[g].V){var h=d[g].b;h.src=j;xc(h);zc(d[g])}else{if(g!=e)d[e]=d[g];e++}d.length=e;d.gb=k;if(e==0){uc(d);delete N[a][b][c];N[a][b].u--;if(N[a][b].u==0){sc(N[a][b]);delete N[a][b];N[a].u--}if(N[a].u==0){sc(N[a]);delete N[a]}}}}\nfunction Ic(a){var b,c=0,d=b==j;b=!!b;if(a==j)mb(O,function(h){for(var l=h.length-1;l>=0;l--){var m=h[l];if(d||b==m.capture){Q(m.key);c++}}});else{a=ha(a);if(O[a]){a=O[a];for(var g=a.length-1;g>=0;g--){var e=a[g];if(d||b==e.capture){Q(e.key);c++}}}}}function Gc(a,b,c){var d=N;if(b in d){d=d[b];if(c in d){d=d[c];a=ha(a);if(d[a])return d[a]}}return j}function Ec(a){if(a in Dc)return Dc[a];return Dc[a]=\"on\"+a}\nfunction Jc(a,b,c,d,g){var e=1;b=ha(b);if(a[b]){a.B--;a=a[b];if(a.wa)a.wa++;else a.wa=1;try{for(var h=a.length,l=0;l<h;l++){var m=a[l];if(m&&!m.V)e&=Kc(m,g)!==k}}finally{a.wa--;Hc(c,d,b,a)}}return Boolean(e)}function Kc(a,b){var c=a.handleEvent(b);a.Wa&&Q(a.key);return c}\nfunction R(a,b){if(s(b))b=new K(b,a);else if(b instanceof K)b.target=b.target||a;else{var c=b;b=new K(b.type,a);qb(b,c)}c=1;var d,g=b.type,e=N;if(!(g in e))return i;e=e[g];g=i in e;var h;if(g){d=[];for(h=a;h;h=h.za)d.push(h);h=e[i];h.B=h.u;for(var l=d.length-1;!b.O&&l>=0&&h.B;l--){b.a=d[l];c&=Jc(h,d[l],b.type,i,b)&&b.ea!=k}}if(k in e){h=e[k];h.B=h.u;if(g)for(l=0;!b.O&&l<d.length&&h.B;l++){b.a=d[l];c&=Jc(h,d[l],b.type,k,b)&&b.ea!=k}else for(d=a;!b.O&&d&&h.B;d=d.za){b.a=d;c&=Jc(h,d,b.type,k,b)&&b.ea!=k}}return Boolean(c)}\nwc(function(a,b){if(!Cc[a])return i;var c=Cc[a],d=c.type,g=N;if(!(d in g))return i;g=g[d];var e,h;if(ec===undefined)ec=B&&!q.addEventListener;if(ec){e=b||aa(\"window.event\");var l=i in g,m=k in g;if(l){if(e.keyCode<0||e.returnValue!=undefined)return i;a:{var n=k;if(e.keyCode==0)try{e.keyCode=-1;break a}catch(oa){n=i}if(n||e.returnValue==undefined)e.returnValue=i}}n=Ac();n.init(e,this);e=i;try{if(l){for(var r=tc(),o=n.a;o;o=o.parentNode)r.push(o);h=g[i];h.B=h.u;for(var F=r.length-1;!n.O&&F>=0&&h.B;F--){n.a=r[F];e&=Jc(h,r[F],d,i,n)}if(m){h=g[k];h.B=h.u;for(F=0;!n.O&&F<r.length&&h.B;F++){n.a=r[F];e&=Jc(h,r[F],d,k,n)}}}else e=Kc(c,n)}finally{if(r){r.length=0;uc(r)}n.r();Bc(n)}return e}d=new L(b,this);try{e=Kc(c,d)}finally{d.r()}return e});function S(){}w(S,dc);p=S.prototype;p.Ya=i;p.za=j;p.Na=function(a){this.za=a};p.addEventListener=function(a,b,c,d){P(this,a,b,c,d)};p.removeEventListener=function(a,b,c,d){Fc(this,a,b,c,d)};p.i=function(){S.q.i.call(this);Ic(this);this.za=j};function T(a,b){this.e=a||1;this.b=b||Lc;this.k=t(this.N,this);this.p=u()}w(T,S);T.prototype.c=k;var Lc=q.window;T.prototype.a=j;T.prototype.N=function(){if(this.c){var a=u()-this.p;if(a>0&&a<this.e*0.8)this.a=this.b.setTimeout(this.k,this.e-a);else{R(this,Mc);if(this.c){this.a=this.b.setTimeout(this.k,this.e);this.p=u()}}}};function Nc(a){a.c=i;if(!a.a){a.a=a.b.setTimeout(a.k,a.e);a.p=u()}}T.prototype.stop=function(){this.c=k;if(this.a){this.b.clearTimeout(this.a);this.a=j}};T.prototype.i=function(){T.q.i.call(this);this.stop();delete this.b};var Mc=\"tick\";function Oc(a,b,c){if(fa(a)){if(c)a=t(a,c)}else if(a&&typeof a.handleEvent==\"function\")a=t(a.handleEvent,a);else f(Error(\"Invalid listener argument\"));return b>2147483647?-1:Lc.setTimeout(a,b||0)};function Pc(a){this.c=a}w(Pc,dc);var Qc=new M(0,100),Rc=[];function U(a,b,c,d,g){if(!da(c)){Rc[0]=c;c=Rc}for(var e=0;e<c.length;e++){var h=a,l=P(b,c[e],d||a,g||k,a.c||a);if(h.a)h.a[l]=i;else if(h.b){h.a=oc(Qc);h.a[h.b]=i;h.b=j;h.a[l]=i}else h.b=l}return a}\nfunction Sc(a,b,c,d,g,e){if(a.b||a.a)if(da(c))for(var h=0;h<c.length;h++)Sc(a,b,c[h],d,g,e);else{a:{d=d||a;e=e||a.c||a;g=!!g;if(b=Gc(b,c,g))for(c=0;c<b.length;c++)if(b[c].U==d&&b[c].capture==g&&b[c].ta==e){b=b[c];break a}b=j}if(b){b=b.key;Q(b);if(a.a){c=a.a;b in c&&delete c[b]}else if(a.b==b)a.b=j}}return a}function Tc(a){if(a.a){for(var b in a.a){Q(b);delete a.a[b]}pc(Qc,a.a);a.a=j}else a.b&&Q(a.b)}Pc.prototype.i=function(){Pc.q.i.call(this);Tc(this)};Pc.prototype.handleEvent=function(){f(Error(\"EventHandler.handleEvent not implemented\"))};function Uc(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}Uc.prototype.J=function(){return new Uc(this.left,this.top,this.width,this.height)};Uc.prototype.toString=function(){return\"(\"+this.left+\", \"+this.top+\" - \"+this.width+\"w x \"+this.height+\"h)\"};function Vc(a,b,c){s(b)?Wc(a,c,b):mb(b,ma(Wc,a))}function Wc(a,b,c){a.style[Xc(c)]=b}function Yc(a,b){var c=I(a);if(c.defaultView&&c.defaultView.getComputedStyle)if(c=c.defaultView.getComputedStyle(a,j))return c[b]||c.getPropertyValue(b);return\"\"}function Zc(a,b){return Yc(a,b)||(a.currentStyle?a.currentStyle[b]:j)||a.style[b]}function $c(a,b,c){var d,g=Va&&(Pa||Za)&&D(\"1.9\");if(b instanceof E){d=b.x;b=b.y}else{d=b;b=c}a.style.left=ad(d,g);a.style.top=ad(b,g)}\nfunction bd(a){if(B)return a.offsetParent;var b=I(a),c=Zc(a,\"position\"),d=c==\"fixed\"||c==\"fixed\";for(a=a.parentNode;a&&a!=b;a=a.parentNode){c=Zc(a,\"position\");d=d&&c==\"static\"&&a!=b.documentElement&&a!=b.body;if(!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||c==\"fixed\"||c==\"fixed\"))return a}return j}\nfunction cd(a){var b,c=I(a),d=Zc(a,\"position\"),g=Va&&c.getBoxObjectFor&&!a.getBoundingClientRect&&d==\"fixed\"&&(b=c.getBoxObjectFor(a))&&(b.screenX<0||b.screenY<0),e=new E(0,0),h;b=c?c.nodeType==9?c:I(c):document;if(h=B)h=H(b).a.compatMode!=\"CSS1Compat\";h=h?b.body:b.documentElement;if(a==h)return e;if(a.getBoundingClientRect){d=a.getBoundingClientRect();if(B){a=a.ownerDocument;d.left-=a.documentElement.clientLeft+a.body.clientLeft;d.top-=a.documentElement.clientTop+a.body.clientTop}b=d;c=Db(H(c));e.x=b.left+c.x;e.y=b.top+c.y}else if(c.getBoxObjectFor&&!g){b=c.getBoxObjectFor(a);c=c.getBoxObjectFor(h);e.x=b.screenX-c.screenX;e.y=b.screenY-c.screenY}else{b=a;do{e.x+=b.offsetLeft;e.y+=b.offsetTop;if(b!=a){e.x+=b.clientLeft||0;e.y+=b.clientTop||0}if(C&&Zc(b,\"position\")==\"fixed\"){e.x+=c.body.scrollLeft;e.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(A||C&&d==\"fixed\")e.y-=c.body.offsetTop;for(b=a;(b=bd(b))&&b!=c.body&&b!=h;){e.x-=b.scrollLeft;if(!A||b.tagName!=\"TR\")e.y-=b.scrollTop}}return e}\nfunction dd(a,b,c){var d=cd(a);if(b instanceof E){c=b.y;b=b.x}$c(a,a.offsetLeft+(b-d.x),a.offsetTop+(c-d.y))}function ed(a,b,c){if(b instanceof G){c=b.height;b=b.width}else{if(c==undefined)f(Error(\"missing height argument\"));c=c}a.style.width=ad(b,i);a.style.height=ad(c,i)}function ad(a,b){if(typeof a==\"number\")a=(b?Math.round(a):a)+\"px\";return a}\nfunction fd(a){var b=A&&!D(\"10\");if(Zc(a,\"display\")!=\"none\")return b?new G(a.offsetWidth||a.clientWidth,a.offsetHeight||a.clientHeight):new G(a.offsetWidth,a.offsetHeight);var c=a.style,d=c.display,g=c.visibility,e=c.position;c.visibility=\"hidden\";c.position=\"fixed\";c.display=\"inline\";if(b){b=a.offsetWidth||a.clientWidth;a=a.offsetHeight||a.clientHeight}else{b=a.offsetWidth;a=a.offsetHeight}c.display=d;c.position=e;c.visibility=g;return new G(b,a)}var gd={};function Xc(a){return gd[a]||(gd[a]=String(a).replace(/\\-([a-z])/g,function(b,c){return c.toUpperCase()}))}function hd(a,b){var c=a.style;if(\"opacity\"in c)c.opacity=b;else if(\"MozOpacity\"in c)c.MozOpacity=b;else if(\"filter\"in c)c.filter=b===\"\"?\"\":\"alpha(opacity=\"+b*100+\")\"}function V(a,b){a.style.display=b?\"\":\"none\"};function id(){}(function(a){a.ab=function(){return a.Lb||(a.Lb=new a)}})(id);id.prototype.a=0;id.ab();function W(a){this.c=a||H();this.Wb=jd}w(W,S);W.prototype.Nb=id.ab();var jd=j;p=W.prototype;p.eb=j;p.D=k;p.j=j;p.Wb=j;p.Pb=j;p.T=j;p.sa=j;p.ga=j;p.ac=k;function kd(a){return a.eb||(a.eb=\":\"+(a.Nb.a++).toString(36))}p.f=function(){return this.j};function ld(a){return a.a||(a.a=new Pc(a))}p.Na=function(a){if(this.T&&this.T!=a)f(Error(\"Method not supported\"));W.q.Na.call(this,a)};p.v=function(){return this.c};p.t=function(){this.j=this.c.createElement(\"div\")};p.L=function(a){if(this.D)f(Error(\"Component already rendered\"));this.j||this.t();a?a.insertBefore(this.j,j):this.c.a.body.appendChild(this.j);if(!this.T||this.T.D)this.S()};p.S=function(){this.D=i;md(this,function(a){!a.D&&a.f()&&a.S()})};p.$=function(){md(this,function(a){a.D&&a.$()});this.a&&Tc(this.a);this.D=k};p.i=function(){W.q.i.call(this);this.D&&this.$();if(this.a){this.a.r();delete this.a}md(this,function(a){a.r()});!this.ac&&this.j&&Bb(this.j);this.T=this.Pb=this.j=this.ga=this.sa=j};function md(a,b){a.sa&&Ea(a.sa,b,void 0)}p.removeChild=function(a,b){if(a){var c=s(a)?a:kd(a),d;if(this.ga&&c){d=this.ga;d=c in d?d[c]:void 0;d=d||j}else d=j;a=d;if(c&&a){d=this.ga;c in d&&delete d[c];Fa(this.sa,a);if(b){a.$();a.j&&Bb(a.j)}c=a;if(c==j)f(Error(\"Unable to set parent component\"));c.T=j;W.q.Na.call(c,j)}}if(!a)f(Error(\"Child is not in parent component\"))};var nd;(function(){function a(l){l=l.match(/[\\d]+/g);l.length=3;return l.join(\".\")}var b=k,c=\"\";if(navigator.plugins&&navigator.plugins.length){var d=navigator.plugins[\"Shockwave Flash\"];if(d){b=i;if(d.description)c=a(d.description)}if(navigator.plugins[\"Shockwave Flash 2.0\"]){b=i;c=\"2.0.0.11\"}}else if(navigator.mimeTypes&&navigator.mimeTypes.length){if(b=(d=navigator.mimeTypes[\"application/x-shockwave-flash\"])&&d.enabledPlugin)c=a(d.enabledPlugin.description)}else try{d=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.7\");b=i;c=a(d.GetVariable(\"$version\"))}catch(g){try{d=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.6\");b=i;c=\"6.0.21\"}catch(e){try{d=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\");b=i;c=a(d.GetVariable(\"$version\"))}catch(h){}}}nd=c})();function od(a,b){W.call(this,b);this.Mb=a;this.e=new Pc(this);this.b=new Jb}w(od,W);p=od.prototype;p.Ob=cc(\"goog.ui.media.FlashObject\");p.rb=\"window\";p.vb=\"#000000\";p.Va=\"sameDomain\";function pd(a,b,c){a.N=s(b)?b:Math.round(b)+\"px\";a.k=s(c)?c:Math.round(c)+\"px\";a.f()&&ed(qd(a),a.N,a.k)}\np.S=function(){od.q.S.call(this);var a=this.f(),b;b=B?\'<object classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" id=\"%s\" name=\"%s\" class=\"%s\"><param name=\"movie\" value=\"%s\"/><param name=\"quality\" value=\"high\"/><param name=\"FlashVars\" value=\"%s\"/><param name=\"bgcolor\" value=\"%s\"/><param name=\"AllowScriptAccess\" value=\"%s\"/><param name=\"allowFullScreen\" value=\"true\"/><param name=\"SeamlessTabbing\" value=\"false\"/>%s<\/object>\':\'<embed quality=\"high\" id=\"%s\" name=\"%s\" class=\"%s\" src=\"%s\" FlashVars=\"%s\" bgcolor=\"%s\" AllowScriptAccess=\"%s\" allowFullScreen=\"true\" SeamlessTabbing=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" %s><\/embed>\';var c=B?\'<param name=\"wmode\" value=\"%s\"/>\':\"wmode=%s\";c=qa(c,this.rb);for(var d=this.b.na(),g=this.b.aa(),e=[],h=0;h<d.length;h++){var l=sa(d[h]),m=sa(g[h]);e.push(l+\"=\"+m)}b=qa(b,kd(this),kd(this),\"goog-ui-media-flash-object\",x(this.Mb),x(e.join(\"&\")),this.vb,this.Va,c);a.innerHTML=b;this.N&&this.k&&pd(this,this.N,this.k);U(this.e,this.f(),nb(jc),hc)};p.t=function(){if(this.p!=j&&!(ya(nd,this.p)>=0)){this.Ob.log(Vb,\"Required flash version not found:\"+this.p,void 0);f(Error(\"Method not supported\"))}var a=this.v().createElement(\"div\");a.className=\"goog-ui-media-flash\";this.j=a};function qd(a){return a.f()?a.f().firstChild:j}p.i=function(){od.q.i.call(this);this.b=j;this.e.r();this.e=j};function rd(a){if(!a.D||!a.f())return k;if(qd(a).readyState&&qd(a).readyState==4)return i;if(qd(a).PercentLoaded&&qd(a).PercentLoaded()==100)return i;return k};var sd={dc:\"breakStarted\",cc:\"breakEnded\",Yc:\"scriptFetched\",Zc:\"scriptTimeout\",kc:\"custom\",gc:\"clickThru\",Cc:\"linearChanged\",hc:\"companion\",Kc:\"noCompanion\",Sc:\"paused\",Xc:\"resumed\",jd:\"volumeChanged\",Nc:\"overlayStarted\",Oc:\"overlayStopped\",Mc:\"overlayExpanded\",Lc:\"overlayCollapsed\",tb:\"error\"};function td(a){this.o=cc(\"adaptv.ads.VPAIDAd\");this.o.info(\"VPAIDAd()\");this.b=a;this.a=[]}function ud(a,b,c){Ea(a.a,function(d){if(d.type==b){c=c||{};d.fn.call(d.scope,{target:this,type:b,data:c})}})}\ntd.prototype.initAd=function(a,b,c){this.width=a;this.height=b;var d=\"https:\"==document.location.protocol?\"https://secure-assets.adap.tv\":\"http://redir.adap.tv\",g=new od(d+\"/redir/client/swfloader.swf?id=swfloader\");pd(g,a,b);g.rb=\"opaque\";g.p=\"9.0.124\";g.Va=\"always\";g.L(sb(this.b));g.f().id=\"adaptvDiv\";var e=setInterval(t(function(){if(!(!rd(g)||window.__adaptv__.jsproxy==j||window.__adaptv__.jsproxy[kd(g)]==j))if(rd(g)&&window.__adaptv__.jsproxy!=j){clearInterval(e);this.Ba=window.__adaptv__.jsproxy[kd(g)].swfloader;this.Ba.__on(\"adaptv_swfloader_SwfLoaded\",function(){function h(l){this.o.info(\"[AdPlayerEvent] \"+l.type,l.data);switch(l.type){case\"scriptFetched\":l.data.hasPreroll===i?ud(this,X.Sa):ud(this,X.Ea,{message:l.data.message||\"No preroll ad available in control script\"});break;case\"breakStarted\":ud(this,X.Ta);break;case\"clickThru\":ud(this,X.sb,l.data);break;case\"companion\":ud(this,X.Ra,l.data);break;case\"breakEnded\":var m=Oc(function(){Lc.clearTimeout(m);ud(this,X.Ua)},500,this)}}this.o.info(\"swfloader loaded\");this.H=window.__adaptv__.jsproxy[kd(g)].adplayer;mb(sd,function(l){this.H.__on(l,h,this)},this);this.H.apiVersion(\"2.1\");this.H.setMetadata(c);this.H.setContentSize(500,400);this.H.setHTMLSize(a,b,0,0);this.H.fetchScript()},this);this.Ba.__on(\"adaptv_swfloader_SwfLoadError\",function(){this.o.info(\"swfloader load error\");ud(this,X.Ea)},this);this.Ba.init(500,400);this.Ba.load(d+\"/redir/client/static/AS3AdPlayer.swf\",\"adplayer\",{events:nb(sd)})}},this),500)};td.prototype.startAd=function(){this.H.startBreak()};function vd(a,b,c,d){a.a.push({type:b,fn:c,scope:d})}td.prototype.r=function(){this.H.destroy()};var X={Sa:\"AdLoaded\",Ta:\"AdStarted\",Ra:\"AdCompanionDisplay\",sb:\"AdClickThru\",Ua:\"AdStopped\",Ea:\"AdError\"};function wd(a,b,c,d,g,e){if(s(a)){this.p=a==xd?b:0;this.e=a==yd?b:0;this.a=a==zd?b:0;this.b=a==Ad?b:0;this.c=a==Bd?b:0;this.k=a==Cd?b:0}else{this.p=a||0;this.e=b||0;this.a=c||0;this.b=d||0;this.c=g||0;this.k=e||0}}wd.prototype.J=function(){return new wd(this.p,this.e,this.a,this.b,this.c,this.k)};var xd=\"y\",yd=\"m\",zd=\"d\",Ad=\"h\",Bd=\"n\",Cd=\"s\";function Dd(a){Ba(a.p==0&&a.e==0);return((a.a*24+a.b)*60+a.c)*60+a.k}\nfunction Ed(a,b,c){if(typeof a==\"number\"){this.a=new Date(a,b||0,c||1);Fd(this,c||1)}else if(ga(a)){this.a=new Date(a.getFullYear(),a.getMonth(),a.getDate());Fd(this,a.getDate())}else{this.a=new Date;this.a.setHours(0);this.a.setMinutes(0);this.a.setSeconds(0);this.a.setMilliseconds(0)}}p=Ed.prototype;p.ka=0;p.la=3;p.J=function(){var a=new Ed(this.a);a.ka=this.ka;a.la=this.la;return a};p.getFullYear=function(){return this.a.getFullYear()};p.getMonth=function(){return this.a.getMonth()};p.getDate=function(){return this.a.getDate()};p.getTime=function(){return this.a.getTime()};function Gd(a){a=a.a.getTimezoneOffset();if(a==0)a=\"Z\";else{var b=Math.abs(a)/60,c=Math.floor(b);a=(a>0?\"-\":\"+\")+y(c)+\":\"+y((b-c)*60)}return a}\np.Ja=function(a){if(a.p||a.e){var b=this.getMonth()+a.e+a.p*12,c=this.getFullYear()+Math.floor(b/12);b%=12;if(b<0)b+=12;var d;a:{switch(b){case 1:d=c%4==0&&(c%100!=0||c%400==0)?29:28;break a;case 5:case 8:case 10:case 3:d=30;break a}d=31}d=Math.min(d,this.getDate());this.a.setDate(1);this.a.setFullYear(c);this.a.setMonth(b);this.a.setDate(d)}if(a.a){a=new Date((new Date(this.getFullYear(),this.getMonth(),this.getDate(),12)).getTime()+a.a*864E5);this.a.setDate(1);this.a.setFullYear(a.getFullYear());this.a.setMonth(a.getMonth());this.a.setDate(a.getDate());Fd(this,a.getDate())}};p.oa=function(a,b){return[this.getFullYear(),y(this.getMonth()+1),y(this.getDate())].join(a?\"-\":\"\")+(b?Gd(this):\"\")};p.toString=function(){return this.oa()};function Fd(a,b){if(a.getDate()!=b)a.a.setUTCHours(a.a.getUTCHours()+(a.getDate()<b?1:-1))}p.valueOf=function(){return this.a.valueOf()};function Y(a,b,c,d,g,e,h){this.a=typeof a==\"number\"?new Date(a,b||0,c||1,d||0,g||0,e||0,h||0):new Date(a?a.getTime():u())}\nw(Y,Ed);Y.prototype.Ja=function(a){Ed.prototype.Ja.call(this,a);a.b&&this.a.setHours(this.a.getHours()+a.b);a.c&&this.a.setMinutes(this.a.getMinutes()+a.c);a.k&&this.a.setSeconds(this.a.getSeconds()+a.k)};Y.prototype.oa=function(a,b){var c=Ed.prototype.oa.call(this,a);if(a)return c+\" \"+y(this.a.getHours())+\":\"+y(this.a.getMinutes())+\":\"+y(this.a.getSeconds())+(b?Gd(this):\"\");return c+\"T\"+y(this.a.getHours())+y(this.a.getMinutes())+y(this.a.getSeconds())+(b?Gd(this):\"\")};Y.prototype.toString=function(){return this.oa()};Y.prototype.J=function(){var a=new Y(this.a);a.ka=this.ka;a.la=this.la;return a};function Hd(a){this.R=a||window;this.va=P(this.R,\"resize\",this.Jb,k,this);this.Aa=vb(this.R||window);if(C&&Qa||A&&this.R.self!=this.R.top)this.Da=window.setInterval(t(this.Xa,this),Id)}w(Hd,S);var Id=500;p=Hd.prototype;p.va=j;p.R=j;p.Aa=j;p.Da=j;p.i=function(){Hd.q.i.call(this);if(this.va){Q(this.va);this.va=j}if(this.Da){window.clearInterval(this.Da);this.Da=j}this.Aa=this.R=j};p.Jb=function(){this.Xa()};p.Xa=function(){var a=vb(this.R||window),b;b=this.Aa;b=a==b?i:!a||!b?k:a.width==b.width&&a.height==b.height;if(!b){this.Aa=a;R(this,\"resize\")}};var Jd=/\\s*;\\s*/;function Kd(a,b){var c=86400;if(/[;=\\s]/.test(a))f(Error(\'Invalid cookie name \"\'+a+\'\"\'));if(/[;\\r\\n]/.test(b))f(Error(\'Invalid cookie value \"\'+b+\'\"\'));c!==undefined||(c=-1);c=c<0?\"\":c==0?\";expires=\"+(new Date(1970,1,1)).toUTCString():\";expires=\"+(new Date(u()+c*1E3)).toUTCString();document.cookie=a+\"=\"+b+\";domain=.adap.tv;path=/\"+c+\"\"}function Ld(a){a=a+\"=\";for(var b=(document.cookie||\"\").split(Jd),c=0,d;d=b[c];c++)if(d.indexOf(a)==0)return d.substr(a.length);return\"0\"};function Md(a){a.setAttribute(\"role\",\"dialog\");a.a=\"dialog\"};function Nd(a){this.j=a;a=B?\"focusout\":\"blur\";this.a=P(this.j,B?\"focusin\":\"focus\",this,!B);this.b=P(this.j,a,this,!B)}w(Nd,S);Nd.prototype.handleEvent=function(a){var b=new L(a.G);b.type=a.type==\"focusin\"||a.type==\"focus\"?\"focusin\":\"focusout\";try{R(this,b)}finally{b.r()}};Nd.prototype.i=function(){Nd.q.i.call(this);Q(this.a);Q(this.b);delete this.j};function Od(a,b,c){this.target=a;this.e=b||a;this.k=c||new Uc(NaN,NaN,NaN,NaN);this.c=I(a);this.a=new Pc(this);P(this.e,\"mousedown\",this.lb,k,this)}w(Od,S);var Pd=B||Va&&D(\"1.9.3\");p=Od.prototype;p.ba=0;p.ca=0;p.mb=0;p.nb=0;p.X=0;p.Y=0;p.$a=i;p.I=k;p.db=0;p.Qb=0;p.Kb=k;p.i=function(){Od.q.i.call(this);Fc(this.e,\"mousedown\",this.lb,k,this);this.a.r();delete this.target;delete this.e;delete this.a};p.lb=function(a){if(this.$a&&!this.I&&(a.type!=\"mousedown\"||(fc?a.G.button==0:a.type==\"click\"||a.G.button&lc[0]))){if(this.db==0){Qd(this,a);if(this.I)a.K();else return}else a.K();var b=this.c,c=b.documentElement,d=!Pd;U(this.a,b,\"mousemove\",this.Rb,d);U(this.a,b,\"mouseup\",this.ja,d);if(Pd){c.setCapture(k);U(this.a,c,\"losecapture\",this.ja)}else U(this.a,wb(b),\"blur\",this.ja);B&&this.Kb&&U(this.a,b,\"dragstart\",ic);this.p&&U(this.a,this.p,\"scroll\",this.Tb,d);this.ba=this.mb=a.pa;this.ca=this.nb=a.qa;this.X=this.target.offsetLeft;this.Y=this.target.offsetTop;this.b=Db(H(this.c));this.Qb=u()}};function Qd(a,b){if(R(a,new Rd(\"start\",a,b.clientX,b.clientY,b))!==k)a.I=i}p.ja=function(a,b){Tc(this.a);Pd&&this.c.releaseCapture();if(this.I){this.I=k;R(this,new Rd(\"end\",this,a.clientX,a.clientY,a,Sd(this,this.X),Td(this,this.Y),b))}};p.Rb=function(a){if(this.$a){var b=a.pa-this.ba,c=a.qa-this.ca;this.ba=a.pa;this.ca=a.qa;if(!this.I){var d=this.mb-this.ba,g=this.nb-this.ca;if(d*d+g*g>this.db){Qd(this,a);if(!this.I){this.ja(a);return}}}c=Ud(this,b,c);b=c.x;c=c.y;if(this.I)if(R(this,new Rd(\"beforedrag\",this,a.clientX,a.clientY,a,b,c))!==k){Vd(this,a,b,c);a.K()}}};function Ud(a,b,c){var d=Db(H(a.c));b+=d.x-a.b.x;c+=d.y-a.b.y;a.b=d;a.X+=b;a.Y+=c;return new E(Sd(a,a.X),Td(a,a.Y))}\np.Tb=function(a){var b=Ud(this,0,0);a.clientX=this.b.x-this.ba;a.clientY=this.b.x-this.ca;Vd(this,a,b.x,b.y)};function Vd(a,b,c,d){a.target.style.left=c+\"px\";a.target.style.top=d+\"px\";R(a,new Rd(\"drag\",a,b.clientX,b.clientY,b,c,d))}function Sd(a,b){var c=a.k,d=!isNaN(c.left)?c.left:j;c=!isNaN(c.width)?c.width:0;return Math.min(d!=j?d+c:Infinity,Math.max(d!=j?d:-Infinity,b))}\nfunction Td(a,b){var c=a.k,d=!isNaN(c.top)?c.top:j;c=!isNaN(c.height)?c.height:0;return Math.min(d!=j?d+c:Infinity,Math.max(d!=j?d:-Infinity,b))}function Rd(a,b,c,d,g,e,h,l){K.call(this,a);this.clientX=c;this.clientY=d;this.b=g;this.left=e!==undefined?e:b.X;this.top=h!==undefined?h:b.Y;this.e=b;this.c=!!l}w(Rd,K);function Wd(a,b,c){W.call(this,c);this.w=a||\"modal-dialog\";this.Pa=!!b;this.z=Xd()}w(Wd,W);p=Wd.prototype;p.ma=j;p.Ab=i;p.ua=i;p.Pa=k;p.xa=i;p.Z=i;p.Ga=0.5;p.qb=\"\";p.Ia=\"\";p.z=j;p.A=j;p.Ca=k;p.Za=k;p.l=j;p.n=j;p.W=j;p.fa=j;p.pb=j;p.Q=j;p.ha=j;p.C=j;function Yd(a,b){a.qb=b;if(a.fa){var c=a.fa;if(\"textContent\"in c)c.textContent=b;else if(c.firstChild&&c.firstChild.nodeType==3){for(;c.lastChild!=c.firstChild;)c.removeChild(c.lastChild);c.firstChild.data=b}else{for(var d;d=c.firstChild;)c.removeChild(d);c.appendChild(I(c).createTextNode(b))}}}function Zd(a,b){a.Ia=b;if(a.ha)a.ha.innerHTML=b}function $d(a){a.f()||a.L();return a.Q}function ae(a){a.f()||a.L();return a.l}function be(a,b){a.Ga=b;a.l&&hd(a.l,a.Ga)}\nfunction ce(a){a.Z=k;if(a.Z&&!a.A&&a.f())a.A=de(a);else if(!a.Z&&a.A){a.f()&&lb(a.W,a.w+\"-title-draggable\");a.A.r();a.A=j}}function de(a){var b=new Od(a.f(),a.W);kb(a.W,a.w+\"-title-draggable\");return b}\np.t=function(){if(this.Pa&&this.xa&&!this.n){this.n=this.v().t(\"iframe\",{frameborder:0,style:\"border:0;vertical-align:bottom;\",src:\'javascript:\"\"\'});this.n.className=this.w+\"-bg\";V(this.n,k);hd(this.n,0)}else if((!this.Pa||!this.xa)&&this.n){Bb(this.n);this.n=j}if(this.xa&&!this.l){this.l=this.v().t(\"div\",this.w+\"-bg\");hd(this.l,this.Ga);V(this.l,k)}else if(!this.xa&&this.l){Bb(this.l);this.l=j}var a=this.v();this.j=a.t(\"div\",{className:this.w,tabIndex:0},this.W=a.t(\"div\",{className:this.w+\"-title\",id:kd(this)},this.fa=a.t(\"span\",this.w+\"-title-text\",this.qb),this.Q=a.t(\"span\",this.w+\"-title-close\")),this.ha=a.t(\"div\",this.w+\"-content\"),this.C=a.t(\"div\",this.w+\"-buttons\"),this.b=a.t(\"span\",{tabIndex:0}));this.pb=this.W.id;Md(this.f());this.f().setAttribute(\"aria-labelledby\",this.pb||\"\");if(this.Ia)this.ha.innerHTML=this.Ia;V(this.Q,this.ua);V(this.f(),k);if(this.z){a=this.z;a.j=this.C;ee(a)}};p.L=function(a){if(this.D)f(Error(\"Component already rendered\"));this.f()||this.t();a=a||Cb(this.v()).body;this.n&&a.appendChild(this.n);this.l&&a.appendChild(this.l);Wd.q.L.call(this,a)};p.S=function(){Wd.q.S.call(this);this.ma=new Nd(Cb(this.v()));if(this.Z&&!this.A)this.A=de(this);U(U(ld(this),this.Q,\"click\",this.Ub),this.ma,\"focusin\",this.Sb);Md(this.f());this.fa.id!==\"\"&&this.f().setAttribute(\"aria-labelledby\",this.fa.id)};p.$=function(){this.Ca&&fe(this,k);this.ma.r();this.ma=j;if(this.A){this.A.r();this.A=j}Wd.q.$.call(this)};function fe(a,b){if(b!=a.Ca){var c=Cb(a.v()),d=wb(c)||window;a.D||a.L(c.body);if(b){ge(a);a.P();U(U(U(ld(a),a.f(),\"keydown\",a.ya),a.f(),\"keypress\",a.ya),d,\"resize\",a.ib)}else Sc(Sc(Sc(ld(a),a.f(),\"keydown\",a.ya),a.f(),\"keypress\",a.ya),d,\"resize\",a.ib);a.n&&V(a.n,b);a.l&&V(a.l,b);V(a.f(),b);b&&a.focus();if(a.Ca=b)U(ld(a),a.C,\"click\",a.hb);else{Sc(ld(a),a.C,\"click\",a.hb);R(a,he);a.Za&&a.r()}}}\np.focus=function(){try{this.f().focus()}catch(a){}if(this.z){var b=this.z.ia;if(b)for(var c=Cb(this.v()),d=this.C.getElementsByTagName(\"button\"),g=0,e;e=d[g];g++)if(e.name==b){try{if(C||A){var h=c.createElement(\"input\");h.style.cssText=\"position:fixed;width:0;height:0;left:0;top:0;\";this.f().appendChild(h);h.focus();this.f().removeChild(h)}e.focus()}catch(l){}break}}};function ge(a){a.n&&V(a.n,k);a.l&&V(a.l,k);var b=Cb(a.v()),c=vb(wb(b)||window||window),d=Math.max(b.body.scrollWidth,c.width);b=Math.max(b.body.scrollHeight,c.height);if(a.n){V(a.n,i);ed(a.n,d,b)}if(a.l){V(a.l,i);ed(a.l,d,b)}if(a.Z){c=fd(a.f());a.A.k=new Uc(0,0,d-c.width,b-c.height)}}\np.P=function(){var a=Cb(this.v()),b=wb(a)||window;if(Zc(this.f(),\"position\")==\"fixed\")var c=a=0;else{c=Db(this.v());a=c.x;c=c.y}var d=fd(this.f());b=vb(b||window);$c(this.f(),Math.max(a+b.width/2-d.width/2,0),Math.max(c+b.height/2-d.height/2,0))};p.Ub=function(){if(this.ua){var a=this.z,b=a&&a.Ha;if(b)R(this,new ie(b,Lb(a,b)))&&fe(this,k);else fe(this,k)}};function je(a,b){a.ua=b;a.Q&&V(a.Q,a.ua)}\np.i=function(){Wd.q.i.call(this);if(this.l){Bb(this.l);this.l=j}if(this.n){Bb(this.n);this.n=j}this.b=this.C=this.Q=j};function ke(a){a.z=j;if(a.C)if(a.z){var b=a.z;b.j=a.C;ee(b)}else a.C.innerHTML=\"\"}p.hb=function(a){a:{for(a=a.target;a!=j&&a!=this.C;){if(a.tagName==\"BUTTON\"){a=a;break a}a=a.parentNode}a=j}if(a&&!a.disabled){a=a.name;R(this,new ie(a,Lb(this.z,a)))&&fe(this,k)}};p.ya=function(a){var b=k,c=k,d=this.z,g=a.target;if(a.type==\"keydown\")if(this.Ab&&a.keyCode==27){var e=d&&d.Ha;g=g.tagName==\"SELECT\"&&!g.disabled;if(e&&!g){c=i;b=R(this,new ie(e,Lb(d,e)))}else g||(b=i)}else{if(a.keyCode==9&&a.cb&&g==this.f())c=i}else if(a.keyCode==13){if(g.tagName==\"BUTTON\")e=g.name;else if(d){var h=d.ia,l;if(l=h)a:{l=d.j.getElementsByTagName(\"BUTTON\");for(var m=0,n;n=l[m];m++)if(n.name==h||n.id==h){l=n;break a}l=j}l=l;g=(g.tagName==\"TEXTAREA\"||g.tagName==\"SELECT\")&&!g.disabled;if(l&&!l.disabled&&!g)e=h}if(e){c=i;b=R(this,new ie(e,String(Lb(d,e))))}}if(b||c){a.ra();a.K()}b&&fe(this,k)};p.ib=function(){ge(this)};p.Sb=function(a){this.b==a.target&&Oc(this.Bb,0,this)};p.Bb=function(){B&&Cb(this.v()).body.focus();this.f().focus()};function ie(a,b){this.type=le;this.key=a;this.caption=b}w(ie,K);var le=\"dialogselect\",he=\"afterhide\";function me(a){this.c=a||H();Jb.call(this)}w(me,Jb);p=me.prototype;p.w=\"goog-buttonset\";p.ia=j;p.j=j;p.Ha=j;p.da=function(a,b,c,d){Jb.prototype.da.call(this,a,b);if(c)this.ia=a;if(d)this.Ha=a;return this};function Z(a,b,c,d){return a.da(b.key,b.caption,c,d)}function ee(a){if(a.j){a.j.innerHTML=\"\";var b=H(a.j);Ib(a,function(c,d){var g=b.t(\"button\",{name:d},c);if(d==this.ia)g.className=this.w+\"-default\";this.j.appendChild(g)},a)}}\nvar ne=na(\"OK\"),oe=na(\"Cancel\"),pe=na(\"Yes\"),qe=na(\"No\"),re=na(\"Save\"),se=na(\"Continue\"),te={key:\"ok\",caption:ne},ue={key:\"cancel\",caption:oe},ve={key:\"yes\",caption:pe},we={key:\"no\",caption:qe},xe={key:\"save\",caption:re},ye={key:\"continue\",caption:se};function Xd(){return Z(Z(new me,te,i),ue,k,i)}Z(new me,te,i,i);Xd();Z(Z(new me,ve,i),we,k,i);Z(Z(Z(new me,ve),we,i),ue,k,i);Z(Z(Z(new me,ye),xe),ue,i,i);function $(a,b){this.o=cc(\"adaptv.ads.VideoInterstitial\");this.o.info(\"VideoInterstitial()\");if(b!=j){this.width=b.width;this.height=b.height;this.e=b.config}this.a=a}p=$.prototype;p.Oa=function(a){this.width=a;return this};p.La=function(a){this.height=a;return this};p.Ma=function(a){this.a=a;return this};p.Ka=function(a){this.e=a;return this};function ze(a){a.o.info(\"showOverlay()\");fe(a.g,i);a.P();var b=new Hd;P(b,\"resize\",function(){this.P()},k,a)}\np.Fa=function(){this.o.info(\"show()\");var a=new Y,b=parseInt(Ld(\"viewCount\"),10);a.a.setTime(parseInt(Ld(\"lastViewTime\"),10));b+=1;Kd(\"viewCount\",b.toString());this.o.info(\"viewCount: \"+b);this.o.info(\"lastViewTime: \"+a.toString());this.a.loadOnView=this.a.loadOnView||1;this.a.viewCap=this.a.viewCap||1;if(b<this.a.loadOnView){this.o.info(\"capped - will only show on view \"+this.a.loadOnView.toString());return this}if((b-this.a.loadOnView)%this.a.viewCap!=0){this.o.info(\"viewCapped - limited to once every \"+\nthis.a.viewCap.toString()+\" view(s)\");return this}if(this.a.timeCap!=j){b=parseFloat(this.a.timeCap.slice(0,-1));var c=this.a.timeCap.slice(-1);b=new wd({s:Cd,m:Bd,h:Ad,d:zd}[c],b);a=a.J();a.Ja(b);this.o.info(\"interval: \"+Dd(b).toString());this.o.info(\"nextViewTime: \"+a);if(a>new Y){this.o.info(\"timeCapped - limited to once every \"+this.a.timeCap);return this}}this.init();if(this.a.coverPage===i){this.o.info(\"showCover()\");V(ae(this.g),i);this.g.n!=j&&V(this.g.n,i);ge(this.g);if(this.a.timeout_ms!=j)this.ob=Oc(function(){if(!this.ub){this.o.info(\"Timing out the interstitial\");this.M()}Lc.clearTimeout(this.ob)},this.a.timeout_ms,this)}return this};p.M=function(){this.o.info(\"hide()\");Bb(this.b);Lc.clearTimeout(this.ob);if(this.F!=j){this.F.stop();this.F.r();this.F=j}if(this.g!=j){fe(this.g,k);this.g.r();this.g=j}return this};p.P=function(){this.o.info(\"reposition()\");if(this.g){ge(this.g);this.g.P();this.g.Ca&&dd(this.b,cd(this.c))}else dd(this.b,-this.width-100,-this.height-100)};p.init=function(){this.o.info(\"init()\");var a=this.a.ids={};a.DEFAULT_PREFIX=this.a.classNamePrefix||\"adaptv-interstitial\";a.CONTAINER=a.DEFAULT_PREFIX+\"-container\";a.ADPLAYER=a.DEFAULT_PREFIX+\"-video\";a.COMPANION=a.DEFAULT_PREFIX+\"-companion\";a.ADPLAYER_ABS=a.DEFAULT_PREFIX+\"-fixed\";this.g=new Wd(this.a.className||a.DEFAULT_PREFIX,i);Zd(this.g,Gb({zb:a.CONTAINER,xb:a.ADPLAYER,yb:a.COMPANION}));ke(this.g);ce(this.g);this.g.Za=i;Yd(this.g,this.a.title||\"Video Ad\");be(this.g,this.a.backgroundOpacity==j?0.8:this.a.backgroundOpacity);je(this.g,this.a.hasCloseButton==j?i:this.a.hasCloseButton);ae(this.g);this.c=sb(this.a.ids.ADPLAYER);this.wb=sb(this.a.ids.COMPANION);if(this.width==j){var b=Yc(this.c,\"width\")||this.c.currentStyle.width;this.Oa(parseInt(b.slice(0,-2),10))}if(this.height==j){b=Yc(this.c,\"height\")||this.c.currentStyle.height;this.La(parseInt(b.slice(0,-2),10))}this.b=xb(\"div\",{id:a.ADPLAYER_ABS});document.body.appendChild(this.b);Vc(this.b,\"position\",\"fixed\");Vc(this.b,\"z-index\",1E5);dd(this.b,-this.width-100,-this.height-100);this.Qa=new td(a.ADPLAYER_ABS);mb(X,function(c){vd(this.Qa,c,function(d){this.o.info(\"[VPAIDEvent] \"+d.type);switch(d.type){case X.Sa:this.ub=i;this.Qa.startAd();break;case X.Ta:ze(this);break;case X.Ra:var g=sb(a.COMPANION);g.style.width=ad(d.data.companion_width,i);g.style.height=ad(d.data.companion_height,i);this.P();break;case X.Ea:this.M();break;case X.Ua:var e=Oc(function(){Lc.clearTimeout(e);this.M()},500,this);Kd(\"lastViewTime\",u().toString())}},this)},this);this.e.companionId=a.COMPANION;this.e.interstitial=i;this.Qa.initAd(this.width,this.height,this.e);this.a.hasCloseButton===i&&P($d(this.g),\"click\",function(){this.M()},i,this);this.a.escapeToClose===i&&P(this.g.f(),\"keydown\",function(c){c.type==\"keydown\"&&c.keyCode==27&&this.M()},i,this);this.F=new T(300);Nc(this.F);P(this.F,Mc,function(){if(this.wb.innerHTML!=\"\"){this.P();this.F.stop();this.F.r();this.F=j;var c=this.g;c.f()||c.L();c.W.appendChild(this.g.v().t(\"span\"))}},k,this);P(window,\"unload\",function(){Ic()},k,this)};var Ae=new function(){this.a=u()};function Be(a){this.a=a||\"\";this.b=Ae}p=Be.prototype;p.jb=i;p.Yb=i;p.Xb=i;p.kb=k;p.Zb=k;function Ce(a){if(a<10)return\"0\"+a;return String(a)}function De(a){Be.call(this,a)}w(De,Be);function Ee(){this.k=t(this.c,this);this.a=new De;this.a.jb=k;this.b=this.a.kb=k;this.e=\"\"}\nEe.prototype.c=function(a){var b;b=this.a;var c=[];c.push(b.a,\" \");if(b.jb){var d=new Date(a.k);c.push(\"[\",Ce(d.getFullYear()-2E3)+Ce(d.getMonth()+1)+Ce(d.getDate())+\" \"+Ce(d.getHours())+\":\"+Ce(d.getMinutes())+\":\"+Ce(d.getSeconds())+\".\"+Ce(Math.floor(d.getMilliseconds()/10)),\"] \")}if(b.Yb){d=(a.k-b.b.a)/1E3;var g=d.toFixed(3),e=0;if(d<1)e=2;else for(;d<100;){e++;d*=10}for(;e-->0;)g=\" \"+g;c.push(\"[\",g,\"s] \")}b.Xb&&c.push(\"[\",a.p,\"] \");b.Zb&&c.push(\"[\",a.c.name,\"] \");c.push(a.e,\"\\n\");b.kb&&a.b&&c.push(a.a,\"\\n\");b=c.join(\"\");if(window.console&&window.console.firebug)switch(a.c){case Tb:window.console.info(b);break;case Ub:window.console.error(b);break;case Vb:window.console.warn(b);break;default:window.console.debug(b)}else if(window.console)window.console.log(b);else if(window.opera)window.opera.postError(b);else this.e+=b};v(\"__adaptv__.debug.configure\",function(a,b){cc(a).b=b||Yb;var c=new Ee;if(i!=c.b){bc();var d=ac,g=c.k;if(!d.a)d.a=[];d.a.push(g);c.b=i}});v(\"__adaptv__.debug.log\",function(a){cc(\"adaptv.page\").info(a)});v(\"__adaptv__.ads.interstitial.VideoInterstitial\",$);v(\"__adaptv__.ads.interstitial.VideoInterstitial.prototype.setWidth\",$.prototype.Oa);v(\"__adaptv__.ads.interstitial.VideoInterstitial.prototype.setHeight\",$.prototype.La);v(\"__adaptv__.ads.interstitial.VideoInterstitial.prototype.setOptions\",$.prototype.Ma);v(\"__adaptv__.ads.interstitial.VideoInterstitial.prototype.setAdConfig\",$.prototype.Ka);v(\"__adaptv__.ads.interstitial.VideoInterstitial.prototype.show\",$.prototype.Fa);v(\"__adaptv__.ads.interstitial.VideoInterstitial.prototype.hide\",$.prototype.M);v(\"__adaptv__.ads.VideoInterstitial\",$);v(\"__adaptv__.ads.VideoInterstitial.prototype.setWidth\",$.prototype.Oa);v(\"__adaptv__.ads.VideoInterstitial.prototype.setHeight\",$.prototype.La);v(\"__adaptv__.ads.VideoInterstitial.prototype.setOptions\",$.prototype.Ma);v(\"__adaptv__.ads.VideoInterstitial.prototype.setAdConfig\",$.prototype.Ka);v(\"__adaptv__.ads.VideoInterstitial.prototype.show\",$.prototype.Fa);v(\"__adaptv__.ads.VideoInterstitial.prototype.hide\",$.prototype.M);window.adaptv_videoint_adconfig!=j&&(new $).Ka(window.adaptv_videoint_adconfig).Ma(window.adaptv_videoint_options).Fa();})();";


/* public/javascripts/shared/ad_hider.js @ 1339185887 */

Scribd.AdHider=(function(){var hideElement=function(el){try{el.setStyle({visibility:'hidden !important'});}catch(e){el.hide();}}
var showElement=function(el){try{el.setStyle({visibility:'visible !important'});}catch(e){el.show();}}
AdHider=function(){this.HIDE_EVENTS.each(function(hide_event){$(document).observe(hide_event,function(e){this.AD_CLASSES.each(function(klass){$$(klass).each(function(el){hideElement(el);el.select("iframe").each(hideElement);});});}.bind(this));}.bind(this));this.SHOW_EVENTS.each(function(show_event){$(document).observe(show_event,function(e){this.AD_CLASSES.each(function(klass){$$(klass).each(function(el){showElement(el);el.select("iframe").each(showElement);});});}.bind(this));}.bind(this));}
AdHider.prototype={AD_CLASSES:['.hideable_ad'],HIDE_EVENTS:['lightbox:open'],SHOW_EVENTS:['lightbox:closed']}
return AdHider;})();


/* public/javascripts/shared/csrf.js @ 1339185887 */

Scribd.init('Scribd','CSRF');Scribd.CSRF={initialize:function(){var meta_param=$$('meta[name=csrf-param]').first(),meta_token=$$('meta[name=csrf-token]').first();this.active=meta_param&&meta_token;this.paramsHash={};if(this.active){this.param=meta_param.readAttribute('content');this.token=meta_token.readAttribute('content');this.paramsHash[this.param]=this.token;}},paramsWithToken:function(params){return Object.extend(params,this.paramsHash);}};document.observe('dom:loaded',Scribd.CSRF.initialize.bind(Scribd.CSRF));


/* public/javascripts/shared/customEffects.js @ 1339185887 */

Effect.FadeWithCallback=function(element){element=$(element);var oldOpacity=element.getInlineOpacity();var options=Object.extend({from:element.getOpacity()||1.0,to:0.0,callback:function(){},afterFinishInternal:function(effect){effect.options.callback();}},arguments[1]||{});return new Effect.Opacity(element,options);};


/* public/javascripts/shared/embed_code.js @ 1339185887 */
var lzy_js_public_javascripts_shared_embed_code="\nScribd.genericEmbedCodeGenerator=Class.create({minWidth:400,minHeight:400,maxWidth:1600,maxHeight:1600,defaultWidth:400,defaultHeight:600,defaultPage:1,defaultMode:\'list\',defaultAutoWidth:true,defaultAutoHeight:false,initialize:function(options){this.options=Object.extend({width:this.defaultWidth,height:this.defaultHeight,page:this.defaultPage,mode:this.defaultMode,auto_width:this.defaultAutoWidth,auto_height:this.defaultAutoHeight,show_title:true,doc_url:\'\',title:\',\',doc_id:0,access_key:\'\'},options||{});this.options.object_id=\'doc_\'+Math.floor(Math.random()*99999);this.buildTemplates();},render:function(options){this.updateOptions(options);return this.renderTemplates();},updateOptions:function(options){this.options=Object.extend(this.options,options);this.options.width=this.options.width||this.defaultWidth;this.options.height=this.options.height||this.defaultHeight;this.options.page=this.options.page||this.defaultPage;if(this.options.auto_width||this.options.width==\"100%\"){this.options.width=\'100%\';}else if(parseInt(this.options.width)<this.minWidth){this.options.width=this.minWidth;}\nif(this.options.auto_height){this.options.height=this.defaultHeight;}else if(parseInt(this.options.height)<this.minHeight){this.options.height=this.minHeight;}},titleString:function(){if(this.options.show_title){return this.title_tmpl.evaluate({title:this.options.title.escapeHTML(),doc_url:this.options.doc_url,title_truncated:this.options.title.escapeHTML().truncate(110)});}else{return\"\";}}});Scribd.WordpressEmbedCodeGenerator=Class.create(Scribd.genericEmbedCodeGenerator,{buildTemplates:function(){this.wp_tmpl=new Template(\"[scribd id=#{doc_id} key=#{access_key} mode=#{mode}]\");},renderTemplates:function(){return this.wp_tmpl.evaluate(this.options);}});Scribd.embedCodeGenerator=Class.create(Scribd.genericEmbedCodeGenerator,{buildTemplates:function(){this.title_tmpl=new Template(\'<a title=\"View #{title} on Scribd\" href=\"#{doc_url}\" style=\"margin: 12px auto 6px auto; font-family: Helvetica,Arial,Sans-serif; font-style: normal; font-variant: normal; font-weight: normal; font-size: 14px; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none; display: block; text-decoration: underline;\">#{title_truncated}<\/a> \');this.object_tmpl=new Template(\'<object id=\"#{object_id}\" name=\"#{object_id}\" height=\"#{height}\" width=\"#{width}\" type=\"application/x-shockwave-flash\" data=\"http://d1.scribdassets.com/ScribdViewer.swf\" style=\"outline:none;\" >\\\n            <param name=\"movie\" value=\"http://d1.scribdassets.com/ScribdViewer.swf\"> \\\n            <param name=\"wmode\" value=\"opaque\"> \\\n            <param name=\"bgcolor\" value=\"#ffffff\"> \\\n            <param name=\"allowFullScreen\" value=\"true\"> \\\n            <param name=\"allowScriptAccess\" value=\"always\"> \\\n            <param name=\"FlashVars\" value=\"document_id=#{doc_id}&access_key=#{access_key}&page=#{page}&viewMode=#{mode}\"> \\\n            <embed id=\"#{object_id}\" name=\"#{object_id}\" src=\"http://d1.scribdassets.com/ScribdViewer.swf?document_id=#{doc_id}&access_key=#{access_key}&page=#{page}&viewMode=#{mode}\" type=\"application/x-shockwave-flash\" allowscriptaccess=\"always\" allowfullscreen=\"true\" height=\"#{height}\" width=\"#{width}\" wmode=\"opaque\" bgcolor=\"#ffffff\"><\/embed> \\\n        <\/object>\');this.script_tmpl=new Template(\'\');},renderTemplates:function(){var object_str=this.object_tmpl.evaluate(this.options);return(this.titleString()+object_str);}});Scribd.HTML5EmbedCodeGenerator=Class.create(Scribd.genericEmbedCodeGenerator,{renderTemplates:function(){var generate_height_script=false;if(this.options.auto_height&&this.options.aspect_ratio){if(this.options.auto_width){generate_height_script=true;}else{this.options.height=Math.round((1/this.options.aspect_ratio)*this.options.width)+60;}}\nthis.options.embed_url=\"http://www.scribd.com/embeds/\"+this.options.doc_id+\"/content\";this.options.embed_url=this.options.embed_url.updateQueryParams({start_page:this.options.page,view_mode:this.options.mode});if(this.options.access_key&&this.options.access_key.length>0){this.options.embed_url=this.options.embed_url.updateQueryParams({access_key:this.options.access_key});}\nif(this.options.secret_password){this.options.embed_url=this.options.embed_url.updateQueryParams({secret_password:this.options.secret_password});}\nvar object_str=this.iframe_tmpl.evaluate({embed_url:this.options.embed_url,object_id:this.options.object_id,aspect_ratio:this.options.aspect_ratio,width:this.options.width,height:this.options.height,auto_height:!!this.options.auto_width});out=this.titleString()+object_str;if(generate_height_script){out+=this.height_script_tmpl.evaluate({object_id:this.options.object_id});}\nreturn out;},buildTemplates:function(){this.title_tmpl=new Template(\'<a title=\"View #{title} on Scribd\" href=\"#{doc_url}\" style=\"margin: 12px auto 6px auto; font-family: Helvetica,Arial,Sans-serif; font-style: normal; font-variant: normal; font-weight: normal; font-size: 14px; line-height: normal; font-size-adjust: none; font-stretch: normal; -x-system-font: none; display: block; text-decoration: underline;\">#{title_truncated}<\/a>\');this.iframe_tmpl=new Template(\'<iframe class=\"scribd_iframe_embed\" src=\"#{embed_url}\" data-auto-height=\"#{auto_height}\" data-aspect-ratio=\"#{aspect_ratio}\" scrolling=\"no\" id=\"#{object_id}\" width=\"#{width}\" height=\"#{height}\" frameborder=\"0\"><\/iframe>\');this.height_script_tmpl=new Template(\'<script type=\"text/javascript\">(function() { var scribd = document.createElement(\"script\"); scribd.type = \"text/javascript\"; scribd.async = true; scribd.src = \"http://www.scribd.com/javascripts/embed_code/inject.js\"; var s = document.getElementsByTagName(\"script\")[0]; s.parentNode.insertBefore(scribd, s); })();<\/script>\');}});";


/* public/javascripts/shared/facebook.js @ 1339185887 */

if(!window.Scribd)var Scribd=new Object();Scribd.Facebook=function(){var apiKey='1b464203f13e585f17de89797e59bd98';var appId='136494494209';var knobURL='';var loaded=false;var session=null;var cookie=new Scribd.JSONCookie('session_metadata');var transitioned=false;var isReadPage=false;var pageTransitionURL="/session_transition/new_page_content";var userUtilTemplate=new Template('\
    <li id="user_util" class="hover_menu l1">\
        <img src="/images/icons/fb_icon_15x15.gif" class="facebook_notice_icon">\
        <a href="http://www.scribd.com/people/view/#{word_user_id}" class="menu_control">#{word_user_name}</a>\
        <div class="sub_menu">\
            <div class="tail">\
                <img alt="Tri_11x6" src="/images/global_header/tri_11x6.gif">\
            </div>\
            <div class="menu_content">\
                #{ic_faq}\
                <h3>\
                  <fb:profile-pic class="fb_profile_thumb" uid="#{fbuid}" facebook-logo="false" linked="false" size="square" width="15" height="15"></fb:profile-pic>\
                  Account\
                </h3>\
                <ul>\
                    <li><a href="http://www.scribd.com/">My Home</a></li>\
                    <li><a href="http://www.scribd.com/people/view/#{word_user_id}">View Public Profile</a></li>\
                    <li><a href="http://www.scribd.com/documents">My Documents</a></li>\
                    <li><a href="http://www.scribd.com/my_document_collections">My Collections</a></li>\
                    <li><a href="http://www.scribd.com/inbox">Messages</a></li>\
                    <li id="util_logout"><a href="/account/edit">Settings</a></li>\
                    <li><a href="http://support.scribd.com">Help</a></li>\
                    <li><a href="http://www.scribd.com/logout">Log Out</a></li>\
                </ul>\
            </div>\
        </div>\
    </li>');var userUtilInstantConnectFaqHtml='<div class="facebook_notice"><h4>How does Scribd know my name?</h4><p>We are using Facebook to personalize your experience on Scribd.</p><a href="http://www.scribd.com/facebookfaq" target="_blank">Learn More</a></div>';function checkSessionState(){if(cookie.get('active_facebook_session')=='false'){Event.fire(document,Scribd.Facebook.EVENTS.inactive_facebook_session);session=false;}
else{FB.getLoginStatus(function(response){if(response.status==='connected'&&response.authResponse){Scribd.log('FB checkSessionState: active fb session');session=response.authResponse;Event.fire(document,Scribd.Facebook.EVENTS.active_facebook_session);}else{Scribd.log('FB checkSessionState: inactive fb session');cookie.set('active_facebook_session','false');cookie.save();session=false;Event.fire(document,Scribd.Facebook.EVENTS.inactive_facebook_session);}});}}
function updateGlobalHeader(word_user_id,word_user_name,created_by_ic){var html=userUtilTemplate.evaluate({'word_user_id':word_user_id,'word_user_name':word_user_name,fbuid:session.uid,ic_faq:created_by_ic?userUtilInstantConnectFaqHtml:''});Effect.FadeWithCallback('header_login',{callback:function(){var header=$('header_login')
header.update(html);header.removeClassName('logged_out_utilities');Effect.Fade('header_login',{from:0,to:1});new Scribd.HoverMenu($('user_util'));}});}
function updatePageUI(){var isFourgen=!!Scribd.FourGen;new Ajax.Request(pageTransitionURL,{method:'get',evalJSON:'force',onSuccess:function(trans){var content;try{var parts=trans.responseText.split("\n");parts.pop();content=JSON.parse(parts.join("\n"));}catch(e){if(typeof(trans.responseJSON)!="undefined"&&trans.responseJSON){content=trans.responseJSON;}
else{try{content=JSON.parse(trans.responseText);}
catch(e2){}}}
if(Scribd.Facebook.isReadPage){if(isFourgen){updateFourgenUI(content);}else{updateiPaperUI(content);}}else{updateFacebookWelcomeUI(content);}
Scribd.logged_in=true;document.body.fire('Scribd:dom_updated');document.fire(Scribd.Facebook.EVENTS.transition);transitioned=true;}});}
function updateFourgenUI(content){updateFacebookWelcomeUI(content);updateReadCastUI(content);updateCollectionsUI(content);if(content.is_owner){$('flag_document_link').addClassName('disabled');}
updateCommentFormUI(content);updateCommentsSection(content);}
function updateiPaperUI(content){if(content!=null){document.body.insert(content.facebook_session_js);updateCommentsSection(content);$('docinfo_wrapper').replace(content.document_information);$$('.follow_button')[0].replace(content.subscribe_button);$('ipaper_top_toolbar_inner_container').replace(content.ipaper_toolbar);$$('.right .ipaper_reading_list')[0].replace(content.ipaper_reading_list);updateReadCastUI(content);}
else{}}
function updateCommentFormUI(content){if(content.comment_form){$('document_comment_form').replace(content.comment_form);}}
function updateCommentsSection(content){if(content.comments_section){$('comments_section').replace(content.comments_section);}}
function updateReadCastUI(content){if(content.readcast){$('readcast_popup_outer').up().replace(content.readcast);$('readcast_popup_outer').show();}
if(content.readcast_settings){var doc_data=content.readcast_settings.document_data;(new Scribd.Readcast.Event.AutoShare({doc:doc_data,auto_submit:content.readcast_settings.prefs['event_settings']['reading']['scribd']=='on',service_type:'scribd',event_type:'read'})).start();(new Scribd.Readcast.Event.AutoShare({doc:doc_data,auto_submit:content.readcast_settings.prefs['event_settings']['reading']['twitter']=='on',service_type:'twitter',event_type:'read'})).start();(new Scribd.Readcast.Event.FacebookAutoShare({doc:doc_data,auto_submit:content.readcast_settings.prefs['event_settings']['reading']['facebook']=='on',event_type:'read'})).start();}}
function updateCollectionsUI(content){var collection_containter=$$('.autogen_class_views_shared_document_collections_lightbox')[0];if(!collection_containter){$$('.toolbar_lightboxes')[0].insert(content.collections);Scribd.Toolbar.switchToLoggedInAction('collections');Scribd.enableDocumentCollectionForm();}}
function updateFacebookWelcomeUI(content){var welcome_banner=$('welcome_banner');if(welcome_banner)welcome_banner.remove();$('wrap').insert({before:content.facebook_top_banner});}
function generateMediaAttachment(doc,type){switch(type){case'flash':return{type:type,imgsrc:doc.imageUrl,swfsrc:'http://d1.scribdassets.com/ScribdViewer.swf?document_id=#{id}&access_key=#{access_key}&page=1&version=1&viewMode=list'.interpolate(doc),width:'100',height:'129',expanded_width:'320',expanded_height:'260'};case'image':return{type:type,src:doc.imageUrl,href:doc.url};default:return{};}}
function publishToStream(message,attachment,autoPost){Scribd.Facebook.ensureInit(function(){var publish_options={method:'stream.publish',message:message,attachment:attachment,action_links:[{text:"Upload Your Documents",href:'http://www.scribd.com/upload-document?from=facebook'}]};if(autoPost){FB.api({method:'users.hasAppPermission',ext_perm:'publish_stream'},function(response){if(response==1){FB.api(publish_options,function(response){});}else{FB.ui(Object.extend({display:'popup'},publish_options),function(response){});}});}else{FB.ui(Object.extend({display:'popup'},publish_options),function(response){});}});}
return{scribdSessionActive:false,serverEnableInstantConnect:true,EVENTS:{loaded:'Scribd:Facebook:loaded',active_facebook_session:'Scribd:Facebook:active_facebook_session',inactive_facebook_session:'Scribd:Facebook:inactive_facebook_session',auto_logged_in:'Scribd:Facebook:auto_logged_in',auto_logged_out:'Scribd:Facebook:auto_logged_out',transition:'Scribd:Facebook:transition'},isSessionTransitioned:function(){return transitioned;},getSessionUID:function(){if(!session||!session.userID){return null;}
return session.userID;},ensureInit:function(func){if(loaded){func();}
else{document.observe(Scribd.Facebook.EVENTS.loaded,func);}},beforeFacebookInitialize:function(){Scribd.Facebook.AutoLogin.initialize();},initializeConnect:function(){FB.init({appId:appId,status:false,cookie:true,xfbml:true,oauth:true});this.session=FB._session;if(facebookUser){FB.getLoginStatus();}
if(Scribd.Facebook.AutoLogin.enabled()){checkSessionState();}
loaded=true;document.fire(Scribd.Facebook.EVENTS.loaded);},instantConnectFilter:function(knobs){var chance;if(Scribd.Request.controller=="word"&&Scribd.Request.action=="view"){chance=knobs.read_page;}
else if(Scribd.Request.controller=="home"){chance=knobs.home_page;}
else{chance=knobs.other_page;}
chance*=(document.referrer.indexOf('www.facebook')>-1)?knobs.facebook_referral:knobs.non_facebook_referral;if(Math.random()<chance){this.instantConnect();}},initiateLogin:function(e,onFBSessionInit){Scribd.Facebook.ensureInit(function(){var btn=e.element();if(btn.hasClassName('fb_connect_button_deactivated')||btn.hasClassName('fb_connect_button_large_deactivated')){window.blur();return;}
var spinner=btn.previous('.spinner')||btn.next('.spinner');if(spinner)
spinner.setStyle({visibility:'visible'});function onCancel(){btn.removeClassName('fb_connect_button_deactivated');btn.removeClassName('fb_connect_button_large_deactivated');if(spinner)
spinner.setStyle({visibility:'hidden'});btn=spinner=null;}
FB.login(function(response){if(response.authResponse){onFBSessionInit();}
else{onCancel();}});if(btn.hasClassName('fb_connect_button'))
btn.addClassName('fb_connect_button_deactivated');else if(btn.hasClassName('fb_connect_button_large'))
btn.addClassName('fb_connect_button_large_deactivated');});},setPageTransitionURL:function(url){pageTransitionURL=url;},transitionToLoggedInUI:function(login_info){updateGlobalHeader(login_info.word_user_id,login_info.word_user_name,login_info.created_by_ic);if(login_info.created_by_ic){Scribd.blueBarUtil.show();}
updatePageUI();},publishDocumentToStream:function(doc,autoPost){if(doc.imageUrl){if(!doc.imageUrl.startsWith('http://'))
doc.imageUrl='http://www.scribd.com'+doc.imageUrl;var m={media:[generateMediaAttachment(doc,'image')],name:doc.title,description:doc.desc.truncate(200),href:doc.url};}else{var m=null;};publishToStream('published '+doc.title+' to Scribd.',m,autoPost);}};}();Scribd.Facebook.AutoLogin={cookie:new Scribd.JSONCookie('session_metadata'),initialize:function(){if(this.enabled()){Event.observe(document,Scribd.Facebook.EVENTS.active_facebook_session,function(e){new Ajax.Request('/facebook_session/instant_connect',{parameters:{facebook_id:Scribd.Facebook.getSessionUID()},onComplete:function(r){if(r.responseJSON.success){trackEvent('Facebook','Autologin');Scribd.log('FB autoLogin: login response',r.responseJSON);Event.fire(document,Scribd.Facebook.EVENTS.auto_logged_in);Scribd.Facebook.transitionToLoggedInUI(r.responseJSON);}else if(r.responseJSON.new_user){Scribd.log('FB autoCreate: create response',r.responseJSON);Event.fire(document,Scribd.Facebook.EVENTS.auto_logged_in);Scribd.Facebook.transitionToLoggedInUI(r.responseJSON);}else{Scribd.log(r.responseJSON.success);Scribd.log('FB autoLogin: no existing scribd user');this.loggedOut();this.cookie.set('no_existing_scribd_user','true');this.cookie.save();}}.bind(this)});}.bind(this));Event.observe(document,Scribd.Facebook.EVENTS.inactive_facebook_session,function(e){Scribd.log('FB autoLogin: no active fb session');this.loggedOut();}.bind(this));}
else{this.loggedOut();}},enabled:function(){if(this.cookie.get('no_existing_scribd_user')=='true'){Scribd.log('FB autoLogin: no existing scribd user (cached)');return false;}
if(document.cookie.match('user_forced_logout=true')){Scribd.log('FB autoLogin: user forced logout');return false;}
if(!Scribd.Facebook.serverEnableInstantConnect||Scribd.Facebook.scribdSessionActive){return false;}
return true;},loggedOut:function(){Event.fire(document,Scribd.Facebook.EVENTS.auto_logged_out);}};Scribd.Facebook.Permissions={context_permissions:{"homepage":["email","publish_stream","read_stream","offline_access"],"toolbar_download":["email","publish_stream","read_stream","offline_access"]},all_permissions:["email","publish_stream","read_stream","offline_access"],hasPermissionsForContext:function(context){var context_permissions=Scribd.Facebook.Permissions.context_permissions[context].join(',');return Scribd.Facebook.Permissions.hasFacebookPermissions(context_permissions);},requestPermissionsForContext:function(context,callbacks){var context_permissions=Scribd.Facebook.Permissions.context_permissions[context].join(',');if(!callbacks.onPermissionsGranted){throw"You must provide an onPermissionsGranted callback";}
if(!callbacks.onPermissionsDenied){throw"You must provide an onPermissionsDenied callback";}
Scribd.Facebook.Permissions.requestFacebookPermissions(context_permissions,callbacks);},hasAllPermissions:function(actualPermissionsString,requiredPermissionsString){if(!actualPermissionsString)return false;var actualPermissionsArray=actualPermissionsString.split(",");var requiredPermissionsArray=requiredPermissionsString.split(",");var hasAll=true;for(var i=0;i<requiredPermissionsArray.length;++i){if(!actualPermissionsArray.include(requiredPermissionsArray[i]))hasAll=false;}
return hasAll;},hasFacebookPermissions:function(permissions){if(!facebookUser)return true;if(!facebookUserPermissions)Scribd.Facebook.Permissions.fetchFacebookPermissions();if(Scribd.Facebook.Permissions.hasAllPermissions(facebookUserPermissions,permissions)){return true;}else{return false;}},requestFacebookPermissions:function(permissions,callbacks){Scribd.Facebook.ensureInit(function(){Scribd.Facebook.Permissions.fetchFacebookPermissions();if(Scribd.Facebook.Permissions.hasFacebookPermissions(permissions)){callbacks.onPermissionsGranted();}else{FB.ui({method:'permissions.request',perms:permissions},function(response){if(response.authResponse){if(Scribd.Facebook.Permissions.hasAllPermissions(response.perms,permissions)){Scribd.Facebook.Permissions.updateScribdPermissions(response.perms);callbacks.onPermissionsGranted();}else{callbacks.onPermissionsDenied();}}else{callbacks.onPermissionsDenied();}});}});},fetchFacebookPermissions:function(){Scribd.Facebook.ensureInit(function(){var all_permissions=Scribd.Facebook.Permissions.all_permissions;FB.api({method:'fql.query',query:'SELECT '+all_permissions.join(',')+' FROM permissions WHERE uid='+facebookUserId},function(response){if(response&&response[0]){var perms=response[0];var perms_granted=[];all_permissions.each(function(perm){if((perms[perm]==1)||(perms[perm]=='1')){perms_granted.push(perm);}});Scribd.Facebook.Permissions.updateScribdPermissions(perms_granted.join(','));}else{facebookUserPermissions='';}});});},updateScribdPermissions:function(permissions){facebookUserPermissions=permissions;new Ajax.Request("/facebook_accounts/set_permissions");}};Scribd.Facebook.getSharedFriends=function(container,max,tmpl,onSuccess){container=$(container);var api_callback=function(response){if(!!response&&response.length>0){response.each(function(id,i){if(i<=max){var pic=tmpl.evaluate({fb_user_id:id});container.insert(pic);}else{throw $break;}});var count_msg=container.down('.friend_count_msg a');if(count_msg){count_msg.update("#{count} friend#{plural}".interpolate({count:response.length,plural:((response.length==1)?'':'s')}));}
container.fire('Scribd:dom_updated');onSuccess();}};Scribd.Facebook.ensureInit(function(){FB.api({method:'Friends.getAppUsers'},api_callback);});};Scribd.Facebook.upgradeAccount=function(e){e.stop();var container=e.element().up('.nag')||e.element().up('.special_nag');Scribd.Facebook.Permissions.requestPermissionsForContext('homepage',{onPermissionsGranted:function(){container.down('.inner').update('<h2 class="first">Thanks, your profile is now complete.</h2>');(function(){Effect.Fade(container);}).delay(3);},onPermissionsDenied:function(){Scribd.log('FB Permissions Request Denied.');}});};Scribd.blueBarUtil={show:function(){},barClosed:function(){trackEvent('Facebook','Blue Bar','Close This Message');},noThanks:function(){FB.api({method:'auth.revokeAuthorization',block:1},function(){});new Ajax.Request("/facebook_session/no_thanks",{asynchronous:false,onSuccess:function(req){trackEvent('Facebook','Blue Bar','No Thanks');(function(){window.location='/logout?return_to='+encodeURIComponent(window.location.pathname);}).delay(1);},on409:function(req){window.location='/account/blocked_from_deletion';}});},onLoadHandler:function(){Scribd.Facebook.ensureInit(function(){if(facebookUser&&Scribd.FacebookSession.correct()&&facebookUserInstantConnected){Scribd.blueBarUtil.show();}});}};Scribd.LikeButtonManager=Class.create({initialize:function(current_facebook_user_id,container,url,width,layout,extras){var extras=extras||'show_faces="true"';var container=$(container);document.observe(Scribd.Facebook.EVENTS.loaded,function(){container.update('<fb:like href="'+url+'" width="'+width+'" layout="'+layout+'" '+extras+'></fb:like>').show();});}});


/* public/javascripts/shared/i18n.js @ 1339185887 */

var I18n=I18n||{};I18n.defaultLocale="en_US";I18n.fallbacks=true;I18n.defaultSeparator=".";I18n.locale=null;I18n.PLACEHOLDER=/(?:\{\{|%\{)(.*?)(?:\}\}?)/gm;I18n.isValidNode=function(obj,node,undefined){return obj[node]!==null&&obj[node]!==undefined;}
I18n.lookup=function(scope,options){var options=options||{},lookupInitialScope=scope,translations=this.prepareOptions(I18n.translations),messages=translations[options.locale||I18n.currentLocale()],options=this.prepareOptions(options),currentScope;if(!messages&&options.redo)
{return;}
if(!messages){options.locale=I18n.defaultLocale
options.redo=true
return I18n.lookup(scope,options)}
if(typeof(scope)=="object"){scope=scope.join(this.defaultSeparator);}
if(options.scope){scope=options.scope.toString()+this.defaultSeparator+scope;}
scope=scope.split(this.defaultSeparator);while(scope.length>0){currentScope=scope.shift();messages=messages[currentScope];if(!messages){if(I18n.fallbacks&&!options.fallback){messages=I18n.lookup(lookupInitialScope,this.prepareOptions({locale:I18n.defaultLocale,fallback:true},options));}
break;}}
if(!messages&&this.isValidNode(options,"defaultValue")){messages=options.defaultValue;}
return messages;};I18n.prepareOptions=function(){var options={},opts,count=arguments.length;for(var i=0;i<count;i++){opts=arguments[i];if(!opts){continue;}
for(var key in opts){if(!this.isValidNode(options,key)){options[key]=opts[key];}}}
return options;};I18n.interpolate=function(message,options){options=this.prepareOptions(options);var matches=message.match(this.PLACEHOLDER),placeholder,value,name;if(!matches){return message;}
for(var i=0;placeholder=matches[i];i++){name=placeholder.replace(this.PLACEHOLDER,"$1");value=options[name];if(!this.isValidNode(options,name)){value="[missing "+placeholder+" value]";}
regex=new RegExp(placeholder.replace(/\{/gm,"\\{").replace(/\}/gm,"\\}"));message=message.replace(regex,value);}
return message;};I18n.translate=function(scope,options){options=this.prepareOptions(options);var translation=this.lookup(scope,options);try{if(typeof(translation)=="object"){if(typeof(options.count)=="number"){return this.pluralize(options.count,scope,options);}else{return translation;}}else{return this.interpolate(translation,options);}}catch(err){return this.missingTranslation(scope);}};I18n.localize=function(scope,value){switch(scope){case"currency":return this.toCurrency(value);case"number":scope=this.lookup("number.format");return this.toNumber(value,scope);case"percentage":return this.toPercentage(value);default:if(scope.match(/^(date|time)/)){return this.toTime(scope,value);}else{return value.toString();}}};I18n.parseDate=function(date){var matches,convertedDate;if(typeof(date)=="object"){return date;};matches=date.toString().match(/(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2}):(\d{2}))?(Z|\+0000)?/);if(matches){for(var i=1;i<=6;i++){matches[i]=parseInt(matches[i],10)||0;}
matches[2]-=1;if(matches[7]){convertedDate=new Date(Date.UTC(matches[1],matches[2],matches[3],matches[4],matches[5],matches[6]));}else{convertedDate=new Date(matches[1],matches[2],matches[3],matches[4],matches[5],matches[6]);}}else if(typeof(date)=="number"){convertedDate=new Date();convertedDate.setTime(date);}else if(date.match(/\d+ \d+:\d+:\d+ [+-]\d+ \d+/)){convertedDate=new Date();convertedDate.setTime(Date.parse(date))}else{convertedDate=new Date();convertedDate.setTime(Date.parse(date));}
return convertedDate;};I18n.toTime=function(scope,d){var date=this.parseDate(d),format=this.lookup(scope);if(date.toString().match(/invalid/i)){return date.toString();}
if(!format){return date.toString();}
return this.strftime(date,format);};I18n.strftime=function(date,format){var options=this.lookup("date");if(!options){return date.toString();}
options.meridian=options.meridian||["AM","PM"];var weekDay=date.getDay(),day=date.getDate(),year=date.getFullYear(),month=date.getMonth()+1,hour=date.getHours(),hour12=hour,meridian=hour>11?1:0,secs=date.getSeconds(),mins=date.getMinutes(),offset=date.getTimezoneOffset(),absOffsetHours=Math.floor(Math.abs(offset/60)),absOffsetMinutes=Math.abs(offset)-(absOffsetHours*60),timezoneoffset=(offset>0?"-":"+")+(absOffsetHours.toString().length<2?"0"+absOffsetHours:absOffsetHours)+(absOffsetMinutes.toString().length<2?"0"+absOffsetMinutes:absOffsetMinutes);if(hour12>12){hour12=hour12-12;}else if(hour12===0){hour12=12;}
var padding=function(n){var s="0"+n.toString();return s.substr(s.length-2);};var f=format;f=f.replace("%a",options.abbr_day_names[weekDay]);f=f.replace("%A",options.day_names[weekDay]);f=f.replace("%b",options.abbr_month_names[month]);f=f.replace("%B",options.month_names[month]);f=f.replace("%d",padding(day));f=f.replace("%e",day);f=f.replace("%-d",day);f=f.replace("%H",padding(hour));f=f.replace("%-H",hour);f=f.replace("%I",padding(hour12));f=f.replace("%-I",hour12);f=f.replace("%m",padding(month));f=f.replace("%-m",month);f=f.replace("%M",padding(mins));f=f.replace("%-M",mins);f=f.replace("%p",options.meridian[meridian]);f=f.replace("%S",padding(secs));f=f.replace("%-S",secs);f=f.replace("%w",weekDay);f=f.replace("%y",padding(year));f=f.replace("%-y",padding(year).replace(/^0+/,""));f=f.replace("%Y",year);f=f.replace("%z",timezoneoffset);return f;};I18n.toNumber=function(number,options){options=this.prepareOptions(options,this.lookup("number.format"),{precision:3,separator:".",delimiter:",",strip_insignificant_zeros:false});var negative=number<0,string=Math.abs(number).toFixed(options.precision).toString(),parts=string.split("."),precision,buffer=[],formattedNumber;number=parts[0];precision=parts[1];while(number.length>0){buffer.unshift(number.substr(Math.max(0,number.length-3),3));number=number.substr(0,number.length-3);}
formattedNumber=buffer.join(options.delimiter);if(options.precision>0){formattedNumber+=options.separator+parts[1];}
if(negative){formattedNumber="-"+formattedNumber;}
if(options.strip_insignificant_zeros){var regex={separator:new RegExp(options.separator.replace(/\./,"\\.")+"$"),zeros:/0+$/};formattedNumber=formattedNumber.replace(regex.zeros,"").replace(regex.separator,"");}
return formattedNumber;};I18n.toCurrency=function(number,options){options=this.prepareOptions(options,this.lookup("number.currency.format"),this.lookup("number.format"),{unit:"$",precision:2,format:"%u%n",delimiter:",",separator:"."});number=this.toNumber(number,options);number=options.format.replace("%u",options.unit).replace("%n",number);return number;};I18n.toHumanSize=function(number,options){var kb=1024,size=number,iterations=0,unit,precision;while(size>=kb&&iterations<4){size=size/kb;iterations+=1;}
if(iterations===0){unit=this.t("number.human.storage_units.units.byte",{count:size});precision=0;}else{unit=this.t("number.human.storage_units.units."+[null,"kb","mb","gb","tb"][iterations]);precision=(size-Math.floor(size)===0)?0:1;}
options=this.prepareOptions(options,{precision:precision,format:"%n%u",delimiter:""});number=this.toNumber(size,options);number=options.format.replace("%u",unit).replace("%n",number);return number;};I18n.toPercentage=function(number,options){options=this.prepareOptions(options,this.lookup("number.percentage.format"),this.lookup("number.format"),{precision:3,separator:".",delimiter:""});number=this.toNumber(number,options);return number+"%";};I18n.pluralize=function(count,scope,options){var translation;try{translation=this.lookup(scope,options);}catch(error){}
if(!translation){return this.missingTranslation(scope);}
var message;options=this.prepareOptions(options);options.count=count.toString();switch(Math.abs(count)){case 0:message=this.isValidNode(translation,"zero")?translation.zero:this.isValidNode(translation,"none")?translation.none:this.isValidNode(translation,"other")?translation.other:this.missingTranslation(scope,"zero");break;case 1:message=this.isValidNode(translation,"one")?translation.one:this.missingTranslation(scope,"one");break;default:message=this.isValidNode(translation,"other")?translation.other:this.missingTranslation(scope,"other");}
return this.interpolate(message,options);};I18n.missingTranslation=function(){var message='[missing "'+this.currentLocale(),count=arguments.length;for(var i=0;i<count;i++){message+="."+arguments[i];}
message+='" translation]';return message;};I18n.currentLocale=function(){return(I18n.locale||I18n.defaultLocale);};I18n.t=I18n.translate;I18n.l=I18n.localize;I18n.p=I18n.pluralize;


/* public/javascripts/shared/link_account.js @ 1339185887 */

if(!window.Scribd)var Scribd=new Object();if(!Scribd.Facebook)Scribd.Facebook={};if(!Scribd.Twitter)Scribd.Twitter={};Scribd.SocialAccount=Class.create({initialize:function(element,callbacks){this.element=element;if(this.element){this.element.observe('click',this.linkPrompt.bind(this));}
if(typeof callbacks!=='undefined'){this.onSuccess=callbacks.onSuccess;this.onFailure=callbacks.onFailure;}},success:function(){if(this.onSuccess)this.onSuccess();},failure:function(){if(this.onFailure)this.onFailure();},linkedTemplate:new Template('<span>#{name}</span>')});Scribd.Facebook.Account=Class.create(Scribd.SocialAccount,{linkPrompt:function(e){e.stop();FB.login(this.handleLinkResponse.bind(this));},handleLinkResponse:function(response){if(response.authResponse){new Ajax.Request("/facebook_link",{method:'post',onSuccess:this.linkSuccess.bind(this),onFailure:this.linkFailure.bind(this)});}else{this.linkFailure();}},setGlobalState:function(){var cookie=FB.Cookie.load();if(cookie){facebookUser=true;facebookSessionKey=cookie.session_key;facebookUserId=cookie.uid;}},linkSuccess:function(){this.setGlobalState();this.setName();$$(".facebook_prefs").invoke('hide');Scribd.Alerts.success('flashes_placeholder',"Your facebook account is now linked.",{auto_fade:true});$$('.facebook_not_linked').invoke('hide');this.success();},linkFailure:function(){Scribd.Alerts.error('flashes_placeholder',"Sorry, another Scribd user is already associated with that Facebook account.",{auto_fade:false});this.failure();},replaceLink:function(response){if(response[0]){var span=this.linkedTemplate.evaluate({name:response[0].name});$$('.facebook_unlink_account').invoke('show');$$('.facebook_link_account').invoke('hide');$$('.facebook_username').each(function(element){element.update(response[0].name);element.show();});}},setName:function(){FB.api({method:'fql.query',query:'SELECT name FROM profile WHERE id='+FB.getAuthResponse().userID},this.replaceLink.bind(this));}});Scribd.Twitter.Account=Class.create(Scribd.SocialAccount,{linkPrompt:function(e){e.stop();var popupParams='location=0,status=0,width=800,height=400';this._twitterWindow=window.open("/twitter_link/new.js",'twitterWindow',popupParams);this._twitterInterval=window.setInterval(this.handleLinkResponse.bind(this),200);},handleLinkResponse:function(){if(!this._twitterWindow){this.responseDone();}
try{if(this._twitterWindow.location.href.indexOf('oauth_token')>=0){this._twitterWindow.close();this.responseDone();}}catch(e){}},responseDone:function(){window.clearInterval(this._twitterInterval);this.testLink();},testLink:function(){new Ajax.Request("/twitter_link.js",{method:'get',onSuccess:this.linkSuccess.bind(this),onFailure:this.linkFailure.bind(this)});},linkSuccess:function(){$$(".twitter_prefs").invoke('hide');Scribd.Alerts.success('flashes_placeholder',"Your twitter account is now linked.",{auto_fade:true});$$('.twitter_not_linked').invoke('hide');this.success();this.setName();},linkFailure:function(){Scribd.Alerts.error('flashes_placeholder',"We could not link your twitter account.  Please try again.",{auto_fade:true});this.failure();},replaceLink:function(trans){$$('.twitter_unlink_account').invoke('show');$$('.twitter_link_account').invoke('hide');$$('.twitter_username').each(function(element){element.update("@"+trans.responseJSON.info.screen_name);element.show();});},setName:function(){new Ajax.Request("/twitter_link/info.json",{method:'get',evalJSON:'force',onSuccess:this.replaceLink.bind(this)});}});Scribd.Facebook.UnlinkAccount=Class.create({initialize:function(element){this.element=element;if(this.element){this.element.observe('click',this.unlinkAccount.bind(this));}},unlinkAccount:function(e){e.stop();new Ajax.Request("/facebook_links/destroy",{method:'delete',onSuccess:this.handleUnlinkAccountResponse.bind(this)});},handleUnlinkAccountResponse:function(response){$$('.facebook_unlink_account').invoke('hide');$$('.facebook_username').invoke('hide');$$('.facebook_link_account').invoke('show');}});Scribd.Twitter.UnlinkAccount=Class.create({initialize:function(element){this.element=element;if(this.element){this.element.observe('click',this.unlinkAccount.bind(this));}},unlinkAccount:function(e){e.stop();new Ajax.Request("/twitter_links/destroy",{method:'delete',onSuccess:this.handleUnlinkAccountResponse.bind(this)});},handleUnlinkAccountResponse:function(response){$$('.twitter_unlink_account').invoke('hide');$$('.twitter_username').invoke('hide');$$('.twitter_link_account').invoke('show');}});document.observe(Scribd.Facebook.EVENTS.loaded,function(){if(!Scribd.Readcast.active())return;$$('.facebook_link').each(function(el){new Scribd.Facebook.Account(el);});$$('.twitter_link').each(function(el){new Scribd.Twitter.Account(el);});});


/* public/javascripts/shared/login_required.js @ 1339185887 */

Scribd.requireLogin=function(){if(Scribd.logged_in){return true;}
Scribd.login.open({});return false;};


/* public/javascripts/shared/logoutAlert.js @ 1339185887 */

if(!window.Scribd)var Scribd=new Object();Scribd.logoutAlert=Class.create({message:'You have logged out.',initialize:function(container){var container=$(container);if(container&&Scribd.Alerts&&!Scribd.logged_in){if(window.location.hash=='#logout'){container.addClassName('active').show();Scribd.Alerts.success_blue(container,this.message);window.location.hash='';}}}});Event.observe(window,'load',function(e){new Scribd.logoutAlert('flashes_placeholder');});


/* public/javascripts/shared/options.js @ 1339185887 */

if(!window.Scribd)var Scribd=new Object();Scribd.Options=function(defaults,options){if(options===undefined)var options={};var r=defaults;for(var property in options)
r[property]=options[property];return r;};


/* public/javascripts/shared/premium.js @ 1339185887 */

if(!window.Scribd)var Scribd=new Object();if(!window.Scribd.Premium)Scribd.Premium=new Object();Scribd.Premium.setup_for_read_page=function(options){options=Object.extend({doc:Scribd.current_doc,extension:Scribd.current_doc.preferred_ext||'pdf',show_download:function(){throw"don't know how to open download dialog";}},options||{});Scribd.Premium.show_gate=function(){if(Scribd.logged_in==true){Scribd.Lightbox.remoteOpen('premium_download','/premium/purchases/gate',{doc:options.doc.id,extension:options.extension},{style:'tight',width:'600'});}else{Scribd.login.open({context:'download',document_id:options.doc.id,next_url:Scribd.DocumentUrl.urlByDocId(options.doc.id,{relative_path:true})+'#download'});}};Scribd.Premium.show_trial=function(){Scribd.LoadJS("v/premium/purchases/trialgate",function(){if(Scribd.logged_in==true){Scribd.Lightbox.remoteOpen('premium_download','/premium/purchases/gate',{doc:options.doc.id,trial:true},{style:'tight',width:'600'});}else{Scribd.login.open({context:'trial',document_id:options.doc.id,callback:"Scribd.Lightbox.remoteOpen('premium_trial','/premium/purchases/gate' , {trial:true, doc: "+options.doc.id+" }, { style: 'tight', width: 600});",fallback_url:window.location});}});};if(window.location.hash=="#archive")
return Scribd.Premium.show_gate();if(window.location.hash=="#archive_trial")
return Scribd.Premium.show_trial();};


/* public/javascripts/shared/prototypes/string.js @ 1339185887 */

Object.extend(String.prototype,(function(){var updateQueryParams=function(params){if(this.indexOf('?')==-1){return this+'?'+Object.toQueryString(params);}else{var old_params=this.toQueryParams();var new_params=Object.extend(old_params,params);return this.baseUrl()+'?'+Object.toQueryString(new_params);}};var baseUrl=function(){return this.slice(0,this.indexOf('?'));};var protocol=function(){var matches=/^(.*?:)\/\//.exec(this);return matches?matches[1]:null;};var domain=function(){var matches=/\/\/(.*?)\//.exec(this);return matches?matches[1]:null;};return{updateQueryParams:updateQueryParams,baseUrl:baseUrl,protocol:protocol,domain:domain};})());


/* public/javascripts/shared/readcast.js @ 1339185887 */

Scribd.Readcast=Scribd.Readcast||{};Scribd.Readcast.Event=Scribd.Readcast.Event||{};Scribd.Readcast.active_events={};Scribd.Readcast.Event.Share=Class.create({initialize:function(options){this.klass=this._klass();this.options=Object.extend(Object.clone(this.klass.DEFAULT_OPTIONS),options);this.events=this.klass.EVENTS;this.doc=this.options.doc;this.doc_collection=this.options.doc_collection;this.scribble_text=this.options.scribble_text;},_klass:function(){return Scribd.Readcast.Event.Share;},resubmit:function(cb){this.submitted=false;this.submit(cb);},submit:function(cb){if(this.submitted)return;this.submitToRemote(cb);document.fire(this.events.submitted,{event:this});return this;},submitToRemote:function(cb){this.submitToScribd();if(Object.isFunction(cb))cb.call(this);return this;},submitToScribd:function(params){var that=this;this.submitted=true;if(this.doc&&this.doc.id)
params=Object.extend({document_id:this.doc.id},params);if(this.doc_collection&&this.doc_collection.id)
params=Object.extend({document_collection_id:this.doc_collection.id},params);if(this.scribble_text){params=Object.extend(params||{},{scribble_text:this.scribble_text});}
new Ajax.Request(this.readcastURL(),{parameters:params,onComplete:function(t){document.fire(that.events.completed,{event:t})}});return this;},readcastURL:function(){return'/readcast/'+this.options.service_type+'/'+this.options.event_type;}});Scribd.Readcast.Event.Share.DEFAULT_OPTIONS={event_type:'read'};Scribd.Readcast.Event.Share.EVENTS={started:'Scribd:Readcast:Share:started',ready:'Scribd:Readcast:Share:ready',submitted:'Scribd:Readcast:Share:submitted',completed:'Scribd:Readcast:Share:completed'};Scribd.Readcast.Event.BlankReadcast=Class.create({initialize:function(options){this.klass=Scribd.Readcast.Event.BlankReadcast;this.options=Object.extend(Object.clone(this.klass.DEFAULT_OPTIONS),options);this.events=this.klass.EVENTS;this.doc=this.options.doc;this.doc_collection=this.options.doc_collection;},start:function(){var that=this;this.start_timer=setTimeout(function(){document.fire(that.events.ready,{event:that});},this.options.delay*1000);return this;}});Scribd.Readcast.Event.BlankReadcast.EVENTS={ready:'Scribd:Readcast:BlankReadcast:ready'};Scribd.Readcast.Event.BlankReadcast.DEFAULT_OPTIONS={delay:10};Scribd.Readcast.Event.AutoShare=Class.create(Scribd.Readcast.Event.Share,{_klass:function(){return Scribd.Readcast.Event.AutoShare;},start:function(){var that=this;this.start_timer=setTimeout(function(){document.fire(that.events.ready,{event:that});Scribd.Readcast.active_events[that.options.service_type]=that;if(that.options.auto_submit){that.undo_timer=setTimeout(function(){Scribd.Readcast.trackEvent("auto submit",that.options.service_type);that.submit();},that.options.submit_delay*1000);document.fire(that.events.started,{event:that});}},this.options.delay*1000);return this;},stop:function(){if(!this.submitted){if(this.undo_timer){clearTimeout(this.undo_timer);}
if(this.start_timer){clearTimeout(this.start_timer);}}
return this;}});Scribd.Readcast.Event.AutoShare.DEFAULT_OPTIONS={delay:10,submit_delay:5,auto_submit:false,service_type:'scribd',event_type:'read'};Scribd.Readcast.Event.AutoShare.EVENTS={started:'Scribd:Readcast:AutoShare:started',ready:'Scribd:Readcast:AutoShare:ready',submitted:'Scribd:Readcast:AutoShare:submitted',completed:'Scribd:Readcast:AutoShare:completed'};Scribd.Readcast.Event.FacebookAutoShare=Class.create(Scribd.Readcast.Event.AutoShare,{initialize:function($super,options){$super(options);this.options.service_type='facebook';this.comments=this.klass.COMMENTS;},_klass:function(){return Scribd.Readcast.Event.FacebookAutoShare;},submitToRemote:function(cb){var fn=this.sendToFacebook.bind(this)(cb);Scribd.FacebookSession.ensureValid(fn);return this;},sendToFacebook:function(cb){var that=this;return(function(){Scribd.Readcast.Permissions.Facebook.ensurePublish(function(response){FB.api(that.facebookApiParams(),function(response){if(!response||response.error){return;}
that.submitToScribd();that.submitted=true;if(Object.isFunction(cb))cb.call(that);});});});},facebookApiParams:function(){var that=this,action_links;if(this.doc){action_links=[{"text":"Readcast","href":Scribd.SharedLink.urlForFacebook(that.doc.url)}];}else{action_links=[{"text":"Readcast","href":Scribd.SharedLink.urlForFacebook(that.doc_collection.url)}];}
return({method:'stream.publish',action_links:action_links,attachment:that.streamAttachment()});},actionComment:function(){return this.klass.ACTION_COMMENTS[this.options.event_type];},streamAttachment:function(){var that=this,props={};if(that.doc){if(that.doc.author!==undefined){props["By"]={"text":that.doc.author.name,"href":that.doc.author.url};}
return({"name":that.doc.title.truncate(80),"caption":that.actionComment(),"description":that.doc.description.truncate(190),"href":Scribd.SharedLink.urlForFacebook(that.doc.url),"properties":props,"media":[{"type":"image","src":that.doc.thumbnail_url,"href":Scribd.SharedLink.urlForFacebook(that.doc.url)}]});}else{if(that.doc_collection.author!==undefined){props["By"]={"text":that.doc_collection.author.name,"href":that.doc_collection.author.url};}
return({"name":that.doc_collection.name.truncate(80),"caption":that.actionComment(),"description":that.doc_collection.description.truncate(190),"href":Scribd.SharedLink.urlForFacebook(that.doc_collection.url),"properties":props,"media":[{"type":"image","src":that.doc_collection.thumbnail_url,"href":Scribd.SharedLink.urlForFacebook(that.doc_collection.url)}]});}}});Scribd.Readcast.Event.FacebookAutoShare.DEFAULT_OPTIONS=Object.clone(Scribd.Readcast.Event.AutoShare.DEFAULT_OPTIONS);Scribd.Readcast.Event.FacebookAutoShare.EVENTS=Object.clone(Scribd.Readcast.Event.AutoShare.EVENTS);Scribd.Readcast.Event.FacebookAutoShare.ACTION_COMMENTS={read:'{*actor*} readcast this',download:'{*actor*} readcast this',upload:'{*actor*} published this'};Scribd.Readcast.Event.FacebookScribbleAutoShare=Class.create(Scribd.Readcast.Event.FacebookAutoShare,{initialize:function($super,options){$super(options);this.options.service_type='facebook';},_klass:function(){return Scribd.Readcast.Event.FacebookScribbleAutoShare;},sendToFacebook:function(cb){var that=this;return(function(){Scribd.Readcast.Permissions.Facebook.ensurePublish(function(response){FB.api(that.facebookApiParams(),function(response){that.submitToScribd();that.submitted=true;});});});},facebookApiParams:function(){if(this.doc){return({method:'links.post',comment:this.scribble_text,url:Scribd.SharedLink.urlForFacebook(this.doc.url)});}else{return({method:'status.set',status:this.scribble_text});}}});Scribd.Readcast.Event.FacebookScribbleAutoShare.EVENTS=Object.clone(Scribd.Readcast.Event.AutoShare.EVENTS);


/* public/javascripts/shared/shared_link.js @ 1339185887 */

if(!window.Scribd)var Scribd=new Object();Scribd.SharedLink=function(){var source=window.location.hash.match('#source:(.+)');if(source){source=source[1];}
return{trackDocumentLink:function(id){if(source=='facebook'){trackEvent('Facebook','Link Sharing',id);}},urlForSource:function(url,source){return url.split('#')[0]+'#source:'+source;},urlForFacebook:function(url){return this.urlForSource(url,'facebook');}};}();


/* public/javascripts/shared/i18n_manager.js @ 1339185887 */

Scribd.I18nManager=Class.create({languages:{"pt_BR":{"iso_639_2":"por","iso_639_1":"pt","lcid":"pt-br","prefix":"pt","id":13,"display_order":6,"available":true,"name":"portugu\u00eas","guess_name":"portuguese"},"es_LA":{"iso_639_2":"spa","iso_639_1":"es","lcid":"es","prefix":"es","id":4,"display_order":4,"available":true,"name":"espa\u00f1ol","guess_name":"spanish"},"en_US":{"iso_639_2":"eng","iso_639_1":"en","lcid":"en","prefix":"www","id":1,"display_order":1,"available":true,"name":"English","guess_name":"english"}},currentLanguage:null,initialize:function(options){var options=options||{};this.detectLanguage();},detectLanguage:function(){this.currentLanguage=this.languages[I18n.locale];if(!this.currentLanguage)this.currentLanguage=this.languages.en;window.setTimeout(function(){Event.fire(document,'Scribd:language_detected')},0);}});


/* public/javascripts/shared/sticky_element.js @ 1339185887 */

if(!window.Scribd)var Scribd={};Scribd.StickyElement=function(id,fixed_callback,absolute_callback,sticky_func,update_func){if(!!(document.all&&(/msie 6./i).test(navigator.appVersion)&&window.ActiveXObject))
return;var previous_stickiness=!sticky_func();var element=$(id);var new_callback=function(force_apply){var force_apply=!!force_apply;var new_stickiness=sticky_func();if(force_apply||(new_stickiness!=previous_stickiness)){previous_stickiness=new_stickiness;if(new_stickiness){fixed_callback(element);}else{absolute_callback(element);}
update_func(element);document.fire('scribd:move_ads');}};var force_apply_callback=function(){new_callback(true);};docManager.addEvent('zoomed',force_apply_callback);docManager.addEvent('viewmodeChanged',new_callback);docManager.addEvent('enteredFullscreen',new_callback);docManager.addEvent('exitedFullscreen',new_callback);document.observe('scribd:dom_height_changed',function(){previous_stickiness=null;force_apply_callback();});Event.observe(document.onresize?document:window,'resize',force_apply_callback);Event.observe(window,'scroll',new_callback);new_callback();};


/* public/javascripts/shared/translations.js @ 1339185887 */

var I18n=I18n||{};I18n.translations={"en_US":{"js":{"enter_a_name_for_your_new_collection":"Enter a name for your new collection...","search_people":"Search People","public_moderated_collection":"(Others can add to this collection, but you approve or reject additions)","hi_there_were_logging_you_in":"Hi there! We're logging you in now.","readcast_complete":"Readcast Complete!","successfully_sent_this_document":"Successfully sent this document!","show_bulk_editor":"Show Bulk Editor","are_you_sure_you_want_to_delete":"Are you sure you want to delete this item?","of":"of","search_within_document":"Search within document","help_me":"I am filled with bees!","hide_bulk_editor":"Show Bulk Editor","public_locked_collection":"(Only you can add to this collection, but others can view it)","search_history":"Search history","previous":"previous","result":"Result","email_addresses_or_scribd_usernames":"email addresses or Scribd usernames","next":"next","add_a_reply":"Add a reply...","search_for_your_course":"Search for your course...","search_my_content":"Search my content...","search_this_profile":"Search this profile...","private_collection":"(Only you can add to this collection, and only you will be able to view it)","share_what_youre_reading":"Share what you're reading...","this_document_could_not_be_deleted":"This document could not be deleted at this time.  Please contact support@scribd.com.","email_addresses_of_recipients":"email addresses of recipients","download":"Download","search_is_disabled":"Search is disabled...","no_search_result_is_found":"No search result is found","search_books_presentations":"Search books, presentations, business, academics...","are_you_sure_you_want_to_delete_":"Are you sure you want to delete these documents?  This CANNOT be undone!"}},"es_LA":{"js":{"hi_there_were_logging_you_in":"\u00a1Bienvenido! Su sesi\u00f3n se est\u00e1 iniciando...","public_moderated_collection":"(Otros pueden agregar a esta colecci\u00f3n, pero usted tendr\u00e1 que aprobar o rechazar los elementos agregados)","search_people":"Buscar personas","enter_a_name_for_your_new_collection":"Ingrese un nombre para su nueva colecci\u00f3n","successfully_sent_this_document":"\u00a1Documento enviado correctamente!","readcast_complete":"\u00a1Readcast completo!","search_within_document":"Buscar dentro de documento","of":"de","are_you_sure_you_want_to_delete":"\u00bfEst\u00e1 seguro de que desea eliminar este objeto?","show_bulk_editor":"Mostrar editor por lotes","public_locked_collection":"(Solo usted puede agregar a esta colecci\u00f3n, y otros podr\u00e1n verla)","hide_bulk_editor":"Mostrar editor por lotes","help_me":"\u00a1Las jirafas nos atacan, repito!","email_addresses_or_scribd_usernames":"direcciones de correo electr\u00f3nico o nombres de usuario de Scribd","result":"Resultado","search_history":"Buscar historial","add_a_reply":"Responder...","search_this_profile":"Buscar este perfil...","search_my_content":"Buscar en mi contenido\u2026","share_what_youre_reading":"Compartir lo que est\u00e1 leyendo...","private_collection":"(Solo usted puede agregar a esta colecci\u00f3n, y nadie m\u00e1s podr\u00e1 verla)","email_addresses_of_recipients":"direcci\u00f3n de correo electr\u00f3nico de los destinatarios","this_document_could_not_be_deleted":"Este documento no puede ser borrado. P\u00f3ngase en contacto con support@scribd.com.","no_search_result_is_found":"No se encontraron resultados","search_is_disabled":"La b\u00fasqueda est\u00e1 deshabilitada\u2026","download":"Descarga","are_you_sure_you_want_to_delete_":"\u00bfEst\u00e1 seguro de que desea eliminar estos documentos? Esta acci\u00f3n no se puede deshacer.","search_books_presentations":"Buscar libros, presentaciones, negocios, publicaciones\u2026"}},"pt_BR":{"js":{"hi_there_were_logging_you_in":"Ol\u00e1! Seu acesso est\u00e1 sendo realizando.","public_moderated_collection":"(Outros usu\u00e1rios podem fazer adi\u00e7\u00f5es a esta cole\u00e7\u00e3o, mas voc\u00ea pode aprovar ou rejeit\u00e1-las)","search_people":"Busque Pessoas","enter_a_name_for_your_new_collection":"Insira um nome para sua nova cole\u00e7\u00e3o...","successfully_sent_this_document":"Este documento foi enviado com sucesso!","readcast_complete":"Readcast conclu\u00eddo!","search_within_document":"Buscar dentro do documento","of":"de","are_you_sure_you_want_to_delete":"Tem certeza que deseja excluir este item?","show_bulk_editor":"Exibir editor de lote","public_locked_collection":"(S\u00f3 voc\u00ea pode fazer adi\u00e7\u00f5es a esta cole\u00e7\u00e3o, mas outros usu\u00e1rios podem visualiz\u00e1-la)","hide_bulk_editor":"Exibir editor de lote","help_me":"Estou cheio de abelhas!","email_addresses_or_scribd_usernames":"endere\u00e7os de e-mail ou nomes de usu\u00e1rio no Scribd","result":"Resultado","search_history":"Historia de Buscas","add_a_reply":"Deixar uma resposta...","search_this_profile":"Pesquisar este perfil...","search_my_content":"Pesquisar no meu conte\u00fado...","share_what_youre_reading":"Compartilhar o que voc\u00ea est\u00e1 lendo...","private_collection":"(S\u00f3 voc\u00ea pode fazer adi\u00e7\u00f5es a esta cole\u00e7\u00e3o, e somente voc\u00ea poder\u00e1 visualiz\u00e1-la)","email_addresses_of_recipients":"dire\u00e7\u00f5es de e-mail dos recipientes","this_document_could_not_be_deleted":"O documento n\u00e3o p\u00f4de ser enviado no momento. Entre em contato atrav\u00e9s do e-mail support@scribd.com.","no_search_result_is_found":"N\u00e3o foram encontrados resultados para sua busca","search_is_disabled":"A pesquisa est\u00e1 desativada...","download":"Download","are_you_sure_you_want_to_delete_":"Tem certeza que deseja excluir estes documentos?","search_books_presentations":"Pesquise por livros, apresenta\u00e7\u00f5es, neg\u00f3cios, acad\u00eamicos..."}}};


/* public/javascripts/shared/twitter.js @ 1339185887 */

Scribd.init('Scribd','Twitter');Scribd.Twitter.loadName=function(){var placeholders=$$('.twitter_placeholder');if(placeholders.length<1){return;}
new Ajax.Request("/twitter_link/info.json",{method:'get',onSuccess:function(trans){try{var name=trans.responseJSON.info.screen_name;if(typeof name==='undefined')return;placeholders.each(function(element){element.update("@"+name);});}catch(e){}}});};


/* public/javascripts/shared/vendor/easyXDM.js @ 1339185887 */
var lzy_js_public_javascripts_shared_vendor_easyXDM="\n(function(window,document,location,setTimeout,decodeURIComponent,encodeURIComponent){var global=this;var _channelId=0;var emptyFn=Function.prototype;var reURI=/^(http.?:\\/\\/([^\\/\\s]+))/,reParent=/[\\-\\w]+\\/\\.\\.\\//,reDoubleSlash=/([^:])\\/\\//g;var CREATE_FRAME_USING_HTML=/msie [67]/.test(navigator.userAgent.toLowerCase());function isHostMethod(object,property){var t=typeof object[property];return t==\'function\'||(!!(t==\'object\'&&object[property]))||t==\'unknown\';}\nfunction isHostObject(object,property){return!!(typeof(object[property])==\'object\'&&object[property]);}\nvar on=(function(){if(isHostMethod(window,\"addEventListener\")){return function(target,type,listener){target.addEventListener(type,listener,false);};}\nelse{return function(object,sEvent,fpNotify){object.attachEvent(\"on\"+sEvent,fpNotify);};}}());var un=(function(){if(isHostMethod(window,\"removeEventListener\")){return function(target,type,listener,useCapture){target.removeEventListener(type,listener,useCapture);};}\nelse{return function(object,sEvent,fpNotify){object.detachEvent(\"on\"+sEvent,fpNotify);};}}());function getDomainName(url){return url.match(reURI)[2];}\nfunction getLocation(url){return url.match(reURI)[1];}\nfunction resolveUrl(url){url=url.replace(reDoubleSlash,\"$1/\");if(!url.match(/^(http||https):\\/\\//)){var path=(url.substring(0,1)===\"/\")?\"\":location.pathname;if(path.substring(path.length-1)!==\"/\"){path=path.substring(0,path.lastIndexOf(\"/\")+1);}\nurl=location.protocol+\"//\"+location.host+path+url;}\nwhile(reParent.test(url)){url=url.replace(reParent,\"\");}\nreturn url;}\nfunction appendQueryParameters(url,parameters){var hash=\"\",indexOf=url.indexOf(\"#\");if(indexOf!==-1){hash=url.substring(indexOf);url=url.substring(0,indexOf);}\nvar q=[];for(var key in parameters){if(parameters.hasOwnProperty(key)){q.push(key+\"=\"+parameters[key]);}}\nreturn url+((url.indexOf(\"?\")===-1)?\"?\":\"&\")+q.join(\"&\")+hash;}\nvar _query=(function(){var query={},pair,search=location.search.substring(1).split(\"&\"),i=search.length;while(i--){pair=search[i].split(\"=\");query[pair[0]]=pair[1];}\nreturn query;}());function undef(v){return typeof v===\"undefined\";}\nfunction getJSON(){var cached={};var obj={a:[1,2,3]},json=\"{\\\"a\\\":[1,2,3]}\";if(JSON&&typeof JSON.stringify===\"function\"&&JSON.stringify(obj).replace((/\\s/g),\"\")===json){return JSON;}\nif(Object.toJSON){if(Object.toJSON(obj).replace((/\\s/g),\"\")===json){cached.stringify=Object.toJSON;}}\nif(typeof String.prototype.evalJSON===\"function\"){obj=json.evalJSON();if(obj.a&&obj.a.length===3&&obj.a[2]===3){cached.parse=function(str){return str.evalJSON();};}}\nif(cached.stringify&&cached.parse){getJSON=function(){return cached;};return cached;}\nreturn null;}\nfunction apply(destination,source,noOverwrite){var member;for(var prop in source){if(source.hasOwnProperty(prop)){if(prop in destination){member=source[prop];if(typeof member===\"object\"){apply(destination[prop],member,noOverwrite);}\nelse if(!noOverwrite){destination[prop]=source[prop];}}\nelse{destination[prop]=source[prop];}}}\nreturn destination;}\nfunction createFrame(config){var frame;if(config.props.name&&CREATE_FRAME_USING_HTML){frame=document.createElement(\"<iframe name=\\\"\"+config.props.name+\"\\\"/>\");}\nelse{frame=document.createElement(\"IFRAME\");}\napply(frame,config.props);frame.id=frame.name;if(config.onLoad){frame.loadFn=function(){config.onLoad(frame.contentWindow);};on(frame,\"load\",frame.loadFn);}\nif(config.container){frame.border=frame.frameBorder=0;config.container.appendChild(frame);}\nelse{frame.style.position=\"absolute\";frame.style.left=\"-2000px\";frame.style.top=\"0px\";document.body.appendChild(frame);}\nreturn frame;}\nvar getXhr=(function(){if(isHostMethod(window,\"XMLHttpRequest\")){return function(){return new XMLHttpRequest();};}\nelse{var item=(function(){var list=[\"Microsoft\",\"Msxml2\",\"Msxml3\"],i=list.length;while(i--){try{item=list[i]+\".XMLHTTP\";var obj=new ActiveXObject(item);return item;}\ncatch(e){}}}());return function(){return new ActiveXObject(item);};}}());function ajax(config){apply(config,{method:\"POST\",headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",\"X-Requested-With\":\"XMLHttpRequest\"},success:emptyFn,error:function(msg){throw new Error(msg);},data:{},type:\"plain\"},true);var req=getXhr(),q=[];req.open(config.method,config.url,true);for(var prop in config.headers){if(config.headers.hasOwnProperty(prop)){req.setRequestHeader(prop,config.headers[prop]);}}\nreq.onreadystatechange=function(){if(req.readyState==4){if(req.status>=200&&req.status<300){var response=req.responseText;if(config.type===\"json\"){response=getJSON().parse(response);}\nconfig.success(response);}\nelse{config.error(\"An error occured. Status code: \"+req.status);}\nreq.onreadystatechange=null;delete req.onreadystatechange;}};for(var key in config.data){if(config.data.hasOwnProperty(key)){q.push(encodeURIComponent(key)+\"=\"+encodeURIComponent(config.data[key]));}}\nreq.send(q.join(\"&\"));}\nfunction prepareTransportStack(config){var protocol=config.protocol,stackEls;config.isHost=config.isHost||undef(_query.xdm_p);if(!config.props){config.props={};}\nif(!config.isHost){config.channel=_query.xdm_c;config.secret=_query.xdm_s;config.remote=decodeURIComponent(_query.xdm_e);protocol=_query.xdm_p;}\nelse{config.remote=resolveUrl(config.remote);config.channel=config.channel||\"default\"+_channelId++;config.secret=Math.random().toString(16).substring(2);if(undef(protocol)){if(isHostMethod(window,\"postMessage\")){protocol=\"1\";}\nelse if(isHostMethod(window,\"ActiveXObject\")&&isHostMethod(window,\"execScript\")){protocol=\"3\";}\nelse if(config.remoteHelper){config.remoteHelper=resolveUrl(config.remoteHelper);protocol=\"2\";}\nelse{protocol=\"0\";}}}\nswitch(protocol){case\"0\":apply(config,{interval:300,delay:2000,useResize:true,useParent:false,usePolling:false},true);if(config.isHost){if(!config.local){var domain=location.protocol+\"//\"+location.host,images=document.body.getElementsByTagName(\"img\"),i=images.length,image;while(i--){image=images[i];if(image.src.substring(0,domain.length)===domain){config.local=image.src;break;}}\nif(!config.local){config.local=window;}}\nvar parameters={xdm_c:config.channel,xdm_p:0};if(config.local===window){config.usePolling=true;config.useParent=true;config.local=location.protocol+\"//\"+location.host+location.pathname+location.search;parameters.xdm_e=encodeURIComponent(config.local);parameters.xdm_pa=1;}\nelse{parameters.xdm_e=resolveUrl(config.local);}\nif(config.container){config.useResize=false;parameters.xdm_po=1;}\nconfig.remote=appendQueryParameters(config.remote,parameters);}\nelse{apply(config,{channel:_query.xdm_c,remote:decodeURIComponent(_query.xdm_e),useParent:!undef(_query.xdm_pa),usePolling:!undef(_query.xdm_po),useResize:config.useParent?false:config.useResize});}\nstackEls=[new easyXDM.stack.HashTransport(config),new easyXDM.stack.ReliableBehavior({timeout:((config.useResize?50:config.interval*1.5)+(config.usePolling?config.interval*1.5:50))}),new easyXDM.stack.QueueBehavior({encode:true,maxLength:4000-config.remote.length}),new easyXDM.stack.VerifyBehavior({initiate:config.isHost})];break;case\"1\":stackEls=[new easyXDM.stack.PostMessageTransport(config),new easyXDM.stack.QueueBehavior()];break;case\"2\":stackEls=[new easyXDM.stack.NameTransport(config),new easyXDM.stack.QueueBehavior(),new easyXDM.stack.VerifyBehavior({initiate:config.isHost})];break;case\"3\":stackEls=[new easyXDM.stack.NixTransport(config),new easyXDM.stack.QueueBehavior()];break;}\nreturn stackEls;}\nfunction chainStack(stackElements){var stackEl,defaults={incoming:function(message,origin){this.up.incoming(message,origin);},outgoing:function(message,recipient){this.down.outgoing(message,recipient);},callback:function(success){this.up.callback(success);},init:function(){this.down.init();},destroy:function(){this.down.destroy();}};for(var i=0,len=stackElements.length;i<len;i++){stackEl=stackElements[i];apply(stackEl,defaults,true);if(i!==0){stackEl.down=stackElements[i-1];}\nif(i!==len-1){stackEl.up=stackElements[i+1];}}\nreturn stackEl;}\nglobal.easyXDM={version:\"2.4.0.90\",apply:apply,query:_query,ajax:ajax,getJSONObject:getJSON,stack:{}};easyXDM.DomHelper={on:on,un:un,requiresJSON:function(path){if(!isHostObject(window,\"JSON\")){document.write(\'<script type=\"text/javascript\" src=\"\'+path+\'\"><\/script>\');}}};(function(){var _map={};easyXDM.Fn={set:function(name,fn){_map[name]=fn;},get:function(name,del){var fn=_map[name];if(del){delete _map[name];}\nreturn fn;}};}());easyXDM.Socket=function(config){var stack=chainStack(prepareTransportStack(config).concat([{incoming:function(message,origin){config.onMessage(message,origin);},callback:function(success){if(config.onReady){config.onReady(success);}}}])),recipient=getLocation(config.remote);this.destroy=function(){stack.destroy();};this.postMessage=function(message){stack.outgoing(message,recipient);};stack.init();};easyXDM.Rpc=function(config,jsonRpcConfig){if(jsonRpcConfig.local){for(var method in jsonRpcConfig.local){if(jsonRpcConfig.local.hasOwnProperty(method)){var member=jsonRpcConfig.local[method];if(typeof member===\"function\"){jsonRpcConfig.local[method]={method:member};}}}}\nvar stack=chainStack(prepareTransportStack(config).concat([new easyXDM.stack.RpcBehavior(this,jsonRpcConfig),{callback:function(success){if(config.onReady){config.onReady(success);}}}]));this.destroy=function(){stack.destroy();};stack.init();};easyXDM.stack.PostMessageTransport=function(config){var pub,frame,callerWindow,targetOrigin;function _getOrigin(event){if(event.origin){return event.origin;}\nif(event.uri){return getLocation(event.uri);}\nif(event.domain){return location.protocol+\"//\"+event.domain;}\nthrow\"Unable to retrieve the origin of the event\";}\nfunction _window_onMessage(event){var origin=_getOrigin(event);if(origin==targetOrigin&&event.data.substring(0,config.channel.length+1)==config.channel+\" \"){pub.up.incoming(event.data.substring(config.channel.length+1),origin);}}\nreturn(pub={outgoing:function(message,domain,fn){callerWindow.postMessage(config.channel+\" \"+message,domain||targetOrigin);fn();},destroy:function(){un(window,\"message\",_window_onMessage);if(frame){callerWindow=null;frame.parentNode.removeChild(frame);frame=null;}},init:function(){targetOrigin=getLocation(config.remote);if(config.isHost){on(window,\"message\",function waitForReady(event){if(event.data==config.channel+\"-ready\"){callerWindow=frame.contentWindow;un(window,\"message\",waitForReady);on(window,\"message\",_window_onMessage);setTimeout(function(){pub.up.callback(true);},0);}});apply(config.props,{src:appendQueryParameters(config.remote,{xdm_e:location.protocol+\"//\"+location.host,xdm_c:config.channel,xdm_p:1})});frame=createFrame(config);}\nelse{on(window,\"message\",_window_onMessage);callerWindow=window.parent;callerWindow.postMessage(config.channel+\"-ready\",targetOrigin);setTimeout(function(){pub.up.callback(true);},0);}}});};easyXDM.stack.NixTransport=function(config){var pub,frame,send,targetOrigin,proxy;return(pub={outgoing:function(message,domain,fn){send(message);fn();},destroy:function(){proxy=null;if(frame){frame.parentNode.removeChild(frame);frame=null;}},init:function(){targetOrigin=getLocation(config.remote);if(config.isHost){try{if(!isHostMethod(window,\"GetNixProxy\")){window.execScript(\'Class NixProxy\\n\'+\'    Private m_parent, m_child, m_Auth\\n\'+\'\\n\'+\'    Public Sub SetParent(obj, auth)\\n\'+\'        If isEmpty(m_Auth) Then m_Auth = auth\\n\'+\'        SET m_parent = obj\\n\'+\'    End Sub\\n\'+\'    Public Sub SetChild(obj)\\n\'+\'        SET m_child = obj\\n\'+\'        m_parent.ready()\\n\'+\'    End Sub\\n\'+\'\\n\'+\'    Public Sub SendToParent(data, auth)\\n\'+\'        If m_Auth = auth Then m_parent.send(CStr(data))\\n\'+\'    End Sub\\n\'+\'    Public Sub SendToChild(data, auth)\\n\'+\'        If m_Auth = auth Then m_child.send(CStr(data))\\n\'+\'    End Sub\\n\'+\'End Class\\n\'+\'Function GetNixProxy()\\n\'+\'    Set GetNixProxy = New NixProxy\\n\'+\'End Function\\n\',\'vbscript\');}\nproxy=GetNixProxy();proxy.SetParent({send:function(msg){pub.up.incoming(msg,targetOrigin);},ready:function(){setTimeout(function(){pub.up.callback(true);},0);}},config.secret);send=function(msg){proxy.SendToChild(msg,config.secret);};}\ncatch(e){throw new Error(\"Could not set up VBScript NixProxy:\"+e.message);}\napply(config.props,{src:appendQueryParameters(config.remote,{xdm_e:location.protocol+\"//\"+location.host,xdm_c:config.channel,xdm_s:config.secret,xdm_p:3})});frame=createFrame(config);frame.contentWindow.opener=proxy;}\nelse{try{proxy=window.opener;}\ncatch(e){throw new Error(\"Cannot access window.opener\");}\nproxy.SetChild({send:function(msg){global.setTimeout(function(){pub.up.incoming(msg,targetOrigin);},0);}});send=function(msg){proxy.SendToParent(msg,config.secret);};setTimeout(function(){pub.up.callback(true);},0);}}});};easyXDM.stack.NameTransport=function(config){var pub;var isHost,callerWindow,remoteWindow,readyCount,callback,remoteOrigin,remoteUrl;function _sendMessage(message){var url=config.remoteHelper+(isHost?(\"#_3\"+encodeURIComponent(remoteUrl+\"#\"+config.channel)):(\"#_2\"+config.channel));callerWindow.contentWindow.sendMessage(message,url);}\nfunction _onReady(){if(isHost){if(++readyCount===2||!isHost){pub.up.callback(true);}}\nelse{_sendMessage(\"ready\");pub.up.callback(true);}}\nfunction _onMessage(message){pub.up.incoming(message,remoteOrigin);}\nfunction _onLoad(){if(callback){setTimeout(function(){callback(true);},0);}}\nreturn(pub={outgoing:function(message,domain,fn){callback=fn;_sendMessage(message);},destroy:function(){callerWindow.parentNode.removeChild(callerWindow);callerWindow=null;if(isHost){remoteWindow.parentNode.removeChild(remoteWindow);remoteWindow=null;}},init:function(){isHost=config.isHost;readyCount=0;remoteOrigin=getLocation(config.remote);config.local=resolveUrl(config.local);if(isHost){easyXDM.Fn.set(config.channel,function(message){if(isHost&&message===\"ready\"){easyXDM.Fn.set(config.channel,_onMessage);_onReady();}});remoteUrl=appendQueryParameters(config.remote,{xdm_e:config.local,xdm_c:config.channel,xdm_p:2});apply(config.props,{src:remoteUrl+\'#\'+config.channel,name:config.channel});remoteWindow=createFrame(config);}\nelse{config.remoteHelper=config.remote;easyXDM.Fn.set(config.channel,_onMessage);}\ncallerWindow=createFrame({props:{src:config.local+\"#_4\"+config.channel},onLoad:function(){un(callerWindow,\"load\",callerWindow.loadFn);easyXDM.Fn.set(config.channel+\"_load\",_onLoad);_onReady();}});}});};easyXDM.stack.HashTransport=function(config){var pub;var me=this,isHost,_timer,pollInterval,_lastMsg,_msgNr,_listenerWindow,_callerWindow;var usePolling,useParent,useResize,_remoteOrigin;function _sendMessage(message){if(!_callerWindow){return;}\nvar url=config.remote+\"#\"+(_msgNr++)+\"_\"+message;if(isHost||!useParent){_callerWindow.contentWindow.location=url;if(useResize){_callerWindow.width=_callerWindow.width>75?50:100;}}\nelse{_callerWindow.location=url;}}\nfunction _handleHash(hash){_lastMsg=hash;pub.up.incoming(_lastMsg.substring(_lastMsg.indexOf(\"_\")+1),_remoteOrigin);}\nfunction _onResize(){_handleHash(_listenerWindow.location.hash);}\nfunction _pollHash(){if(_listenerWindow.location.hash&&_listenerWindow.location.hash!=_lastMsg){_handleHash(_listenerWindow.location.hash);}}\nfunction _attachListeners(){if(usePolling){_timer=setInterval(_pollHash,pollInterval);}\nelse{on(_listenerWindow,\"resize\",_onResize);}}\nreturn(pub={outgoing:function(message,domain){_sendMessage(message);},destroy:function(){if(usePolling){window.clearInterval(_timer);}\nelse if(_listenerWindow){un(_listenerWindow,\"resize\",_pollHash);}\nif(isHost||!useParent){_callerWindow.parentNode.removeChild(_callerWindow);}\n_callerWindow=null;},init:function(){isHost=config.isHost;pollInterval=config.interval;_lastMsg=\"#\"+config.channel;_msgNr=0;usePolling=config.usePolling;useParent=config.useParent;useResize=config.useResize;_remoteOrigin=getLocation(config.remote);if(!isHost&&useParent){_listenerWindow=window;_callerWindow=parent;_attachListeners();pub.up.callback(true);}\nelse{apply(config,{props:{src:(isHost?config.remote:config.remote+\"#\"+config.channel),name:(isHost?\"local_\":\"remote_\")+config.channel},onLoad:(isHost&&useParent||!isHost)?(function(){_listenerWindow=window;_attachListeners();pub.up.callback(true);}):null});_callerWindow=createFrame(config);if(isHost&&!useParent){var tries=0,max=config.delay/50;(function getRef(){if(++tries>max){throw new Error(\"Unable to reference listenerwindow\");}\nif(_listenerWindow){return;}\ntry{_listenerWindow=_callerWindow.contentWindow.frames[\"remote_\"+config.channel];window.clearTimeout(_timer);_attachListeners();pub.up.callback(true);return;}\ncatch(ex){setTimeout(getRef,50);}}());}}}});};easyXDM.stack.ReliableBehavior=function(config){var pub,timer,current,next,sendId=0,sendCount=0,maxTries=config.tries||5,timeout=config.timeout,receiveId=0,callback;return(pub={incoming:function(message,origin){var indexOf=message.indexOf(\"_\"),ack=parseInt(message.substring(0,indexOf),10),id;message=message.substring(indexOf+1);indexOf=message.indexOf(\"_\");id=parseInt(message.substring(0,indexOf),10);indexOf=message.indexOf(\"_\");message=message.substring(indexOf+1);if(timer&&ack===sendId){window.clearTimeout(timer);timer=null;if(callback){setTimeout(function(){callback(true);},0);}}\nif(id!==0){if(id!==receiveId){receiveId=id;message=message.substring(id.length+1);pub.down.outgoing(id+\"_0_ack\",origin);setTimeout(function(){pub.up.incoming(message,origin);},config.timeout/2);}\nelse{pub.down.outgoing(id+\"_0_ack\",origin);}}},outgoing:function(message,origin,fn){callback=fn;sendCount=0;current={data:receiveId+\"_\"+(++sendId)+\"_\"+message,origin:origin};(function send(){timer=null;if(++sendCount>maxTries){if(callback){setTimeout(function(){callback(false);},0);}}\nelse{pub.down.outgoing(current.data,current.origin);timer=setTimeout(send,config.timeout);}}());},destroy:function(){if(timer){window.clearInterval(timer);}\npub.down.destroy();}});};easyXDM.stack.QueueBehavior=function(config){var pub,queue=[],waiting=true,incoming=\"\",destroying,maxLength=0;function dispatch(){if(waiting||queue.length===0||destroying){return;}\nwaiting=true;var message=queue.shift();pub.down.outgoing(message.data,message.origin,function(success){waiting=false;if(message.callback){setTimeout(function(){message.callback(success);},0);}\ndispatch();});}\nreturn(pub={init:function(){if(undef(config)){config={};}\nmaxLength=config.maxLength?config.maxLength:0;pub.down.init();},callback:function(success){waiting=false;dispatch();pub.up.callback(success);},incoming:function(message,origin){var indexOf=message.indexOf(\"_\"),seq=parseInt(message.substring(0,indexOf),10);incoming+=message.substring(indexOf+1);if(seq===0){if(config.encode){incoming=decodeURIComponent(incoming);}\npub.up.incoming(incoming,origin);incoming=\"\";}},outgoing:function(message,origin,fn){if(config.encode){message=encodeURIComponent(message);}\nvar fragments=[],fragment;if(maxLength){while(message.length!==0){fragment=message.substring(0,maxLength);message=message.substring(fragment.length);fragments.push(fragment);}}\nelse{fragments.push(message);}\nwhile((fragment=fragments.shift())){queue.push({data:fragments.length+\"_\"+fragment,origin:origin,callback:fragments.length===0?fn:null});}\ndispatch();},destroy:function(){destroying=true;pub.down.destroy();}});};easyXDM.stack.VerifyBehavior=function(config){var pub,mySecret,theirSecret,verified=false;function startVerification(){mySecret=Math.random().toString(16).substring(2);pub.down.outgoing(mySecret);}\nreturn(pub={incoming:function(message,origin){var indexOf=message.indexOf(\"_\");if(indexOf===-1){if(message===mySecret){pub.up.callback(true);}\nelse if(!theirSecret){theirSecret=message;if(!config.initiate){startVerification();}\npub.down.outgoing(message);}}\nelse{if(message.substring(0,indexOf)===theirSecret){pub.up.incoming(message.substring(indexOf+1),origin);}}},outgoing:function(message,origin,fn){pub.down.outgoing(mySecret+\"_\"+message,origin,fn);},callback:function(success){if(config.initiate){startVerification();}}});};easyXDM.stack.RpcBehavior=function(proxy,config){var pub,serializer=config.serializer||getJSON();var _callbackCounter=0,_callbacks={};function _send(data){data.jsonrpc=\"2.0\";pub.down.outgoing(serializer.stringify(data));}\nfunction _createMethod(definition,method){var slice=Array.prototype.slice;return function(){var l=arguments.length,callback,message={method:method};if(l>0&&typeof arguments[l-1]===\"function\"){if(l>1&&typeof arguments[l-2]===\"function\"){callback={success:arguments[l-2],error:arguments[l-1]};message.params=slice.call(arguments,0,l-2);}\nelse{callback={success:arguments[l-1]};message.params=slice.call(arguments,0,l-1);}\n_callbacks[\"\"+(++_callbackCounter)]=callback;message.id=_callbackCounter;}\nelse{message.params=slice.call(arguments,0);}\n_send(message);};}\nfunction _executeMethod(method,id,fn,params){if(!fn){if(id){_send({id:id,error:{code:-32601,message:\"Procedure not found.\"}});}\nreturn;}\nvar used=false,success,error;if(id){success=function(result){if(used){return;}\nused=true;_send({id:id,result:result});};error=function(message){if(used){return;}\nused=true;_send({id:id,error:{code:-32099,message:\"Application error: \"+message}});};}\nelse{success=error=emptyFn;}\ntry{var result=fn.method.apply(fn.scope,params.concat([success,error]));if(!undef(result)){success(result);}}\ncatch(ex1){error(ex1.message);}}\nreturn(pub={incoming:function(message,origin){var data=serializer.parse(message);if(data.method){if(config.handle){config.handle(data,_send);}\nelse{_executeMethod(data.method,data.id,config.local[data.method],data.params);}}\nelse{var callback=_callbacks[data.id];if(data.error){if(callback.error){callback.error(data.error);}}\nelse if(callback.success){callback.success(data.result);}\ndelete _callbacks[data.id];}},init:function(){if(config.remote){for(var method in config.remote){if(config.remote.hasOwnProperty(method)){proxy[method]=_createMethod(config.remote[method],method);}}}\npub.down.init();},destroy:function(){for(var method in config.remote){if(config.remote.hasOwnProperty(method)&&proxy.hasOwnProperty(method)){delete proxy[method];}}\npub.down.destroy();}});};})(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);";


/* :files, 'public/javascripts/shared', ... @ (none) */


/* :files, 'app/views', ... @ 1339185851 */
/* app/views/layouts/global_search.js @ 1339185851 */

Scribd.SearchAutoCompleter=(function(){function DataSource(data,category){this.data=data;this.category=category;}
DataSource.prototype={find:function(query){var matches=[];this.data.each(function(element){if(this.category==="documents"){var pos=firstMatchedPosition(element.n,query);element.title=element.n;element.url=Scribd.DocumentUrl.urlByDocId(element.i,{relative_path:true});}else if(this.category==="users"||this.category==="publishers"){var pos=firstMatchedPosition(element.un,query);element.title=element.un;if(pos<0){pos=firstMatchedPosition(element.ul,query);element.title=element.ul;}
var id=(this.category==="users"?element.i:element.ui);element.url='/users/'+id;}else if(this.category==="document_collections"||this.category==="scribd_pages"){element.title=element.n;var pos=firstMatchedPosition(element.n,query);if(this.category==="document_collections"){element.url='/document_collections/'+element.i;}else{element.url=element.u;}}
element.sanitizedTitle=element.title&&element.title.escapeHTML();element.sanitizedUserName=element.un&&element.un.escapeHTML();if(pos>-1){matches.push([element,pos,query.length]);}else if(element.e&&element.e.indexOf(query)>-1){matches.push([element,0,0]);}}.bind(this));return matches;},size:function(){return this.data.length;}};function Result(obj,pos,len){this.obj=obj;this.pos=pos;this.len=len;this.dom_id=null;this.next=null;this.prev=null;this.dom_id="ac_result_"+this.obj.t+"_"+this.obj.i;}
Result.prototype={render:function(template){this.obj.mod_title=this.obj.title.substr(0,this.pos).escapeHTML()+"<strong>"+
this.obj.title.substr(this.pos,this.len).escapeHTML()+"</strong>"+
this.obj.title.substr(this.pos+this.len,this.obj.title.length).escapeHTML();return("<span id='"+this.dom_id+"'>"+template+"</span>").interpolate(this.obj);},element:function(){if(this._element){return this._element;}
this._element=$(this.dom_id);return this._element;}};function Container(element,title){this.element=element;this.title=title;this.results=[];}
Container.prototype={updateWith:function(results){this.results=[];if(results.length===0){this.element.hide();return;}
this.element.show();var html=["<h4>"+this.title.gsub('_',' ')+"</h4><ul>"];var that=this;results.each(function(result){var obj=result[0];var pos=result[1];var len=result[2];that.results.push(new Result(obj,pos,len));});this.results.each(function(result){html.push(result.render(that.template));});html.push('</ul>');this.element.down('.ac_main').update(html.join(''));},clear:function(){this.element.down('.ac_main').update('');}};function firstMatchedPosition(text,query){text=text.toLowerCase();if(text.substr(0,query.length)===query){return pos=0;}
var pos=text.indexOf(" "+query);if(pos>-1){pos++;}
return pos;}
function normalizeQuery(query){return query?query.strip().toLowerCase():query;}
var SearchAutocompleter=function(field,resultsContainerId,keyStrokeBufferDelay){this.field=field;this.resultsContainerId=resultsContainerId;this.selectedElement=null;this.results=[];this.categories=[];this.bufferKeyTimer=null;this.keyStrokeBufferDelay=keyStrokeBufferDelay||200;Event.observe(window,"keyup",function(e){if(!$(this.resultsContainerId).visible())return;if((e.keyCode===13||e.keyCode==9)&&this.results.length>0&&this.selectedElement){location.href=this.selectedElement.obj.url;}else if(e.keyCode==38){if(this.selectedElement===null){this.changeSelectedElement(this.results[this.results.length-1]);}else{this.changeSelectedElement(this.selectedElement.prev);}
e.stop();}else if(e.keyCode==40){if(this.selectedElement===null){this.changeSelectedElement(this.results[0]);}else{this.changeSelectedElement(this.selectedElement.next);}
e.stop();}else if(e.keyCode==27){e.stop();this.hide();}}.bind(this));Event.observe(window,"click",function(e){if(e.findElement()!==this.field){this.hide();}}.bind(this));Event.observe(this.field,"keyup",this.bufferedKeyup.bind(this));this.dataSources=[];this.containers={};};SearchAutocompleter.prototype={hide:function(){this.results=[];this.selectedElement=null;$(this.resultsContainerId).hide();this.categories.each(function(category){this.containers[category].clear();}.bind(this));},bufferedKeyup:function(){if(this.bufferedQuery!==this.field.getValue()){window.clearTimeout(this.bufferKeyTimer);this.bufferedQuery=this.field.getValue();var query=normalizeQuery(this.bufferedQuery);var that=this;this.bufferKeyTimer=window.setTimeout(function(){that.service.find(query,{found:function(json){that.initDataSources(json);that.find(query);$(that.resultsContainerId).show();},notFound:function(){that.hide();}});},query.length==1&&((query>='a'&&query<='z')||(query>='A'&&query<='Z'))?0:that.keyStrokeBufferDelay);}},initDataSources:function(data){var total=0
this.dataSources=[];for(var category in data){var ds=new DataSource(data[category],category);total+=ds.size();this.dataSources.push(ds);}
return total;},init:function(data){this.initDataSources(data);for(var category in data){this.categories.push(category);var sectionId=this.resultsContainerId+"_"+category;if(!$(sectionId)){$(this.resultsContainerId).insert("<div id='#{id}' class='ac_section'></div>".interpolate({id:sectionId}));}
var container=new Container($(sectionId),category);this.containers[category]=container;if(category==="scribd_pages"){container.template="<a href='#{url}'><li><p>#{mod_title}</p></li></a>";}else if(category==='users'||category==='publishers'){container.template="<a href='#{url}'><li><img src='#{tu}' alt='#{sanitizedTitle}' /><p>#{mod_title}</p></li></a>";}else if(category==="documents"||category==="document_collections"){container.template="<a href='#{url}'><li><img src='#{tu}' alt='#{sanitizedTitle}' /><div><p>#{mod_title}</p><p class='ac_user_credit'><span class='label'>From:</span> #{sanitizedUserName}</p></div></li></a>";}}},changeSelectedElement:function(newElement){if(this.selectedElement!==null){var selectedElement=this.selectedElement.element();if(selectedElement){selectedElement.down().removeClassName("highlight");}}
this.selectedElement=newElement;if(newElement!==null){var selectedElement=this.selectedElement.element();if(selectedElement){selectedElement.down().addClassName("highlight");}}},addKeybindings:function(){var that=this;this.results.each(function(result){Event.observe(result.element(),"mouseover",function(e){that.changeSelectedElement(result);});});},find:function(query){this.results=[];this.selectedElement=null;for(var i=0;i<this.dataSources.length;i++){var dataSource=this.dataSources[i];var container=this.containers[dataSource.category];if(container){container.updateWith(dataSource.find(query));this.results=this.results.concat(container.results);}}
if(this.results.length==0){this.hide();}else{for(var i=0;i<this.results.length;i++){if(i!==0){this.results[i-1].next=this.results[i];this.results[i].prev=this.results[i-1];}
if(i!==this.results.length-1){this.results[i+1].prev=this.results[i];this.results[i].next=this.results[i+1];}}
this.addKeybindings();}}};var GlobalService=Class.create({initialize:function(url){this.url=url,this.resultCache={},this.executedQueries={},this.bufferedQuery=null;},find:function(query,callbacks){if(this.hasNoResults(query)){callbacks.notFound();}else if(this.hasCache(query)){return callbacks.found(this.resultCache[query]);}else if(query!==this.bufferedQuery){if(!this.isFetching){this.isFetching=true;this._fetch(query,callbacks);}}
this.bufferedQuery=query;},_fetch:function(query,callbacks){this.bufferedQuery=query;this._remoteFetch(query,{q:query},callbacks);},_remoteFetch:function(query,params,callbacks){var that=this;new Ajax.Request(this.url,{method:'get',parameters:params,onSuccess:function(resp){var data=resp.responseJSON;if(data){var totalFound=0;for(var category in data){totalFound+=data[category].length;}
if(that.shouldCache()){that.executedQueries[query]=totalFound;that.resultCache[query]=data;}
if(totalFound>0){return callbacks.found(data);}}
callbacks.notFound();},onFailure:function(resp){Scribd.logError(resp);callbacks.notFound();},onException:function(req,e){Scribd.logError(e);},onComplete:function(){that.isFetching=false;if(query!==that.bufferedQuery){that.find(that.bufferedQuery,callbacks);}}});},hasNoResults:function(query){if(!query){return true;}
var found=this.executedQueries[query];if(found&&found<=0){return true;}
for(var q in this.executedQueries){if(query.indexOf(q)===0&&this.executedQueries[q]<=0){return true;}}
return false;},hasCache:function(query){var found=this.executedQueries[query];return(found&&found>0);},shouldCache:function(){return true;},preAlphabetCache:function(){var that=this;new Ajax.Request(this.url,{method:'get',parameters:{prefetch:true},onSuccess:function(resp){var data=resp.responseJSON;if(data){for(var preQuery in data){var pqData=data[preQuery];;var totalFound=0;for(var category in pqData){totalFound+=pqData[category].length;}
that.executedQueries[preQuery]=totalFound;that.resultCache[preQuery]=pqData;}}},onFailure:function(resp){Scribd.logError(resp);},onException:function(req,e){Scribd.logError(e);}});}});var UserService=Class.create(GlobalService,{initialize:function($super,userId){this.userId=userId;$super('/users/'+userId+'/autocompleter/fetchids');this.tries={0:new Scribd.CompactTrie(),1:new Scribd.CompactTrie(),3:new Scribd.CompactTrie()};this.triesLoaded=0;},fetchTrie:function(type,url){var that=this,typeId=SearchAutocompleter.TypesToIDs[type],globalCallback='__uactJsonp'+typeId;window[globalCallback]=undefined;window[globalCallback]=function(data){that.initTrie(typeId,data);};Scribd.jsonp({url:url,callback:globalCallback});},initTrie:function(category,data){this.tries[category].data=data;this.triesLoaded++;},_fetch:function(query,callbacks){if(query.length<2){callbacks.notFound();this.isFetching=false;}else{var params={};var found=false;for(var category in this.tries){var trie=this.tries[category];var ids=trie.search(query).flatten().uniq();if(ids.length>0){params[category]=ids.slice(0,5).join(',');found=true;}}
if(found){this._remoteFetch(query,params,callbacks);}else{if(this.shouldCache()){this.executedQueries[query]=0;}
callbacks.notFound();this.isFetching=false;}}},shouldCache:function(){return this.triesLoaded===3;}});SearchAutocompleter.GlobalService=GlobalService;SearchAutocompleter.UserService=UserService;SearchAutocompleter.TypesToIDs={documents:0,users:1,publisers:2,document_collections:3,scribd_pages:4};return SearchAutocompleter;})();Scribd.CompactTrie=(function(){var CT=function(data,endpoint){this.data=data||{};this.endpoint=endpoint||CT.endpoint;};CT.endpoint=String.fromCharCode(0x1337);CT.prototype={search:function(query){var data=this.data;var currentQuery='';for(var i=0;i<query.length;i++){var ch=query[i];currentQuery=currentQuery.concat(ch);var d=data[ch];if(d){data=d;currentQuery='';}else{var found=prefixMatch(data,currentQuery);if(!found){return[];}
if((found.key.length>=query.length-i&&found.key.indexOf(query.substr(i))===0)){data=found.data;break;}else if(query.substr(i).indexOf(found.key)===0){i+=(found.key.length-1);if(this.isEndPoint(found.data)){return[];}
currentQuery='';data=found.data;}else{return[];}}}
return this.enumerate(data);},enumerate:function(data){var results=[];for(var key in data){var ep=data[key];if(key==this.endpoint){results.push(data[key]);}else{results=results.concat(this.enumerate(data[key],key,this.endpoint));}}
return results;},isEndPoint:function(data){for(var k in data){var ep=data[k];if(k!=this.endpoint)
return false;}
return true;}};function prefixMatch(data,prefix){for(var key in data){if(key.indexOf(prefix)===0){return({'key':key,'data':data[key]});}}
return null;}
return CT;})();document.observe('dom:loaded',function(){var globalHeader=$('global_header');if(!globalHeader){return;}
if($('template_main_content')){if(!$('template_main_content').visible()){return;}}
var queryFields=$$('#global_header .search_input, #footer .search_input'),defaultText=I18n.t('js.search_books_presentations');queryFields.each(function(query){query.blur();/*<sl:translate>*/
var val=$F(query);/*</sl:translate>*/
if(query.visible()&&(!val||val===defaultText)){Scribd.addDefaultTextEvents(query,defaultText);}});if(Scribd.getOption('GlobalAutoCompleterEnabled')&&$("autocompleter")){var a=new Scribd.SearchAutoCompleter($('query_header'),"autocompleter");a.init({"documents":[],"users":[],"document_collections":[],"publishers":[],"scribd_pages":[]});a.service=new Scribd.SearchAutoCompleter.GlobalService('/autocompleter');}
$$('.search_button').invoke('observe','click',function(e){e.stop();var button=e.findElement(),form=button.up('form'),text=$F(form.down('.search_input'));if(text.strip()===defaultText){return;}
form.submit();});});


/* app/views/newdoc/document_list.js @ 1339185851 */

Scribd.init("Scribd","UI");Scribd.UI.DocumentListTabs=Class.create({initialize:function(container){this.container=$(container);if(!this.container)return;this.container.down(".tabs").observe("click",function(e){var elm=e.findElement('div[data-name]');if(elm){this.select_tab(elm.readAttribute("data-name"));}}.bind(this));this.select_tab(this.container.down(".tabs .tab").readAttribute("data-name"));},select_tab:function(name){var body=this.container.down(".content");body.select("> div").each(function(d){if(d.readAttribute("data-name")==name){d.show();}else{d.hide();}}.bind(this));this.container.select(".tabs .tab").invoke("removeClassName","active");this.container.select(".tabs .tab[data-name='"+name+"']").invoke("addClassName","active");}});Scribd.UI.DocumentListPager=Class.create({actions:{next_page:function(){this.goto_page(this.current_page+1);},prev_page:function(){this.goto_page(this.current_page-1);}},initialize:function(container){this.per_page=3;this.container=$(container);if(!this.container)return;this.container.observe("click",function(e){for(var action_name in this.actions){if(this.actions.hasOwnProperty(action_name)&&e.element().hasClassName(action_name)){e.stop();this.actions[action_name].call(this,e);}}}.bind(this));this.paginate();},remove:function(){var collections=this.container.up(".sidebar_collections"),content=this.container.up("div[data-name]");var tab_name=content.readAttribute("data-name");collections.down(".tabs .tab[data-name='"+tab_name+"']").remove();content.remove();if(collections.select(".tabs .tab").length==0){collections.remove();}},paginate:function(){var items=this.container.select(".pub_featured_doc");if(items.length==0)return this.remove();var page_num=1,max_pages=Math.ceil(items.length/this.per_page);this.pages=items.eachSlice(this.per_page,function(s){var page=new Element("div",{className:"related_page"});s.each(function(elm){page.insert({bottom:elm});});var footer=new Element("div",{className:"page_footer"});if(page_num>1){footer.insert({bottom:new Element("span",{className:"prev_page pseudoLink"}).update("Prev")});}
if(page_num<max_pages){if(!footer.empty()){footer.insert({bottom:" &middot; "});}
footer.insert({bottom:new Element("span",{className:"next_page pseudoLink"}).update("Next")});}
if(!footer.empty()){page.insert({bottom:footer});}
page_num++;return page;});this.pages.each(function(p){this.container.insert({bottom:p});}.bind(this));this.goto_page(1);},goto_page:function(page_num){page_num=Math.max(1,Math.min(this.pages.length,page_num));for(var i=0;i<this.pages.length;i++){var p=this.pages[i];if(i+1==page_num){p.show();p.select("img").each(function(img){force_lzld(img);});}else{p.hide();}}
this.current_page=page_num;}});


/* app/views/shared/menu/hover_menu.js @ 1339185851 */

Scribd.HoverMenu=Class.create({initialize:function(hover_el,menu_el){this.hover_element=hover_el;this.menu_element=this.hover_element.down('.sub_menu');this.active=false;this.timerId=null;this.setupObservers();},controls:function(){return[this.hover_element,this.menu_element];},setupObservers:function(){this.hover_element.observe('mouseenter',this.showMenu.bind(this));this.controls().invoke('observe','mouseenter',this.activate.bind(this));this.controls().invoke('observe','mousemove',this.activate.bind(this));this.controls().invoke('observe','click',this.activate.bind(this));this.controls().invoke('observe','mouseout',this.deactivate.bind(this));$("wrap").observe('click',function(){this.hover_element.removeClassName('open');}.bind(this));},activate:function(){this.active=true;clearTimeout(this.timerId);this.timerId=this.tryHide.bind(this).delay(1);},deactivate:function(){this.active=false;},tryHide:function(){if(this.active){return false;}
this.hover_element.removeClassName('open');},showMenu:function(){this.hideOthers();this.hover_element.addClassName('open');},hideOthers:function(){$$('.hover_menu').each(function(el){el.removeClassName('open');});}});document.observe('dom:loaded',function(){$$('.hover_menu').each(function(el){new Scribd.HoverMenu(el);});});


/* :class_inlines, 'app/views', ... @ 1339185851 */
/* app/views/newdoc/paginated/_page_numbers.js @ 1339185851 */

Scribd.init("Scribd","UI");Scribd.UI.PageNumbers=Class.create({page_range:7,initialize:function(container){this.container=$(container);if(docManager.pageCount()==1){this.container.hide();return;}
this.viewer=this.container.parentNode;this.pages_elm=this.container.down(".pages");this.center_on_document=this.center_on_document.bind(this);this.max_page=Scribd.UI.Pager.prototype.get_highest_page();this.attach.bind(this).defer();this.container.observe("click",function(e){var elm=e.findElement("[data-page]");if(elm){docManager.gotoPage(elm.readAttribute("data-page"));document.fire("scribd:interact");trackEvent("newdoc","Pagination","click_page_number",Scribd.logged_in?1:0);}}.bind(this));docManager.addEvent("expectedFirstPageChanged",function(page_num){this.current_page_changed(page_num);}.bind(this));this.current_page_changed(1);},current_page_changed:function(page_num){page_num=parseInt(page_num,10);if(page_num==this.page_num)return;this.pages_elm.update("");var half=Math.floor(this.page_range/2);var before=this.get_pages(page_num,-1,half),after=this.get_pages(page_num,1,this.page_range-before.length-1);if(!before.hit_end){this.pages_elm.appendChild(this.new_page_elm(1));this.pages_elm.appendChild(new Element("span").update("...").addClassName("dotdotdot"));}
var pages=before.concat().concat([page_num]).concat(after);pages.each(function(p){this.pages_elm.appendChild(this.new_page_elm(p));}.bind(this));if(!after.hit_end){this.pages_elm.appendChild(new Element("span").update("...").addClassName("dotdotdot"));this.pages_elm.appendChild(this.new_page_elm(this.max_page));}
this.pages_elm.select("li").each(function(e){if(e.readAttribute("data-page")==page_num){e.addClassName("current");}else{e.removeClassName("current");}});this.page_num=page_num;this.center_on_document();},get_pages:function(start,direction,count){var pages=[];var last=start;while(count-->0){start=docManager.getClosestPageNumber(start+direction,direction);if(start==last||start<1||start>this.max_page)break;last=start;pages.push(start);}
if(start<=1||start>=this.max_page)pages.hit_end=true;if(direction<0)pages.reverse(true);return pages;},new_page_elm:function(page_num){return new Element("li",{"data-page":page_num}).update(page_num);},attach:function(){document.observe("scribd:dom_height_changed",this.center_on_document);docManager.addEvent("zoomed",Scribd.UI.page_numbers.center_on_document.bind(this));this.center_on_document();},center_on_document:function(){var width=this.container.getWidth(),parent_width=this.viewer.getWidth();this.container.setStyle({left:Math.floor((parent_width-width)/2)+"px"});}});


/* app/views/newdoc/paginated/_paddles.js @ 1339185851 */

Scribd.init("Scribd","UI");Scribd.UI.Paddles=Class.create({actions:{paddle_left:function(){document.fire("scribd:interact");Scribd.UI.scroll_to_top();docManager.gotoPreviousPage();},paddle_right:function(){document.fire("scribd:interact");Scribd.UI.scroll_to_top();docManager.gotoNextPage();}},initialize:function(container){this.container=$(container);if(docManager.pageCount()==1){this.container.hide();return;}
this.max_page=Scribd.UI.Pager.prototype.get_highest_page();this.left_paddle=this.container.down(".paddle_left");this.right_paddle=this.container.down(".paddle_right");this.attach();this.is_mini=false;this.container.observe("click",function(e){Scribd.UI.dispatch(e,this.actions,this);}.bind(this));},on_change_page:function(num){if(num==1){this.left_paddle.addClassName("disabled");}else{this.left_paddle.removeClassName("disabled");}
if(num==this.max_page){this.right_paddle.addClassName("disabled");}else{this.right_paddle.removeClassName("disabled");}},attach:function(){var _this=this;var viewer=$("viewer");var left_paddle=this.left_paddle,right_paddle=this.right_paddle;var paddle_height=left_paddle.getHeight();docManager.addEvent("expectedFirstPageChanged",function(page_num){_this.on_change_page(page_num);});this.update_position=function(){var viewer_height=viewer.getHeight();var viewer_offset=viewer.cumulativeOffset();var scroll=document.viewport.getScrollOffsets();var up;if(viewer.style.position=="fixed"){up=0;}else{up=Math.max(scroll.top,viewer_offset.top);}
var down=viewer_offset.top+viewer_height;var height=down-up;var mid=Math.max(8,Math.floor((height-paddle_height)/2));left_paddle.style.bottom=mid+"px";right_paddle.style.bottom=mid+"px";}.bind(this);(function(){_this.on_change_page(docManager.firstVisiblePage.pageNum);var nop=function(){};_this.update_position();Scribd.StickyElement(_this.container,nop,nop,nop,_this.update_position);}).defer();}});


/* app/views/newdoc/show/_web.js @ 1339185851 */

Scribd.UI.setup_scrolling=function(){Scribd.UI.is_paginated=true;var current_user=Scribd.paginated_user={};current_user.max_viewed_page=1;current_user.num_refreshes=0;var page_load_time=+new Date;trackEvent("newdoc","Scrolling","hit",Scribd.logged_in?1:0);docManager.addEvent("expectedFirstPageChanged",function(page){current_user.max_viewed_page=Math.max(current_user.max_viewed_page,page);});Event.observe(window,'unload',function(){trackEvent('newdoc','Scrolling','pages_views_count',current_user.max_viewed_page);if(Scribd.UI.pager){trackEvent('newdoc','Scrolling','pages_views_percent',current_user.max_viewed_page/Scribd.UI.pager.max_page);}
trackEvent("newdoc","Scrolling","num_refreshes",current_user.num_refreshes);trackEvent("newdoc","Scrolling","time_on_site",(new Date-page_load_time)/1000);});};


/* app/views/newdoc/show/paginated.js @ 1339185851 */

Scribd.init("Scribd","UI");Scribd.UI.setup_pagination=function(){Scribd.UI.is_paginated=true;var current_user=Scribd.paginated_user={};current_user.max_viewed_page=1;current_user.num_refreshes=0;var page_load_time=+new Date;trackEvent("newdoc","Pagination","hit",Scribd.logged_in?1:0);docManager.addEvent("expectedFirstPageChanged",function(page){current_user.max_viewed_page=Math.max(current_user.max_viewed_page,page);});Event.observe(window,'unload',function(){trackEvent('newdoc','Pagination','pages_views_count',current_user.max_viewed_page);if(Scribd.UI.pager){trackEvent('newdoc','Pagination','pages_views_percent',current_user.max_viewed_page/Scribd.UI.pager.max_page);}
trackEvent("newdoc","Pagination","num_refreshes",current_user.num_refreshes);trackEvent("newdoc","Pagination","time_on_site",(new Date-page_load_time)/1000);});document.observe('scribd:interact',function(){var slots=Scribd.Ads.gpt_slots;if(slots&&googletag.pubads){current_user.num_refreshes++;googletag.pubads().refresh(slots);}}.throttle(5000));document.observe("keyup",function(e){var event_name;switch(e.keyCode){case Event.KEY_LEFT:document.fire("scribd:interact");event_name="keyboard_prev_page";Scribd.UI.scroll_to_top();docManager.gotoPreviousPage();break;case Event.KEY_RIGHT:document.fire("scribd:interact");event_name="keyboard_next_page";Scribd.UI.scroll_to_top();docManager.gotoNextPage();break;default:return;}
trackEvent("newdoc","Pagination",event_name,Scribd.logged_in?1:0);e.stop();});docManager.viewManagers.slideshow._setPageBounds=function(bounds){var page=this.documentManager.pages[this.currentPageId];if(!page)return;var width=bounds.width,height=bounds.height;(function(){width-=30;height=Math.ceil(width*this.origHeight/this.origWidth);this.containerElem.style.width=width+"px";this.containerElem.style.height=height+"px";this._targetWidth=width;this._fitContentsToWidth();}).apply(page);};(function(){var fn=document.fire.bind(document,"scribd:dom_height_changed");docManager.addEvent("exitedFullscreen",fn);docManager.addEvent("enteredFullscreen",fn);}).defer();};


/* app/views/newdoc/_search.js @ 1339185851 */

Scribd.init("Scribd","UI");Scribd.UI.DocumentSearchForm=Class.create({event_name:"document_search",initialize:function(container,controller){this.container=$(container);this.controller=controller;this.input=this.container.down(".query");this.form=this.container.down("form");var submitter=this.search_submit.bind(this);this.form.observe("submit",submitter);this.form.down(".search_submit").observe("click",submitter);},value:function(val){if(val!==undefined){this.input.value=val;}else{return this.input.value;}},disable:function(){this.form.addClassName("disabled");this.input.disabled=true;},enable:function(){this.form.removeClassName("disabled");this.input.disabled=false;},search_submit:function(e){trackEvent("newdoc","Submit",this.event_name,Scribd.logged_in?1:0);e.stop();this.controller.search(this.value());}});Scribd.UI.DocumentSearch=Class.create({initialize:function(container){this.container=$(container);this.searcher=new Scribd.Fourgen.DocSearcher({doc_id:Scribd.current_doc.id,upload_id:Scribd.current_doc.word_upload_id,secret_password:Scribd.current_doc.secret_password});this.controller=new Scribd.UI.SearchController(this.searcher,{on_clear:function(){this.form.value("");this.results.hide();}.bind(this)});this.results=new Scribd.UI.SearchResults(this.container.down(".search_results"),this);this.form=new Scribd.UI.DocumentSearchForm(this.container.down(".sidebar_search"),this.controller);this.form.event_name="sidebar_search";var is_mac=navigator.platform.match(/Mac/);if(is_mac)this.container.addClassName("osx");var enable_hotkey=true;if(Scribd.BrowserDetect.browser=="Explorer"){enable_hotkey=Scribd.BrowserDetect.version>=9;}
if(enable_hotkey){this.container.addClassName("hotkey_enabled");}
document.observe("keydown",function(e){if(e.keyCode=="F".charCodeAt(0)){if(is_mac&&e.metaKey||!is_mac&&e.ctrlKey){trackEvent("newdoc","Hotkey","present_search",Scribd.logged_in?1:0);this.results.present_for_search();e.stop();}
return;}
if(this.results.visible){if(e.keyCode==27){this.controller.reset_and_clear();this.results.hide();}else if(e.keyCode==38){this.controller.goto_prev_result();}else if(e.keyCode==40){this.controller.goto_next_result();}else{return;}
e.stop();}}.bind(this));}});Scribd.UI.SearchResults=Class.create({padding:16,actions:{next_result:function(){this.controller.goto_next_result();},prev_result:function(){this.controller.goto_prev_result();},close_button:function(){this.controller.reset_and_clear();this.hide();},history_result:function(elm){var query=elm.readAttribute("data-query");if(query==this.controller.query)return;this.controller.search(query,true);}},visible:false,initialize:function(container,doc_search){this.container=$(container);this.doc_search=doc_search;this.controller=doc_search.controller;this.search_history=[];this.list_elm=this.container.down(".results_list");this.form=new Scribd.UI.DocumentSearchForm(this.container.down(".popup_search"),this.controller);this.form.event_name="popup_search";this.controller.listen("on_search",function(query,from_history){this.show_loading();if(!from_history){this.search_history.push(query);}
this.render_search_history();this.form.value(query);this.container.select(".last_query").invoke("update",query.escapeHTML());this.form.disable();},this);this.controller.listen("on_results",function(results){if(!this.visible)return;this.form.enable();if(results.length===0){this.container.select(".scroller",".current_info").invoke("hide");}else{this.container.select(".scroller",".current_info").invoke("show");}
this.list_elm.update("");results.each(function(r,i){var elm=this.new_result_element(r.snippet,r.pageNum,i);this.list_elm.appendChild(elm);},this);this.container.select(".num_results").invoke("update",results.length);if(results.length==1){this.container.select(".plural").invoke("hide");this.container.select(".non_plural").invoke("show");}else{this.container.select(".plural").invoke("show");this.container.select(".non_plural").invoke("hide");}
this.done_loading();},this);this.controller.listen("on_select_result",function(i){this.container.select(".current_result_num").invoke("update",i+1);var old=this.list_elm.down("li.current_result");if(old){old.removeClassName("current_result");}
var current=this.list_elm.select("li")[i].addClassName("current_result");var scroller=this.container.down(".scroller");var h=current.getHeight(),scroll_height=scroller.getHeight();var pos=i*h;if(pos<scroller.scrollTop){scroller.scrollTop=pos;}else if(pos>scroller.scrollTop+scroll_height){scroller.scrollTop=pos-scroll_height+h;}},this);this.container.observe("click",function(e){if(Scribd.UI.dispatch(e,this.actions,this,"search"))return;var li=e.findElement("li");if(li){var result_id=li.readAttribute("data-result_id");if(result_id){this.controller.goto_nth_result(result_id);}}}.bind(this));this.controller.listen("on_clear",function(){this.form.value("");}.bind(this));this.attach.bind(this).defer();},new_result_element:function(snippet,page_num,i){var elm=this.container.down(".result_template").down("li").cloneNode(true);elm.down(".inner_num").update(page_num);elm.down(".snippet").update(this.highlight_snippet(snippet));elm.writeAttribute("data-result_id",i);return elm;},render_search_history:function(){var list=this.container.down(".history_list");list.update("");var queries=this.search_history.slice(-6).reverse();if(queries.length<=1){this.container.down(".search_history").hide();return;}
this.container.down(".search_history").show();var elms=queries.map(function(q){var elm=new Element("div").update(q.truncate('25').escapeHTML());elm.addClassName("history_result");if(this.controller.query==q)elm.addClassName("current");elm.writeAttribute("data-query",q);return elm;},this);var sep=" » ";elms.each(function(elm,i){list.appendChild(elm);if(i!=elms.length-1){list.appendChild(new Element("span").update(sep));}});},show_loading:function(){this.show();this.container.addClassName("loading");this.container.removeClassName("fresh_search");this.container.removeClassName("not_loading");document.fire("scribd:dom_height_changed");},done_loading:function(){this.container.removeClassName("loading");this.container.addClassName("not_loading");document.fire("scribd:dom_height_changed");},present_for_search:function(){if(!this.visible){this.container.addClassName("fresh_search");}
this.show();this.render_search_history();this.form.value("");this.form.input.focus();},show:function(){this.visible=true;this.doc_search.container.addClassName("show_results");this.form.enable();},hide:function(){this.visible=false;this.doc_search.container.removeClassName("show_results");},highlight_snippet:function(snippet,query){query=query||this.controller.query;var pattern=new RegExp('('+RegExp.escape(query)+')','i');return snippet.escapeHTML().sub(pattern,function(match){return('<span class="found">'+match[1]+'</span>');});},attach:function(){var _this=this;Scribd.StickyElement(this.container,function(elm){elm.setStyle({position:"fixed",top:"auto",bottom:_this.padding+"px"});},function(elm){var viewer_pos=viewer.cumulativeOffset(),viewer_height=viewer.getHeight(),container_height=_this.container.getHeight();elm.setStyle({position:"absolute",bottom:"auto",top:(viewer_pos.top+viewer_height-_this.padding-container_height)+"px"});},function(elm){var viewer=$("viewer");var screen_height=document.viewport.getHeight(),scroll=document.viewport.getScrollOffsets(),viewer_pos=viewer.cumulativeOffset(),viewer_height=viewer.getHeight();return scroll.top+screen_height<viewer_pos.top+viewer_height;},function(elm){var col=$("document_column");var x=col.cumulativeOffset()[0],w=col.getWidth(),viewport_w=document.viewport.getWidth(),tool_w=elm.getWidth();var left;if(w>viewport_w){left=Math.floor((viewport_w-tool_w)/2);}else{left=Math.floor(x+w/2-tool_w/2);}
elm.setStyle({left:left+"px"});});}});Scribd.UI.SearchController=Class.create({selected_classname:'fourgen_highlight_selected',initialize:function(searcher,events){this.events=events||{};this.searcher=searcher;this.loadedPages={};this.reset();docManager.addEvent('pageLoaded',this.handle_page_loaded.bind(this));docManager.addEvent('expectedFirstPageChanged',this.handle_page_changed.bind(this));},listen:function(name,fn,bind){if(bind)fn=fn.bind(bind);fn._next_listener=this.events[name];this.events[name]=fn;},fire:function(name,args){var fn=this.events[name];var out;while(fn){out=fn.apply(this,args||[]);fn=fn._next_listener;}
return out;},search:function(query,from_history){if(query){this.reset();this.query=query;this.fire("on_search",[query,from_history]);this.searcher.search(this.query,this.render_results.bind(this));}},reset:function(){this.query=null;this.query_results=null;this.current_result=0;this.results_on_page={};this.highlightedPages={};this.highlightingSelectedPage={};Scribd.Annotation.removeHighlight();},reset_and_clear:function(){this.reset();this.fire("on_clear");},render_results:function(data){if(!this.query)return;if(data&&data.length>0){this.query_results=data;this.goto_current.bind(this).defer();}else{this.query_results=[];}
this.query_results.each(function(res){this.results_on_page[res.pageNum]=(this.results_on_page[res.pageNum]||0)+1;},this);this.fire("on_results",[this.query_results]);},goto_current:function(){var result=this.query_results[this.current_result];if(result){this.goto_result(result);this.fire("on_select_result",[this.current_result,result]);}},goto_nth_result:function(n){this.current_result=Math.max(0,Math.min(n,this.query_results.length));this.goto_current();},goto_next_result:function(){if(this.query_results===null)return;this.current_result=(this.current_result+1)%this.query_results.length;this.goto_current();this.fire("next_result");},goto_prev_result:function(){if(this.query_results===null)return;this.current_result--;if(this.current_result<0)this.current_result=this.query_results.length-1;this.goto_current();this.fire("prev_result");},goto_result:function(result){var page_num=result.pageNum;if(page_num!=docManager.currentPageNum()){this.setHighlightingSelectedPage(page_num);docManager.gotoPage(page_num);}
this.highlight_page(page_num,this.query,function(){if(!this.isHighlightingSelectedPage(page_num)){var highlights=$$('#outer_page_'+page_num+' .fourgen_highlight');var n=0,i=this.current_result-1;while(i>=0&&this.query_results[i--].pageNum==page_num)n++;var current_highlight=highlights[n];current_highlight.addClassName(this.selected_classname);if(this.last_highlight){current_highlight.removeClassName(this.selected_classname);}
this.last_highlight=current_highlight;var offset=Scribd.DOM.scaledCumulativeOffset(current_highlight);if(offset!==0){window.scrollTo(offset.left,offset.top-10);}}
this.unsetHighlightingSelectedPage(page_num);}.bind(this));},handle_page_loaded:function(container){var page_num=container.id.match(/^outer_page_(\d+)$/)[1];if(this.query&&!this.isHighlightingSelectedPage(page_num)){this.setLoadedPage(page_num);this.highlight_page(page_num,this.query);}},handle_page_changed:function(page_num){if(this.query&&!this.hasHighlightedPage(page_num)&&!this.isHighlightingSelectedPage(page_num))
{this.highlight_page(page_num,this.query);}},highlight_page:function(pageNum,query,callback){var expected_results=this.results_on_page[pageNum];var page_container=$('outer_page_'+pageNum);var _try_highlight=function(retries){retries=retries===undefined?8:retries;var found=Scribd.Annotation.highlightText(page_container,query,'fourgen_highlight');if(!this.hasLoadedPage(pageNum)&&retries>0&&found<expected_results){return setTimeout(function(){_try_highlight(retries-1);},500);}
this.setHighlightedPage(pageNum);if(callback){callback($$('#outer_page_'+pageNum+' .fourgen_highlight'));}}.bind(this);if(expected_results>0){_try_highlight();}},isHighlightingSelectedPage:function(pageNum){return this.highlightingSelectedPage['p'+pageNum]===true;},setHighlightingSelectedPage:function(pageNum){this.highlightingSelectedPage['p'+pageNum]=true;},unsetHighlightingSelectedPage:function(pageNum){this.highlightingSelectedPage['p'+pageNum]=false;},hasLoadedPage:function(pageNum){return this.loadedPages['p'+pageNum]===true;},setLoadedPage:function(pageNum){this.loadedPages['p'+pageNum]=true;},hasHighlightedPage:function(pageNum){return this.highlightedPages['p'+pageNum]===true;},setHighlightedPage:function(pageNum){this.highlightedPages['p'+pageNum]=true;}});


/* app/views/shared/javascript_widget.js @ 1339185851 */

if(!window.Scribd)var Scribd=new Object();if(!window.Scribd.Shared)Scribd.Shared=new Object();Scribd.Shared.JavascriptWidget=Class.create({initialize:function(options){this.options=options;this.widget_dom_id=options.widget_dom_id;this.is_widget_loaded=false;},onDomLoaded:function(event){this.widget_dom=$(this.widget_dom_id);this.widget_dom.javascript_widget=this;this.on_widgets_loaded=this.onWidgetsLoaded.bind(this);Event.observe(document,'Scribd:widgets_loaded',this.on_widgets_loaded);},onWidgetsLoaded:function(event){Event.stopObserving(document,'Scribd:widgets_loaded',this.on_widgets_loaded);this.is_widget_loaded=true;}});


/* app/views/paid/_header.js @ 1339185851 */

Scribd.init('Scribd','Paid');Scribd.Paid.Header=Class.create(Scribd.Shared.JavascriptWidget,{initialize:function($super,options){$super(options);this.back_to_lightbox=options.back_to_lightbox;this.button_class=options.button_class;},onDomLoaded:function($super,event){$super(event);if(this.widget_dom.down('.'+this.button_class)){this.widget_dom.down('.'+this.button_class).observe('click',function(e){switch(this.button_class){case'back_button':if(parent.transport){parent.transport.postMessage('open '+this.back_to_lightbox);}else{Scribd.Lightbox.open(this.back_to_lightbox,75);}
break;case'close_button':case'subtle_close_button':if(parent.transport){parent.transport.postMessage('close');}else{Scribd.Lightbox.close();}
break;default:}}.bind(this));}}});


/* app/views/shared/analytics/_doc_view_pingback.js @ 1339185851 */

if(!window.Scribd){var Scribd={};}
Scribd.Pingback={run:function(url){if(navigator&&navigator.userAgent&&!!navigator.userAgent.match(/Google (Web|Instant) Preview/)){return null;}
var data={};if(document.referrer){data['referer']=document.referrer;}
new Ajax.Request(url,{method:'post',parameters:data});}};


/* app/views/premium/purchases/hybrid_gate.js @ 1339185851 */

Scribd.init('Scribd','Premium','Purchases');Scribd.Premium.Purchases.HybridGate=Class.create(Scribd.Shared.JavascriptWidget,{initialize:function($super,options){$super(options);this.credit_card_upsell_url=options.credit_card_upsell_url;this.document_id=options.document_id;this.download_plans=options.download_plans;this.xhr=options.xhr;trackEvent("payments","premium/purchases","archive_lightbox_step1");},onDomLoaded:function($super,event){$super(event);var gate=this;var widget_dom=this.widget_dom;Event.observe(document,'Scribd:upload_widget:uploadStart',function(e){widget_dom.down('.gate_upload_spinner_container').show();});Event.observe(document,'Scribd:upload_widget:uploadComplete',function(e){widget_dom.down('.gate_upload_spinner_container').hide();widget_dom.down('.archive_flow').blindUp();Effect.SlideDown('purchase_gate_upload_success',{scaleFrom:0,scaleTo:100});});},onWidgetsLoaded:function($super,event){$super(event);this.plansJavascriptWidget().selectDefaultPlan();},plansJavascriptWidget:function(){return $('archive_gate_plans').javascript_widget;},paymentOptionsJavascriptWidget:function(){return $('archive_gate_payment_options').javascript_widget;},planSelected:function(){var plan=this.plansJavascriptWidget().selectedPlan();this.paymentOptionsJavascriptWidget().planSelectedHandler(plan);},submitHandler:function(method,onCompleteCallback){var plan=this.plansJavascriptWidget().selectedPlan();var self=this;var next=function(url){if(self.options.xhr){Scribd.Lightbox.remoteOpen('premium_credit_card_flow',url,{},{style:'tight'});}else{window.location=url;}};var secureNext=function(url){if(self.options.xhr){Scribd.Lightbox.remoteOpen('premium_credit_card_flow',url.updateQueryParams({}),{height:"750"},{style:'tight'});}else{window.location=url;}};onCompleteCallback();var credit_card_url=this.credit_card_upsell_url.updateQueryParams({doc:this.document_id,duration:plan,upsell:true});secureNext(credit_card_url);}});


/* app/views/newdoc/_pager.js @ 1339185851 */

Scribd.init("Scribd","UI");Scribd.UI.Pager=Class.create({margin_top:4,margin_right:4,actions:{next_page:function(){this.goto_page(this.current_page_num+1);},prev_page:function(){this.goto_page(this.current_page_num-1);},zoom_in:function(){docManager.zoom(1.25);this.zoom_changed();},zoom_out:function(){docManager.zoom(0.8);this.zoom_changed();},enter_fullscreen:function(){docManager.enterFullscreen();this.container.addClassName("in_fullscreen");},exit_fullscreen:function(){docManager.exitFullscreen();this.container.removeClassName("in_fullscreen");},goto_top:function(){new Effect.ScrollTo($('template_main_content'),{duration:0.6});},switch_to_pagination:function(){Scribd.toggle_pagination();},switch_to_scrolling:function(){Scribd.toggle_pagination();}},goto_page:function(i){var direction=i>this.current_page_num?1:-1,target_page=docManager.getClosestPageNumber(i,direction);docManager.gotoPage(target_page,{direction:direction});var effect=docManager._currentViewManager._scrollEffect;if(effect){this.is_paging=true;this.scroll_effects++;var finish=effect.options.afterFinish;this.current_page_num=target_page;effect.options.afterFinish=function(){finish.call(this,arguments);this.scroll_effects--;if(this.scroll_effects==0){this.is_paging=false;}}.bind(this);}},get_highest_page:function(){var count=Scribd.current_doc.page_count;if(!count){count=0;for(var page_id in docManager.pages){count=Math.max(count,page_id);}}
return count;},zoom_changed:function(){var view_manager=docManager._currentViewManager;if(view_manager){var zoom=view_manager._currentZoomMultiplier;var btn=this.container.down(".zoom_out");if(zoom==1){btn.addClassName("disabled");}else{btn.removeClassName("disabled");}}},initialize:function(container,document_column,opts){this.container=$(container);this.options=opts;if(docManager.pageCount()==1){this.container.down(".pager_top").hide();this.container.down(".pager_bottom").addClassName("single");}
this.document_column=$(document_column);this.attach.bind(this).defer();this.max_page=this.get_highest_page();this.container.down(".max_page").update(this.max_page);this.next_page=this.container.down(".next_page");this.prev_page=this.container.down(".prev_page");this.scroll_effects=0;this.is_paging=false;var _this=this;docManager.addEvent("expectedFirstPageChanged",function(page_num){_this.on_update_page_num(page_num);});this.update_page_num.bind(this).defer();this.container.observe("click",function(e){Scribd.UI.dispatch(e,_this.actions,_this,"pager");});this.container.observe("mouseenter",function(e){_this.lock_position();});this.container.observe("mouseleave",function(e){_this.unlock_position();});this.page_input=this.container.down(".page_input");Scribd.restrict_input_to_numbers(this.page_input);this.page_input.observe("click",function(){this.page_input.select();}.bind(this));this.page_input.observe("change",this.update_page_from_input.bind(this));this.page_input.observe("keypress",function(e){if(e.keyCode==Event.KEY_RETURN){this.update_page_from_input();}}.bind(this));this.page_input.observe("focus",function(){this.container.addClassName("input_focused");}.bind(this));this.page_input.observe("blur",function(){this.container.removeClassName("input_focused");}.bind(this));this.page_input.observe("keydown",function(e){var event_name;switch(e.keyCode){case Event.KEY_UP:this.actions.prev_page.call(this);event_name="pager_prev_page";break;case Event.KEY_DOWN:this.actions.next_page.call(this);event_name="pager_next_page";break;default:return;}
trackEvent("newdoc","Hotkey",event_name,Scribd.logged_in?1:0);this.page_input.select();e.stop();}.bind(this));this.zoom_changed();},update_page_from_input:function(){var page_num=parseInt(this.page_input.value,10);if(!isNaN(page_num)){docManager.gotoPage(Math.min(page_num,this.max_page));}},update_page_num:function(){this.on_update_page_num(docManager.firstVisiblePage.pageNum);},on_update_page_num:function(page_num){if(!this.is_paging){this.current_page_num=page_num;}
this.page_input.value=this.current_page_num;if(this.current_page_num==1){this.prev_page.addClassName("disabled");}else{this.prev_page.removeClassName("disabled");}
if(this.current_page_num>=this.max_page){this.next_page.addClassName("disabled");}else{this.next_page.removeClassName("disabled");}},attach:function(){var _this=this;var pager_size=this.container.getDimensions();var absolute_top=true;function calc_left(doc_offset_left,position_type){var scroll=document.viewport.getScrollOffsets();if(position_type==='fixed'){doc_offset_left-=scroll.left;}
var doc_width=_this.document_column.getWidth();var right=doc_offset_left+doc_width;var window_right=document.viewport.getWidth();if(position_type==='absolute'){window_right+=scroll.left;}
if(doc_offset_left+doc_width>window_right){right=window_right;}
return(right-_this.margin_right-pager_size.width)+"px";}
Scribd.StickyElement(this.container,function(elm){if(_this.locked){_this.set_locked_position();return;}
var doc_offset=_this.document_column.cumulativeOffset();elm.setStyle({position:"fixed",top:_this.margin_top+"px",left:calc_left(doc_offset.left,'fixed')});},function(elm){if(_this.locked){_this.set_locked_position();return;}
var doc_offset=_this.document_column.cumulativeOffset();var y;if(absolute_top){y=doc_offset.top+_this.margin_top;}else{var doc_height=_this.document_column.getHeight();y=doc_offset.top+doc_height-pager_size.height-_this.margin_top;}
elm.setStyle({position:"absolute",top:y+"px",left:calc_left(doc_offset.left,'absolute')});},function(){if(_this.options.fixed)return false;var scroll=document.viewport.getScrollOffsets();var doc_offset=_this.document_column.cumulativeOffset();var doc_height=_this.document_column.getHeight();if(scroll.top<=doc_offset.top){absolute_top=true;return false;}
if(doc_offset.top+doc_height-scroll.top<pager_size.height+_this.margin_top){absolute_top=false;return false;}
return true;},function(){});},lock_position:function(){this.locked=true;this.locked_position=this.container.viewportOffset();},unlock_position:function(){this.locked=false;document.fire("scribd:dom_height_changed");},set_locked_position:function(){this.container.setStyle({position:"fixed",top:this.locked_position.top+"px",left:this.locked_position.left+"px"});}});


/* app/views/newdoc/_section_list.js @ 1339185851 */

document.observe('dom:loaded',function(){if($('sectionlist')){$('sectionlist').down('ul').observe('click',function(e){var sectionlink=e.target;if(sectionlink.hasAttribute('data-section')){var section=sectionlink.getAttribute('data-section');var first_page=sectionlink.getAttribute('data-first-page');document.location.hash="#page="+first_page;docManager.gotoPage(first_page);trackEvent('newdoc','Sectionized','TOC_NavClick');e.stop();e.preventDefault();}});}});


/* app/views/newdoc/paginated/_scrubber.js @ 1339185851 */

Scribd.init("Scribd","UI");Scribd.UI.Scrubber=Class.create({actions:{show_sections:function(){if(this.section_tooltip.visible()){this.hide_section_tooltip();}else{this.show_section_tooltip();}}},initialize:function(container,opts){this.container=$(container);if(docManager.pageCount()==1){this.container.hide();return;}
this.section_list=opts.section_list||[];this.marker_offset=opts.marker_offset||22;this.page_offset=opts.page_offset||0.99;this.page_display=this.container.down('#scrubber_current_page');this.track=this.container.down('.slider_track');this.handle=this.container.down('.handle');this.slider_tooltip=this.container.down('.slider_tooltip');this.section_tooltip=this.container.down('.section_tooltip');this.highest_page=Scribd.UI.Pager.prototype.get_highest_page();this.slider=new Control.Slider(this.handle,this.track,{axis:'horizontal',range:$R(1,this.highest_page+this.page_offset),increment:1,disabled:false,sliderValue:1,onChange:this.on_change.bind(this),onSlide:this.on_slide.bind(this)});this.section_list=this.section_list.sortBy(function(section){return-1*section.first_page;});this.update_page_display(docManager.currentPageNum());this.slider_tooltip.hide();this.section_tooltip.hide();this.update_tooltip();this.setup_events();(function(){this.draw();}).bind(this).defer();},setup_events:function(){var events=['expectedFirstPageChanged','zoomed','enteredFullscreen','exitedFullscreen'];events.each(function(event_name){docManager.addEvent(event_name,(function(page_num){this.draw();}).bind(this));},this);document.observe('click',(function(e,el){if(!e.target.descendantOf(this.section_tooltip)){this.hide_section_tooltip();}}).bind(this));this.container.observe('click',(function(e){Scribd.UI.dispatch(e,this.actions,this,'scrubber');}).bind(this));this.track.observe('dblclick',(function(e){var pointerX=Event.pointerX(e);var trackLeft=this.track.viewportOffset().left;pointerX=pointerX-trackLeft;pointerX=this.translate_to_value(pointerX);this.goto_page(this.closest_page(pointerX));e.stop();}).bind(this));},goto_page:function(page_num){var cur_page_num=this.current_page_num();if(cur_page_num==page_num){return false;}
var direction=page_num>cur_page_num?1:-1,target_page=docManager.getClosestPageNumber(page_num,direction);docManager.gotoPage(target_page,{direction:direction});return true;},on_slide:function(value){var page_num=this.closest_page(value);if(!isNaN(page_num)){this.update_tooltip(page_num);this.slider_tooltip.show();}
this.value=value;},on_change:function(){var page_num=this.closest_page(this.value);if(!this.goto_page(page_num)){this.update_slider(page_num);}
this.slider_tooltip.hide();trackEvent('newdoc','Slide','slider_changed');},update_slider:function(page_num){var slider_value=this.skewed_value(page_num);var saved_func=this.slider.options.onChange;this.slider.options.onChange=(function(){});this.slider.setValue(slider_value);this.update_page_display(page_num);this.slider.options.onChange=saved_func;},skewed_value:function(page_num){return page_num+(page_num*this.page_offset)/(this.highest_page);},render_section_markers:function(){this.track.select('.section_marker').map(Element.remove);this.section_list.each(function(section){var left=this.translate_to_px(this.skewed_value(section.first_page));this.track.insert({bottom:new Element('div',{'class':'section_marker','id':'at_page_'+section.first_page}).setStyle({left:left})});},this);},translate_to_px:function(value){var offset=this.slider.translateToPx(value).replace(/px$/,"");var adjusted=parseInt(offset,10)+parseInt(this.slider.handleLength,10)-this.marker_offset;return adjusted+'px';},translate_to_value:function(px){return this.slider.translateToValue(px-this.slider.handleLength+this.marker_offset);},draw:function(){this.resize_slider(this.current_page_num());this.render_section_markers();},resize_slider:function(page_num){var opts=this.slider.options;this.slider.dispose();delete this.slider;this.slider=new Control.Slider(this.handle,this.track,opts);this.update_slider(page_num);},update_tooltip:function(page_num){this.slider_tooltip.down('.page_text').textContent="page "+page_num;var current_section;if(!!(current_section=this.section_for_page(page_num))){this.slider_tooltip.down('.section_text').textContent=current_section.title;}else{this.slider_tooltip.down('.section_text').textContent="";}},update_page_display:function(page_num){this.page_display.textContent=""+page_num;},closest_page:function(value){return Math.floor(value);},section_for_page:function(page_num){return this.section_list.detect(function(section){return(this>=section.first_page&&this<=section.last_page);},page_num);},current_page_num:function(){if(!docManager.firstVisiblePage){return 1;}
return docManager.firstVisiblePage.pageNum;},hide_section_tooltip:function(){this.section_tooltip.hide();if(!!(paddles=Scribd.UI.paddle_widget)){paddles.container.show();}},show_section_tooltip:function(){this.section_tooltip.show();if(!!(paddles=Scribd.UI.paddle_widget)){paddles.container.hide();}}});


/* app/views/upload/_base_upload_widget.js @ 1339185851 */

if(!Scribd)Scribd=new Object();if(!Scribd.Upload)Scribd.Upload=new Object();Scribd.Upload.BaseUploadWidget=Class.create(Scribd.Shared.JavascriptWidget,{initialize:function($super,options){$super(options);this.upload_template_dom_id=options.upload_template_dom_id;},enforceCopyrightWarning:function(){if(window.copyright_agreed_to)
return true;var result=confirm($(this.widget_dom_id).down('.copyright_warning').innerHTML);window.copyright_agreed_to=result;return result;}});


/* app/views/upload/_upload_button_widget.js @ 1339185851 */

if(!Scribd)Scribd=new Object();if(!Scribd.Upload)Scribd.Upload=new Object();Scribd.Upload.UploadButtonWidget=Class.create(Scribd.Upload.BaseUploadWidget,{SCRIBD_ERROR:{INVALID_JSON:1201,NO_FILE_ID_PRESENT:1202},initialize:function($super,options){$super(options);this.auto_submit_to_facebook=options.auto_submit_to_facebook;this.button_height=options.button_height;this.button_width=options.button_width;this.button_image_url=options.button_image_url;this.button_placeholder_id=options.button_placeholder_id;this.debug_swf_upload=options.debug_swf_upload;this.file_queue_limit=options.file_queue_limit;this.file_upload_limit=options.file_upload_limit;this.file_size_limit_mb=options.file_size_limit_mb;this.file_types=options.file_types;this.file_types_description=options.file_types_description;this.flash_url=options.flash_url;this.is_private=options.is_private;this.minimum_flash_version=options.minimum_flash_version;this.post_params=options.post_params;this.prevent_swf_caching=options.prevent_swf_caching;this.track_event_action=options.track_event_action;this.track_event_label=options.track_event_label;this.upload_source=options.upload_source;this.upload_status_dom_id=options.upload_status_dom_id;this.upload_template_dom_id=options.upload_template_dom_id;this.upload_url=options.upload_url;this.user_creation_source=options.user_creation_source;this.user_creation_url=options.user_creation_url;this.button_cursor=SWFUpload.CURSOR.HAND;this.button_window_mode=SWFUpload.WINDOW_MODE.TRANSPARENT;this.event_element=document;this.upload_manager_by_file_id=$H();if(Scribd.override_upload_url){this.upload_url=Scribd.override_upload_url;}
var swf_options=this.optionsForSWFUpload();this.swf_upload=this.newSWFUpload(swf_options);},optionsForSWFUpload:function(){return{button_cursor:this.button_cursor,button_height:this.button_height,button_width:this.button_width,button_image_url:this.button_image_url,button_placeholder_id:this.button_placeholder_id,button_window_mode:this.button_window_mode,debug:this.debug_swf_upload,file_queue_limit:this.file_queue_limit,file_upload_limit:this.file_upload_limit,file_size_limit_mb:this.file_size_limit_mb+' MB',file_types:this.file_types,file_types_description:this.file_types_description,flash_url:this.flash_url,minimum_flash_version:this.minimum_flash_version,post_params:this.post_params,prevent_swf_caching:this.prevent_swf_caching,upload_url:this.upload_url,file_dialog_start_handler:this.fileDialogStart.bind(this),file_dialog_complete_handler:this.fileDialogComplete.bind(this),file_queued_handler:this.fileQueued.bind(this),file_queue_error_handler:this.fileQueueError.bind(this),upload_start_handler:this.uploadStart.bind(this),upload_progress_handler:this.uploadProgress.bind(this),upload_error_handler:this.uploadError.bind(this),upload_success_handler:this.uploadSuccess.bind(this),upload_complete_handler:this.uploadComplete.bind(this)};},newSWFUpload:function(options){return new SWFUpload(options);},fileDialogStart:function(){window.copyright_message_seen=false;},fileDialogComplete:function(num_files_selected,num_files_queued,total_queued){this.num_files_selected=num_files_selected;this.num_files_completed=0;this.num_files_successful=0;if(num_files_selected>0&&this.enforceCopyrightWarning()){this.startUploadOrCreateAnonymousUser();}},fileQueued:function(file){if(!this.enforceCopyrightWarning())
return;var options=this.optionsForUploadManager(file);var upload_manager=this.newUploadManager(options);var parsed_name=this.parseName(file.name);upload_manager.insertElement({file_name_short:parsed_name.name.truncate(30),file_name_long:parsed_name.name,file_upload_id:this.widget_dom_id+'_file_'+file.index});upload_manager.onQueue();this.upload_manager_by_file_id[file.id]=upload_manager;},parseName:function(name){var name_parts=name.split('.');var extension=name_parts.pop();var base_name=name_parts.join('.');return{name:base_name,ext:extension};},optionsForUploadManager:function(file){var parsed_name=this.parseName(file.name);return{addHTML:this.addFileHTML.bind(this),auto_submit_to_facebook:this.auto_submit_to_facebook,cancelListener:this.cancelUpload.bind(this,file),file_template_element_id:this.upload_template_dom_id,filename_base:parsed_name.name,filename_extension:parsed_name.ext,isPrivate:this.isPrivate(),upload_source:this.upload_source};},newUploadManager:function(options){return new Scribd.scalable_upload_manager(options);},fileQueueError:function(file,error_code,msg){var error_msg;switch(error_code){case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:error_msg="Too many items in queue.";break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:error_msg="File is too big.";break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:error_msg="File appears to be empty.";break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:error_msg="Invalid File Type.";break;default:error_msg="Unhandled error: "+error_code;this.uploader.debug("queue error: "+error_code+" "+msg);}
this.uploadManagerForFile(file).onQueueError(error_msg);this.swf_upload.setButtonDisabled(false);},uploadStart:function(file){this.event_element.fire('Scribd:upload_widget:uploadStart',{file_id:file.id});this.swf_upload.setButtonDisabled(true);},uploadProgress:function(file,bytes_loaded,bytes_total){var percent=Math.ceil(bytes_loaded/bytes_total*100);this.uploadManagerForFile(file).onProgress(percent);},uploadError:function(file,error_code,msg){var error_msg;switch(error_code){case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:error_msg='Upload Cancelled';break;case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:error_msg="Upload Error: "+msg;break;case SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL:error_msg="File destination not found";break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:error_msg="There may be a problem with the network connection, please try again.";break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:error_msg="Security Error";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:error_msg="Upload limit exceeded";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:error_msg="Upload Failed";break;case SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND:error_msg="File ID not found";break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:error_msg="File validation failed";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:error_msg="Upload stopped";break;case this.SCRIBD_ERROR.INVALID_JSON:error_msg="There may be a problem with the network connection, please try again.";break;case this.SCRIBD_ERROR.NO_FILE_ID_PRESENT:error_msg="No file ID present";break;default:error_msg='Unhandled Error: '+error_code;this.uploader.debug("upload error: "+error_code+" "+msg);}
this.uploadManagerForFile(file).onError("("+new Date().getTime()+"): "+error_msg);this.swf_upload.setButtonDisabled(false);},uploadSuccess:function(file,server_data,response){var file_info=this.parseServerResponse(file,server_data);if(!file_info)return;this.uploadManagerForFile(file).onSuccess(file_info);var stats=this.swf_upload.getStats();if(stats.files_queued>0){this.startUpload();}else{this.swf_upload.setButtonDisabled(false);}
window.trackEvent('upload',this.track_event_action,this.track_event_label,0);this.event_element.fire('Scribd:upload_widget:uploadSuccess',{file_id:file.id,doc_id:file_info.id,doc_title:file_info.title});this.num_files_successful+=1;},parseServerResponse:function(file,server_data){var file_info=null;try{file_info=server_data.evalJSON(true);}catch(e){this.invalidJsonError(file,server_data);return null;}
if(!this.isValidFileInfo(file_info)){this.invalidFileInfoError(file,server_data);return null;}
return file_info;},invalidJsonError:function(file,server_data){this.uploadError(file,this.SCRIBD_ERROR.INVALID_JSON,'There may be a problem with the network connection, please try again.');},isValidFileInfo:function(file_info){return((file_info)&&(file_info.id)&&(file_info.id>0)&&(file_info.access_key)&&(file_info.access_key.length>0));},invalidFileInfoError:function(file,server_data){this.uploadError(file,this.SCRIBD_ERROR.NO_FILE_ID_PRESENT,'Invalid server response: '+server_data);},uploadComplete:function(file){var upload_manager=this.uploadManagerForFile(file);upload_manager.onComplete();this.num_files_completed+=1;if(this.num_files_completed==this.num_files_selected){if(this.num_files_successful==this.num_files_selected){this.event_element.fire("Scribd:upload_widget:allFilesSuccessful");}else{this.event_element.fire("Scribd:upload_widget:someFilesUnsuccessful");}}
this.event_element.fire('Scribd:upload_widget:uploadComplete',{file_id:file.id});},enforceCopyrightWarning:function($super){if(window.copyright_message_seen){return window.copyright_agreed_to;}else{window.copyright_message_seen=true;return $super();}},isPrivate:function(){return this.is_private;},startUploadOrCreateAnonymousUser:function(){if(this.upload_url){this.startUpload();}else{new Ajax.Request(this.user_creation_url,{asynchronous:true,evalScripts:true,parameters:{from:this.user_creation_source},onSuccess:this.anonymousUserCreated.bind(this),onFailure:this.anonymousUserCreationFailed.bind(this)});}},anonymousUserCreated:function(transport){var data=transport.responseText.evalJSON();var upload_url=data.upload_url;if(upload_url&&!upload_url.blank()){this.upload_url=upload_url;this.swf_upload.setUploadURL(upload_url);this.startUpload();}else{this.anonymousUserCreationFailed(transport);}},anonymousUserCreationFailed:function(transport){var rawText=transport.responseText;this.uploader.setButtonDisabled(true);this.upload_manager_by_file_id.each(function(item){var upload_manager=item.value;upload_manager.onError('Registration failed.');});this.showAnonymousUserCreationFailed(rawText);},showAnonymousUserCreationFailed:function(rawText){$$('.uw_anonymous_user_creation_failed').each(function(e){e.show();});},startUpload:function(){this.setPostParam('override_cookies',this.getBrowserCookies());this.setPostParam('override_uuid',this.getBrowserUuid());this.setPostParam('private_flag',this.isPrivate());this.setPostParam('source',this.upload_source);this.swf_upload.startUpload();},getBrowserUuid:function(){return Scribd.getBrowserUuid();},getBrowserCookies:function(){return document.cookie;},addFileHTML:function(dom_element){var upload_status_dom=$(this.upload_status_dom_id);upload_status_dom.insert({top:dom_element});},cancelUpload:function(file){this.swf_upload.cancelUpload(file.id,false);},setPostParam:function(key,value){this.swf_upload.removePostParam(key);this.swf_upload.addPostParam(key,value);},uploadManagerForFile:function(file){return this.upload_manager_by_file_id[file.id];}});


/* app/views/shared/sharing/readcast_confirmations.js @ 1339185851 */

if(!window.Scribd)var Scribd=new Object();Scribd.ReadCaster=Class.create({initialize:function(options){this.event_type=options.event_type;this.submit_button=options.submit_button;this.confirmations=options.confirm_checkboxes;this.permissions=options.permissions;this.doc=options.doc;this.doc_collection=options.doc_collection;this.linked_sites=options.linked_sites;this.submit_button.observe('click',this.handleReadcastEvents.bind(this));this.after=options.after;this.stop_event=options.stop_event;},handleReadcastEvents:function(e){if(this.stop_event){e.stop();}
if(Object.isFunction(this.after)){this.after.call(this);}
this.submitReadcastEvents();},submitReadcastEvents:function(params){var that=this;this.linked_sites.each(function(linked_site){if(Scribd.ReadCaster.shouldSubmitForSite(linked_site,that.permissions,that.confirmations)){var klass=that.eventClass(linked_site);var klass_params={event_type:that.event_type,service_type:linked_site};var extraInfo="";if(that.doc){extraInfo=" on doc";klass_params=Object.extend(klass_params,{doc:that.doc});}else if(that.doc_collection){extraInfo=" on doc collection";klass_params=Object.extend(klass_params,{doc_collection:that.doc_collection,auto_submit:false});}
Scribd.Readcast.trackEvent(that.event_type+" submit"+extraInfo,linked_site);var new_event=new klass(Object.extend(params||{},klass_params));new_event.submit();}});},eventClass:function(site){if(site==='facebook'){return Scribd.Readcast.Event.FacebookAutoShare;}else{return Scribd.Readcast.Event.AutoShare;}}});Scribd.ReadCaster.shouldSubmitForSite=function(linked_site,permissions,confirmations){if(permissions[linked_site]==='on'){return true;}
if(confirmations){return confirmations.detect(function(confirmation){var site=confirmation.className;return(site===linked_site&&confirmation.getValue()==='1');});}};Scribd.ScribbleReadCaster=Class.create(Scribd.ReadCaster,{initialize:function($super,options){$super(options);this.scribble_text_field=options.scribble_text_field;this.docReload=options.doc_reload;},handleReadcastEvents:function(e){if(Object.isFunction(this.docReload)){this.doc=this.docReload.call(this);}
if(this.scribble_text_field&&this.scribble_text_field.value.length>0){this.submitReadcastEvents({scribble_text:this.scribble_text_field.value});}},eventClass:function(site){if(site==='facebook'){return Scribd.Readcast.Event.FacebookScribbleAutoShare;}else{return Scribd.Readcast.Event.AutoShare;}}});Scribd.EventBasedReadCaster=Class.create({initialize:function(options){this.event_type=options.event_type;this.permissions=options.permissions;this.linked_sites=options.linked_sites;var that=this;document.observe(options.observes||'Scribd:EventBasedReadCaster:ready',function(e){var confirmations=e.memo.confirmations;var doc=e.memo.doc;that.linked_sites.each(function(linked_site){if(Scribd.ReadCaster.shouldSubmitForSite(linked_site,that.permissions,confirmations)){var extraInfo="";if(doc){extraInfo=" on doc";}
Scribd.Readcast.trackEvent(that.event_type+" submit"+extraInfo,linked_site);var klass=Scribd.EventBasedReadCaster.eventClass(linked_site);var new_event=new klass({'doc':doc,event_type:that.event_type,service_type:linked_site});new_event.submit();}});});}});Scribd.EventBasedReadCaster.eventClass=function(site){if(site==='facebook'){return Scribd.Readcast.Event.FacebookAutoShare;}else{return Scribd.Readcast.Event.AutoShare;}};Scribd.EventBasedReadCaster.fire=function(memo){document.fire('Scribd:EventBasedReadCaster:ready',memo);};Scribd.ReadCaster.observing_confirmations=false;Scribd.ReadCaster.observeConfirmations=function(){if(!Scribd.ReadCaster.observing_confirmations){Scribd.ReadCaster.observing_confirmations=true;document.observe('click',function(e){var element=e.findElement();var container=Scribd.ReadCaster.findReadcastConfirmation(element);if(!container){container=Scribd.ReadCaster.findReadcastConfirmation(element.up());}
if(container){var checkbox=container.down('input');if(container.hasClassName('disabled')){container.removeClassName('disabled');checkbox.checked=true;}else{container.addClassName('disabled');checkbox.checked=false;}}});}};Scribd.ReadCaster.isReadcastConfirmation=function(element){return element&&element.hasClassName&&element.hasClassName('readcast_confirmation');};Scribd.ReadCaster.findReadcastConfirmation=function(element){return Scribd.ReadCaster.isReadcastConfirmation(element)?element:null;};


/* app/views/newdoc/show.js @ 1339185851 */

Scribd.init("Scribd","UI");Scribd.alert_highjack=function(lightbox_id,on_alert){var old_render=Scribd.Alerts.render;Scribd.Alerts.render=function(){if(Scribd.Lightbox.current().id==lightbox_id){on_alert.apply(null,arguments);}else{old_render.apply(this,arguments);}};};Scribd.UI.dispatch=function(e,actions,context,event_prefix,disable_stop){for(var name in actions){if(!actions.hasOwnProperty(name))continue;var elm=e.findElement("."+name);if(elm){if(!disable_stop){e.stop();}
if(elm.hasClassName("disabled"))return true;var event_name=event_prefix?event_prefix+"_"+name:name;trackEvent("newdoc","Click",event_name,Scribd.logged_in?1:0);actions[name].call(context,elm,e);return true;}}
return false;};Scribd.restrict_to_numbers=function(e){var code;if(e.keyCode)code=e.keyCode;else if(e.which)code=e.which;var character=String.fromCharCode(code);if(code==27){this.blur();return false;}
if(!e.ctrlKey&&code!=9&&code!=8&&code!=36&&code!=37&&code!=38&&(code!=39)&&code!=40&&code!=46){if(character.match(/[0-9]/g)){return true;}else{e.stop();}}};Scribd.restrict_input_to_numbers=function(input){input=$(input);input.observe("keypress",Scribd.restrict_to_numbers);input.observe("change",Scribd.restrict_to_numbers);};Scribd.trackSessionLength('newdoc','Metrics','SessionLengthSec');Event.observe(document,"dom:loaded",function(){var funcPageView=function(){if($perf){$perf.recordPerceivedLoadTime(((new Date()).getTime()));}
docManager.removeEvent("pageView",funcPageView);document.fire('scribd:load_ads');};docManager.addEvent("pageView",funcPageView);var featured=$("pub_featured_docs");if(featured){Scribd.UI.related_pager=new Scribd.UI.DocumentListPager(featured);}
docManager.addEvent('hideExtras',function(){$('sidebar').hide();});docManager.addEvent('showExtras',function(){$('sidebar').show();});var leaderboard=$("leaderboard_ad_main");var ppp_banner=$("profile_branding_banner");if(ppp_banner){ppp_banner.down("img").observe("load",function(){document.fire("scribd:dom_height_changed");});}
var page_hash=window.location.hash.match(/#page=(\d+)/);if(page_hash&&page_hash.length==2){docManager.gotoPage(page_hash[1]);}
(function(){var action=window.location.hash.match(/^#(\w+)$/);if(action){action=action[1];switch(action){case"download":Scribd.sidebar_actions.sidebar_download_button();break;case"readcast":Scribd.social_actions.readcast_button();break;case"collections":Scribd.social_actions.collections_button();break;case"fullscreen":case"full":var pager=Scribd.UI.pager;pager.actions.enter_fullscreen.call(pager);break;}}}).defer();if(Scribd.current_doc.show_gate){Scribd.Premium.setup_for_read_page({show_download:function(){Scribd.sidebar_actions.sidebar_download_button();}});}
if(Scribd.logged_in){["scribd","twitter"].each(function(network){(new Scribd.Readcast.Event.AutoShare({doc:Scribd.current_doc.sharing_data,auto_submit:Scribd.current_doc.auto_share[network],service_type:network,event_type:'read'})).start();});(new Scribd.Readcast.Event.FacebookAutoShare({doc:Scribd.current_doc.sharing_data,auto_submit:Scribd.current_doc.auto_share.facebook,event_type:'read'})).start();}
$$("#admin_show_link","#admin_hidden_link").invoke("observe","click",function(){$('admin_show').toggle();$('admin_hidden').toggle();document.fire('scribd:move_ads');});});document.observe('scribd:docinfo_ready',function(){if(Scribd.current_doc.is_bad&&typeof(Scribd.BrowserDetect.is_bot)==='undefined'){var cookie=new Scribd.JSONCookie('session_metadata');var time=cookie.get('adult_ok');var delta=(new Date()).getTime()-time;if(!time||delta>3600000){window.stop();var newHref=window.location.protocol+'//'+window.location.host+'/doc/protected/'+Scribd.current_doc.id;if(typeof(Scribd.current_doc.section_id)!=='undefined')
newHref+='/'+Scribd.current_doc.section_id;window.location.href=newHref;}}});(function(){var onAdfilled=function(divId,callback,persist,pollTime,timeout){var initialHeight;var poller;var timesPolled=0;var div;timeout=timeout||2e4;pollTime=pollTime||1e3;div=$(divId);initialHeight=div.getHeight();poller=setInterval(function(){timesPolled+=1;if((timesPolled*pollTime)>timeout){clearInterval(poller);}
if(div.getHeight()!==initialHeight){if(!persist)
clearInterval(poller);callback(divId);}},pollTime);};var fixAd=function(adId){Scribd.absolutizeAndPad(adId);document.fire("scribd:dom_height_changed");};if(Prototype.Browser.WebKit){Event.observe(document,'dom:loaded',function(){if(Scribd.Ads.enabled){var ads=['leaderboard_ad_gam','rightcolumn_ad_gam'];ads.each(function(adId){if($(adId)){onAdfilled(adId,fixAd);}});}});}})();Scribd.toggle_pagination=function(){if(Scribd.current_doc.is_owner){new Ajax.Request("/newdoc/toggle_pagination_test",{method:"post",parameters:{id:Scribd.current_doc.id},onSuccess:function(){window.location.reload();}});}
var revert_name=Scribd.UI.is_paginated?"pagination":"not_paginated";trackEvent("newdoc","Pagination","revert_"+revert_name,Scribd.logged_in?1:0);if(Scribd.logged_in){var cookie=new Scribd.JSONCookie("session_metadata");if(!cookie.get("pagination_disabled")){cookie.set("pagination_disabled",true);console.log("pagination disabled");}else{cookie.unset("pagination_disabled");console.log("pagination enabled");}
cookie.save();window.location.reload();}else{Scribd.login.open({context:"view_mode",callback:"Scribd.logged_in = true, Scribd.toggle_pagination()"});}};Scribd.UI.scroll_to_top=function(){$('viewer').scrollTo();};Scribd.UI.fixAds=function(){for(var i in Scribd.Ads.adUnits){Scribd.absolutizeAndPad(Scribd.Ads.adUnits[i]);document.fire("scribd:dom_height_changed");}};


/* app/views/newdoc/paginated/_collection_widgets.js @ 1339185851 */

Scribd.UI.CollectionWidgets=Class.create({initialize:function(container){var collections=container.select('.paginated_document_collection');collections.each(function(collection){return new Scribd.UI.DocumentCollection(collection);});}});Scribd.UI.DocumentCollection=Class.create({actions:{next_collection_page:function(){this.goto_page(this.current_page+1);},prev_collection_page:function(){this.goto_page(this.current_page-1);}},tracking:{paginated_featured_doc:function(){}},initialize:function(container){this.per_page=3;this.container=$(container);this.prev_page_button=this.container.down('.prev_page');this.next_page_button=this.container.down('.next_page');if(!this.container)return;this.container.observe("click",function(e){Scribd.UI.dispatch(e,this.actions,this);}.bind(this));this.container.observe("click",function(e){Scribd.UI.dispatch(e,this.tracking,this,null,true);}.bind(this));this.paginate();},paginate:function(){var items=this.container.select(".paginated_featured_doc")||[];if(items.length==0)return this.remove();var page_num=1,max_pages=Math.ceil(items.length/this.per_page);this.pages=items.eachSlice(this.per_page,function(s){var page=new Element("div",{className:"related_page"});s.each(function(elm){page.insert({bottom:elm});});var footer=new Element("div",{className:"page_footer"});if(page_num>1){footer.insert({bottom:new Element("span",{className:"prev_collection_page pseudoLink"}).update(I18n.t("js.previous"))});}
if(page_num<max_pages){if(!footer.empty()){footer.insert({bottom:" | "});}
footer.insert({bottom:new Element("span",{className:"next_collection_page pseudoLink"}).update(I18n.t("js.next"))});}
if(!footer.empty()){page.insert({bottom:footer});}
page_num++;return page;});this.pages.each(function(p){this.container.insert({bottom:p});}.bind(this));this.goto_page(1);},goto_page:function(page_num){page_num=Math.max(1,Math.min(this.pages.length,page_num));for(var i=0;i<this.pages.length;i++){var p=this.pages[i];if(i+1==page_num){p.show();p.select("img").each(function(img){force_lzld(img);});}else{p.hide();}}
this.current_page=page_num;}});


/* app/views/shared/sharing/dialog.js @ 1339185851 */

if(!window.Scribd)var Scribd=new Object();if(!Scribd.Readcast)Scribd.Readcast={};Scribd.Readcast.Dialog={Animations:{standard:{show_popup:function(){if(this.showing)return;this.showing=true;this.element.show();Scribd.Readcast.trackEvent("dialog","show");new Effect.Morph(this.element,{style:'margin-left: 5px',duration:0.4,queue:{position:'front',scope:'readcastControls'},afterFinish:Scribd.Readcast.Control.showControls});},hide_popup:function(e){e.stop();Scribd.Readcast.trackEvent("dialog","close");this.element.blindUp({duration:0.2});}},blank:{show_popup:function(){if(this.showing)return;this.showing=true;this.element.show();Scribd.Readcast.trackEvent("blankdialog","show");new Effect.Morph(this.element,{style:'margin-left: 5px',duration:0.4,queue:{position:'front',scope:'readcastControls'}});},hide_popup:function(e){e.stop();Scribd.Readcast.trackEvent("blankdialog","close");this.element.blindUp({duration:0.2});}},fourgen:{shown:false,show_popup:function(e){if(!Scribd.Readcast.Dialog.Animations.fourgen.shown){Scribd.Readcast.Dialog.Animations.fourgen.shown=true;Scribd.Toolbar.actions.readcast(e);}},hide_popup:function(e){Scribd.Toolbar.actions.readcast(e);}}},initialize:function(){var that=this;if(Scribd.Readcast.Dialog.animation==='fourgen'){this.show_popup=Scribd.Readcast.Dialog.Animations.fourgen.show_popup;this.hide_popup=Scribd.Readcast.Dialog.Animations.fourgen.hide_popup;}else{this.show_popup=Scribd.Readcast.Dialog.Animations.standard.show_popup;this.hide_popup=Scribd.Readcast.Dialog.Animations.standard.hide_popup;}
document.observe(Scribd.Readcast.Event.AutoShare.EVENTS.ready,function(e){if(Scribd.Readcast.readingDisabled()){return;}
if(Scribd.Toolbar&&Scribd.Toolbar.openPopups&&Scribd.Toolbar.openPopups.size!=0){return;}
if(!Scribd.Readcast.no_initial_popup()){that.show_popup.bind(that)(e);}});this.loadTwitterName();this.element=$('readcast_popup_outer');this.element.down('.close_button').observe('click',this.hide_popup.bind(this));var alt=this.element.down('.alternate_link');if(alt){alt.observe('click',this.hide_popup.bind(this));}},loadTwitterName:function(){var placeholders=$$('.twitter_placeholder');if(placeholders.length<1)return;new Ajax.Request("/twitter_link/info.json",{method:'get',evalJSON:'force',onSuccess:function(trans){try{var name=trans.responseJSON.info.screen_name;if(name===undefined)return;placeholders.each(function(element){element.update("@"+name);});}catch(e){}}});}};Scribd.Readcast.active=function(){if($$('.readcast_popup').size()>0)return true;return false;};Scribd.Readcast.blank_active=function(){if($$('.blank_readcast_popup').size()>0)return true;return false;};Scribd.Readcast.trackEvent=function(action,label){window.trackEvent("Readcast",action,label);};Scribd.Readcast.readingDisabled=function(){if($$('.readcast_popup.disabled_reading').size()>0)return true;return false;};Scribd.Readcast.no_initial_popup=function(){if($$('.readcast_popup.no_initial_popup').size()>0)return true;return false;};(function(){function initDialog(){if(!Scribd.Readcast.active())return;Scribd.Readcast.Dialog.initialize();}
document.observe('dom:loaded',initDialog);document.observe(Scribd.Facebook.EVENTS.transition,initDialog);})();


/* app/views/documents/ads_below_sideboard.js @ 1339185851 */

document.observe('dom:loaded',function(){var pinned_ad=$('pinned_ad');var container=$('pinned_ad_container');var page_container=$$('.outer_page_container')[0];var is_ie6=!!(document.all&&(/msie 6./i).test(navigator.appVersion)&&window.ActiveXObject);if(!pinned_ad||!container)
return;var is_pinned=false;var pin,unpin;if(is_ie6){pin=function(){pinned_ad.addClassName('ie_fixed');pinned_ad.setStyle({top:(document.viewport.getScrollOffsets().top-50)+'px'});};unpin=function(){pinned_ad.removeClassName('ie_fixed');pinned_ad.setStyle({top:'0px'});};}else{pin=function(){if(!is_pinned){pinned_ad.addClassName('fixed');is_pinned=true;}};unpin=function(){if(is_pinned){pinned_ad.removeClassName('fixed');is_pinned=false;}};}
var update_pinning=function(){if(container.viewportOffset().top+pinned_ad.getHeight()>page_container.viewportOffset().top+page_container.getHeight()){unpin();return;}
if(container.viewportOffset().top<0)
pin();else
unpin();};var repin=function(){unpin();update_pinning();};Event.observe(window,'scroll',update_pinning);docManager.addEvent('zoomed',repin);docManager.addEvent('enteredFullscreen',unpin);docManager.addEvent('exitedFullscreen',repin);});


/* app/views/shared/sharing/blank_dialog.js @ 1339185851 */

if(!window.Scribd)var Scribd=new Object();if(!Scribd.Readcast)Scribd.Readcast={};Scribd.Readcast.BlankDialog={initialize:function(){var that=this;that.element=$('readcast_popup_outer');that.element.down('.close_button').observe('click',that.hide_popup.bind(that));that.element.down('.readcast_now_button').observe('click',that.show_login_lb.bind(that));var alt=that.element.down('.alternate_link');if(alt){alt.observe('click',that.hide_popup.bind(this));}},show_popup:function(e){if(Scribd.Readcast.Dialog.animation==='fourgen'){Scribd.Readcast.Dialog.Animations.fourgen.show_popup.call(this,e);}else{Scribd.Readcast.Dialog.Animations.blank.show_popup.call(this,e);}},hide_popup:function(e){if(Scribd.Readcast.Dialog.animation==='fourgen'){Scribd.Readcast.Dialog.Animations.fourgen.hide_popup.call(this,e);}else{Scribd.Readcast.Dialog.Animations.blank.hide_popup.call(this,e);}},show_login_lb:function(e){e.stop();Scribd.Readcast.trackEvent("readcast this login");Scribd.login.open({context:'readcast'});}};Scribd.Readcast.trackEvent=function(action,label){window.trackEvent("Readcast",action,label);};document.observe(Scribd.Readcast.Event.BlankReadcast.EVENTS.ready,function(e){Scribd.Readcast.BlankDialog.show_popup();});(function(){function initDialog(){if(!Scribd.Readcast.blank_active())return;Scribd.Readcast.BlankDialog.initialize();}
document.observe('dom:loaded',initDialog);document.observe(Scribd.Facebook.EVENTS.auto_logged_out,initDialog);})();


/* app/views/premium/purchases/gate_components/payment_options_d.js @ 1339185851 */

Scribd.init('Scribd','Premium','Purchases','GateComponents');Scribd.Premium.Purchases.GateComponents.PaymentOptionsD=Class.create(Scribd.Shared.JavascriptWidget,{initialize:function($super,options){$super(options);this.parent_dom_id=options.parent_dom_id;this.chargify_disabled=options.chargify_disabled;this.credit_card_disabled=options.credit_card_disabled;},onDomLoaded:function($super,event){$super(event);var payment_options=this;var widget_dom=this.widget_dom;widget_dom.down('#button_continue').observe('click',function(e){e.stop();if(!this.hasClassName('disabled'))payment_options.submitButtonPressed('credit_card');});},parentJavascriptWidget:function(){return $(this.parent_dom_id).javascript_widget;},planSelectedHandler:function(plan){var widget_dom=this.widget_dom;},submitButtonPressed:function(method){this.submitUIHandler(method);this.parentJavascriptWidget().submitHandler(method,this.reverseSubmitUIHandler.bind(this,method));},submitUIHandler:function(method){var buttons=$$('.payment_button a');var spinner=$('button_continue').down('.loading');spinner.show();buttons.invoke('addClassName','disabled');},reverseSubmitUIHandler:function(method){var buttons=$$('.payment_button a');var spinner=$('button_continue').down('.loading');spinner.hide();buttons.invoke('removeClassName','disabled');this.parentJavascriptWidget().planSelected();}});


/* app/views/newdoc/_comments.js @ 1339185851 */

Scribd.UI.CommentList=Class.create({document_events_url:"/document_events/",actions:{more_comments_button:function(elm){this.load_more_comments();},reply_button:function(elm){var id=elm.readAttribute("data-timeline_event_id"),uid=elm.readAttribute("data-to_uid"),key=id+";"+uid;var form=this.forms[key];if(form){form.container.toggle();}else{var container=elm.up(".single_comment").next('.comment_replies');if(!container){container=new Element("div",{"class":"comment_replies"});elm.up(".single_comment").insert({after:container});}
form=this.reply_form_for(id,uid,container);this.forms[key]=form;elm.parentNode.insert({after:form.container});}},delete_button:function(elm){this.delete_comment(elm.readAttribute("data-id"));var comment=elm.up(".single_comment");comment.update('<div class="autogen_class_views_shared_alerts_success_red autogen_class_views_shared_alerts_base"><div class="inner">Deleted!</div></div>');comment.addClassName("deleted");var replies=comment.next(".comment_replies");if(replies)replies.remove();(function(){new Effect.Fade(comment,{duration:0.5});}).delay(2.0);}},initialize:function(container){this.current_page=1;this.forms={};this.container=$(container);this.container.observe("click",function(e){Scribd.UI.dispatch(e,this.actions,this,"comments");}.bind(this));},reply_form_for:function(event_id,uid,display_element){var elm=$("reply_template").down(".comment_form").cloneNode(true);elm.removeAttribute("id");elm.down("form").action="/documents/"+Scribd.current_doc.id+"/comments/"+event_id+"/reply?to_uid="+uid;return new Scribd.UI.CommentForm(elm,{is_reply:true,display_element:display_element});},delete_comment:function(doc_event_id){var url=this.document_events_url+doc_event_id;new Ajax.Request(url,{asynchronous:true,evalScripts:true,method:'delete'});},load_more_comments:function(extras){extras=extras||{per_page:8,format:"json"};var page=++this.current_page;var url="/documents/"+Scribd.current_doc.id+"/comments?page="+page;this.container.down(".more_comments_button").hide();this.container.down(".loading_comments").show();new Ajax.Request(url,{method:'get',parameters:extras,onComplete:function(req){var events=this.container.down(".events");var htmls=req.responseJSON.comments.map(function(comment){return comment.content;});if(!req.responseJSON.last_page&&req.responseJSON.comments.length!=0){this.container.down(".more_comments_button").show();}
this.container.down(".loading_comments").hide();var new_comments=new Element("div").update(htmls.join(""));events.insert({bottom:new_comments});new Effect.BlindDown(new_comments,{duration:0.2});document.fire('scribd:dom_height_changed');}.bind(this)});}});Scribd.UI.CommentForm=Class.create({events_sent:{},max_len:400,actions:{fake_textarea:function(){Scribd.login.open({context:"comment",next_url:Scribd.current_doc.url+"#comments"});},submit_comment:function(){this.submit_comment();}},initialize:function(container,options){this.options=Object.extend({},options||{});this.container=$(container);this.form=this.container.down("form");var _this=this;this.form.onsubmit=function(e){Event.stop(e||window.event);_this.submit_comment();return false;};this.container.observe("click",function(e){Scribd.UI.dispatch(e,this.actions,this,"commments");}.bind(this));this.input=this.container.down("textarea");this.errors=this.container.down(".comment_errors");if(this.input){Scribd.enforceMaxLength(this.input,this.container.down('.number'),this.max_len);this.input.observe("focus",function(){var event_name=this.options.is_reply?"comment_reply":"comment_new";if(this.events_sent[event_name])return;trackEvent("newdoc","Focus",event_name,Scribd.logged_in?1:0);this.events_sent[event_name]=true;}.bind(this));}else{this.container.down(".number").update(this.max_len);}},validate:function(){this.errors.hide();if(this.input.value.blank()){this.errors.show();return false;}
return true;},set_error_message:function(msg){this.errors.down(".alert").update(msg);this.errors.show();},submit_comment:function(){var btn=this.container.down(".submit_comment");if(btn.hasClassName("disabled"))return;if(!this.validate())return;this.errors.hide();btn.addClassName("disabled");Scribd.Remote.Form(this.form,{use_alert:false,onComplete:function(req){this.form.enable();this.form.down(".spinner").hide();btn.removeClassName("disabled");if(req.responseJSON.error){this.set_error_message(req.responseJSON.error);return;}
this.input.value='';this.display_comment(req.responseJSON.content);}.bind(this)});},display_comment:function(html){var events=this.options.display_element||$("comments_section").down(".events");events.insert({top:html});var comment=events.firstDescendant();if(this.options.is_reply){comment.down(".single_comment").addClassName("child_comment");comment.down(".reply_button").remove();this.container.toggle();}
new Effect.BlindDown(comment,{transition:Effect.Transitions.spring});new Effect.Appear(comment,{afterFinish:function(){document.fire('scribd:dom_height_changed');}});}});


/* app/views/layouts/footer/language_selector.js @ 1339185851 */

Scribd.init('Scribd','Layouts','Footer');Scribd.Layouts.Footer.LanguageSelector=Class.create(Scribd.Shared.JavascriptWidget,{initialize:function($super,options){$super(options);this.open=false;},onDomLoaded:function($super,event){$super(event);this.widget_dom.select('.top_row .language').invoke('observe','click',function(e){e.stop();if(this.open){this.widget_dom.down('.top_row .language').removeClassName('active');this.widget_dom.down('.language_selector').hide();this.open=false;}else{this.widget_dom.down('.top_row .language').addClassName('active');this.widget_dom.down('.language_selector').show();this.open=true;window.scrollTo(0,document.body.scrollHeight);}
return false;}.bind(this));var set_lang=function(){this.widget_dom.select('.top_row .language a').invoke('update',Scribd.I18n.currentLanguage.name.capitalize());this.widget_dom.select('.language_selector li[data-id='+Scribd.I18n.currentLanguage.lcid+'] a').invoke('addClassName','active');}.bind(this);if(Scribd.I18n){set_lang();}else{document.observe('Scribd:language_detected',set_lang);}}});


/* app/views/shared/facebook/session.js @ 1339185851 */

if(!window.Scribd)var Scribd=new Object();Scribd.FacebookSession={getUserId:function(){var authResponse=FB.getAuthResponse();if(authResponse){return authResponse.userID;}},correct:function(){if(!window.facebookUser||(typeof window.facebookUserId==='undefined'))return false;return this.getUserId()==facebookUserId;},verifyExec:function(fn,force){if(!window.facebookUser)return;var that=this;if(!that.correct()){if(force){FB.getLoginStatus(function(response){var authResponse=response.authResponse;if(authResponse){FB.logout(function(response){FB.login(function(response){that.withValid(fn);});});}else{FB.login(function(response){that.withValid(fn);});}});}}else{fn();}},ensureValid:function(fn){this.verifyExec(fn,true);},withValid:function(fn){this.verifyExec(fn,false);}};


/* app/views/shared/sharing/preferences.js @ 1339185851 */

if(!window.Scribd)var Scribd=new Object();if(!Scribd.Readcast)Scribd.Readcast={};Scribd.Readcast.Status={initialize:function(){this.element=$('readcast_status');},set:function(type,msg){this.element.writeAttribute('class',type);this.element.update('<p>'+msg+'</p>');this.element.show();setTimeout(this.hide.bind(this),4000);},hide:function(){this.element.fade(2000);},success:function(msg){this.set('success',msg);},warn:function(msg){this.set('warn',msg);},error:function(msg){this.set('error',msg);}};Scribd.Readcast.Preferences={initialize:function(){var that=this;$$('.advanced_preferences').each(function(a){a.observe('click',that.openAdvanced);});that.checkUnlinked();},checkUnlinked:function(){$$('.pref_container').each(function(el){var not_linked=el.down('.not_linked');if(not_linked&&not_linked.style.display!=='none'){el.select('input[type=radio]').each(Form.Element.disable)}else{el.select('input[type=radio]').each(Form.Element.enable)}});},openAdvanced:function(e){e.stop();Scribd.Readcast.trackEvent("preferences","open advanced");window.open("/account/edit#sharing");}};Scribd.Readcast.Permissions={Facebook:{ensurePublish:function(callback){var that=this;FB.api({method:'users.hasAppPermission',ext_perm:'publish_stream'},function(response){if(!(response==1)){that.askForPublish(callback);}else{callback.call(this);}});},askForPublish:function(callback){var permissions="email,publish_stream,read_stream,offline_access";Scribd.Readcast.trackEvent("permissions","facebook stream publish prompt");FB.login(function(response){var authResponse=response.authResponse;if(authResponse&&Scribd.Facebook.Permissions.hasAllPermissions(response.perms,permissions)){callback.call(this);}else{Scribd.Readcast.Status.error('Readcast not sent');}},{scope:permissions});}}};Scribd.Readcast.Form={initialize:function(){this.form=$('sharing_prefs');$('save_changes_button').observe('click',this.submit);this.form.reset();this.cancelChanges=$('cancel_changes');$H(Scribd.Readcast.sharingPrefs).each(function(pair){$('options_event_settings_reading_'+pair.key+'_'+pair.value).checked=true;});$('header_button_on').observe('click',Scribd.Readcast.Form.toggleControls('on'));$('header_button_ask').observe('click',Scribd.Readcast.Form.toggleControls('ask'));},turnOn:function(networks){$H(networks).each(function(pair){$('options_event_settings_reading_'+pair.key+'_on').checked=pair.value;$('options_event_settings_reading_'+pair.key+'_ask').checked=!pair.value;});},toggleControls:function(state){return function(e){e.preventDefault();Scribd.Readcast.trackEvent("preferences","header click "+state);$$('div.sharing_option input.'+state).each(function(el){el.checked=true;});};},optionName:function(network){return"options[event_settings][reading]["+network+"]";},updatePrefs:function(){var that=this;Scribd.Readcast.sharingPrefs=$H(Scribd.Readcast.sharingPrefs).keys().inject({},function(m,network){m[network]=$$('input:checked[type="radio"][name="'+that.optionName(network)+'"]').pluck('value');return m;});},submit:function(e){e.stop();Scribd.Readcast.trackEvent("preferences","save");Scribd.Readcast.Form.doSubmit(true);},doSubmit:function(slideUp,status){new Ajax.Request(Scribd.Readcast.Form.form.action,{method:'put',parameters:Form.serialize(Scribd.Readcast.Form.form),onSuccess:function(response){Scribd.Readcast.Form.updatePrefs();if(status){Scribd.Readcast.Status.success(status);}else{Scribd.Readcast.Form.cancelChanges.update('Preferences saved');Scribd.Readcast.Status.success('Preferences saved');}
if(slideUp){new Effect.toggle('readcast_preferences','slide',{delay:0.5,duration:0.3,afterFinish:function(effect){Scribd.Readcast.Form.cancelChanges.update('Cancel');}});}},onFailure:function(response){Scribd.Readcast.Status.error('Unable to save');Scribd.Readcast.Form.cancelChanges.update('Unable to save');}});}};(function(){function initPreferences(){if(!Scribd.Readcast.active())return;Scribd.Readcast.Preferences.initialize();}
document.observe('dom:loaded',initPreferences);document.observe(Scribd.Facebook.EVENTS.transition,initPreferences);})();


/* app/views/premium/purchases/gate_components/plans_d.js @ 1339185851 */

Scribd.init('Scribd','Premium','Purchases','GateComponents');Scribd.Premium.Purchases.GateComponents.PlansD=Class.create(Scribd.Shared.JavascriptWidget,{initialize:function($super,options){$super(options);this.download_plans=options.download_plans;this.default_duration=options.default_duration;this.parent_dom_id=options.parent_dom_id;},onDomLoaded:function($super,event){$super(event);this.payment_radios=this.widget_dom.down('#package_plans').select('input[type="radio"]');var plans=this;$$('.package_container').each(function(c){c.observe('click',function(){plans.selectPlan(c.readAttribute('duration'));});});},parentJavascriptWidget:function(){return $(this.parent_dom_id).javascript_widget;},selectPlan:function(duration){var radio=this.widget_dom.down('#package_option_'+duration);if(radio&&!radio.disabled)radio.checked=true;this.parentJavascriptWidget().planSelected();},selectDefaultPlan:function(){return this.selectPlan(this.default_duration);},selectedDuration:function(){return this.payment_radios.detect(function(radio){return radio.checked;}).value;},selectedPlan:function(){return this.selectedDuration();}});


/* app/views/newdoc/_social.js @ 1339185851 */

Scribd.init("Scribd","UI");Scribd.UI.ensure_login=function(fn,context,hash){return function(){hash=hash||"#"+context;if(!Scribd.logged_in){Scribd.login.open({context:context,next_url:Scribd.current_doc.url+hash});}else{return fn.apply(this,arguments);}};};Scribd.UI.CommentsButton=Class.create({initialize:function(container){this.container=$(container);this.container.observe("click",this.click.bind(this));this.saved_position=null;},listen_scroll:function(){if(this.scroll_callback)return;this.scroll_callback=function(){if(this.is_scrolling)return;var comments=$("comments_section");if(comments.viewportOffset().top>document.viewport.getHeight()){Element.stopObserving(window,"scroll",this.scroll_callback);this.scroll_callback=false;this.saved_position=null;this.container.removeClassName("at_bottom");}}.bind(this);Element.observe(window,"scroll",this.scroll_callback);},click:function(){if(this.saved_position!==null){this.scroll_to_pos(this.saved_position);this.saved_position=null;this.container.removeClassName("at_bottom");}else{var comments=$("comments_section");if(comments.viewportOffset().top>document.viewport.getHeight()){this.saved_position=document.viewport.getScrollOffsets().top;this.container.addClassName("at_bottom");this.listen_scroll();}
this.is_scrolling=true;new Effect.ScrollTo(comments,{duration:0.6,afterFinish:function(){this.is_scrolling=false;}.bind(this)});}},scroll_to_pos:function(pos){var scrollOffsets=document.viewport.getScrollOffsets();this.is_scrolling=true;return new Effect.Tween(null,scrollOffsets.top,pos,{afterFinish:function(){this.is_scrolling=false;}.bind(this)},function(p){scrollTo(scrollOffsets.left,p.round());});}});Scribd.social_actions={embed_button:function(){Scribd.Lightbox.remoteOpen('embed_lb','/newdoc/embed_dialog',Scribd.toolbarParams(),{close:true});$rat('sharebox.viewbar.more_share_options');},readcast_button:Scribd.UI.ensure_login(function(){Scribd.Lightbox.remoteOpen('readcast_lb','/newdoc/readcast_dialog',Scribd.toolbarParams(),{close:true});},"readcast"),collections_button:Scribd.UI.ensure_login(function(e){Scribd.Lightbox.remoteOpen("collections_lb","/newdoc/collections_dialog",Scribd.toolbarParams(),{close:true});},"collections"),sticky_download_button:function(){Scribd.sidebar_actions.sidebar_download_button();},copy_link_button:function(){Scribd.Lightbox.remoteOpen("copy_link_lb","/newdoc/copy_link_dialog",Scribd.toolbarParams(),{close:true});},toggle_popup_button:function(){this.container.toggleClassName("popup_open");this.listen_for_hide();},close_button:function(){this.container.removeClassName("popup_open");},simple_comments_button:function(){new Effect.ScrollTo($("comments_section"),{duration:0.6});}};Scribd.UI.SocialButtons=Class.create({actions:Scribd.social_actions,initialize:function(container){this.container=$(container);this.bind_events();},bind_events:function(elm){elm=elm||this.container;var comments_btn=elm.down(".comments_button");if(comments_btn){this.comments_button=new Scribd.UI.CommentsButton(comments_btn);}
elm.observe("click",function(e){Scribd.UI.dispatch(e,this.actions,this);}.bind(this));}});Scribd.UI.SocialPanel=Class.create(Scribd.UI.SocialButtons,{margin:8,initialize:function(container,document_column){this.container=$(container);this.document_column=$(document_column);this.is_hidden=false;this.attach();this.bind_events(this.container);},enable_sidebar:function(){this.container.parentNode.hide();$("sidebar").addClassName("show_social");this.is_hidden=true;(function(){document.fire("scribd:dom_height_changed");}).defer();},disable_sidebar:function(){this.container.parentNode.show();$("sidebar").removeClassName("show_social");this.is_hidden=false;},attach:function(){var _this=this;(function(){var sidebar_width=$("sidebar").getWidth(),column_width=_this.container.parentNode.getWidth();function too_big(){return _this.document_column.getWidth()+sidebar_width+column_width>=document.viewport.getWidth()-16;}
Scribd.StickyElement(this.container,function(elm){var doc_offset=_this.document_column.cumulativeOffset();elm.setStyle({position:"fixed",top:_this.margin+"px",left:_this.container.parentNode.cumulativeOffset().left+"px"});},function(elm){elm.setStyle({position:"static"});},function(){var scroll=document.viewport.getScrollOffsets();var doc_offset=_this.document_column.cumulativeOffset();return scroll.top>doc_offset.top;},function(){if(too_big()){if(!_this.is_hidden){_this.enable_sidebar();}}else{if(_this.is_hidden){_this.disable_sidebar();}}});}).bind(this).defer();}});Scribd.UI.MiniSocialPanel=Class.create(Scribd.UI.SocialButtons,{initialize:function(container){this.container=$(container);this.bind_events(this.container);this.is_attached=false;this.attach.bind(this).defer();this.popup_open=false;this.mouse_inside_popup=false;},listen_for_hide:function(){var _this=this;this.mouse_inside_popup=true;var hider=function(){if(!_this.mouse_inside_popup){_this.container.removeClassName("popup_open");document.stopObserving("mousemove",listener);}}.debounce(3000);var listener=function(e){_this.mouse_inside_popup=!!e.findElement(".social_popup")||!!e.findElement(".toggle_popup_button");if(_this.mouse_inside_popup){hider();}};document.observe("mousemove",listener);},attach:function(){var _this=this,sidebar=$("sidebar"),spacer=this.container.parentNode;Scribd.StickyElement(this.container,function(elm){var spacer_left=spacer.cumulativeOffset().left;elm.setStyle({position:"fixed",width:spacer.getWidth()+"px",top:"0px",left:spacer_left+"px"});},function(elm){elm.setStyle({position:"static",width:"",top:"auto",left:"auto"});},function(){var scroll=document.viewport.getScrollOffsets(),spacer_top=spacer.cumulativeOffset().top;var is_attached=scroll.top>spacer_top;if(is_attached!=this.is_attached){if(is_attached){_this.container.addClassName("is_fixed");}else{_this.container.removeClassName("is_fixed");_this.container.removeClassName("popup_open");}
this.is_attached=is_attached;}
return is_attached;},function(elm){});}});


/* app/views/newdoc/_sidebar.js @ 1339185851 */

Scribd.toolbarParams=function(){var params={id:Scribd.current_doc.id,show_container:true};if(Scribd.current_doc.secret_password){params.secret_password=Scribd.current_doc.secret_password;}
return params;};Scribd.sidebar_actions={sidebar_download_button:function(){trackEvent("payments","newdoc","download_dialog:button:click",Scribd.logged_in?1:0);if(Scribd.logged_in){Scribd.Lightbox.remoteOpen('download_lb','/newdoc/download_dialog',Scribd.toolbarParams(),{close:true});$rat('analytics.sidebar.document.download',{'title':Scribd.current_doc.title});}else{Scribd.login.open({context:"download",next_url:Scribd.current_doc.url+"#download"});}},delete_document_button:function(){var message;if(Scribd.current_doc.is_deletable){var form=$('delete_form');message=$('delete_form_message').innerHTML;if(confirm(message))form.submit();}else{var message=I18n.t('js.this_document_could_not_be_deleted');alert(message);}},flag_button:function(){Scribd.Lightbox.remoteOpen("flag_doc_lb","/newdoc/flag_dialog",Scribd.toolbarParams(),{close:true});},toggle_info:function(){Scribd.UI.enable_rating();var pageType=Scribd.UI.is_paginated?"Paginated":"Scrolling";trackEvent("newdoc",pageType,"toggle_info");this.down(".more_info").toggleClassName("open");document.fire('scribd:move_ads');}};Scribd.UI.enable_rating=Scribd.once(function(){if(!Scribd.current_doc.rating_url)return;try{new Starbox("document_starbox",Scribd.current_doc.rating,{overlay:'blue_gradient.png',className:'pointy',locked:false,effect:{mouseout:false}});}catch(e){}
var rating=$("rating");if(rating){rating.observe("starbox:rated",function(event){if(Scribd.logged_in||Scribd.Facebook.isSessionTransitioned()){new Ajax.Request(Scribd.current_doc.rating_url,{parameters:event.memo,evalJSON:"force"});}else{Scribd.login.open({next_url:Scribd.current_doc.url,fallback_url:"/",context:"rate"});}});}});Scribd.UI.Sidebar=Class.create({initialize:function(container){var sidebar=this.container=$(container);this.container.observe("click",function(e){if(e.findElement(".truncated_more")||e.findElement(".truncated_less")){e.element().up(".truncated_text").select(".truncated_long",".truncated_short").invoke("toggle");document.fire('scribd:move_ads');e.stop();return;}
Scribd.UI.dispatch(e,Scribd.sidebar_actions,sidebar);});function set_privacy_indicator(is_private){var indicator=sidebar.down(".privacy_indicator");if(is_private)indicator.show();else indicator.hide();}
this.container.select(".privacy_control input").invoke("observe","change",function(e){var visibility=e.element().value;set_privacy_indicator(visibility=="private");if(Scribd.UI.social_panel){if(visibility=="private"){Scribd.UI.social_panel.container.addClassName("private");}else{Scribd.UI.social_panel.container.removeClassName("private");}}
new Ajax.Request('/documents/make_'+visibility,{parameters:Scribd.CSRF.paramsWithToken({document_ids:Scribd.current_doc.id}),evalJSON:true,onFailure:function(trans){set_privacy_indicator(visibility!="private");}.bind(this)});});}});


/* app/views/shared/document_collections/form.js @ 1339185851 */

if(!window.Scribd)var Scribd=new Object();Scribd.enableDocumentCollectionForm=function(){var M=Scribd.DocumentCollectionsManager;Scribd.ajaxDocumentCollectionForm({form:'new_document_collection',reveal:true,params:function(){var params={format:'json',document_id:$('lightbox_document_collections').down('.document_collections_container').retrieve('document_id')}
return params;},success:function(json,params){var doc_id=params.document_id;var new_collection=new Element('div').update(M.collection_template.evaluate(M.renderingCollectionAttributes(doc_id,json.document_collection))).down('li.document_collection');M.storeCollections(doc_id,[json.document_collection]);M.attachEvent(doc_id,new_collection);$$('.manage_collection .add_to_my_collections').each(function(container){container.insert({'top':new_collection});});}});M.addPaginationEvent();};Scribd.ajaxDocumentCollectionForm=function(options){var form=$(options.form);var spinner=spinner||form.down('.spinner');var error_container=$(error_container)||form.down('.error');var form_container=options.form_container||form.up();var success_message=options.success_message;var method=options.method||'post';var clickable_header=$(options.clickable_header)||form_container.down('.form_header');var name_input=form.down('#document_collection_name');var new_name_message=I18n.t('js.enter_a_name_for_your_new_collection');function reset(){form.reset();if(form_container&&options.reveal){name_input.setValue(new_name_message);}
form_container&&form_container.removeClassName('document_collection_form_container_open');error_container&&error_container.update('');}
if($('dynamic_privacy_explanation')){explanationTextContainer=$('dynamic_privacy_explanation');explanationSelector=$('document_collection_combined_privacy_type');explanationTextContainer.innerHTML=getExplanation(explanationSelector);explanationSelector.observe('change',function(e){e.stop();explanationTextContainer.innerHTML=getExplanation(this);});}
function getExplanation(explanationSelector){switch(explanationSelector.value){case"public - locked":return I18n.t('js.public_locked_collection');case"public - moderated":return I18n.t('js.public_moderated_collection');case"private":return I18n.t('js.private_collection');default:return"";}}
form.observe('submit',function(e){e.stop();var params=Object.isFunction(options.params)?options.params(form):options.params;if(options.reveal&&name_input.getValue()===new_name_message){name_input.setValue('');}
form.request({'method':method,parameters:(params),onCreate:function(){form.disable();spinner&&spinner.show();},onComplete:function(){form.enable();spinner&&spinner.hide();},onSuccess:function(response){var json=response.responseJSON;switch(json.status){case'ok':success_message&&success_message.show();options.success&&options.success(json,params)
options.reset?options.reset(form):reset();return;case'error':options.error&&options.error(json,params);error_container&&Scribd.Alerts.error(error_container,json.message)}}});});var cancel=form.down('a.cancel');if(cancel){cancel.observe('click',function(e){e.stop();options.reset?options.reset(form):reset();})}
if(form_container&&options.reveal){name_input.setValue(new_name_message);name_input.observe('focus',function(e){form_container.addClassName('document_collection_form_container_open');if(name_input.getValue()===new_name_message){name_input.setValue('');}});name_input.observe('blur',function(e){if(name_input.getValue().strip()===''){name_input.setValue(new_name_message);}});}
if(clickable_header){clickable_header.observe('click',function(){form_container.toggleClassName('document_collection_form_container_open');});}};


/* app/views/facebook/_login_button.rb:15 @ 1339185851 */

if(!window.Scribd)var Scribd=new Object();if(!window.Scribd.Facebook)Scribd.Facebook=new Object();Scribd.Facebook.LoginButton=Class.create(Scribd.Shared.JavascriptWidget,{initialize:function($super,options){$super(options);},onWidgetsLoaded:function($super,event){$super(event);var buttonClickedFunction=this.buttonClicked.bind(this);this.widget_dom.select('.fb_button').each(function(button){button.observe('click',buttonClickedFunction);});this.posted_form=this.widget_dom.down('.posted_form');},buttonClicked:function(event){Event.stop(event);this.in_process=true;this.showSpinnerIfStillProcessing.bind(this).delay(0);FB.login(this.fbLoginReturned.bind(this),{scope:"email,publish_stream,read_stream,offline_access"});},fbLoginReturned:function(response){var authResponse=response.authResponse;if(authResponse){var session_elements_div=this.posted_form.down(".facebook_session_elements");if(session_elements_div){var cookies=document.cookie;var regexp=new RegExp("(fbs_[a-f0-9]*)\s*=\s*([^;]+)");var match=regexp.exec(cookies);if(match){var fbs_cookie_name=match[1];var fbs_cookie=match[2];match=new RegExp("^\"(.*)\"$").exec(fbs_cookie);if(match){fbs_cookie=match[1];}
session_elements_div.insert("<input type='hidden' name='fbs_cookie' value='"+fbs_cookie+"' />");session_elements_div.insert("<input type='hidden' name='fbs_cookie_name' value='"+fbs_cookie_name+"' />");}else{session_elements_div.insert("<input type='hidden' name='fbs_cookie' value='none' />");}
for(var name in authResponse){var value=authResponse[name];session_elements_div.insert("<input type='hidden' name='facebook_session["+name+"]' value='"+value+"' />");}}
this.userIsLoggedInToFacebook(response);}else{this.userCancelledFacebookLogin(response);}},userIsLoggedInToFacebook:function(response){if(this.options.trackEvent){eval(this.options.trackEvent);}else if(this.options.google_analytics_event){trackEvent("Facebook",this.options.google_analytics_event);}
this.loggedInCallback();},userCancelledFacebookLogin:function(response){this.in_process=false;this.invokeOnInProcess(function(e){e.hide();});},showSpinnerIfStillProcessing:function(){if(this.in_process){this.invokeOnInProcess(function(e){e.show();});}},invokeOnInProcess:function(f){this.widget_dom.select(".in_process").each(f);},loggedInCallback:function(){this.posted_form.submit();}});
